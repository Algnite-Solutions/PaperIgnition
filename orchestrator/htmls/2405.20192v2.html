<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id3.id1">TAIA</span>: Large Language Models are Out-of-Distribution Data Learners</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuyang Jiang 
<br class="ltx_break"/>Fudan University
<br class="ltx_break"/>Shanghai Artificial Intelligence Laboratory 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.3.id1">shuyangjiang23@m.fudan.edu.cn</span>
&amp;Yusheng Liao<sup class="ltx_sup" id="id5.4.id2">∗</sup>
<br class="ltx_break"/>Cooperative Medianet Innovation Center,
<br class="ltx_break"/>Shanghai Jiao Tong University 
<br class="ltx_break"/>Shanghai Artificial Intelligence Laboratory 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id6.5.id3">liao20160907@sjtu.edu.cn</span>
&amp;Ya Zhang, Yanfeng Wang, Yu Wang<sup class="ltx_sup" id="id7.6.id4">†</sup>
<br class="ltx_break"/>Cooperative Medianet Innovation Center,
<br class="ltx_break"/>Shanghai Jiao Tong University 
<br class="ltx_break"/>Shanghai Artificial Intelligence Laboratory 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id8.7.id5">{ya_zhang, wangyanfeng622, yuwangsjtu}@sjtu.edu.cn</span>
</span><span class="ltx_author_notes">Equal contribution, alphabetical order.Corresponding Author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id9.id1">Fine-tuning on task-specific question-answer pairs is a predominant method for enhancing the performance of instruction-tuned large language models (LLMs) on downstream tasks. However, in certain specialized domains, such as healthcare or harmless content generation, it is nearly impossible to obtain a large volume of high-quality data that matches the downstream distribution. To improve the performance of LLMs in data-scarce domains with domain-mismatched data, we re-evaluated the Transformer architecture and discovered that not all parameter updates during fine-tuning contribute positively to downstream performance. Our analysis reveals that within the self-attention and feed-forward networks, only the fine-tuned attention parameters are particularly beneficial when the training set’s distribution does not fully align with the test set. Based on this insight, we propose an effective inference-time intervention method: <span class="ltx_text ltx_ulem_uline" id="id9.id1.1">T</span>raining <span class="ltx_text ltx_ulem_uline" id="id9.id1.2">A</span>ll parameters but <span class="ltx_text ltx_ulem_uline" id="id9.id1.3">I</span>nferring with only <span class="ltx_text ltx_ulem_uline" id="id9.id1.4">A</span>ttention (<span class="ltx_text ltx_font_smallcaps" id="id9.id1.5">TAIA</span>). We empirically validate <span class="ltx_text ltx_font_smallcaps" id="id9.id1.6">TAIA</span> using two general instruction-tuning datasets and evaluate it on seven downstream tasks involving math, reasoning, and knowledge understanding across LLMs of different parameter sizes and fine-tuning techniques. Our comprehensive experiments demonstrate that <span class="ltx_text ltx_font_smallcaps" id="id9.id1.7">TAIA</span> achieves superior improvements compared to both the fully fine-tuned model and the base model in most scenarios, with significant performance gains. The high tolerance of <span class="ltx_text ltx_font_smallcaps" id="id9.id1.8">TAIA</span> to data mismatches makes it resistant to jailbreaking tuning and enhances specialized tasks using general data.
Code is available in <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/pixas/TAIA_LLM" title="">https://github.com/pixas/TAIA_LLM</a>.</p>
</div>
<figure class="ltx_figure" id="S0.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S0.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="887" id="S0.F1.sf1.g1" src="x1.png" width="821"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S0.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="880" id="S0.F1.sf2.g1" src="x2.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S0.F1.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="887" id="S0.F1.sf3.g1" src="x3.png" width="821"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.sf3.2.1.1" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S0.F1.4.2" style="font-size:90%;">
Performance comparison of various fine-tuning methods under three OOD data mixing scenarios.
The target domain is medical knowledge, using Chinese subset of MMedBench <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a>]</cite> as the in-domain training dataset. (a) The dataset is mixed with medical OOD data from CMExam <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, maintaining a total dataset size of 20k; (b) The dataset is mixed with general OOD data from CoT-Collection <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>, also keeping the total dataset size at 20k; (c) The dataset includes general OOD data from CoT-Collection, while the size of the in-domain training dataset remains at 20k. As the proportion of OOD data increases, the performance of the vanilla fine-tuning declines significantly, whereas <span class="ltx_text ltx_font_smallcaps" id="S0.F1.4.2.1">TAIA</span> manages to sustain robust performance in the target domain (details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5.SS5" title="E.5 Data Mixing Experiments ‣ Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">E.5</span></a>).
</span></figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large language models (LLMs) have revolutionized Natural Language Processing (NLP), where LLMs have been pretrained on a massive textual corpus and encoded massive world knowledge <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite>. These models achieve remarkable zero-shot and few-shot performance across a wide range of tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">45</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">65</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">66</span></a>]</cite>.
The innovation of instruction tuning, also known as supervised fine-tuning (SFT), has further enhanced the instruction-following capabilities of LLMs <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">46</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">11</span></a>]</cite>, simplifying human-LLM interactions.
Despite the availability of high-quality data for SFT being limited <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib86" title=""><span class="ltx_text" style="font-size:90%;">86</span></a>]</cite>, expanding SFT datasets remains a straightforward method to adapt LLMs for specific tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite>. Various SFT datasets, such as Alpaca <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite> and Natural Instructions <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib41" title=""><span class="ltx_text" style="font-size:90%;">41</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib69" title=""><span class="ltx_text" style="font-size:90%;">69</span></a>]</cite>, have been manually curated or artificially generated to create more generalized instruction-tuned LLMs.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, real-world applications of LLMs are diverse <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> and complex <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>, often making public datasets insufficient.
While synthetic data is useful, it is expensive and tends to exhibit a distribution shift biased towards the parent LLM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib67" title=""><span class="ltx_text" style="font-size:90%;">67</span></a>]</cite>.
Consequently, the data distribution that LLMs adapt to during fine-tuning often differs significantly from that required for specific tasks. This discrepancy leads to inferior performance on specialized tasks and knowledge forgetting due to disruptions in the parametric knowledge stored in LLMs <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite>.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S0.F1" title="Figure 1 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1</span></a> also shows that with more out-of-distribution (OOD) tuning data, the vanilla fine-tune method brings
catastrophic forgetting problems, degrading models’ performance on downstream tasks. The scarcity of natural data and the suboptimal quality of synthetic data present substantial challenges to effectively adapting LLMs for specialized tasks. In essence, the dependency on in-domain distribution fine-tuning corpora hampers the broader deployment of LLMs.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address this, we propose avoiding such data dependency by leveraging the intrinsic properties of fine-tuning and developing an inference-time method that does not rely on high-quality in-distribution data.
We first conduct an in-depth investigation of the internal Transformer architecture.
We find that during fine-tuning, LLMs enhance their instruction-following ability, primarily controlled by the self-attention module <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib75" title=""><span class="ltx_text" style="font-size:90%;">75</span></a>]</cite>.
Conversely, parameterized knowledge is encoded by the key-value intrinsic of the feed-forward network (FFN) module <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">40</span></a>]</cite> during pretraining <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib56" title=""><span class="ltx_text" style="font-size:90%;">56</span></a>]</cite>.
Fine-tuning primarily elicits this pretrained knowledge <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">71</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">46</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib59" title=""><span class="ltx_text" style="font-size:90%;">59</span></a>]</cite>, which remains relatively fixed <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib86" title=""><span class="ltx_text" style="font-size:90%;">86</span></a>]</cite>.
This insight prompts us to discard the FFN updates during fine-tuning, as only a small portion positively contributes to downstream performance, while most disrupt the knowledge when fine-tuned on task-mismatched data.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">A naive approach is to fine-tune only the attention parameters, but this fails to generalize to OOD data due to insufficient exploration of non-linearity. To ensure sufficient learning of non-linearity, we introduce additional FFN parameters during fine-tuning but retain only the beneficial self-attention updates. This strategy, named <span class="ltx_text ltx_ulem_uline" id="S1.p4.1.1">T</span>raining-<span class="ltx_text ltx_ulem_uline" id="S1.p4.1.2">A</span>ll-<span class="ltx_text ltx_ulem_uline" id="S1.p4.1.3">I</span>nferring-only-<span class="ltx_text ltx_ulem_uline" id="S1.p4.1.4">A</span>ttention (<span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.5">TAIA</span>), achieves both OOD generalization and sufficient optimization space. The comparisons between the proposed method and the vanilla fine-tuning method are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">2</span></a></p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We validate <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.1">TAIA</span> across seven datasets including math, reasoning, and knowledge understanding, using four LLM families and two fine-tuning techniques.
Extensive experiments demonstrate the efficacy of <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.2">TAIA</span> across various model configurations and its outstanding robustness compared to other baselines.
Furthermore, detailed analyses confirm the reproducibility of <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.3">TAIA</span> in terms of fine-tuning methods and fine-tuning dataset scales.
<span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.4">TAIA</span> also maintains the few-shot adaptation ability of base models and withstands multi-level red-teaming attacks.
It consistently improves performance in vertical domains like healthcare with increasing OOD data (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S0.F1" title="Figure 1 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Overall, we conclude our contributions as three-fold:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Necessity Analysis:</span> We analyze the necessity of leveraging OOD data for effective downstream fine-tuning, revisiting the roles of self-attention and FFN in the Transformer architecture and formalizing their contributions during fine-tuning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Inference-Time Intervention:</span> We propose a simple yet effective inference-time method that trains all parameters but retains only the self-attention updates. This approach optimizes performance across downstream and closed-book tasks, as validated by extensive experiments.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Expanding Model Adaptability:</span>
Our approach introduces an innovative method for utilizing OOD data in fine-tuning LLMs, substantially decreasing the dependence on in-domain data. This advancement enhances the adaptability of LLMs, enabling them to perform exceptionally well across a wider range of specialized and real-world tasks.
</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="349" id="S1.F2.g1" src="x4.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.6.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S1.F2.7.2" style="font-size:90%;">Comparison between different fine-tuning and inference methods. Parameters colored with <span class="ltx_text" id="S1.F2.7.2.1" style="color:#B1D095;">green</span> and <span class="ltx_text" id="S1.F2.7.2.2" style="color:#F1D578;">yellow</span> represent models finetuned with in-domain and out-of-distribution data, respectively. “ID” and “OOD” represents in-distribution and out-of-distribution, respectively. When we train in-domain data (colored as <span class="ltx_text" id="S1.F2.7.2.3" style="color:#B1D095;">green</span>) and out-of-domain data (colored as <span class="ltx_text" id="S1.F2.7.2.4" style="color:#F1D578;">yellow</span>) and evaluate in in-domain test sets and out-of-domain test sets, respectively (The second row; fine-tuning). The vanilla fine-tuning method can only perform well when trained on ID data and evaluated in ID test sets. Compared to vanilla tuning, TAIA can perform generally well on both types of test sets when given OOD data. As a similar approach that only trains attention, TOA (Train-only-attention) performs badly on both types of evaluation sets as it loses sufficient exploration of optimal parameter groups.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Self-attention module</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.3">Let <math alttext="\{t_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><msubsup id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2">𝑡</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">\{t_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">{ italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> represents the inputs to an Transformer-based LLM, and
<math alttext="\{\mathbf{x}_{i}\}_{i=1}^{N}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml">N</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1"><in id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2"></in><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3">𝑁</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\{\mathbf{x}_{i}\}_{i=1}^{N}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">{ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> represent the token representations after the embedding layer of a Transformer-based LLM.
For each layer <math alttext="l" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_l</annotation></semantics></math>, LLM initially computes the query, key, and value vectors:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx1">
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{q}_{m}^{l}=f_{q}(\mathbf{x}_{m}^{l},m)\quad\mathbf{k}_{n}%
^{l}=f_{k}(\mathbf{x}_{n}^{l},n)\quad\mathbf{v}_{n}^{l}=f_{v}(\mathbf{x}_{n}^{%
l},n)" class="ltx_Math" display="inline" id="S2.Ex1.m1.5"><semantics id="S2.Ex1.m1.5a"><mrow id="S2.Ex1.m1.5.5.2" xref="S2.Ex1.m1.5.5.3.cmml"><mrow id="S2.Ex1.m1.4.4.1.1" xref="S2.Ex1.m1.4.4.1.1.cmml"><msubsup id="S2.Ex1.m1.4.4.1.1.3" xref="S2.Ex1.m1.4.4.1.1.3.cmml"><mi id="S2.Ex1.m1.4.4.1.1.3.2.2" xref="S2.Ex1.m1.4.4.1.1.3.2.2.cmml">𝐪</mi><mi id="S2.Ex1.m1.4.4.1.1.3.2.3" xref="S2.Ex1.m1.4.4.1.1.3.2.3.cmml">m</mi><mi id="S2.Ex1.m1.4.4.1.1.3.3" xref="S2.Ex1.m1.4.4.1.1.3.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.4.4.1.1.2" xref="S2.Ex1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.4.4.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.cmml"><msub id="S2.Ex1.m1.4.4.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.3.cmml"><mi id="S2.Ex1.m1.4.4.1.1.1.3.2" xref="S2.Ex1.m1.4.4.1.1.1.3.2.cmml">f</mi><mi id="S2.Ex1.m1.4.4.1.1.1.3.3" xref="S2.Ex1.m1.4.4.1.1.1.3.3.cmml">q</mi></msub><mo id="S2.Ex1.m1.4.4.1.1.1.2" xref="S2.Ex1.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.4.4.1.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml">(</mo><msubsup id="S2.Ex1.m1.4.4.1.1.1.1.1.1" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="S2.Ex1.m1.4.4.1.1.1.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.3" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml">,</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">m</mi><mo id="S2.Ex1.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.Ex1.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace id="S2.Ex1.m1.5.5.2.3" width="1em" xref="S2.Ex1.m1.5.5.3a.cmml"></mspace><mrow id="S2.Ex1.m1.5.5.2.2.2" xref="S2.Ex1.m1.5.5.2.2.3.cmml"><mrow id="S2.Ex1.m1.5.5.2.2.1.1" xref="S2.Ex1.m1.5.5.2.2.1.1.cmml"><msubsup id="S2.Ex1.m1.5.5.2.2.1.1.3" xref="S2.Ex1.m1.5.5.2.2.1.1.3.cmml"><mi id="S2.Ex1.m1.5.5.2.2.1.1.3.2.2" xref="S2.Ex1.m1.5.5.2.2.1.1.3.2.2.cmml">𝐤</mi><mi id="S2.Ex1.m1.5.5.2.2.1.1.3.2.3" xref="S2.Ex1.m1.5.5.2.2.1.1.3.2.3.cmml">n</mi><mi id="S2.Ex1.m1.5.5.2.2.1.1.3.3" xref="S2.Ex1.m1.5.5.2.2.1.1.3.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.5.5.2.2.1.1.2" xref="S2.Ex1.m1.5.5.2.2.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.5.5.2.2.1.1.1" xref="S2.Ex1.m1.5.5.2.2.1.1.1.cmml"><msub id="S2.Ex1.m1.5.5.2.2.1.1.1.3" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3.cmml"><mi id="S2.Ex1.m1.5.5.2.2.1.1.1.3.2" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3.2.cmml">f</mi><mi id="S2.Ex1.m1.5.5.2.2.1.1.1.3.3" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3.3.cmml">k</mi></msub><mo id="S2.Ex1.m1.5.5.2.2.1.1.1.2" xref="S2.Ex1.m1.5.5.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.2.cmml"><mo id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.3.cmml">n</mi><mi id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.3" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.3" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.2.cmml">,</mo><mi id="S2.Ex1.m1.2.2" xref="S2.Ex1.m1.2.2.cmml">n</mi><mo id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.4" stretchy="false" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace id="S2.Ex1.m1.5.5.2.2.2.3" width="1em" xref="S2.Ex1.m1.5.5.2.2.3a.cmml"></mspace><mrow id="S2.Ex1.m1.5.5.2.2.2.2" xref="S2.Ex1.m1.5.5.2.2.2.2.cmml"><msubsup id="S2.Ex1.m1.5.5.2.2.2.2.3" xref="S2.Ex1.m1.5.5.2.2.2.2.3.cmml"><mi id="S2.Ex1.m1.5.5.2.2.2.2.3.2.2" xref="S2.Ex1.m1.5.5.2.2.2.2.3.2.2.cmml">𝐯</mi><mi id="S2.Ex1.m1.5.5.2.2.2.2.3.2.3" xref="S2.Ex1.m1.5.5.2.2.2.2.3.2.3.cmml">n</mi><mi id="S2.Ex1.m1.5.5.2.2.2.2.3.3" xref="S2.Ex1.m1.5.5.2.2.2.2.3.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.5.5.2.2.2.2.2" xref="S2.Ex1.m1.5.5.2.2.2.2.2.cmml">=</mo><mrow id="S2.Ex1.m1.5.5.2.2.2.2.1" xref="S2.Ex1.m1.5.5.2.2.2.2.1.cmml"><msub id="S2.Ex1.m1.5.5.2.2.2.2.1.3" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3.cmml"><mi id="S2.Ex1.m1.5.5.2.2.2.2.1.3.2" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3.2.cmml">f</mi><mi id="S2.Ex1.m1.5.5.2.2.2.2.1.3.3" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3.3.cmml">v</mi></msub><mo id="S2.Ex1.m1.5.5.2.2.2.2.1.2" xref="S2.Ex1.m1.5.5.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.2.cmml"><mo id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.2.cmml">(</mo><msubsup id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.2" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.3" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.3.cmml">n</mi><mi id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.3" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.3" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.2.cmml">,</mo><mi id="S2.Ex1.m1.3.3" xref="S2.Ex1.m1.3.3.cmml">n</mi><mo id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.4" stretchy="false" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.5b"><apply id="S2.Ex1.m1.5.5.3.cmml" xref="S2.Ex1.m1.5.5.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.3a.cmml" xref="S2.Ex1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.4.4.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1"><eq id="S2.Ex1.m1.4.4.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.2"></eq><apply id="S2.Ex1.m1.4.4.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.3.1.cmml" xref="S2.Ex1.m1.4.4.1.1.3">superscript</csymbol><apply id="S2.Ex1.m1.4.4.1.1.3.2.cmml" xref="S2.Ex1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.3.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.4.4.1.1.3.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.3.2.2">𝐪</ci><ci id="S2.Ex1.m1.4.4.1.1.3.2.3.cmml" xref="S2.Ex1.m1.4.4.1.1.3.2.3">𝑚</ci></apply><ci id="S2.Ex1.m1.4.4.1.1.3.3.cmml" xref="S2.Ex1.m1.4.4.1.1.3.3">𝑙</ci></apply><apply id="S2.Ex1.m1.4.4.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1"><times id="S2.Ex1.m1.4.4.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.2"></times><apply id="S2.Ex1.m1.4.4.1.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.3.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.4.4.1.1.1.3.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.3.2">𝑓</ci><ci id="S2.Ex1.m1.4.4.1.1.1.3.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.3.3">𝑞</ci></apply><interval closure="open" id="S2.Ex1.m1.4.4.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1"><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.Ex1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.4.4.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝑚</ci></interval></apply></apply><apply id="S2.Ex1.m1.5.5.2.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.3a.cmml" xref="S2.Ex1.m1.5.5.2.2.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.5.5.2.2.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1"><eq id="S2.Ex1.m1.5.5.2.2.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.2"></eq><apply id="S2.Ex1.m1.5.5.2.2.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.1.1.3.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3">superscript</csymbol><apply id="S2.Ex1.m1.5.5.2.2.1.1.3.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.1.1.3.2.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.1.1.3.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3.2.2">𝐤</ci><ci id="S2.Ex1.m1.5.5.2.2.1.1.3.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3.2.3">𝑛</ci></apply><ci id="S2.Ex1.m1.5.5.2.2.1.1.3.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.3.3">𝑙</ci></apply><apply id="S2.Ex1.m1.5.5.2.2.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1"><times id="S2.Ex1.m1.5.5.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.2"></times><apply id="S2.Ex1.m1.5.5.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3.2">𝑓</ci><ci id="S2.Ex1.m1.5.5.2.2.1.1.1.3.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.3.3">𝑘</ci></apply><interval closure="open" id="S2.Ex1.m1.5.5.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1"><apply id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.2.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2">𝑛</ci></interval></apply></apply><apply id="S2.Ex1.m1.5.5.2.2.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2"><eq id="S2.Ex1.m1.5.5.2.2.2.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.2"></eq><apply id="S2.Ex1.m1.5.5.2.2.2.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.2.2.3.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3">superscript</csymbol><apply id="S2.Ex1.m1.5.5.2.2.2.2.3.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.2.2.3.2.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.2.2.3.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3.2.2">𝐯</ci><ci id="S2.Ex1.m1.5.5.2.2.2.2.3.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3.2.3">𝑛</ci></apply><ci id="S2.Ex1.m1.5.5.2.2.2.2.3.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.3.3">𝑙</ci></apply><apply id="S2.Ex1.m1.5.5.2.2.2.2.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1"><times id="S2.Ex1.m1.5.5.2.2.2.2.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.2"></times><apply id="S2.Ex1.m1.5.5.2.2.2.2.1.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.2.2.1.3.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.2.2.1.3.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3.2">𝑓</ci><ci id="S2.Ex1.m1.5.5.2.2.2.2.1.3.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.3.3">𝑣</ci></apply><interval closure="open" id="S2.Ex1.m1.5.5.2.2.2.2.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1"><apply id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.2">𝐱</ci><ci id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.2.3">𝑛</ci></apply><ci id="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.5.5.2.2.2.2.1.1.1.1.3">𝑙</ci></apply><ci id="S2.Ex1.m1.3.3.cmml" xref="S2.Ex1.m1.3.3">𝑛</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.5c">\displaystyle\mathbf{q}_{m}^{l}=f_{q}(\mathbf{x}_{m}^{l},m)\quad\mathbf{k}_{n}%
^{l}=f_{k}(\mathbf{x}_{n}^{l},n)\quad\mathbf{v}_{n}^{l}=f_{v}(\mathbf{x}_{n}^{%
l},n)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.5d">bold_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_m ) bold_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_n ) bold_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_n )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.5">where <math alttext="m,n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m1.2"><semantics id="S2.SS0.SSS0.Px1.p1.4.m1.2a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m1.2.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m1.2.3.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m1.1.1.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m1.2.3.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m1.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m1.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m1.2.2.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m1.2b"><list id="S2.SS0.SSS0.Px1.p1.4.m1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m1.2.3.2"><ci id="S2.SS0.SSS0.Px1.p1.4.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m1.1.1">𝑚</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m1.2.2">𝑛</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m1.2c">m,n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m1.2d">italic_m , italic_n</annotation></semantics></math> are token indexes in the sequence and <math alttext="f_{\{q;k;v\}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m2.3"><semantics id="S2.SS0.SSS0.Px1.p1.5.m2.3a"><msub id="S2.SS0.SSS0.Px1.p1.5.m2.3.4" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.4.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m2.3.4.2" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.4.2.cmml">f</mi><mrow id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml"><mo id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml">{</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m2.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m2.1.1.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5.2" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml">;</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m2.2.2.2.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5.3" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml">;</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.3.cmml">v</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5.4" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m2.3b"><apply id="S2.SS0.SSS0.Px1.p1.5.m2.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m2.3.4.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m2.3.4.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.4.2">𝑓</ci><list id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.5"><ci id="S2.SS0.SSS0.Px1.p1.5.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.1.1.1.1">𝑞</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.2.2.2.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m2.3.3.3.3">𝑣</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m2.3c">f_{\{q;k;v\}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m2.3d">italic_f start_POSTSUBSCRIPT { italic_q ; italic_k ; italic_v } end_POSTSUBSCRIPT</annotation></semantics></math> are position embeddings parameterized by RoPE <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib61" title=""><span class="ltx_text" style="font-size:90%;">61</span></a>]</cite>.
After that, the attention score is computed between these two position tokens:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx2">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{o}_{m}^{l\top}=\mathrm{softmax}\left(\frac{\mathbf{q}_{m}%
^{l\top}W_{q}^{l}W_{k}^{l\top}\mathbf{K}_{m}^{l\top}}{\sqrt{d_{k}}}\right)%
\mathbf{V}_{m}^{l}W_{v}^{l}" class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.2" xref="S2.E1.m1.1.2.cmml"><msubsup id="S2.E1.m1.1.2.2" xref="S2.E1.m1.1.2.2.cmml"><mi id="S2.E1.m1.1.2.2.2.2" xref="S2.E1.m1.1.2.2.2.2.cmml">𝐨</mi><mi id="S2.E1.m1.1.2.2.2.3" xref="S2.E1.m1.1.2.2.2.3.cmml">m</mi><mrow id="S2.E1.m1.1.2.2.3" xref="S2.E1.m1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.2.2.3.2" xref="S2.E1.m1.1.2.2.3.2.cmml">l</mi><mo id="S2.E1.m1.1.2.2.3.3" lspace="0.222em" xref="S2.E1.m1.1.2.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S2.E1.m1.1.2.1" xref="S2.E1.m1.1.2.1.cmml">=</mo><mrow id="S2.E1.m1.1.2.3" xref="S2.E1.m1.1.2.3.cmml"><mi id="S2.E1.m1.1.2.3.2" xref="S2.E1.m1.1.2.3.2.cmml">softmax</mi><mo id="S2.E1.m1.1.2.3.1" xref="S2.E1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.1.2.3.3.2" xref="S2.E1.m1.1.1.cmml"><mo id="S2.E1.m1.1.2.3.3.2.1" xref="S2.E1.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mfrac id="S2.E1.m1.1.1a" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml"><msubsup id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml"><mi id="S2.E1.m1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.2.2.2.2.cmml">𝐪</mi><mi id="S2.E1.m1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.2.2.2.3.cmml">m</mi><mrow id="S2.E1.m1.1.1.2.2.3" xref="S2.E1.m1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.1.2.2.3.2" xref="S2.E1.m1.1.1.2.2.3.2.cmml">l</mi><mo id="S2.E1.m1.1.1.2.2.3.3" lspace="0.222em" xref="S2.E1.m1.1.1.2.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S2.E1.m1.1.1.2.1" xref="S2.E1.m1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E1.m1.1.1.2.3" xref="S2.E1.m1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.2.3.2.2" xref="S2.E1.m1.1.1.2.3.2.2.cmml">W</mi><mi id="S2.E1.m1.1.1.2.3.2.3" xref="S2.E1.m1.1.1.2.3.2.3.cmml">q</mi><mi id="S2.E1.m1.1.1.2.3.3" xref="S2.E1.m1.1.1.2.3.3.cmml">l</mi></msubsup><mo id="S2.E1.m1.1.1.2.1a" xref="S2.E1.m1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E1.m1.1.1.2.4" xref="S2.E1.m1.1.1.2.4.cmml"><mi id="S2.E1.m1.1.1.2.4.2.2" xref="S2.E1.m1.1.1.2.4.2.2.cmml">W</mi><mi id="S2.E1.m1.1.1.2.4.2.3" xref="S2.E1.m1.1.1.2.4.2.3.cmml">k</mi><mrow id="S2.E1.m1.1.1.2.4.3" xref="S2.E1.m1.1.1.2.4.3.cmml"><mi id="S2.E1.m1.1.1.2.4.3.2" xref="S2.E1.m1.1.1.2.4.3.2.cmml">l</mi><mo id="S2.E1.m1.1.1.2.4.3.3" lspace="0.222em" xref="S2.E1.m1.1.1.2.4.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S2.E1.m1.1.1.2.1b" xref="S2.E1.m1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E1.m1.1.1.2.5" xref="S2.E1.m1.1.1.2.5.cmml"><mi id="S2.E1.m1.1.1.2.5.2.2" xref="S2.E1.m1.1.1.2.5.2.2.cmml">𝐊</mi><mi id="S2.E1.m1.1.1.2.5.2.3" xref="S2.E1.m1.1.1.2.5.2.3.cmml">m</mi><mrow id="S2.E1.m1.1.1.2.5.3" xref="S2.E1.m1.1.1.2.5.3.cmml"><mi id="S2.E1.m1.1.1.2.5.3.2" xref="S2.E1.m1.1.1.2.5.3.2.cmml">l</mi><mo id="S2.E1.m1.1.1.2.5.3.3" lspace="0.222em" xref="S2.E1.m1.1.1.2.5.3.3.cmml">⊤</mo></mrow></msubsup></mrow><msqrt id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><msub id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml"><mi id="S2.E1.m1.1.1.3.2.2" xref="S2.E1.m1.1.1.3.2.2.cmml">d</mi><mi id="S2.E1.m1.1.1.3.2.3" xref="S2.E1.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac></mstyle><mo id="S2.E1.m1.1.2.3.3.2.2" xref="S2.E1.m1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.1.2.3.1a" xref="S2.E1.m1.1.2.3.1.cmml">⁢</mo><msubsup id="S2.E1.m1.1.2.3.4" xref="S2.E1.m1.1.2.3.4.cmml"><mi id="S2.E1.m1.1.2.3.4.2.2" xref="S2.E1.m1.1.2.3.4.2.2.cmml">𝐕</mi><mi id="S2.E1.m1.1.2.3.4.2.3" xref="S2.E1.m1.1.2.3.4.2.3.cmml">m</mi><mi id="S2.E1.m1.1.2.3.4.3" xref="S2.E1.m1.1.2.3.4.3.cmml">l</mi></msubsup><mo id="S2.E1.m1.1.2.3.1b" xref="S2.E1.m1.1.2.3.1.cmml">⁢</mo><msubsup id="S2.E1.m1.1.2.3.5" xref="S2.E1.m1.1.2.3.5.cmml"><mi id="S2.E1.m1.1.2.3.5.2.2" xref="S2.E1.m1.1.2.3.5.2.2.cmml">W</mi><mi id="S2.E1.m1.1.2.3.5.2.3" xref="S2.E1.m1.1.2.3.5.2.3.cmml">v</mi><mi id="S2.E1.m1.1.2.3.5.3" xref="S2.E1.m1.1.2.3.5.3.cmml">l</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.2.cmml" xref="S2.E1.m1.1.2"><eq id="S2.E1.m1.1.2.1.cmml" xref="S2.E1.m1.1.2.1"></eq><apply id="S2.E1.m1.1.2.2.cmml" xref="S2.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.2.1.cmml" xref="S2.E1.m1.1.2.2">superscript</csymbol><apply id="S2.E1.m1.1.2.2.2.cmml" xref="S2.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.2.2.2.2">𝐨</ci><ci id="S2.E1.m1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.2.2.2.3">𝑚</ci></apply><apply id="S2.E1.m1.1.2.2.3.cmml" xref="S2.E1.m1.1.2.2.3"><csymbol cd="latexml" id="S2.E1.m1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.2.2.3">limit-from</csymbol><ci id="S2.E1.m1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.2.2.3.2">𝑙</ci><csymbol cd="latexml" id="S2.E1.m1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.2.2.3.3">top</csymbol></apply></apply><apply id="S2.E1.m1.1.2.3.cmml" xref="S2.E1.m1.1.2.3"><times id="S2.E1.m1.1.2.3.1.cmml" xref="S2.E1.m1.1.2.3.1"></times><ci id="S2.E1.m1.1.2.3.2.cmml" xref="S2.E1.m1.1.2.3.2">softmax</ci><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.2.3.3.2"><divide id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.2.3.3.2"></divide><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"><times id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.2.1"></times><apply id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.2.2">superscript</csymbol><apply id="S2.E1.m1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.2.2.2.2">𝐪</ci><ci id="S2.E1.m1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.2.2.2.3">𝑚</ci></apply><apply id="S2.E1.m1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.2.2.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.1.2.2.3">limit-from</csymbol><ci id="S2.E1.m1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.1.2.2.3.2">𝑙</ci><csymbol cd="latexml" id="S2.E1.m1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.1.2.2.3.3">top</csymbol></apply></apply><apply id="S2.E1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.3">superscript</csymbol><apply id="S2.E1.m1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.3.2.1.cmml" xref="S2.E1.m1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.2.3.2.2.cmml" xref="S2.E1.m1.1.1.2.3.2.2">𝑊</ci><ci id="S2.E1.m1.1.1.2.3.2.3.cmml" xref="S2.E1.m1.1.1.2.3.2.3">𝑞</ci></apply><ci id="S2.E1.m1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.3.3">𝑙</ci></apply><apply id="S2.E1.m1.1.1.2.4.cmml" xref="S2.E1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.4.1.cmml" xref="S2.E1.m1.1.1.2.4">superscript</csymbol><apply id="S2.E1.m1.1.1.2.4.2.cmml" xref="S2.E1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.4.2.1.cmml" xref="S2.E1.m1.1.1.2.4">subscript</csymbol><ci id="S2.E1.m1.1.1.2.4.2.2.cmml" xref="S2.E1.m1.1.1.2.4.2.2">𝑊</ci><ci id="S2.E1.m1.1.1.2.4.2.3.cmml" xref="S2.E1.m1.1.1.2.4.2.3">𝑘</ci></apply><apply id="S2.E1.m1.1.1.2.4.3.cmml" xref="S2.E1.m1.1.1.2.4.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.2.4.3.1.cmml" xref="S2.E1.m1.1.1.2.4.3">limit-from</csymbol><ci id="S2.E1.m1.1.1.2.4.3.2.cmml" xref="S2.E1.m1.1.1.2.4.3.2">𝑙</ci><csymbol cd="latexml" id="S2.E1.m1.1.1.2.4.3.3.cmml" xref="S2.E1.m1.1.1.2.4.3.3">top</csymbol></apply></apply><apply id="S2.E1.m1.1.1.2.5.cmml" xref="S2.E1.m1.1.1.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.5.1.cmml" xref="S2.E1.m1.1.1.2.5">superscript</csymbol><apply id="S2.E1.m1.1.1.2.5.2.cmml" xref="S2.E1.m1.1.1.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.5.2.1.cmml" xref="S2.E1.m1.1.1.2.5">subscript</csymbol><ci id="S2.E1.m1.1.1.2.5.2.2.cmml" xref="S2.E1.m1.1.1.2.5.2.2">𝐊</ci><ci id="S2.E1.m1.1.1.2.5.2.3.cmml" xref="S2.E1.m1.1.1.2.5.2.3">𝑚</ci></apply><apply id="S2.E1.m1.1.1.2.5.3.cmml" xref="S2.E1.m1.1.1.2.5.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.2.5.3.1.cmml" xref="S2.E1.m1.1.1.2.5.3">limit-from</csymbol><ci id="S2.E1.m1.1.1.2.5.3.2.cmml" xref="S2.E1.m1.1.1.2.5.3.2">𝑙</ci><csymbol cd="latexml" id="S2.E1.m1.1.1.2.5.3.3.cmml" xref="S2.E1.m1.1.1.2.5.3.3">top</csymbol></apply></apply></apply><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><root id="S2.E1.m1.1.1.3a.cmml" xref="S2.E1.m1.1.1.3"></root><apply id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2">𝑑</ci><ci id="S2.E1.m1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply><apply id="S2.E1.m1.1.2.3.4.cmml" xref="S2.E1.m1.1.2.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.3.4.1.cmml" xref="S2.E1.m1.1.2.3.4">superscript</csymbol><apply id="S2.E1.m1.1.2.3.4.2.cmml" xref="S2.E1.m1.1.2.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.3.4.2.1.cmml" xref="S2.E1.m1.1.2.3.4">subscript</csymbol><ci id="S2.E1.m1.1.2.3.4.2.2.cmml" xref="S2.E1.m1.1.2.3.4.2.2">𝐕</ci><ci id="S2.E1.m1.1.2.3.4.2.3.cmml" xref="S2.E1.m1.1.2.3.4.2.3">𝑚</ci></apply><ci id="S2.E1.m1.1.2.3.4.3.cmml" xref="S2.E1.m1.1.2.3.4.3">𝑙</ci></apply><apply id="S2.E1.m1.1.2.3.5.cmml" xref="S2.E1.m1.1.2.3.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.3.5.1.cmml" xref="S2.E1.m1.1.2.3.5">superscript</csymbol><apply id="S2.E1.m1.1.2.3.5.2.cmml" xref="S2.E1.m1.1.2.3.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.3.5.2.1.cmml" xref="S2.E1.m1.1.2.3.5">subscript</csymbol><ci id="S2.E1.m1.1.2.3.5.2.2.cmml" xref="S2.E1.m1.1.2.3.5.2.2">𝑊</ci><ci id="S2.E1.m1.1.2.3.5.2.3.cmml" xref="S2.E1.m1.1.2.3.5.2.3">𝑣</ci></apply><ci id="S2.E1.m1.1.2.3.5.3.cmml" xref="S2.E1.m1.1.2.3.5.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\mathbf{o}_{m}^{l\top}=\mathrm{softmax}\left(\frac{\mathbf{q}_{m}%
^{l\top}W_{q}^{l}W_{k}^{l\top}\mathbf{K}_{m}^{l\top}}{\sqrt{d_{k}}}\right)%
\mathbf{V}_{m}^{l}W_{v}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">bold_o start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l ⊤ end_POSTSUPERSCRIPT = roman_softmax ( divide start_ARG bold_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l ⊤ end_POSTSUPERSCRIPT bold_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) bold_V start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.12">where <math alttext="W_{q}^{l},W_{k}^{l},W_{v}^{l}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.6.m1.3"><semantics id="S2.SS0.SSS0.Px1.p1.6.m1.3a"><mrow id="S2.SS0.SSS0.Px1.p1.6.m1.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.4.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.3.cmml">q</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.4" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.4.cmml">,</mo><msubsup id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.3.cmml">k</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.5" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.4.cmml">,</mo><msubsup id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.3.cmml">v</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.4" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.4.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.2" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.2.cmml">d</mi><mi id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.3" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m1.3b"><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3"><in id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.4"></in><list id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3"><apply id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.2.2.2.2.2.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.2.3">𝑣</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.3.3.3.3">𝑙</ci></apply></list><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.2">ℝ</ci><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3"><times id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.2">𝑑</ci><apply id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m1.3.3.5.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m1.3c">W_{q}^{l},W_{k}^{l},W_{v}^{l}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.6.m1.3d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable weight matrices, <math alttext="d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.7.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.7.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.7.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.7.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.7.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.7.m2.1d">italic_d</annotation></semantics></math> is the model dimension and <math alttext="d_{k}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.8.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.8.m3.1a"><msub id="S2.SS0.SSS0.Px1.p1.8.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.2.cmml">d</mi><mi id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.8.m3.1b"><apply id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.8.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.8.m3.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.8.m3.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the inner dimension and <math alttext="\mathbf{K}_{m}^{l}=[\mathbf{k}_{1}^{l},\cdots,\mathbf{k}_{m}^{l}]^{\top}\in%
\mathbb{R}^{m\times d},\mathbf{V}_{m}^{l}=[\mathbf{v}_{1}^{l},\cdots,\mathbf{v%
}_{m}^{l}]^{\top}\in\mathbb{R}^{m\times d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.9.m4.4"><semantics id="S2.SS0.SSS0.Px1.p1.9.m4.4a"><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.2.cmml">𝐊</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.5" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.5.cmml">=</mo><msup id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml"><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml">[</mo><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.2.cmml">𝐤</mi><mn id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.9.m4.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.9.m4.1.1.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.5" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.2.cmml">𝐤</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.6" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml">]</mo></mrow><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.4.cmml">⊤</mo></msup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.6" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.6.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.3a.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.2.cmml">𝐕</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.5" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.5.cmml">=</mo><msup id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml"><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml">[</mo><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.2.cmml">𝐯</mi><mn id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.3.cmml">1</mn><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.9.m4.2.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.9.m4.2.2.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.5" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml">,</mo><msubsup id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.2.cmml">𝐯</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.6" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml">]</mo></mrow><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.4" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.4.cmml">⊤</mo></msup><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.6" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.6.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.2" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.3" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.3.cmml">d</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.9.m4.4b"><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.3a.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.3">formulae-sequence</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1"><and id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1a.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1"></and><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1b.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1"><eq id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.5.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.5"></eq><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.2">𝐊</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.4.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2">superscript</csymbol><list id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2"><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.2">𝐤</ci><cn id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.1.1">⋯</ci><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.2">𝐤</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.2.2.2.3">𝑙</ci></apply></list><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.4.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.4">top</csymbol></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1c.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1"><in id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.6.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.6"></in><share href="https://arxiv.org/html/2405.20192v2#S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.2.cmml" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1d.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1"></share><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.2">ℝ</ci><apply id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3"><times id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.3.3.1.1.7.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2"><and id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2a.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2"></and><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2b.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2"><eq id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.5"></eq><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.2">𝐕</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.4.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2">superscript</csymbol><list id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2"><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.2">𝐯</ci><cn id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.2.3">1</cn></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.1.1.1.1.3">𝑙</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.2.2">⋯</ci><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.2">𝐯</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.2.2.2.3">𝑙</ci></apply></list><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.4">top</csymbol></apply></apply><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2c.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2"><in id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.6.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.6"></in><share href="https://arxiv.org/html/2405.20192v2#S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.2.cmml" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2d.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2"></share><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.2">ℝ</ci><apply id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3"><times id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m4.4.4.2.2.7.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.9.m4.4c">\mathbf{K}_{m}^{l}=[\mathbf{k}_{1}^{l},\cdots,\mathbf{k}_{m}^{l}]^{\top}\in%
\mathbb{R}^{m\times d},\mathbf{V}_{m}^{l}=[\mathbf{v}_{1}^{l},\cdots,\mathbf{v%
}_{m}^{l}]^{\top}\in\mathbb{R}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.9.m4.4d">bold_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = [ bold_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , ⋯ , bold_k start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT , bold_V start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = [ bold_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , ⋯ , bold_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and we use the single-head notation for simplicity.
Finally, another projection matrix <math alttext="W_{o}^{l}\in\mathbb{R}^{d\times d_{k}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.10.m5.1"><semantics id="S2.SS0.SSS0.Px1.p1.10.m5.1a"><mrow id="S2.SS0.SSS0.Px1.p1.10.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.3.cmml">o</mi><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.2" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.3" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.10.m5.1b"><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1"><in id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.1"></in><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.2.3">𝑜</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.2.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.2">ℝ</ci><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3"><times id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.2">𝑑</ci><apply id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m5.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.10.m5.1c">W_{o}^{l}\in\mathbb{R}^{d\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.10.m5.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is used to project <math alttext="\mathbf{o}_{m}^{l}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.11.m6.1"><semantics id="S2.SS0.SSS0.Px1.p1.11.m6.1a"><msubsup id="S2.SS0.SSS0.Px1.p1.11.m6.1.1" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.2.cmml">𝐨</mi><mi id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.3" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.11.m6.1b"><apply id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.2">𝐨</ci><ci id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.11.m6.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.11.m6.1c">\mathbf{o}_{m}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.11.m6.1d">bold_o start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> back to token space <math alttext="\mathbf{x}_{m}^{l}=W_{o}^{l}\mathbf{o}_{m}^{l}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.12.m7.1"><semantics id="S2.SS0.SSS0.Px1.p1.12.m7.1a"><mrow id="S2.SS0.SSS0.Px1.p1.12.m7.1.1" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.2.cmml">𝐱</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.1" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.cmml"><msubsup id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.3.cmml">o</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.1.cmml">⁢</mo><msubsup id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.2.cmml">𝐨</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.3.cmml">m</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.3.cmml">l</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.12.m7.1b"><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1"><eq id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.2">𝐱</ci><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.2.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3"><times id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.1"></times><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.2.3">𝑜</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.2.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.2">𝐨</ci><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.2.3">𝑚</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m7.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.12.m7.1c">\mathbf{x}_{m}^{l}=W_{o}^{l}\mathbf{o}_{m}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.12.m7.1d">bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT bold_o start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>.
Self-attention with rotary position embedding is more effective for computing contextual mappings <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib84" title=""><span class="ltx_text" style="font-size:90%;">84</span></a>]</cite> in arbitrary sequences, particularly in long contexts <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib61" title=""><span class="ltx_text" style="font-size:90%;">61</span></a>]</cite>. It incorporates an induction-head mechanism that enables the Transformer architecture to predict co-occurring tokens within a given sequence <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite> from an in-context perspective. Meanwhile, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Wu et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib75" title=""><span class="ltx_text" style="font-size:90%;">75</span></a>]</cite> systematically demonstrate that self-attention significantly enhances its instruction-following capability through fine-tuning. Knowledge tokens that do not appear in the context are stored as global tokens in the FFN memory <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Feed-forward network (FFN)</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.6">In modern transformer architectures, the SiLU <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib55" title=""><span class="ltx_text" style="font-size:90%;">55</span></a>]</cite> gating linear unit <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib58" title=""><span class="ltx_text" style="font-size:90%;">58</span></a>]</cite> is adopted by various models <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib65" title=""><span class="ltx_text" style="font-size:90%;">65</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">66</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>.
It is formulated as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx3">
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{x}_{m}^{l}=W_{d}^{l}(\mathrm{SiLU}(W_{g}^{l}\mathbf{x}_{m%
}^{l})\odot W_{u}^{l}\mathbf{x}_{m}^{l})" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml">m</mi><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">l</mi></msubsup><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.3.2.2.cmml">W</mi><mi id="S2.E2.m1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.3.2.3.cmml">d</mi><mi id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml">SiLU</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">g</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">m</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml">u</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.1.1.3.2.3.cmml">m</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝐱</ci><ci id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3">𝑚</ci></apply><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑙</ci></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.3.2.2">𝑊</ci><ci id="S2.E2.m1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.3.2.3">𝑑</ci></apply><ci id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3">𝑙</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3">SiLU</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑔</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐱</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.2.3">𝑢</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2.2">𝐱</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{x}_{m}^{l}=W_{d}^{l}(\mathrm{SiLU}(W_{g}^{l}\mathbf{x}_{m%
}^{l})\odot W_{u}^{l}\mathbf{x}_{m}^{l})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_W start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ( roman_SiLU ( italic_W start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ⊙ italic_W start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.5">where <math alttext="W_{g}^{l},W_{u}^{l}\in\mathbb{R}^{d^{\prime}\times d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.2"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.2a"><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.cmml"><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml"><msubsup id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml">g</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">,</mo><msubsup id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.cmml">u</mi><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml">l</mi></msubsup></mrow><mo id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml">∈</mo><msup id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.cmml"><msup id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.2" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.3.cmml">′</mo></msup><mo id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.3" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.2b"><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2"><in id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.3"></in><list id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2"><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3">𝑢</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3">𝑙</ci></apply></list><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.2">ℝ</ci><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3"><times id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.1"></times><apply id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.2">𝑑</ci><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.2.3">′</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.2c">W_{g}^{l},W_{u}^{l}\in\mathbb{R}^{d^{\prime}\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.2d">italic_W start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{d}^{l}\in\mathbb{R}^{d\times d^{\prime}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.2.cmml">W</mi><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.3.cmml">d</mi><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml">×</mo><msup id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.2" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.3" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.3.cmml">′</mo></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1"><in id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.1"></in><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2">superscript</csymbol><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.2">𝑊</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.3">𝑑</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.2.3">𝑙</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3"><times id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.1"></times><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.2">𝑑</ci><apply id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">W_{d}^{l}\in\mathbb{R}^{d\times d^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.3.m3.1a"><msup id="S2.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑑</ci><ci id="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m3.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.3.m3.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden dimension. <math alttext="\odot" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px2.p1.4.m4.1a"><mo id="S2.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m4.1b"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m4.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m4.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.4.m4.1d">⊙</annotation></semantics></math> is the element-wise multiplication and <math alttext="\mathrm{SiLU}(x)=x\odot\mathrm{sigmoid}(x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.5.m5.2"><semantics id="S2.SS0.SSS0.Px2.p1.5.m5.2a"><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.cmml"><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.2.cmml">SiLU</mi><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.1" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.3.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.cmml"><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">x</mi><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.1" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml"><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.1.cmml">⊙</mo><mi id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.3" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.3.cmml">sigmoid</mi></mrow><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.1" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.3.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml"><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml">(</mo><mi id="S2.SS0.SSS0.Px2.p1.5.m5.2.2" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.5.m5.2b"><apply id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3"><eq id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.1"></eq><apply id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2"><times id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.1"></times><ci id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.2.2">SiLU</ci><ci id="S2.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.1.1">𝑥</ci></apply><apply id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3"><times id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.1"></times><apply id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2"><csymbol cd="latexml" id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.1">direct-product</csymbol><ci id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.2">𝑥</ci><ci id="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.3.3.2.3">sigmoid</ci></apply><ci id="S2.SS0.SSS0.Px2.p1.5.m5.2.2.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m5.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.5.m5.2c">\mathrm{SiLU}(x)=x\odot\mathrm{sigmoid}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.5.m5.2d">roman_SiLU ( italic_x ) = italic_x ⊙ roman_sigmoid ( italic_x )</annotation></semantics></math>.
The feed-forward network uses inverse-bottleneck parameterization methods, which inherently enlarges the representation space and eases the encoding of diverse knowledge from different tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">40</span></a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Finetuning towards tasks</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.3">During fine-tuning in task-related data, natural practices format data as <span class="ltx_text ltx_font_typewriter" id="S2.SS0.SSS0.Px3.p1.3.1">{instruction,(input),output}</span> pairs: <math alttext="(I,x^{t},y^{t})" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.1.m1.3"><semantics id="S2.SS0.SSS0.Px3.p1.1.m1.3a"><mrow id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml"><mo id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml">(</mo><mi id="S2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">I</mi><mo id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.4" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml">,</mo><msup id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.2" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.2.cmml">x</mi><mi id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.3" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.3.cmml">t</mi></msup><mo id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.5" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml">,</mo><msup id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.2" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.2.cmml">y</mi><mi id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.3" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.3.cmml">t</mi></msup><mo id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.6" stretchy="false" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.1.m1.3b"><vector id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2"><ci id="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1">𝐼</ci><apply id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.2">𝑥</ci><ci id="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.2.2.1.1.3">𝑡</ci></apply><apply id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.2">𝑦</ci><ci id="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.3.3.2.2.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.1.m1.3c">(I,x^{t},y^{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.1.m1.3d">( italic_I , italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math> where <math alttext="t\in\{1,2,\cdots,N\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.2.m2.4"><semantics id="S2.SS0.SSS0.Px3.p1.2.m2.4a"><mrow id="S2.SS0.SSS0.Px3.p1.2.m2.4.5" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.2" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.2.cmml">t</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.1" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml"><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml">{</mo><mn id="S2.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">1</mn><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2.2" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S2.SS0.SSS0.Px3.p1.2.m2.2.2" xref="S2.SS0.SSS0.Px3.p1.2.m2.2.2.cmml">2</mn><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2.3" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m2.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px3.p1.2.m2.3.3.cmml">⋯</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2.4" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m2.4.4" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.4.cmml">N</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2.5" stretchy="false" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.2.m2.4b"><apply id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5"><in id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.1"></in><ci id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.2">𝑡</ci><set id="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.5.3.2"><cn id="S2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px3.p1.2.m2.1.1">1</cn><cn id="S2.SS0.SSS0.Px3.p1.2.m2.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px3.p1.2.m2.2.2">2</cn><ci id="S2.SS0.SSS0.Px3.p1.2.m2.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.3.3">⋯</ci><ci id="S2.SS0.SSS0.Px3.p1.2.m2.4.4.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m2.4.4">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.2.m2.4c">t\in\{1,2,\cdots,N\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.2.m2.4d">italic_t ∈ { 1 , 2 , ⋯ , italic_N }</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px3.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.3.m3.1d">italic_N</annotation></semantics></math> is the dataset size.
In a causal LLM architecture, the learning objective is to minimize the task distribution with the LLM’s internal distribution, via a negative log-likelihood manner:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\boldsymbol{\theta}}=-\frac{1}{N}\sum_{t=1}^{N}\sum_{i=1}^{T}\log
p%
_{\boldsymbol{\theta}}(y_{i}^{t}|y_{&lt;i}^{t},x^{t},I)" class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><msub id="S2.E3.m1.2.2.3" xref="S2.E3.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.3.2" xref="S2.E3.m1.2.2.3.2.cmml">ℒ</mi><mi id="S2.E3.m1.2.2.3.3" xref="S2.E3.m1.2.2.3.3.cmml">𝜽</mi></msub><mo id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml">=</mo><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.cmml"><mo id="S2.E3.m1.2.2.1a" xref="S2.E3.m1.2.2.1.cmml">−</mo><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mfrac id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml"><mn id="S2.E3.m1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.3.2.cmml">1</mn><mi id="S2.E3.m1.2.2.1.1.3.3" xref="S2.E3.m1.2.2.1.1.3.3.cmml">N</mi></mfrac><mo id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><munderover id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S2.E3.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.2.2.3.2" xref="S2.E3.m1.2.2.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.1.1.1.2.2.3.1" xref="S2.E3.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.1.1.1.2.2.3.3" xref="S2.E3.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.2.2.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.cmml"><munderover id="S2.E3.m1.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E3.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.3.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.3.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml">y</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msubsup><mo fence="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><msubsup id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml"></mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">&lt;</mo><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msup><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">I</mi></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"></eq><apply id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.3.1.cmml" xref="S2.E3.m1.2.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.3.2.cmml" xref="S2.E3.m1.2.2.3.2">ℒ</ci><ci id="S2.E3.m1.2.2.3.3.cmml" xref="S2.E3.m1.2.2.3.3">𝜽</ci></apply><apply id="S2.E3.m1.2.2.1.cmml" xref="S2.E3.m1.2.2.1"><minus id="S2.E3.m1.2.2.1.2.cmml" xref="S2.E3.m1.2.2.1"></minus><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1"><times id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"><divide id="S2.E3.m1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.3"></divide><cn id="S2.E3.m1.2.2.1.1.3.2.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.3.2">1</cn><ci id="S2.E3.m1.2.2.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.3.3">𝑁</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><apply id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.2.2.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2.3"><eq id="S2.E3.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><apply id="S2.E3.m1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E3.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E3.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3"><log id="S2.E3.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3.1"></log><apply id="S2.E3.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.2">𝑦</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3"><lt id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></lt><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2">absent</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝐼</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathcal{L}_{\boldsymbol{\theta}}=-\frac{1}{N}\sum_{t=1}^{N}\sum_{i=1}^{T}\log
p%
_{\boldsymbol{\theta}}(y_{i}^{t}|y_{&lt;i}^{t},x^{t},I)</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">caligraphic_L start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_y start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.8">where <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.4.m1.1"><semantics id="S2.SS0.SSS0.Px3.p1.4.m1.1a"><mi id="S2.SS0.SSS0.Px3.p1.4.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.4.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.4.m1.1b"><ci id="S2.SS0.SSS0.Px3.p1.4.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.4.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.4.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.4.m1.1d">italic_T</annotation></semantics></math> is the output sequence length.
This objective prompts <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.5.m2.1"><semantics id="S2.SS0.SSS0.Px3.p1.5.m2.1a"><mi id="S2.SS0.SSS0.Px3.p1.5.m2.1.1" xref="S2.SS0.SSS0.Px3.p1.5.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.5.m2.1b"><ci id="S2.SS0.SSS0.Px3.p1.5.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.5.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.5.m2.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.5.m2.1d">bold_italic_θ</annotation></semantics></math> to converge when the generated response <math alttext="\hat{y}^{t}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.6.m3.1"><semantics id="S2.SS0.SSS0.Px3.p1.6.m3.1a"><msup id="S2.SS0.SSS0.Px3.p1.6.m3.1.1" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.cmml"><mover accent="true" id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.2" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.2.cmml">y</mi><mo id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.1" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.3" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.6.m3.1b"><apply id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2"><ci id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.1">^</ci><ci id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.2.2">𝑦</ci></apply><ci id="S2.SS0.SSS0.Px3.p1.6.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.6.m3.1c">\hat{y}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.6.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> matches <math alttext="y^{t}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.7.m4.1"><semantics id="S2.SS0.SSS0.Px3.p1.7.m4.1a"><msup id="S2.SS0.SSS0.Px3.p1.7.m4.1.1" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.2" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1.2.cmml">y</mi><mi id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.3" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.7.m4.1b"><apply id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1.2">𝑦</ci><ci id="S2.SS0.SSS0.Px3.p1.7.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.7.m4.1c">y^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.7.m4.1d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e., the internal distribution of <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.8.m5.1"><semantics id="S2.SS0.SSS0.Px3.p1.8.m5.1a"><mi id="S2.SS0.SSS0.Px3.p1.8.m5.1.1" xref="S2.SS0.SSS0.Px3.p1.8.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.8.m5.1b"><ci id="S2.SS0.SSS0.Px3.p1.8.m5.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.8.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.8.m5.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.8.m5.1d">bold_italic_θ</annotation></semantics></math> aligns with the fine-tuning dataset.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">TAIA</span>: <span class="ltx_text ltx_font_bold" id="S3.2.2">T</span>raining <span class="ltx_text ltx_font_bold" id="S3.3.3">A</span>ll Parameters but <span class="ltx_text ltx_font_bold" id="S3.4.4">I</span>nferring with Only <span class="ltx_text ltx_font_bold" id="S3.5.5">A</span>ttention</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Motivation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Fine-tuning LLMs for downstream tasks typically requires a substantial amount of high-quality conversational data. While a large volume of high-quality synthetic data generated by GPT-4 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">45</span></a>]</cite> is publicly available and useful for general domains like Math Word Problems and programming, real-world applications of LLMs are diverse <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> and complex <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>. This diversity renders public datasets insufficient for many scenarios.
Synthetic data, although useful, is costly and often exhibits distribution shifts towards the parent LLM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib67" title=""><span class="ltx_text" style="font-size:90%;">67</span></a>]</cite>. Consequently, the data distribution achieved through fine-tuning often diverges from that required for specific tasks. The scarcity of natural task-specific data and the suboptimal quality of synthetic data present significant challenges for the effective transfer of LLMs to specific tasks.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">To address these issues and reduce LLMs’ dependency on specialized data, we aim to enable LLMs to perform proficiently on specific tasks using OOD data.
Given that the self-attention and feed-forward network (FFN) modules within LLMs function differently, we re-evaluate their respective roles during supervised fine-tuning.
Our study indicates that OOD fine-tuning introduces noisy parametric knowledge into the FFN memory. Therefore, filtering out noisy parameters while retaining beneficial ones is crucial for generalization (§<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.SS2" title="3.2 Parameter Selection for Out-of-Distribution (OOD) SFT ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3.2</span></a>). Through systematic analysis and empirical validation, we demonstrate that the optimal parameter selection strategy is achieved by <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.1.1">TAIA</span>, which involves training all parameters but retaining only attention updates (§<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.SS3" title="3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Parameter Selection for Out-of-Distribution (OOD) SFT</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Prior research has demonstrated that LLMs possess a wide range of task knowledge <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib50" title=""><span class="ltx_text" style="font-size:90%;">50</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib56" title=""><span class="ltx_text" style="font-size:90%;">56</span></a>]</cite> after semi-supervised learning on web data. To enhance their proficiency in specific tasks, domain-related instruction-tuning <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib85" title=""><span class="ltx_text" style="font-size:90%;">85</span></a>]</cite> is utilized to improve the knowledge access process <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib71" title=""><span class="ltx_text" style="font-size:90%;">71</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">46</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib59" title=""><span class="ltx_text" style="font-size:90%;">59</span></a>]</cite>.
Moreover, studies <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib75" title=""><span class="ltx_text" style="font-size:90%;">75</span></a>]</cite> have shown that self-attention improves LLMs ability to follow instructions through fine-tuning, which aids in effective knowledge elicitation. However, when trained on OOD data, the optimization objective (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S2.E3" title="In Finetuning towards tasks ‣ 2 Preliminaries ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>) involves significant distribution shifts in certain parameter groups. This can disrupt the pre-trained knowledge encoded through the Transformer’s feed-forward network (FFN) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite>.
Therefore, a balanced approach is to disregard the parameters that are noisily disrupted, while preserving the parameters that contribute to held-out tasks. This approach is already endorsed by existing research <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib80" title=""><span class="ltx_text" style="font-size:90%;">80</span></a>]</cite>.
Since fine-tuning prioritizes effective instruction following over absorbing potentially misleading knowledge, it can be inferred that the knowledge acquired by the FFNs during fine-tuning could be considered somewhat redundant.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Towards Optimal Parameter Selection Strategy</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Based on the above analysis, a subsequent action is to directly fine-tune only the parameters of the self-attention modules and freeze the FFN ones, which we call TOA (<span class="ltx_text ltx_ulem_uline" id="S3.SS3.p1.1.1">T</span>rain <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p1.1.2">O</span>nly <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p1.1.3">A</span>ttention Parameters).</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="248" id="S3.F3.g1" src="x5.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.4.2" style="font-size:90%;">Performance of TOA and <span class="ltx_text ltx_font_smallcaps" id="S3.F3.4.2.1">TAIA</span> with the layer-wise FFN LoRA. All models are equipped with attention LoRA at each layer and fine-tuned on a corpus mixture with 50% OOD data.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">A similar practice to TOA is parameter-efficient fine-tuning (PEFT), as they both only train partial parameters. PEFT has achieved a trade-off between performance and training efficiency due to the superfluity of parameters in LLMs <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib80" title=""><span class="ltx_text" style="font-size:90%;">80</span></a>]</cite>. We anticipate that TOA could yield results comparable to those obtained by training all parameters, as it essentially represents a form of the PEFT method and has been verified in vision tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib79" title=""><span class="ltx_text" style="font-size:90%;">79</span></a>]</cite>.
However, as shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S2.E1" title="In Self-attention module ‣ 2 Preliminaries ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1</span></a>, there are few non-linear operations during the attention computation, which inhibits TOA from learning complex representations of the training data. Without sufficient representation exploration, TOA suffers from unlearning of general features via OOD data, despite circumventing catastrophic forgetting problems.
We conduct experiments (details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5.SS6" title="E.6 Layer-wise FFN Fine-tuning Experiments ‣ Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">E.6</span></a>) to validate the inferiority of TOA in learning general instruction-following ability and show the results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.F3" title="Figure 3 ‣ 3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>. With FFN modules participating in gradient descents, the performance on the downstream task increases with the proper selection of FFN modules, even if the introduction of FFN modules disrupts pretrained memory. However, TOA still lags far behind the base model, indicating its inability to extract non-intervention features from OOD data.
To maintain the advantage of the non-linearity of FFN modules on the update of self-attention modules, we adopt another approach: we add all parameters into the optimizer group. In contrast to the vanilla method, we only maintain the updated self-attention part and reuse the pretrained weights for FFN modules after fine-tuning, which we name <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p2.1.1">T</span>raining <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p2.1.2">A</span>ll parameters but <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p2.1.3">I</span>nferring with only <span class="ltx_text ltx_ulem_uline" id="S3.SS3.p2.1.4">A</span>ttention (<span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.5">TAIA</span>).
<span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.1.6">TAIA</span> guarantees that self-attention can leverage the gradient descent process to optimize its parameters with redundant FFN fine-tuning parameters. The removal of updated FFN parameters during inference, on the other hand, ensures the integrity of parameterized knowledge stored in original FFN modules and the well-learning of beneficial knowledge from OOD data, as supported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.F3" title="Figure 3 ‣ 3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Implementation of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.1.1">TAIA</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.8">During training, the parameters of FFN and self-attention are updated based on max-likelihood modeling:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\theta}_{ffn}^{\prime},{\theta}_{attn}^{\prime}=\arg\max_{\{\theta\}}\sum_{i=%
1}^{N}p(\boldsymbol{y}_{i}|\boldsymbol{X}_{i},{\theta}_{ffn},{\theta}_{attn})" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.3.cmml"><msubsup id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.2.2.cmml">θ</mi><mrow id="S3.E4.m1.2.2.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2.3.2" xref="S3.E4.m1.2.2.1.1.1.2.3.2.cmml">f</mi><mo id="S3.E4.m1.2.2.1.1.1.2.3.1" xref="S3.E4.m1.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.1.2.3.3" xref="S3.E4.m1.2.2.1.1.1.2.3.3.cmml">f</mi><mo id="S3.E4.m1.2.2.1.1.1.2.3.1a" xref="S3.E4.m1.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.1.2.3.4" xref="S3.E4.m1.2.2.1.1.1.2.3.4.cmml">n</mi></mrow><mo id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.3.3.2.2.3" xref="S3.E4.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.E4.m1.3.3.2.2.2" xref="S3.E4.m1.3.3.2.2.2.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.3.3.2.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.3.2" xref="S3.E4.m1.3.3.2.2.2.2.3.2.cmml">a</mi><mo id="S3.E4.m1.3.3.2.2.2.2.3.1" xref="S3.E4.m1.3.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.2.3.3" xref="S3.E4.m1.3.3.2.2.2.2.3.3.cmml">t</mi><mo id="S3.E4.m1.3.3.2.2.2.2.3.1a" xref="S3.E4.m1.3.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.2.3.4" xref="S3.E4.m1.3.3.2.2.2.2.3.4.cmml">t</mi><mo id="S3.E4.m1.3.3.2.2.2.2.3.1b" xref="S3.E4.m1.3.3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.2.3.5" xref="S3.E4.m1.3.3.2.2.2.2.3.5.cmml">n</mi></mrow><mo id="S3.E4.m1.3.3.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml">=</mo><mrow id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mrow id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3.cmml"><mi id="S3.E4.m1.4.4.3.3.1" xref="S3.E4.m1.4.4.3.3.1.cmml">arg</mi><mo id="S3.E4.m1.4.4.3.3a" lspace="0.167em" xref="S3.E4.m1.4.4.3.3.cmml">⁡</mo><munder id="S3.E4.m1.4.4.3.3.2" xref="S3.E4.m1.4.4.3.3.2.cmml"><mi id="S3.E4.m1.4.4.3.3.2.2" xref="S3.E4.m1.4.4.3.3.2.2.cmml">max</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.1.1.2.cmml">{</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">θ</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.1.1.2.cmml">}</mo></mrow></munder></mrow><mo id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.3.1" xref="S3.E4.m1.4.4.3.1.cmml"><munderover id="S3.E4.m1.4.4.3.1.2" xref="S3.E4.m1.4.4.3.1.2.cmml"><mo id="S3.E4.m1.4.4.3.1.2.2.2" movablelimits="false" xref="S3.E4.m1.4.4.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.3.1.2.2.3" xref="S3.E4.m1.4.4.3.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.3.1.2.2.3.2" xref="S3.E4.m1.4.4.3.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.4.4.3.1.2.2.3.1" xref="S3.E4.m1.4.4.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.3.1.2.2.3.3" xref="S3.E4.m1.4.4.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.4.4.3.1.2.3" xref="S3.E4.m1.4.4.3.1.2.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.4.4.3.1.1" xref="S3.E4.m1.4.4.3.1.1.cmml"><mi id="S3.E4.m1.4.4.3.1.1.3" xref="S3.E4.m1.4.4.3.1.1.3.cmml">p</mi><mo id="S3.E4.m1.4.4.3.1.1.2" xref="S3.E4.m1.4.4.3.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.3.1.1.1.1" xref="S3.E4.m1.4.4.3.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.3.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.3.1.1.1.1.1" xref="S3.E4.m1.4.4.3.1.1.1.1.1.cmml"><msub id="S3.E4.m1.4.4.3.1.1.1.1.1.5" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.5.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5.2.cmml">𝒚</mi><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.5.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5.3.cmml">i</mi></msub><mo fence="false" id="S3.E4.m1.4.4.3.1.1.1.1.1.4" xref="S3.E4.m1.4.4.3.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.4.cmml"><msub id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.4" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.2.cmml">f</mi><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.3.cmml">f</mi><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1a" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.4" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.5" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mrow id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.2" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.2.cmml">a</mi><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.3" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.3.cmml">t</mi><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1a" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.4" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.4.cmml">t</mi><mo id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1b" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.5" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.5.cmml">n</mi></mrow></msub></mrow></mrow><mo id="S3.E4.m1.4.4.3.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"></eq><list id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.2"><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2.2">𝜃</ci><apply id="S3.E4.m1.2.2.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.2.3"><times id="S3.E4.m1.2.2.1.1.1.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2.3.2">𝑓</ci><ci id="S3.E4.m1.2.2.1.1.1.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.2.3.3">𝑓</ci><ci id="S3.E4.m1.2.2.1.1.1.2.3.4.cmml" xref="S3.E4.m1.2.2.1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">′</ci></apply><apply id="S3.E4.m1.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.E4.m1.3.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2">𝜃</ci><apply id="S3.E4.m1.3.3.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3"><times id="S3.E4.m1.3.3.2.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3.1"></times><ci id="S3.E4.m1.3.3.2.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3.2">𝑎</ci><ci id="S3.E4.m1.3.3.2.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3.3">𝑡</ci><ci id="S3.E4.m1.3.3.2.2.2.2.3.4.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3.4">𝑡</ci><ci id="S3.E4.m1.3.3.2.2.2.2.3.5.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3.5">𝑛</ci></apply></apply><ci id="S3.E4.m1.3.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.3">′</ci></apply></list><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><times id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3.2"></times><apply id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3"><arg id="S3.E4.m1.4.4.3.3.1.cmml" xref="S3.E4.m1.4.4.3.3.1"></arg><apply id="S3.E4.m1.4.4.3.3.2.cmml" xref="S3.E4.m1.4.4.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.2.1.cmml" xref="S3.E4.m1.4.4.3.3.2">subscript</csymbol><max id="S3.E4.m1.4.4.3.3.2.2.cmml" xref="S3.E4.m1.4.4.3.3.2.2"></max><set id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝜃</ci></set></apply></apply><apply id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3.1"><apply id="S3.E4.m1.4.4.3.1.2.cmml" xref="S3.E4.m1.4.4.3.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.2.1.cmml" xref="S3.E4.m1.4.4.3.1.2">superscript</csymbol><apply id="S3.E4.m1.4.4.3.1.2.2.cmml" xref="S3.E4.m1.4.4.3.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.2.2.1.cmml" xref="S3.E4.m1.4.4.3.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.3.1.2.2.2.cmml" xref="S3.E4.m1.4.4.3.1.2.2.2"></sum><apply id="S3.E4.m1.4.4.3.1.2.2.3.cmml" xref="S3.E4.m1.4.4.3.1.2.2.3"><eq id="S3.E4.m1.4.4.3.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.3.1.2.2.3.1"></eq><ci id="S3.E4.m1.4.4.3.1.2.2.3.2.cmml" xref="S3.E4.m1.4.4.3.1.2.2.3.2">𝑖</ci><cn id="S3.E4.m1.4.4.3.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.4.4.3.1.2.3.cmml" xref="S3.E4.m1.4.4.3.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.4.4.3.1.1.cmml" xref="S3.E4.m1.4.4.3.1.1"><times id="S3.E4.m1.4.4.3.1.1.2.cmml" xref="S3.E4.m1.4.4.3.1.1.2"></times><ci id="S3.E4.m1.4.4.3.1.1.3.cmml" xref="S3.E4.m1.4.4.3.1.1.3">𝑝</ci><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.3.1.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.5.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.1.1.1.1.5.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.5.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5.2">𝒚</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.5.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.5.3">𝑖</ci></apply><list id="S3.E4.m1.4.4.3.1.1.1.1.1.3.4.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3"><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.2">𝑿</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3"><times id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.2">𝑓</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.3">𝑓</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.2.2.2.3.4">𝑛</ci></apply></apply><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3"><times id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.2">𝑎</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.3">𝑡</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.4">𝑡</ci><ci id="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.5.cmml" xref="S3.E4.m1.4.4.3.1.1.1.1.1.3.3.3.3.5">𝑛</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">{\theta}_{ffn}^{\prime},{\theta}_{attn}^{\prime}=\arg\max_{\{\theta\}}\sum_{i=%
1}^{N}p(\boldsymbol{y}_{i}|\boldsymbol{X}_{i},{\theta}_{ffn},{\theta}_{attn})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">italic_θ start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_θ start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT { italic_θ } end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_p ( bold_italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.3">where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_N</annotation></semantics></math> is the number of training samples and <math alttext="\boldsymbol{X}_{i},\boldsymbol{y}_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.2"><semantics id="S3.SS4.p1.2.m2.2a"><mrow id="S3.SS4.p1.2.m2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.3.cmml"><msub id="S3.SS4.p1.2.m2.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.1.1.2" xref="S3.SS4.p1.2.m2.1.1.1.1.2.cmml">𝑿</mi><mi id="S3.SS4.p1.2.m2.1.1.1.1.3" xref="S3.SS4.p1.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.2.m2.2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.2.m2.2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.2.cmml"><mi id="S3.SS4.p1.2.m2.2.2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.2.2.cmml">𝒚</mi><mi id="S3.SS4.p1.2.m2.2.2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.2b"><list id="S3.SS4.p1.2.m2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.2"><apply id="S3.SS4.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.2">𝑿</ci><ci id="S3.SS4.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS4.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.2">𝒚</ci><ci id="S3.SS4.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.2c">\boldsymbol{X}_{i},\boldsymbol{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.2d">bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are query and response sequences sampled from any conversational data, like Alpaca-GPT4 or CoT-Collection, respectively. <math alttext="{\theta}^{\prime}_{(\cdot)}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msubsup id="S3.SS4.p1.3.m3.1.2" xref="S3.SS4.p1.3.m3.1.2.cmml"><mi id="S3.SS4.p1.3.m3.1.2.2.2" xref="S3.SS4.p1.3.m3.1.2.2.2.cmml">θ</mi><mrow id="S3.SS4.p1.3.m3.1.1.1.3" xref="S3.SS4.p1.3.m3.1.2.cmml"><mo id="S3.SS4.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.3.m3.1.2.cmml">(</mo><mo id="S3.SS4.p1.3.m3.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS4.p1.3.m3.1.1.1.1.cmml">⋅</mo><mo id="S3.SS4.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.3.m3.1.2.cmml">)</mo></mrow><mo id="S3.SS4.p1.3.m3.1.2.2.3" xref="S3.SS4.p1.3.m3.1.2.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.2.cmml" xref="S3.SS4.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2">subscript</csymbol><apply id="S3.SS4.p1.3.m3.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.2.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.2.2.2.cmml" xref="S3.SS4.p1.3.m3.1.2.2.2">𝜃</ci><ci id="S3.SS4.p1.3.m3.1.2.2.3.cmml" xref="S3.SS4.p1.3.m3.1.2.2.3">′</ci></apply><ci id="S3.SS4.p1.3.m3.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">{\theta}^{\prime}_{(\cdot)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( ⋅ ) end_POSTSUBSCRIPT</annotation></semantics></math> is the updated weight in full fine-tuning or the merged weight of LoRA tuning. After training, TAIA only utilizes the updated attention parameters and reuses the pre-trained FFN parameters to perform inference:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{y}=\arg\max_{\boldsymbol{y}}\sum_{j=1}^{K}\log p(y_{j}|\boldsymbol%
{y}_{j-1},\boldsymbol{X},{\theta}_{ffn},{\theta}_{attn}^{\prime})" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mi id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml">𝒚</mi><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><mrow id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.1" xref="S3.E5.m1.2.2.1.3.1.cmml">arg</mi><mo id="S3.E5.m1.2.2.1.3a" lspace="0.167em" xref="S3.E5.m1.2.2.1.3.cmml">⁡</mo><munder id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.3.2.2" xref="S3.E5.m1.2.2.1.3.2.2.cmml">max</mi><mi id="S3.E5.m1.2.2.1.3.2.3" xref="S3.E5.m1.2.2.1.3.2.3.cmml">𝒚</mi></munder></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><munderover id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.2.2.2" movablelimits="false" xref="S3.E5.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.3.2" xref="S3.E5.m1.2.2.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E5.m1.2.2.1.1.2.2.3.1" xref="S3.E5.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.2.1.1.2.2.3.3" xref="S3.E5.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.2.1.1.2.3" xref="S3.E5.m1.2.2.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.3.1.cmml">log</mi><mo id="S3.E5.m1.2.2.1.1.1.3a" lspace="0.167em" xref="S3.E5.m1.2.2.1.1.1.3.cmml">⁡</mo><mi id="S3.E5.m1.2.2.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.3.2.cmml">p</mi></mrow><mo id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.5.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.2.cmml">y</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.5.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.3.cmml">j</mi></msub><mo fence="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.4.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝑿</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">f</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">f</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.6" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.2.cmml">θ</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.2.cmml">a</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.3.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.4.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1b" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.5.cmml">n</mi></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><ci id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3">𝒚</ci><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><times id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></times><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><arg id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3.1"></arg><apply id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.3.2">subscript</csymbol><max id="S3.E5.m1.2.2.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2"></max><ci id="S3.E5.m1.2.2.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.3.2.3">𝒚</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><apply id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2">subscript</csymbol><sum id="S3.E5.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2"></sum><apply id="S3.E5.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3"><eq id="S3.E5.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.2">𝑗</ci><cn id="S3.E5.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.2.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.3">𝐾</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3"><log id="S3.E5.m1.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.1"></log><ci id="S3.E5.m1.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2">𝑝</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.5.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.5.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.2">𝑦</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.5.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.3">𝑗</ci></apply><list id="S3.E5.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝒚</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑗</ci><cn id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑿</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.2">𝑓</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.3">𝑓</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.2.2.3.4">𝑛</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.2">𝜃</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.2">𝑎</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.3">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.4">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.5.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.2.3.5">𝑛</ci></apply></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.3.3">′</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\boldsymbol{y}=\arg\max_{\boldsymbol{y}}\sum_{j=1}^{K}\log p(y_{j}|\boldsymbol%
{y}_{j-1},\boldsymbol{X},{\theta}_{ffn},{\theta}_{attn}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">bold_italic_y = roman_arg roman_max start_POSTSUBSCRIPT bold_italic_y end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_log italic_p ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | bold_italic_y start_POSTSUBSCRIPT italic_j - 1 end_POSTSUBSCRIPT , bold_italic_X , italic_θ start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.7">where <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m1.1"><semantics id="S3.SS4.p1.4.m1.1a"><mi id="S3.SS4.p1.4.m1.1.1" xref="S3.SS4.p1.4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m1.1b"><ci id="S3.SS4.p1.4.m1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m1.1d">italic_K</annotation></semantics></math> is the generated sequence length and <math alttext="\boldsymbol{X}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m2.1"><semantics id="S3.SS4.p1.5.m2.1a"><mi id="S3.SS4.p1.5.m2.1.1" xref="S3.SS4.p1.5.m2.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m2.1b"><ci id="S3.SS4.p1.5.m2.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m2.1c">\boldsymbol{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m2.1d">bold_italic_X</annotation></semantics></math> is the query input to LLMs that shares different distributions with the training data. In this scenario, <math alttext="{\theta}_{ffn}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m3.1"><semantics id="S3.SS4.p1.6.m3.1a"><msub id="S3.SS4.p1.6.m3.1.1" xref="S3.SS4.p1.6.m3.1.1.cmml"><mi id="S3.SS4.p1.6.m3.1.1.2" xref="S3.SS4.p1.6.m3.1.1.2.cmml">θ</mi><mrow id="S3.SS4.p1.6.m3.1.1.3" xref="S3.SS4.p1.6.m3.1.1.3.cmml"><mi id="S3.SS4.p1.6.m3.1.1.3.2" xref="S3.SS4.p1.6.m3.1.1.3.2.cmml">f</mi><mo id="S3.SS4.p1.6.m3.1.1.3.1" xref="S3.SS4.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.6.m3.1.1.3.3" xref="S3.SS4.p1.6.m3.1.1.3.3.cmml">f</mi><mo id="S3.SS4.p1.6.m3.1.1.3.1a" xref="S3.SS4.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.6.m3.1.1.3.4" xref="S3.SS4.p1.6.m3.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m3.1b"><apply id="S3.SS4.p1.6.m3.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m3.1.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m3.1.1.2.cmml" xref="S3.SS4.p1.6.m3.1.1.2">𝜃</ci><apply id="S3.SS4.p1.6.m3.1.1.3.cmml" xref="S3.SS4.p1.6.m3.1.1.3"><times id="S3.SS4.p1.6.m3.1.1.3.1.cmml" xref="S3.SS4.p1.6.m3.1.1.3.1"></times><ci id="S3.SS4.p1.6.m3.1.1.3.2.cmml" xref="S3.SS4.p1.6.m3.1.1.3.2">𝑓</ci><ci id="S3.SS4.p1.6.m3.1.1.3.3.cmml" xref="S3.SS4.p1.6.m3.1.1.3.3">𝑓</ci><ci id="S3.SS4.p1.6.m3.1.1.3.4.cmml" xref="S3.SS4.p1.6.m3.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m3.1c">{\theta}_{ffn}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m3.1d">italic_θ start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is the original parameter of FFN in pre-trained models and <math alttext="{\theta}_{attn}^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m4.1"><semantics id="S3.SS4.p1.7.m4.1a"><msubsup id="S3.SS4.p1.7.m4.1.1" xref="S3.SS4.p1.7.m4.1.1.cmml"><mi id="S3.SS4.p1.7.m4.1.1.2.2" xref="S3.SS4.p1.7.m4.1.1.2.2.cmml">θ</mi><mrow id="S3.SS4.p1.7.m4.1.1.2.3" xref="S3.SS4.p1.7.m4.1.1.2.3.cmml"><mi id="S3.SS4.p1.7.m4.1.1.2.3.2" xref="S3.SS4.p1.7.m4.1.1.2.3.2.cmml">a</mi><mo id="S3.SS4.p1.7.m4.1.1.2.3.1" xref="S3.SS4.p1.7.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m4.1.1.2.3.3" xref="S3.SS4.p1.7.m4.1.1.2.3.3.cmml">t</mi><mo id="S3.SS4.p1.7.m4.1.1.2.3.1a" xref="S3.SS4.p1.7.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m4.1.1.2.3.4" xref="S3.SS4.p1.7.m4.1.1.2.3.4.cmml">t</mi><mo id="S3.SS4.p1.7.m4.1.1.2.3.1b" xref="S3.SS4.p1.7.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS4.p1.7.m4.1.1.2.3.5" xref="S3.SS4.p1.7.m4.1.1.2.3.5.cmml">n</mi></mrow><mo id="S3.SS4.p1.7.m4.1.1.3" xref="S3.SS4.p1.7.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m4.1b"><apply id="S3.SS4.p1.7.m4.1.1.cmml" xref="S3.SS4.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m4.1.1.1.cmml" xref="S3.SS4.p1.7.m4.1.1">superscript</csymbol><apply id="S3.SS4.p1.7.m4.1.1.2.cmml" xref="S3.SS4.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m4.1.1.2.1.cmml" xref="S3.SS4.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m4.1.1.2.2.cmml" xref="S3.SS4.p1.7.m4.1.1.2.2">𝜃</ci><apply id="S3.SS4.p1.7.m4.1.1.2.3.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3"><times id="S3.SS4.p1.7.m4.1.1.2.3.1.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3.1"></times><ci id="S3.SS4.p1.7.m4.1.1.2.3.2.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3.2">𝑎</ci><ci id="S3.SS4.p1.7.m4.1.1.2.3.3.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3.3">𝑡</ci><ci id="S3.SS4.p1.7.m4.1.1.2.3.4.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3.4">𝑡</ci><ci id="S3.SS4.p1.7.m4.1.1.2.3.5.cmml" xref="S3.SS4.p1.7.m4.1.1.2.3.5">𝑛</ci></apply></apply><ci id="S3.SS4.p1.7.m4.1.1.3.cmml" xref="S3.SS4.p1.7.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m4.1c">{\theta}_{attn}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m4.1d">italic_θ start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the updated parameter groups of self-attention in full fine-tuning (or merged weight of self-attention in LoRA tuning).</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.5.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.6.2" style="font-size:90%;">Validation experiments using two training corpus and four seed backbones across seven test sets. “CQA.” refers to CommonsenseQA and “MMB.” refers to the English subset of MMedbench benchmark. “FT Method” denotes the fine-tuning method, which is either LoRA or MoLoRA. <span class="ltx_text ltx_font_bold" id="S3.T1.6.2.1">Bold</span> indicates the optimal result in each subgroup and <span class="ltx_text ltx_ulem_uline" id="S3.T1.6.2.2">underline</span> indicates the suboptimal result. The <span class="ltx_text ltx_font_smallcaps" id="S3.T1.6.2.3" style="background-color:#E6E6E6;">TAIA</span> setting achieves optimal fine-tuning results in most cases.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.7" style="width:433.6pt;height:498.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-80.8pt,92.9pt) scale(0.72839784293893,0.72839784293893) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.7.1">
<tr class="ltx_tr" id="S3.T1.7.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" id="S3.T1.7.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.1.1.1"><span class="ltx_text" id="S3.T1.7.1.1.1.1.1"></span><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.1.2"> <span class="ltx_text" id="S3.T1.7.1.1.1.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.7.1.1.1.1.2.1.1">
<span class="ltx_tr" id="S3.T1.7.1.1.1.1.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.1.1.1.2.1.1.1.1">Training</span></span>
<span class="ltx_tr" id="S3.T1.7.1.1.1.1.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.1.1.1.2.1.1.2.1">Dataset</span></span>
</span></span> <span class="ltx_text" id="S3.T1.7.1.1.1.1.2.2"></span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" id="S3.T1.7.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.2.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" id="S3.T1.7.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.3.1">FT Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" id="S3.T1.7.1.1.4" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.4.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" colspan="5" id="S3.T1.7.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.5.1">Reasoning</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" colspan="2" id="S3.T1.7.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.6.1">Knowledge</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" id="S3.T1.7.1.1.7" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.7.1">Avg.</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.2">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.1.1">MATH</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.2.1">BBH</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.2.3"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.3.1">CQA.</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.2.4"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.4.1">LogiQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.2.5"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.5.1">SVAMP</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.2.6"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.6.1">MMB.</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.2.7"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.7.1">MMLU</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.3">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.3.1.1">Base Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.2">Qwen1.5-1.8B</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.3">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.3.4">–</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.5">4.28</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.6">16.80</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.7">58.39</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.8">32.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.3.9">24.80</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.10">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.3.11">43.62</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.3.12">30.58</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.4">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.1">Qwen1.5-7B</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.4.3">–</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4">20.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.5">30.76</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.6">78.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.7">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.4.8">54.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.9">45.09</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.4.10">57.69</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.11">47.11</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.5">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.1">LLaMA2-7B</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.5.3">–</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.4">8.22</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5">26.36</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.6">48.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.7">33.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.5.8">44.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.9">32.21</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.5.10">42.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.11">33.71</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.6">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.1">LLaMA3-8B</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.6.3">–</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.4">27.92</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.5">29.58</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6">73.71</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.7">41.47</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.6.8">83.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.9">60.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.6.10">59.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.11">53.76</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.7">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.1" rowspan="16"><span class="ltx_text" id="S3.T1.7.1.7.1.1"><span class="ltx_text" id="S3.T1.7.1.7.1.1.1"></span> <span class="ltx_text" id="S3.T1.7.1.7.1.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.7.1.7.1.1.2.1">
<span class="ltx_tr" id="S3.T1.7.1.7.1.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.7.1.1.2.1.1.1">Alpaca-</span></span>
<span class="ltx_tr" id="S3.T1.7.1.7.1.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.7.1.1.2.1.2.1">GPT4</span></span>
</span></span> <span class="ltx_text" id="S3.T1.7.1.7.1.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.2" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.7.2.1">Qwen1.5-1.8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.3" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.7.3.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.7.4">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.5">8.02</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.6">28.80</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.7">60.44</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.8">35.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.7.9">22.10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.10">34.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.7.11">41.67</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.7.12">32.98</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.8.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.2.1" style="background-color:#E6E6E6;">10.82</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.3.1" style="background-color:#E6E6E6;">30.03</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.4.1" style="background-color:#E6E6E6;">64.29</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.5.1" style="background-color:#E6E6E6;">33.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.8.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.6.1" style="background-color:#E6E6E6;">29.90</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.7.1" style="background-color:#E6E6E6;">34.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.8.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.8.8.1" style="background-color:#E6E6E6;">43.73</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.8.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.8.9.1" style="background-color:#E6E6E6;">35.21</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.9">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.9.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.9.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.3">8.44</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.4">23.67</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.5">60.69</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.6">32.72</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.9.7">25.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.8">34.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.9.9">42.58</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.9.10">32.52</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.10.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.2.1" style="background-color:#E6E6E6;">10.20</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.3.1" style="background-color:#E6E6E6;">27.71</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.4.1" style="background-color:#E6E6E6;">63.47</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.5.1" style="background-color:#E6E6E6;">32.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.10.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.6.1" style="background-color:#E6E6E6;">31.10</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.7.1" style="background-color:#E6E6E6;">34.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.10.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.10.8.1" style="background-color:#E6E6E6;">43.48</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.10.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.10.9.1" style="background-color:#E6E6E6;">34.74</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.11.1.1">Qwen1.5-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.11.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.11.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.4">17.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.5">36.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.6">77.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.7">37.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.11.8">57.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.9">44.85</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.11.10">54.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.11.11">46.50</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.12.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.2.1" style="background-color:#E6E6E6;">24.98</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.3.1" style="background-color:#E6E6E6;">43.46</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.4.1" style="background-color:#E6E6E6;">77.31</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.5.1" style="background-color:#E6E6E6;">41.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.12.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.6.1" style="background-color:#E6E6E6;">67.20</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.7.1" style="background-color:#E6E6E6;">46.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.12.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.12.8.1" style="background-color:#E6E6E6;">57.29</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.12.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.12.9.1" style="background-color:#E6E6E6;">51.27</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.13">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.13.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.13.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.3">16.12</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.4">35.05</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.5">76.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.6">38.71</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.13.7">56.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.8">45.56</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.13.9">55.03</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.13.10">46.31</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.14.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.2.1" style="background-color:#E6E6E6;">25.04</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.3.1" style="background-color:#E6E6E6;">42.54</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.4.1" style="background-color:#E6E6E6;">77.56</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.5.1" style="background-color:#E6E6E6;">41.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.14.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.6.1" style="background-color:#E6E6E6;">65.60</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.7.1" style="background-color:#E6E6E6;">46.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.14.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.14.8.1" style="background-color:#E6E6E6;">57.15</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.14.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.14.9.1" style="background-color:#E6E6E6;">50.92</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.15">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.15.1.1">LLama2-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.15.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.15.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.4">7.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.5">33.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.6">63.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.7">35.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.15.8">43.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.9">38.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.15.10">43.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.15.11">37.80</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.16">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.16.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.2.1" style="background-color:#E6E6E6;">8.02</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.3.1" style="background-color:#E6E6E6;">31.47</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.4.1" style="background-color:#E6E6E6;">63.06</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.5.1" style="background-color:#E6E6E6;">34.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.16.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.6.1" style="background-color:#E6E6E6;">57.08</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.7.1" style="background-color:#E6E6E6;">38.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.16.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.16.8.1" style="background-color:#E6E6E6;">41.91</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.16.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.16.9.1" style="background-color:#E6E6E6;">39.13</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.17">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.17.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.17.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.3">7.42</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.4">32.64</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.5">64.95</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.6">34.41</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.17.7">45.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.8">37.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.17.9">41.18</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.17.10">37.60</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.18.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.2.1" style="background-color:#E6E6E6;">8.82</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.3.1" style="background-color:#E6E6E6;">30.93</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.4.1" style="background-color:#E6E6E6;">63.80</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.5.1" style="background-color:#E6E6E6;">34.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.18.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.6.1" style="background-color:#E6E6E6;">51.80</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.7.1" style="background-color:#E6E6E6;">36.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.18.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.18.8.1" style="background-color:#E6E6E6;">41.21</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.18.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.18.9.1" style="background-color:#E6E6E6;">38.17</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.19">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.19.1.1">LLama3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.19.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.19.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.4">25.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.5">37.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.6">75.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.7">37.63</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.19.8">69.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.9">57.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.19.10">60.84</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.19.11">51.99</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.20">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.20.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.2.1" style="background-color:#E6E6E6;">28.34</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.3.1" style="background-color:#E6E6E6;">31.30</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.4.1" style="background-color:#E6E6E6;">75.92</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.5.1" style="background-color:#E6E6E6;">40.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.20.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.6.1" style="background-color:#E6E6E6;">85.10</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.7.1" style="background-color:#E6E6E6;">58.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.20.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.20.8.1" style="background-color:#E6E6E6;">61.87</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.20.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.20.9.1" style="background-color:#E6E6E6;">54.54</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.21">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.21.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.21.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.3">25.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.4">35.85</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.5">77.15</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.6">39.63</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.21.7">71.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.8">57.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.21.9">61.78</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.21.10">52.71</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.22">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.22.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.2.1" style="background-color:#E6E6E6;">28.16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.3.1" style="background-color:#E6E6E6;">29.10</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.4.1" style="background-color:#E6E6E6;">77.48</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.5.1" style="background-color:#E6E6E6;">40.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.22.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.6.1" style="background-color:#E6E6E6;">84.90</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.7.1" style="background-color:#E6E6E6;">59.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.22.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.22.8.1" style="background-color:#E6E6E6;">61.42</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.22.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.22.9.1" style="background-color:#E6E6E6;">54.32</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.23">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_tt" id="S3.T1.7.1.23.1" rowspan="16"><span class="ltx_text" id="S3.T1.7.1.23.1.1"><span class="ltx_text" id="S3.T1.7.1.23.1.1.1"></span> <span class="ltx_text" id="S3.T1.7.1.23.1.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.7.1.23.1.1.2.1">
<span class="ltx_tr" id="S3.T1.7.1.23.1.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.23.1.1.2.1.1.1">CoT-</span></span>
<span class="ltx_tr" id="S3.T1.7.1.23.1.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.1.23.1.1.2.1.2.1">Collection</span></span>
</span></span> <span class="ltx_text" id="S3.T1.7.1.23.1.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.2" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.23.2.1">Qwen1.5-1.8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.3" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.23.3.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.23.4">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.5">7.68</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.6">13.90</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.7">58.07</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.8">21.97</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.23.9">39.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.10">27.65</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.7.1.23.11">25.51</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.7.1.23.12">27.68</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.24">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.24.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.2.1" style="background-color:#E6E6E6;">9.64</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.3.1" style="background-color:#E6E6E6;">21.93</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.4.1" style="background-color:#E6E6E6;">67.32</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.5.1" style="background-color:#E6E6E6;">32.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.24.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.6.1" style="background-color:#E6E6E6;">40.30</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.7.1" style="background-color:#E6E6E6;">34.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.24.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.24.8.1" style="background-color:#E6E6E6;">42.39</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.24.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.24.9.1" style="background-color:#E6E6E6;">35.54</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.25">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.25.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.25.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.3">7.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.4">12.99</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.5">58.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.6">22.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.25.7">38.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.8">27.42</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.25.9">23.88</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.25.10">27.37</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.26">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.26.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.2.1" style="background-color:#E6E6E6;">9.08</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.3.1" style="background-color:#E6E6E6;">22.49</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.4.1" style="background-color:#E6E6E6;">67.73</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.5.1" style="background-color:#E6E6E6;">34.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.26.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.6.1" style="background-color:#E6E6E6;">44.80</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.7.1" style="background-color:#E6E6E6;">36.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.26.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.26.8.1" style="background-color:#E6E6E6;">44.13</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.26.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.26.9.1" style="background-color:#E6E6E6;">37.07</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.27">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.27.1.1">Qwen1.5-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.27.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.27.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.4">13.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.5">24.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.6">72.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.7">21.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.27.8">53.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.9">27.49</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.27.10">25.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.27.11">33.91</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.28">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.28.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.2.1" style="background-color:#E6E6E6;">20.28</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.3.1" style="background-color:#E6E6E6;">32.54</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.4.1" style="background-color:#E6E6E6;">80.10</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.5.1" style="background-color:#E6E6E6;">41.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.28.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.6.1" style="background-color:#E6E6E6;">61.90</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.7.1" style="background-color:#E6E6E6;">46.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.28.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.28.8.1" style="background-color:#E6E6E6;">56.52</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.28.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.28.9.1" style="background-color:#E6E6E6;">48.57</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.29">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.29.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.29.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.3">13.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.4">22.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.5">75.59</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.6">22.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.29.7">52.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.8">27.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.29.9">25.37</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.29.10">34.26</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.30">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.30.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.2.1" style="background-color:#E6E6E6;">19.74</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.3.1" style="background-color:#E6E6E6;">30.96</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.4.1" style="background-color:#E6E6E6;">78.84</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.5.1" style="background-color:#E6E6E6;">41.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.30.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.6.1" style="background-color:#E6E6E6;">58.81</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.7.1" style="background-color:#E6E6E6;">46.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.30.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.30.8.1" style="background-color:#E6E6E6;">57.01</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.30.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.30.9.1" style="background-color:#E6E6E6;">47.62</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.31">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.31.1.1">LLama2-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.31.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.31.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.4">7.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.5">19.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.6">56.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.7">30.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.31.8">52.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.9">38.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.31.10">46.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.31.11">36.04</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.32">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.32.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.2.1" style="background-color:#E6E6E6;">8.44</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.3.1" style="background-color:#E6E6E6;">26.00</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.4.1" style="background-color:#E6E6E6;">60.77</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.5.1" style="background-color:#E6E6E6;">31.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.32.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.6.1" style="background-color:#E6E6E6;">58.33</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.7.1" style="background-color:#E6E6E6;">38.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.32.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.32.8.1" style="background-color:#E6E6E6;">42.54</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.32.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.32.9.1" style="background-color:#E6E6E6;">38.03</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.33">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.33.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.33.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.3">4.54</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.4">20.21</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.5">61.55</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.6">36.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.33.7">56.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.8">37.86</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.33.9">45.09</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.33.10">37.36</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.34">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.34.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.2.1" style="background-color:#E6E6E6;">8.04</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.3.1" style="background-color:#E6E6E6;">30.20</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.4.1" style="background-color:#E6E6E6;">63.49</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.5.1" style="background-color:#E6E6E6;">33.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.34.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.6.1" style="background-color:#E6E6E6;">55.40</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.7.1" style="background-color:#E6E6E6;">37.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.34.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.34.8.1" style="background-color:#E6E6E6;">45.34</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.34.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.34.9.1" style="background-color:#E6E6E6;">39.05</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.35">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_t" id="S3.T1.7.1.35.1" rowspan="4"><span class="ltx_text" id="S3.T1.7.1.35.1.1">LLama3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.2" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.35.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.35.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.4">16.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.5">23.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.6">67.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.7">27.19</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.35.8">78.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.9">55.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.1.35.10">60.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.35.11">47.00</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.36">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.36.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.2.1" style="background-color:#E6E6E6;">26.28</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.3.1" style="background-color:#E6E6E6;">18.86</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.4.1" style="background-color:#E6E6E6;">71.25</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.5.1" style="background-color:#E6E6E6;">41.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.36.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.6.1" style="background-color:#E6E6E6;">82.80</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.7.1" style="background-color:#E6E6E6;">58.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.36.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.36.8.1" style="background-color:#E6E6E6;">63.16</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.36.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_ulem_uline" id="S3.T1.7.1.36.9.1" style="background-color:#E6E6E6;">51.74</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.37">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.37.1" rowspan="2"><span class="ltx_text" id="S3.T1.7.1.37.1.1">MoLoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.37.2">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.3">17.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.4">22.24</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.5">71.74</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.6">28.27</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.37.7">79.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.8">58.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.1.37.9">60.07</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.37.10">48.25</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.38">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T1.7.1.38.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.2.1" style="background-color:#E6E6E6;">25.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.3.1" style="background-color:#E6E6E6;">28.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.4.1" style="background-color:#E6E6E6;">73.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.5.1" style="background-color:#E6E6E6;">40.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T1.7.1.38.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.6.1" style="background-color:#E6E6E6;">83.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.7.1" style="background-color:#E6E6E6;">60.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T1.7.1.38.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S3.T1.7.1.38.8.1" style="background-color:#E6E6E6;">61.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T1.7.1.38.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.38.9.1" style="background-color:#E6E6E6;">53.24</span></td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Backbone LLMs</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We select two LLM families, Qwen1.5 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> and LLaMA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib66" title=""><span class="ltx_text" style="font-size:90%;">66</span></a>]</cite> and delicately chose control groups to address the following three concerns: (1) Different Model Sizes within the Same LLM Family: We choose Qwen1.5-1.8B and Qwen1.5-7B to test within the same LLM family, how <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.1">TAIA</span> works for different sizes of LLMs with the same pretraining data;
(2) Same Model Size across Different LLM Families: We choose Qwen1.5-7B and LLaMA2-7B to test among different LLM families but the same size, whether <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.2">TAIA</span> still holds;
and (3) Impact of Enlarged Pretraining Data: We choose LLaMA2-7B and LLaMA3-8B to test whether <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.3">TAIA</span> is applicable when the LLM pretraining data is significantly enlarged.
We choose the chat version for all models.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment Details</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We choose two instruction tuning corpus to further demonstrate the high generalization of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.1">TAIA</span> under PEFT methods.
We choose Alpaca-GPT4-bilingual mixed from Alpaca-GPT4 and Alpaca-GPT4-zh <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite>.
Apart from this, we also adopt CoT-Collection <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite> which is a mixture of various tasks presented in the Chain-of-Thought <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib72" title=""><span class="ltx_text" style="font-size:90%;">72</span></a>]</cite> format.
We train 1 epoch for each dataset with the maximum context set to 3072 and the batch size set to 128.
We set the learning rate to <math alttext="2e-4" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">2</mn><mo id="S4.SS2.p1.1.m1.1.1.2.1" xref="S4.SS2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">−</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><minus id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></minus><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><times id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2.1"></times><cn id="S4.SS2.p1.1.m1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.2.2">2</cn><ci id="S4.SS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">2e-4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">2 italic_e - 4</annotation></semantics></math> for all runs and adopt LoRA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>]</cite> and Mixture-of-LoRA (MoLoRA)<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib76" title=""><span class="ltx_text" style="font-size:90%;">76</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite> as representative PEFT methods.
The LoRA rank is set to 16 and LoRA alpha is set to 32.
In MoLoRA, we set the expert count to 4 and activate 1 during inference for all settings.
All experiments were conducted on 4 NVIDIA A100 GPUs with ZeRO3 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib53" title=""><span class="ltx_text" style="font-size:90%;">53</span></a>]</cite> optimization. For the test set, we selected seven widely used datasets: two for evaluating models’ knowledge understanding and five for testing LLMs’ reasoning ability. A detailed description of these test sets can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5" title="Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Quantitative Analysis</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.T1" title="Table 1 ‣ 3.4 Implementation of TAIA ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1</span></a> presents a comprehensive comparison between various fine-tuning methods (vanilla, LoRA, MoLoRA, and our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.1">TAIA</span>) across different training datasets and model backbones.
The results clearly demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.2">TAIA</span> enhances the utilization of training data, consistently outperforming other methods across mentioned benchmarks.
For weaker LLMs like Qwen1.5-1.8B and LLaMA2-7B, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.3">TAIA</span> significantly amplifies the improvements achieved by standard fine-tuning. For stronger backbones such as Qwen1.5-7B and LLaMA3-8B, standard fine-tuning often degrades performance, but <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.4">TAIA</span> maintains and even enhances the original capabilities.
Notably, TAIA-fine-tuned LLaMA3-8B excels in SVAMP and MMB benchmarks, achieving top scores of 85.10 and 59.07, respectively, indicating its robustness in deep math comprehension and medical reasoning tasks.
Furthermore, in the MMLU benchmark, TAIA-fine-tuned models achieve superior average scores, confirming that <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.5">TAIA</span> not only protects pretrainpretrained knowledge from disturbance but also enables better knowledge utilization for reasoning. These findings underscore the superior efficacy of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.6">TAIA</span> in enhancing LLMs’ performance across diverse reasoning and knowledge domains.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.3.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.4.2" style="font-size:90%;">Comparison with other OOD generalization methods. <span class="ltx_text ltx_font_smallcaps" id="S4.T2.4.2.1">TAIA</span> is more robust and general than other competitive methods and requires no additional implementation efforts.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.5" style="width:433.6pt;height:239.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.3pt,6.3pt) scale(0.950282748519796,0.950282748519796) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.5.1">
<tr class="ltx_tr" id="S4.T2.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.5.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.2.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="S4.T2.5.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.3.1">Reasoning</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T2.5.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.4.1">Knowledge</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.1.1.5" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.1.5.1">Avg.</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.2">
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.1.1">MATH</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.2.2"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.2.1">BBH</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.2.3"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.3.1">CQA.</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.2.4"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.4.1">LogiQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.2.5"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.5.1">SVAMP</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.2.6"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.6.1">MMB.</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.2.7"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.2.7.1">MMLU</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.1">Base Model</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3">4.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.4">16.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.5">58.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.6">32.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.7">24.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.8">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.9">43.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.10">30.58</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.1" rowspan="5"><span class="ltx_text" id="S4.T2.5.1.4.1.1"><span class="ltx_text" id="S4.T2.5.1.4.1.1.1"></span> <span class="ltx_text" id="S4.T2.5.1.4.1.1.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.4.1.1.2.1">
<span class="ltx_tr" id="S4.T2.5.1.4.1.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.4.1.1.2.1.1.1">Alpaca-</span></span>
<span class="ltx_tr" id="S4.T2.5.1.4.1.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.4.1.1.2.1.2.1">GPT4</span></span>
</span></span> <span class="ltx_text" id="S4.T2.5.1.4.1.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.4.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.3">8.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.4">28.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.5">60.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.6">35.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.4.7">22.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.8">34.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.4.9">41.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.4.10">32.98</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.1">L2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.2">3.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.3">24.37</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.4">57.82</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.5.5.1">35.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.6">21.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.7">35.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.8">41.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.9">31.26</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.1">EWC</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.2">3.56</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.3">25.02</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.4">60.52</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.5">34.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.6">22.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.7">34.88</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.8">41.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.9">30.10</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.1">Self-Distill</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.2">7.34</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.3">26.29</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.4">53.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.5">28.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.6">18.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7">35.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.8">39.87</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.9">28.09</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.1">LoRACL</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.2">8.04</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.3">28.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.4">60.03</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.5">34.41</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.6">27.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.7"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.8.7.1">35.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.8">42.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.9">33.73</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.9">
<td class="ltx_td" id="S4.T2.5.1.9.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.1.9.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.3" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.3.1" style="background-color:#E6E6E6;">10.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.4.1" style="background-color:#E6E6E6;">30.03</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.5" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.5.1" style="background-color:#E6E6E6;">64.29</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.1.9.6.1" style="background-color:#E6E6E6;">33.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.7" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.7.1" style="background-color:#E6E6E6;">29.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.1.9.8.1" style="background-color:#E6E6E6;">34.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.9.1" style="background-color:#E6E6E6;">43.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.9.10.1" style="background-color:#E6E6E6;">35.21</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.10">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.5.1.10.1" rowspan="5"><span class="ltx_text" id="S4.T2.5.1.10.1.1"><span class="ltx_text" id="S4.T2.5.1.10.1.1.1"></span> <span class="ltx_text" id="S4.T2.5.1.10.1.1.2">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.5.1.10.1.1.2.1">
<span class="ltx_tr" id="S4.T2.5.1.10.1.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.10.1.1.2.1.1.1">CoT-</span></span>
<span class="ltx_tr" id="S4.T2.5.1.10.1.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.5.1.10.1.1.2.1.2.1">Collection</span></span>
</span></span> <span class="ltx_text" id="S4.T2.5.1.10.1.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.10.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.3">7.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.4">13.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.5">58.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.6">21.97</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.10.7">39.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.8">27.65</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.10.9">25.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.10.10">27.68</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.1">L2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.2">0.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.3">5.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.4">23.26</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.5">22.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.6">41.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.7">27.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.8">23.63</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.9">20.64</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.1">EWC</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.2">0.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.3">7.71</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.4">22.64</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.5">22.27</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.6">40.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.7">27.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.8">23.67</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.9">20.65</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.1">LoRACL</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.2">7.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.3">14.85</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.4">58.07</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.5">21.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.6"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.13.6.1">41.60</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.7">27.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.8">23.53</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.9">27.91</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.14">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.14.1" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.1.14.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.2" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.2.1" style="background-color:#E6E6E6;">9.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.3" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.3.1" style="background-color:#E6E6E6;">21.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.4.1" style="background-color:#E6E6E6;">67.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.5" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.5.1" style="background-color:#E6E6E6;">32.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.14.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T2.5.1.14.6.1" style="background-color:#E6E6E6;">40.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.7" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.7.1" style="background-color:#E6E6E6;">34.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.14.8" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.8.1" style="background-color:#E6E6E6;">42.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.14.9" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.14.9.1" style="background-color:#E6E6E6;">35.54</span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.5.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.6.2" style="font-size:90%;">Ablation experiments on different inference modes under two training corpus. We validate the performance of inference modes by considering both general tasks and domain tasks. <span class="ltx_text ltx_font_bold" id="S4.T3.6.2.1">Bold</span> indicates the optimal result in each subgroup and <span class="ltx_text ltx_ulem_uline" id="S4.T3.6.2.2">underline</span> indicates the suboptimal result. Note that even fine-tuned on out-of-domain data, <span class="ltx_text ltx_font_smallcaps" id="S4.T3.6.2.3">TAIA</span> still achieves optimal results on specific domain tasks and even surpasses the performance of the base model.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.7" style="width:433.6pt;height:185.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-56.1pt,24.1pt) scale(0.794295816475554,0.794295816475554) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1">
<tr class="ltx_tr" id="S4.T3.7.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.1.1">Training Data</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.2.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.3.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T3.7.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.4.1">Genereal Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T3.7.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.5.1">Domain Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.1.1.6" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.6.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.2">
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.1.1">CMMLU</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.2.2"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.2.1">MMLU</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.3.1">CEval</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.4.1">MMed ZH</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.2.5"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.5.1">MMed EN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.2.6"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.2.6.1">MATH</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.1">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.2">Qwen1.5-1.8B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.3.3">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.4">52.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.5">43.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.3.6">55.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.7">62.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.8">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.3.9">4.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.3.10">41.99</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.1" rowspan="5"><span class="ltx_text" id="S4.T3.7.1.4.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.4.1.1.1">
<span class="ltx_tr" id="S4.T3.7.1.4.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.4.1.1.1.1.1">Medical</span></span>
<span class="ltx_tr" id="S4.T3.7.1.4.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.4.1.1.1.2.1">Collection</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.2" rowspan="5"><span class="ltx_text" id="S4.T3.7.1.4.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.4.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.4">39.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.5">27.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.4.6">37.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.7">57.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.8">29.69</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.4.9">8.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.4.10">33.44</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.5.1" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_smallcaps" id="S4.T3.7.1.5.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.5.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.2.1" style="background-color:#E6E6E6;">54.58</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.5.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.3.1" style="background-color:#E6E6E6;">44.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.5.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.4.1" style="background-color:#E6E6E6;">55.57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.5.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.5.1" style="background-color:#E6E6E6;">64.97</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.5.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.6.1" style="background-color:#E6E6E6;">36.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.5.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.5.7.1" style="background-color:#E6E6E6;">10.20</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.5.8" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.5.8.1" style="background-color:#E6E6E6;">44.37</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.6.1">TAIF</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.6.2">47.06</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.6.3">42.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.6.4">45.62</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.6.5">58.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.6.6">32.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.6.7">9.06</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.6.8"><span class="ltx_text ltx_ulem_uline" id="S4.T3.7.1.6.8.1">39.10</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.7.1">TOA</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.7.2">43.37</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.7.3">29.21</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.7.4">39.90</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.7.5">59.54</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.7.6">30.79</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.7.7">7.90</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.7.8">35.12</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.8.1">TOF</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.8.2">41.18</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.8.3">26.64</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.8.4">39.82</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.8.5">58.17</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.8.6">29.22</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.8.7">8.14</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.8.8">33.86</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.7.1.9.1" rowspan="5"><span class="ltx_text" id="S4.T3.7.1.9.1.1">OpenMath</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.7.1.9.2" rowspan="5"><span class="ltx_text" id="S4.T3.7.1.9.2.1">LoRA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.9.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.9.4">54.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.9.5">39.36</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.9.6">50.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.9.7">58.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.9.8">33.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.1.9.9">7.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.1.9.10">40.55</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.10.1" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_smallcaps" id="S4.T3.7.1.10.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.10.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.2.1" style="background-color:#E6E6E6;">54.35</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.10.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.3.1" style="background-color:#E6E6E6;">43.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.10.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.4.1" style="background-color:#E6E6E6;">56.32</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.10.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.5.1" style="background-color:#E6E6E6;">63.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.10.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.6.1" style="background-color:#E6E6E6;">35.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.10.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S4.T3.7.1.10.7.1" style="background-color:#E6E6E6;">11.68</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.10.8" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.10.8.1" style="background-color:#E6E6E6;">44.33</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.11.1">TAIF</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.11.2">53.46</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.11.3">43.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.11.4">54.85</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.11.5">62.84</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.11.6">36.25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.11.7">7.64</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.11.8"><span class="ltx_text ltx_ulem_uline" id="S4.T3.7.1.11.8.1">43.09</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.12.1">TOA</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.12.2">53.37</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.12.3">33.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.12.4">50.22</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.12.5">57.88</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.12.6">30.56</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.1.12.7">7.50</td>
<td class="ltx_td ltx_align_center" id="S4.T3.7.1.12.8">38.88</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.13">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.1.13.1">TOF</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.7.1.13.2">52.95</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.7.1.13.3">37.46</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.1.13.4">48.37</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.7.1.13.5">55.34</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.7.1.13.6">31.66</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.1.13.7">7.48</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.7.1.13.8">38.88</td>
</tr>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Compare with Other OOD Generalization Methods</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">We mainly choose methods aimed for continual learning (CL) which also attempts to improve models with incoming OOD training data.
We select L2, EWC <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite>, Self-Distill <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib78" title=""><span class="ltx_text" style="font-size:90%;">78</span></a>]</cite> and LoRACL, which is a variant of AdapterCL <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">39</span></a>]</cite> as the competitors and the detailed settings of the experiment are discussed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5.SS7" title="E.7 Comparing with OOD Generalization Methods ‣ Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">E.7</span></a>
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.T2" title="Table 2 ‣ 4.3 Quantitative Analysis ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">2</span></a> shows that although CL-based methods can leverage OOD data for downstream tasks, they are ineffective in certain evaluation sets (e.g., L2 on MMedBench or LoRACL on CommonsenseQA).
It indicates that these methods have specific preferences for downstream tasks and cannot be perfectly applied to any arbitrary application.
In contrast, <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">TAIA</span> is not only implementation friendly but also generalizable enough for improving most downstream performances.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">We test three variants of <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.1">TAIA</span>, all designed to reduce distribution shifting after fine-tuning on OOD data: TOA, TOF, and TAIF. The latter two, TOF and TAIF, are similar to TOA and <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.2">TAIA</span> respectively, but with relevant parameters changed from self-attention to FFN. Experiments were conducted on the Qwen1.5-1.8B model using the same setting described in §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.SS2" title="4.2 Experiment Details ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a>. Results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.T3" title="Table 3 ‣ 4.3 Quantitative Analysis ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>. We observe that both <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.3">TAIA</span> and TAIF demonstrate better generalization properties compared to the vanilla method, with <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.4">TAIA</span> achieving the best. This again confirms the crucial role of self-attention in maintaining the generalization ability of LLMs. In contrast, TOF and TOA both suffer from inadequate parameter exploration and even perform worse than the baseline when tuned on OpenMath <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">64</span></a>]</cite>, further supporting the practice of retaining redundant parameters during training.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Representation Analysis</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.5">In §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.SS3" title="3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3.3</span></a>, we infer that <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.5.1">TAIA</span> can obtain more general hidden representations compared to the baseline and TOA.
We here examine the generalization of <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.5.2">TAIA</span> from a perspective of activation similarities.
We define the activation similarity of the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">italic_i</annotation></semantics></math>-th data sample between two models, <math alttext="\boldsymbol{\theta}_{p}" class="ltx_Math" display="inline" id="S4.SS6.p1.2.m2.1"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">𝜽</mi><mi id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">𝜽</ci><ci id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\boldsymbol{\theta}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">bold_italic_θ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\boldsymbol{\theta}_{q}" class="ltx_Math" display="inline" id="S4.SS6.p1.3.m3.1"><semantics id="S4.SS6.p1.3.m3.1a"><msub id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml">𝜽</mi><mi id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2">𝜽</ci><ci id="S4.SS6.p1.3.m3.1.1.3.cmml" xref="S4.SS6.p1.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">\boldsymbol{\theta}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.3.m3.1d">bold_italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, which are trained separately on two corpora <math alttext="D_{p}" class="ltx_Math" display="inline" id="S4.SS6.p1.4.m4.1"><semantics id="S4.SS6.p1.4.m4.1a"><msub id="S4.SS6.p1.4.m4.1.1" xref="S4.SS6.p1.4.m4.1.1.cmml"><mi id="S4.SS6.p1.4.m4.1.1.2" xref="S4.SS6.p1.4.m4.1.1.2.cmml">D</mi><mi id="S4.SS6.p1.4.m4.1.1.3" xref="S4.SS6.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m4.1b"><apply id="S4.SS6.p1.4.m4.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.4.m4.1.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS6.p1.4.m4.1.1.2.cmml" xref="S4.SS6.p1.4.m4.1.1.2">𝐷</ci><ci id="S4.SS6.p1.4.m4.1.1.3.cmml" xref="S4.SS6.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m4.1c">D_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.4.m4.1d">italic_D start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="D_{q}" class="ltx_Math" display="inline" id="S4.SS6.p1.5.m5.1"><semantics id="S4.SS6.p1.5.m5.1a"><msub id="S4.SS6.p1.5.m5.1.1" xref="S4.SS6.p1.5.m5.1.1.cmml"><mi id="S4.SS6.p1.5.m5.1.1.2" xref="S4.SS6.p1.5.m5.1.1.2.cmml">D</mi><mi id="S4.SS6.p1.5.m5.1.1.3" xref="S4.SS6.p1.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.5.m5.1b"><apply id="S4.SS6.p1.5.m5.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m5.1.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS6.p1.5.m5.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1.2">𝐷</ci><ci id="S4.SS6.p1.5.m5.1.1.3.cmml" xref="S4.SS6.p1.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.5.m5.1c">D_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> with different distributions, as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx4">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Sim}(\mathbf{h}_{p},\mathbf{h}_{q})_{i}=\frac{1}{L}\sum_{%
l=1}^{L}\frac{\mathbf{h}_{pi}^{l\top}\mathbf{h}_{qi}^{l}}{\|\mathbf{h}_{pi}^{l%
}\|\cdot\|\mathbf{h}_{qi}^{l}\|}" class="ltx_Math" display="inline" id="S4.E6.m1.4"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml"><mrow id="S4.E6.m1.4.4.2" xref="S4.E6.m1.4.4.2.cmml"><mi id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.4.cmml">Sim</mi><mo id="S4.E6.m1.4.4.2.3" xref="S4.E6.m1.4.4.2.3.cmml">⁢</mo><msub id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml"><mrow id="S4.E6.m1.4.4.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.3.cmml"><mo id="S4.E6.m1.4.4.2.2.2.2.3" stretchy="false" xref="S4.E6.m1.4.4.2.2.2.3.cmml">(</mo><msub id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.E6.m1.3.3.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.3.cmml">p</mi></msub><mo id="S4.E6.m1.4.4.2.2.2.2.4" xref="S4.E6.m1.4.4.2.2.2.3.cmml">,</mo><msub id="S4.E6.m1.4.4.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.E6.m1.4.4.2.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.2.cmml">𝐡</mi><mi id="S4.E6.m1.4.4.2.2.2.2.2.3" xref="S4.E6.m1.4.4.2.2.2.2.2.3.cmml">q</mi></msub><mo id="S4.E6.m1.4.4.2.2.2.2.5" stretchy="false" xref="S4.E6.m1.4.4.2.2.2.3.cmml">)</mo></mrow><mi id="S4.E6.m1.4.4.2.2.4" xref="S4.E6.m1.4.4.2.2.4.cmml">i</mi></msub></mrow><mo id="S4.E6.m1.4.4.3" xref="S4.E6.m1.4.4.3.cmml">=</mo><mrow id="S4.E6.m1.4.4.4" xref="S4.E6.m1.4.4.4.cmml"><mstyle displaystyle="true" id="S4.E6.m1.4.4.4.2" xref="S4.E6.m1.4.4.4.2.cmml"><mfrac id="S4.E6.m1.4.4.4.2a" xref="S4.E6.m1.4.4.4.2.cmml"><mn id="S4.E6.m1.4.4.4.2.2" xref="S4.E6.m1.4.4.4.2.2.cmml">1</mn><mi id="S4.E6.m1.4.4.4.2.3" xref="S4.E6.m1.4.4.4.2.3.cmml">L</mi></mfrac></mstyle><mo id="S4.E6.m1.4.4.4.1" xref="S4.E6.m1.4.4.4.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.4.3" xref="S4.E6.m1.4.4.4.3.cmml"><mstyle displaystyle="true" id="S4.E6.m1.4.4.4.3.1" xref="S4.E6.m1.4.4.4.3.1.cmml"><munderover id="S4.E6.m1.4.4.4.3.1a" xref="S4.E6.m1.4.4.4.3.1.cmml"><mo id="S4.E6.m1.4.4.4.3.1.2.2" movablelimits="false" xref="S4.E6.m1.4.4.4.3.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.4.4.4.3.1.2.3" xref="S4.E6.m1.4.4.4.3.1.2.3.cmml"><mi id="S4.E6.m1.4.4.4.3.1.2.3.2" xref="S4.E6.m1.4.4.4.3.1.2.3.2.cmml">l</mi><mo id="S4.E6.m1.4.4.4.3.1.2.3.1" xref="S4.E6.m1.4.4.4.3.1.2.3.1.cmml">=</mo><mn id="S4.E6.m1.4.4.4.3.1.2.3.3" xref="S4.E6.m1.4.4.4.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.4.4.4.3.1.3" xref="S4.E6.m1.4.4.4.3.1.3.cmml">L</mi></munderover></mstyle><mstyle displaystyle="true" id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mfrac id="S4.E6.m1.2.2a" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.2.2.4" xref="S4.E6.m1.2.2.4.cmml"><msubsup id="S4.E6.m1.2.2.4.2" xref="S4.E6.m1.2.2.4.2.cmml"><mi id="S4.E6.m1.2.2.4.2.2.2" xref="S4.E6.m1.2.2.4.2.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.2.2.4.2.2.3" xref="S4.E6.m1.2.2.4.2.2.3.cmml"><mi id="S4.E6.m1.2.2.4.2.2.3.2" xref="S4.E6.m1.2.2.4.2.2.3.2.cmml">p</mi><mo id="S4.E6.m1.2.2.4.2.2.3.1" xref="S4.E6.m1.2.2.4.2.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.4.2.2.3.3" xref="S4.E6.m1.2.2.4.2.2.3.3.cmml">i</mi></mrow><mrow id="S4.E6.m1.2.2.4.2.3" xref="S4.E6.m1.2.2.4.2.3.cmml"><mi id="S4.E6.m1.2.2.4.2.3.2" xref="S4.E6.m1.2.2.4.2.3.2.cmml">l</mi><mo id="S4.E6.m1.2.2.4.2.3.3" lspace="0.222em" xref="S4.E6.m1.2.2.4.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S4.E6.m1.2.2.4.1" xref="S4.E6.m1.2.2.4.1.cmml">⁢</mo><msubsup id="S4.E6.m1.2.2.4.3" xref="S4.E6.m1.2.2.4.3.cmml"><mi id="S4.E6.m1.2.2.4.3.2.2" xref="S4.E6.m1.2.2.4.3.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.2.2.4.3.2.3" xref="S4.E6.m1.2.2.4.3.2.3.cmml"><mi id="S4.E6.m1.2.2.4.3.2.3.2" xref="S4.E6.m1.2.2.4.3.2.3.2.cmml">q</mi><mo id="S4.E6.m1.2.2.4.3.2.3.1" xref="S4.E6.m1.2.2.4.3.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.4.3.2.3.3" xref="S4.E6.m1.2.2.4.3.2.3.3.cmml">i</mi></mrow><mi id="S4.E6.m1.2.2.4.3.3" xref="S4.E6.m1.2.2.4.3.3.cmml">l</mi></msubsup></mrow><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E6.m1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow><mi id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S4.E6.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E6.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.E6.m1.2.2.2.3" rspace="0.222em" xref="S4.E6.m1.2.2.2.3.cmml">⋅</mo><mrow id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.cmml"><mo id="S4.E6.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.cmml">‖</mo><msubsup id="S4.E6.m1.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.1.1.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.2" xref="S4.E6.m1.2.2.2.2.1.1.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.2.2.2.2.1.1.2.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.2" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2.cmml">q</mi><mo id="S4.E6.m1.2.2.2.2.1.1.2.3.1" xref="S4.E6.m1.2.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.1.1.2.3.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.3.cmml">i</mi></mrow><mi id="S4.E6.m1.2.2.2.2.1.1.3" xref="S4.E6.m1.2.2.2.2.1.1.3.cmml">l</mi></msubsup><mo id="S4.E6.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"><eq id="S4.E6.m1.4.4.3.cmml" xref="S4.E6.m1.4.4.3"></eq><apply id="S4.E6.m1.4.4.2.cmml" xref="S4.E6.m1.4.4.2"><times id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.3"></times><ci id="S4.E6.m1.4.4.2.4.cmml" xref="S4.E6.m1.4.4.2.4">Sim</ci><apply id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2">subscript</csymbol><interval closure="open" id="S4.E6.m1.4.4.2.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.2.2"><apply id="S4.E6.m1.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.2">𝐡</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.3">𝑝</ci></apply><apply id="S4.E6.m1.4.4.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.2">𝐡</ci><ci id="S4.E6.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.3">𝑞</ci></apply></interval><ci id="S4.E6.m1.4.4.2.2.4.cmml" xref="S4.E6.m1.4.4.2.2.4">𝑖</ci></apply></apply><apply id="S4.E6.m1.4.4.4.cmml" xref="S4.E6.m1.4.4.4"><times id="S4.E6.m1.4.4.4.1.cmml" xref="S4.E6.m1.4.4.4.1"></times><apply id="S4.E6.m1.4.4.4.2.cmml" xref="S4.E6.m1.4.4.4.2"><divide id="S4.E6.m1.4.4.4.2.1.cmml" xref="S4.E6.m1.4.4.4.2"></divide><cn id="S4.E6.m1.4.4.4.2.2.cmml" type="integer" xref="S4.E6.m1.4.4.4.2.2">1</cn><ci id="S4.E6.m1.4.4.4.2.3.cmml" xref="S4.E6.m1.4.4.4.2.3">𝐿</ci></apply><apply id="S4.E6.m1.4.4.4.3.cmml" xref="S4.E6.m1.4.4.4.3"><apply id="S4.E6.m1.4.4.4.3.1.cmml" xref="S4.E6.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.3.1.1.cmml" xref="S4.E6.m1.4.4.4.3.1">superscript</csymbol><apply id="S4.E6.m1.4.4.4.3.1.2.cmml" xref="S4.E6.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.3.1.2.1.cmml" xref="S4.E6.m1.4.4.4.3.1">subscript</csymbol><sum id="S4.E6.m1.4.4.4.3.1.2.2.cmml" xref="S4.E6.m1.4.4.4.3.1.2.2"></sum><apply id="S4.E6.m1.4.4.4.3.1.2.3.cmml" xref="S4.E6.m1.4.4.4.3.1.2.3"><eq id="S4.E6.m1.4.4.4.3.1.2.3.1.cmml" xref="S4.E6.m1.4.4.4.3.1.2.3.1"></eq><ci id="S4.E6.m1.4.4.4.3.1.2.3.2.cmml" xref="S4.E6.m1.4.4.4.3.1.2.3.2">𝑙</ci><cn id="S4.E6.m1.4.4.4.3.1.2.3.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.4.4.4.3.1.3.cmml" xref="S4.E6.m1.4.4.4.3.1.3">𝐿</ci></apply><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><divide id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2"></divide><apply id="S4.E6.m1.2.2.4.cmml" xref="S4.E6.m1.2.2.4"><times id="S4.E6.m1.2.2.4.1.cmml" xref="S4.E6.m1.2.2.4.1"></times><apply id="S4.E6.m1.2.2.4.2.cmml" xref="S4.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.2.1.cmml" xref="S4.E6.m1.2.2.4.2">superscript</csymbol><apply id="S4.E6.m1.2.2.4.2.2.cmml" xref="S4.E6.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.2.2.1.cmml" xref="S4.E6.m1.2.2.4.2">subscript</csymbol><ci id="S4.E6.m1.2.2.4.2.2.2.cmml" xref="S4.E6.m1.2.2.4.2.2.2">𝐡</ci><apply id="S4.E6.m1.2.2.4.2.2.3.cmml" xref="S4.E6.m1.2.2.4.2.2.3"><times id="S4.E6.m1.2.2.4.2.2.3.1.cmml" xref="S4.E6.m1.2.2.4.2.2.3.1"></times><ci id="S4.E6.m1.2.2.4.2.2.3.2.cmml" xref="S4.E6.m1.2.2.4.2.2.3.2">𝑝</ci><ci id="S4.E6.m1.2.2.4.2.2.3.3.cmml" xref="S4.E6.m1.2.2.4.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.2.2.4.2.3.cmml" xref="S4.E6.m1.2.2.4.2.3"><csymbol cd="latexml" id="S4.E6.m1.2.2.4.2.3.1.cmml" xref="S4.E6.m1.2.2.4.2.3">limit-from</csymbol><ci id="S4.E6.m1.2.2.4.2.3.2.cmml" xref="S4.E6.m1.2.2.4.2.3.2">𝑙</ci><csymbol cd="latexml" id="S4.E6.m1.2.2.4.2.3.3.cmml" xref="S4.E6.m1.2.2.4.2.3.3">top</csymbol></apply></apply><apply id="S4.E6.m1.2.2.4.3.cmml" xref="S4.E6.m1.2.2.4.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.3.1.cmml" xref="S4.E6.m1.2.2.4.3">superscript</csymbol><apply id="S4.E6.m1.2.2.4.3.2.cmml" xref="S4.E6.m1.2.2.4.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.3.2.1.cmml" xref="S4.E6.m1.2.2.4.3">subscript</csymbol><ci id="S4.E6.m1.2.2.4.3.2.2.cmml" xref="S4.E6.m1.2.2.4.3.2.2">𝐡</ci><apply id="S4.E6.m1.2.2.4.3.2.3.cmml" xref="S4.E6.m1.2.2.4.3.2.3"><times id="S4.E6.m1.2.2.4.3.2.3.1.cmml" xref="S4.E6.m1.2.2.4.3.2.3.1"></times><ci id="S4.E6.m1.2.2.4.3.2.3.2.cmml" xref="S4.E6.m1.2.2.4.3.2.3.2">𝑞</ci><ci id="S4.E6.m1.2.2.4.3.2.3.3.cmml" xref="S4.E6.m1.2.2.4.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E6.m1.2.2.4.3.3.cmml" xref="S4.E6.m1.2.2.4.3.3">𝑙</ci></apply></apply><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><ci id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.3">⋅</ci><apply id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2">𝐡</ci><apply id="S4.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3"><times id="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1"><csymbol cd="latexml" id="S4.E6.m1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.2">norm</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1">superscript</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2">𝐡</ci><apply id="S4.E6.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3"><times id="S4.E6.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.1"></times><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.2">𝑞</ci><ci id="S4.E6.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E6.m1.2.2.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">\displaystyle\mathrm{Sim}(\mathbf{h}_{p},\mathbf{h}_{q})_{i}=\frac{1}{L}\sum_{%
l=1}^{L}\frac{\mathbf{h}_{pi}^{l\top}\mathbf{h}_{qi}^{l}}{\|\mathbf{h}_{pi}^{l%
}\|\cdot\|\mathbf{h}_{qi}^{l}\|}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.4d">roman_Sim ( bold_h start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , bold_h start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_L end_ARG ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT divide start_ARG bold_h start_POSTSUBSCRIPT italic_p italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l ⊤ end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_ARG start_ARG ∥ bold_h start_POSTSUBSCRIPT italic_p italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∥ ⋅ ∥ bold_h start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS6.p1.7">where <math alttext="\mathbf{h}_{p},\mathbf{h}_{q}" class="ltx_Math" display="inline" id="S4.SS6.p1.6.m1.2"><semantics id="S4.SS6.p1.6.m1.2a"><mrow id="S4.SS6.p1.6.m1.2.2.2" xref="S4.SS6.p1.6.m1.2.2.3.cmml"><msub id="S4.SS6.p1.6.m1.1.1.1.1" xref="S4.SS6.p1.6.m1.1.1.1.1.cmml"><mi id="S4.SS6.p1.6.m1.1.1.1.1.2" xref="S4.SS6.p1.6.m1.1.1.1.1.2.cmml">𝐡</mi><mi id="S4.SS6.p1.6.m1.1.1.1.1.3" xref="S4.SS6.p1.6.m1.1.1.1.1.3.cmml">p</mi></msub><mo id="S4.SS6.p1.6.m1.2.2.2.3" xref="S4.SS6.p1.6.m1.2.2.3.cmml">,</mo><msub id="S4.SS6.p1.6.m1.2.2.2.2" xref="S4.SS6.p1.6.m1.2.2.2.2.cmml"><mi id="S4.SS6.p1.6.m1.2.2.2.2.2" xref="S4.SS6.p1.6.m1.2.2.2.2.2.cmml">𝐡</mi><mi id="S4.SS6.p1.6.m1.2.2.2.2.3" xref="S4.SS6.p1.6.m1.2.2.2.2.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.6.m1.2b"><list id="S4.SS6.p1.6.m1.2.2.3.cmml" xref="S4.SS6.p1.6.m1.2.2.2"><apply id="S4.SS6.p1.6.m1.1.1.1.1.cmml" xref="S4.SS6.p1.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.6.m1.1.1.1.1.1.cmml" xref="S4.SS6.p1.6.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS6.p1.6.m1.1.1.1.1.2.cmml" xref="S4.SS6.p1.6.m1.1.1.1.1.2">𝐡</ci><ci id="S4.SS6.p1.6.m1.1.1.1.1.3.cmml" xref="S4.SS6.p1.6.m1.1.1.1.1.3">𝑝</ci></apply><apply id="S4.SS6.p1.6.m1.2.2.2.2.cmml" xref="S4.SS6.p1.6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS6.p1.6.m1.2.2.2.2.1.cmml" xref="S4.SS6.p1.6.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS6.p1.6.m1.2.2.2.2.2.cmml" xref="S4.SS6.p1.6.m1.2.2.2.2.2">𝐡</ci><ci id="S4.SS6.p1.6.m1.2.2.2.2.3.cmml" xref="S4.SS6.p1.6.m1.2.2.2.2.3">𝑞</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.6.m1.2c">\mathbf{h}_{p},\mathbf{h}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.6.m1.2d">bold_h start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , bold_h start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are the activation hidden states after certain modules, and <math alttext="L" class="ltx_Math" display="inline" id="S4.SS6.p1.7.m2.1"><semantics id="S4.SS6.p1.7.m2.1a"><mi id="S4.SS6.p1.7.m2.1.1" xref="S4.SS6.p1.7.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.7.m2.1b"><ci id="S4.SS6.p1.7.m2.1.1.cmml" xref="S4.SS6.p1.7.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.7.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.7.m2.1d">italic_L</annotation></semantics></math> is the number of hidden layers.
We select C-Eval <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite> as the test and Medical-Collection, a 180K subset of CoT-Collection and OpenMath <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">64</span></a>]</cite> as our training corpus.
We follow the same experimental setting as described in §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.SS2" title="4.2 Experiment Details ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a> and present the performance-similarity relations in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A0.F5" title="Figure 5 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">5</span></a>. The results show that a large proportion of activation similarities for <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.7.1">TAIA</span> are close to 1, significantly higher than those of other methods. This high activation consistency of <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.7.2">TAIA</span> correlates with its superior performance, regardless of the training corpus used. It confirms that by emphasizing instruction-following ability through <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.7.3">TAIA</span>, LLMs demonstrate robust generalization performance and effective transferability of training data.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Analysis</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we discuss the following research questions (RQ) of the <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">TAIA</span> strategy:</p>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix1.1.1.1">RQ1:</span></span>
<div class="ltx_para" id="S5.I1.ix1.p1">
<p class="ltx_p" id="S5.I1.ix1.p1.1">Does <span class="ltx_text ltx_font_smallcaps" id="S5.I1.ix1.p1.1.1">TAIA</span> suit full fine-tuning where the catastrophic forgetting is even more severe?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix2.1.1.1">RQ2:</span></span>
<div class="ltx_para" id="S5.I1.ix2.p1">
<p class="ltx_p" id="S5.I1.ix2.p1.1">We have confirmed that <span class="ltx_text ltx_font_smallcaps" id="S5.I1.ix2.p1.1.1">TAIA</span> learns only the beneficial parts of the fine-tuning data. Does this mean that it can survive in red teaming and enhance the model’s helpfulness?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix3.1.1.1">RQ3:</span></span>
<div class="ltx_para" id="S5.I1.ix3.p1">
<p class="ltx_p" id="S5.I1.ix3.p1.1">How proficient can <span class="ltx_text ltx_font_smallcaps" id="S5.I1.ix3.p1.1.1">TAIA</span> show if we scale the training corpus?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix4.1.1.1">RQ4:</span></span>
<div class="ltx_para" id="S5.I1.ix4.p1">
<p class="ltx_p" id="S5.I1.ix4.p1.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Wang et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib68" title=""><span class="ltx_text" style="font-size:90%;">68</span></a>]</cite> finds that supervised fine-tuning hurts LLMs few-shot performance on unseen tasks. Can <span class="ltx_text ltx_font_smallcaps" id="S5.I1.ix4.p1.1.1">TAIA</span> restore similar few-shot ability as the base LLM?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S5.I1.ix5.1.1.1">RQ5:</span></span>
<div class="ltx_para" id="S5.I1.ix5.p1">
<p class="ltx_p" id="S5.I1.ix5.p1.1">Fine-tuning converges to the downstream distribution, leading to the diminishing rank compared to the base LLM. How does the rank change when <span class="ltx_text ltx_font_smallcaps" id="S5.I1.ix5.p1.1.1">TAIA</span> is adopted?
</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.3.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.4.2" style="font-size:90%;">The application of <span class="ltx_text ltx_font_smallcaps" id="S5.T4.4.2.1">TAIA</span> on full fine-tuning technique trained on CoT-Collection. It still surpasses the vanilla fine-tuning method but lags behind the base LLM. </span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.5" style="width:433.6pt;height:118pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-14.7pt,4.0pt) scale(0.936317956124745,0.936317956124745) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T4.5.1">
<tr class="ltx_tr" id="S5.T4.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.2.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.3.1">MATH</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.4.1">BBH</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.5.1">CQA.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.6.1">LogiQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.7"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.7.1">SVAMP</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.8"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.8.1">MMB.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.9"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.9.1">MMLU</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.10"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.10.1">Avg.</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.1" rowspan="3"><span class="ltx_text" id="S5.T4.5.1.2.1.1">Qwen1.5-1.8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.2">Base Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.3">4.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.4">16.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.5">58.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.6">32.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.7">27.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.8">33.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.9">43.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.2.10">31.03</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.3">
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.1">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.2">6.88</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.3">14.51</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.4">59.21</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.5">20.28</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.6">34.30</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.7">27.65</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.8">23.36</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.3.9">26.60</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.4">
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.1" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_smallcaps" id="S5.T4.5.1.4.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.2.1" style="background-color:#E6E6E6;">8.22</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.3.1" style="background-color:#E6E6E6;">15.56</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.4.1" style="background-color:#E6E6E6;">60.61</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.5.1" style="background-color:#E6E6E6;">25.65</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.6.1" style="background-color:#E6E6E6;">39.00</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.7.1" style="background-color:#E6E6E6;">28.20</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.8.1" style="background-color:#E6E6E6;">25.65</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.4.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.4.9.1" style="background-color:#E6E6E6;">28.98</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T4.5.1.5.1" rowspan="3"><span class="ltx_text" id="S5.T4.5.1.5.1.1">Qwen1.5-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.2">Base Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.3">20.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.4">30.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.5">78.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.6">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.7">54.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.8">45.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.9">57.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.5.10">47.11</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.6">
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.1">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.2">9.34</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.3">23.85</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.4">71.66</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.5">21.04</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.6">57.90</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.7">27.57</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.8">24.44</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.1.6.9">33.69</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.1.7">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.1" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_smallcaps" id="S5.T4.5.1.7.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.2.1" style="background-color:#E6E6E6;">14.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.3.1" style="background-color:#E6E6E6;">27.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.4.1" style="background-color:#E6E6E6;">72.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.5.1" style="background-color:#E6E6E6;">33.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.6.1" style="background-color:#E6E6E6;">64.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.7.1" style="background-color:#E6E6E6;">40.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.8.1" style="background-color:#E6E6E6;">35.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.7.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="S5.T4.5.1.7.9.1" style="background-color:#E6E6E6;">41.31</span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T5.8.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S5.T5.9.2" style="font-size:90%;">Comparison of <span class="ltx_text ltx_font_smallcaps" id="S5.T5.9.2.1">TAIA</span> with vanilla fine-tuning on red-teaming resistance. When jailbreaking LLMs on harmful datasets, <span class="ltx_text ltx_font_smallcaps" id="S5.T5.9.2.2">TAIA</span> harvests lower attack success rates than vanilla fine-tuning on both harmful and benign datasets, showing its strong generalization in distilling out harmful features.
</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T5.4" style="width:390.3pt;height:76pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-35.9pt,7.0pt) scale(0.844605288677351,0.844605288677351) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T5.4.4">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.1.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.2.1">Base Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.1.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.3.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.4.1">Advbench</span></td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S5.T5.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.1.1">AlpacaEval<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T5.1.1.1.1.1.1.m1.1"><semantics id="S5.T5.1.1.1.1.1.1.m1.1a"><mo id="S5.T5.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T5.1.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.1.1.1.m1.1b"><ci id="S5.T5.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.1.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.2.2.2.1"><span class="ltx_text ltx_font_bold" id="S5.T5.2.2.2.1.1">Explicitly harmful<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T5.2.2.2.1.1.m1.1"><semantics id="S5.T5.2.2.2.1.1.m1.1a"><mo id="S5.T5.2.2.2.1.1.m1.1.1" stretchy="false" xref="S5.T5.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.1.1.m1.1b"><ci id="S5.T5.2.2.2.1.1.m1.1.1.cmml" xref="S5.T5.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.2.2.2.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.3.3.3.2"><span class="ltx_text ltx_font_bold" id="S5.T5.3.3.3.2.1">Identity Shifting<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T5.3.3.3.2.1.m1.1"><semantics id="S5.T5.3.3.3.2.1.m1.1a"><mo id="S5.T5.3.3.3.2.1.m1.1.1" stretchy="false" xref="S5.T5.3.3.3.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.3.2.1.m1.1b"><ci id="S5.T5.3.3.3.2.1.m1.1.1.cmml" xref="S5.T5.3.3.3.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.3.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.3.3.3.2.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T5.4.4.4.3"><span class="ltx_text ltx_font_bold" id="S5.T5.4.4.4.3.1">Benign<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T5.4.4.4.3.1.m1.1"><semantics id="S5.T5.4.4.4.3.1.m1.1a"><mo id="S5.T5.4.4.4.3.1.m1.1.1" stretchy="false" xref="S5.T5.4.4.4.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.4.3.1.m1.1b"><ci id="S5.T5.4.4.4.3.1.m1.1.1.cmml" xref="S5.T5.4.4.4.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.4.3.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T5.4.4.4.3.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.4.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T5.4.4.5.1" rowspan="3"><span class="ltx_text" id="S5.T5.4.4.5.1.1">LLaMA2-7B-chat</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.4.5.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.4.5.3">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.4.5.4">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.4.5.5">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.4.5.6">7.66</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.4.6">
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.6.1">Vanilla</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.6.2">84.59</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.6.3">93.27</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.6.4">4.04</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.6.5">7.46</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.4.7">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.4.4.7.1" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_smallcaps" id="S5.T5.4.4.7.1.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.4.4.7.2" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S5.T5.4.4.7.2.1" style="background-color:#E6E6E6;">8.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.4.4.7.3" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S5.T5.4.4.7.3.1" style="background-color:#E6E6E6;">30.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.4.4.7.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S5.T5.4.4.7.4.1" style="background-color:#E6E6E6;">0.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.4.4.7.5" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S5.T5.4.4.7.5.1" style="background-color:#E6E6E6;">9.94</span></td>
</tr>
</table>
</span></div>
</figure>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Response to RQ1: <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.1.1">TAIA</span> is also applicable to the full fine-tuning technique.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">Our analysis and empirical study focused on PEFT scenarios, mitigating catastrophic forgetting. To test <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.p1.1.1">TAIA</span> in a full fine-tuning context, we maintained the same experiment settings as with LoRA tuning but lowered the learning rate to <math alttext="5e-5" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mrow id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mn id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">5</mn><mo id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.1" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">−</mo><mn id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1"><minus id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.1"></minus><apply id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2"><times id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.1"></times><cn id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" type="integer" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.2">5</cn><ci id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.2.3">𝑒</ci></apply><cn id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px1.p1.1.m1.1c">5e-5</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px1.p1.1.m1.1d">5 italic_e - 5</annotation></semantics></math> for stability and used the CoT-Collection as the fine-tuning corpus. Testing on Qwen1.8b and 7b sizes, the results (Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5.T4" title="Table 4 ‣ 5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4</span></a>) indicate <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.p1.1.2">TAIA</span> maintains superior performance in reasoning tasks (SVAMP, MATH, CommonsenseQA). However, due to extensive parameter modifications during full fine-tuning, <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px1.p1.1.3">TAIA</span> experiences significant catastrophic forgetting in knowledge-intensive tasks (MMLU, MMedBench). Despite this, it still outperforms the vanilla inference method, validating its applicability and generalization in full fine-tuning scenarios.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Response to RQ2: <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px2.1.1">TAIA</span> significantly reduces harmfulness and improves helpfulness.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">The analysis and experiments above have demonstrated that <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px2.p1.1.1">TAIA</span> enables LLMs to generalize on OOD data, reducing dependency on data quality. To explore if <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px2.p1.1.2">TAIA</span> can handle training data with harmful information while enhancing LLM usefulness without substantially increasing harmfulness, we followed <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Qi et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite> to red-team LLaMA2-7B-chat using three attack levels and evaluated on Advbench <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite>. We used 100 of the most harmful samples from the Anthropic red team dataset <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite>, 10 identity-shifting samples from <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Qi et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite>, and benign data from Alpaca-GPT4 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite>. For models tuned on benign data, we also tested helpfulness on AlpacaEval <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite>. Results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5.T5" title="Table 5 ‣ 5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">5</span></a> show that <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px2.p1.1.3">TAIA</span> significantly reduces the attack success rate after tuning on three levels of red-teaming data while gaining higher helpfulness from the benign dataset. This demonstrates that careful parameter selection can distill out unsafe parameters and enhance LLM robustness.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Response to RQ3: <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px3.1.1">TAIA</span> succeeds in varying data sizes.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">To validate the efficacy of <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px3.p1.1.1">TAIA</span> across different sizes of fine-tuning datasets, we sampled the CoT-Collection dataset to create six fine-tuning corpora of varying sizes: [1K, 10K, 50K, 100K, 200K, 1.8M]. We used the same experimental settings as described in §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4" title="4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4</span></a>. The results, shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5.F4.sf1" title="In Figure 4 ‣ Response to RQ5: TAIA increases the representation rank of self-attention. ‣ 5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4(a)</span></a>, indicate that <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px3.p1.1.2">TAIA</span> achieves higher performance more quickly and with less data, demonstrating a more efficient utilization of OOD data. Additionally, unlike vanilla fine-tuning, which experiences significant performance drops when trained on a 1K dataset, <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px3.p1.1.3">TAIA</span> is minimally affected by the distribution gap between its internal distribution and that of the 1,000 samples. This demonstrates the high robustness and generalization capability of <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px3.p1.1.4">TAIA</span>. The full results are detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T14" title="Table 14 ‣ F.6 Model Scaling of TAIA ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">14</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Response to RQ4: <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px4.1.1">TAIA</span> fully restores the few-shot capability of the base LLM and even improves the performance.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px4.p1.1"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Brown et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> demonstrate the generalization of LLMs as they can adapt to new tasks with few-shot in-context learning.
As LLMs are incapable of few-shot learning after SFT on a specific dataset <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib68" title=""><span class="ltx_text" style="font-size:90%;">68</span></a>]</cite>, we want to verify whether <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px4.p1.1.1">TAIA</span> can maintain the superb few-shot learning ability.We evaluate the few-shot adaptation of <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px4.p1.1.2">TAIA</span> using the same checkpoint trained with CoT-collection and test it in a 100 subset sampled from MATH <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite>.
Results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5.F4.sf2" title="In Figure 4 ‣ Response to RQ5: TAIA increases the representation rank of self-attention. ‣ 5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4(b)</span></a> show that the vanilla fine-tuning method has lost its few-shot learning capability.
In contrast, <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px4.p1.1.3">TAIA</span> has regained the ability to learn contextually as the base LLM, achieving performance leap from demonstrations in an approximately linear manner.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Response to RQ5: <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px5.1.1">TAIA</span> increases the representation rank of self-attention.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px5.p1.7"><cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Dong et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> denote that the residual rank of the representation highly correlates to the final performance of Transformer models.
The residual rank of any hidden state <math alttext="\mathbf{X}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px5.p1.1.m1.1a"><mrow id="S5.SS0.SSS0.Px5.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml"><mi id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.2" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.cmml"><mi id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.2" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.3" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.1.m1.1b"><apply id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1"><in id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.1"></in><ci id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.2">𝐗</ci><apply id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.1.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.2.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3"><times id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.1"></times><ci id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.2.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.2">𝑛</ci><ci id="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.3.cmml" xref="S5.SS0.SSS0.Px5.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.1.m1.1c">\mathbf{X}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.1.m1.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> can be obtained by <math alttext="\|\mathrm{res}(\mathbf{X})\|_{1,\infty}=\|\mathbf{X}-\boldsymbol{\mu}\|_{1,\infty}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.2.m2.7"><semantics id="S5.SS0.SSS0.Px5.p1.2.m2.7a"><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.7.7" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.cmml"><msub id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.2.cmml"><mo id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.2.1.cmml">‖</mo><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.2.cmml">res</mi><mo id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.1.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.3.2" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.3.2.1" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.cmml">(</mo><mi id="S5.SS0.SSS0.Px5.p1.2.m2.5.5" xref="S5.SS0.SSS0.Px5.p1.2.m2.5.5.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.3.2.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.3" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.2.1.cmml">‖</mo></mrow><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.4" xref="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.3.cmml"><mn id="S5.SS0.SSS0.Px5.p1.2.m2.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.1.1.1.1.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.4.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.2" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.2.cmml">∞</mi></mrow></msub><mo id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.3" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.3.cmml">=</mo><msub id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.2.cmml"><mo id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.2.1.cmml">‖</mo><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.2.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.1.cmml">−</mo><mi id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.3" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.3.cmml">𝝁</mi></mrow><mo id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.3" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.2.1.cmml">‖</mo></mrow><mrow id="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.4" xref="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.3.cmml"><mn id="S5.SS0.SSS0.Px5.p1.2.m2.3.3.1.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.3.3.1.1.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.4.1" xref="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.3.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.2" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.2.cmml">∞</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.2.m2.7b"><apply id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7"><eq id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.3.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.3"></eq><apply id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.2">norm</csymbol><apply id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1"><times id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.1"></times><ci id="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.6.6.1.1.1.1.2">res</ci><ci id="S5.SS0.SSS0.Px5.p1.2.m2.5.5.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.5.5">𝐗</ci></apply></apply><list id="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.4"><cn id="S5.SS0.SSS0.Px5.p1.2.m2.1.1.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.2.m2.1.1.1.1">1</cn><infinity id="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.2.2.2.2"></infinity></list></apply><apply id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.2">norm</csymbol><apply id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1"><minus id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.1"></minus><ci id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.2">𝐗</ci><ci id="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.7.7.2.1.1.1.3">𝝁</ci></apply></apply><list id="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.4"><cn id="S5.SS0.SSS0.Px5.p1.2.m2.3.3.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.2.m2.3.3.1.1">1</cn><infinity id="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.2.m2.4.4.2.2"></infinity></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.2.m2.7c">\|\mathrm{res}(\mathbf{X})\|_{1,\infty}=\|\mathbf{X}-\boldsymbol{\mu}\|_{1,\infty}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.2.m2.7d">∥ roman_res ( bold_X ) ∥ start_POSTSUBSCRIPT 1 , ∞ end_POSTSUBSCRIPT = ∥ bold_X - bold_italic_μ ∥ start_POSTSUBSCRIPT 1 , ∞ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\boldsymbol{\mu}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.3.m3.1"><semantics id="S5.SS0.SSS0.Px5.p1.3.m3.1a"><mrow id="S5.SS0.SSS0.Px5.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.2" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.2.cmml">𝝁</mi><mo id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.1" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.cmml"><mi id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.2" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.3" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.3.m3.1b"><apply id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1"><in id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.1"></in><ci id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.2">𝝁</ci><apply id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.1.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3">superscript</csymbol><ci id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.2.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.3.cmml" xref="S5.SS0.SSS0.Px5.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.3.m3.1c">\boldsymbol{\mu}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.3.m3.1d">bold_italic_μ ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the averaged representation and <math alttext="\|\mathbf{X}\|_{1,\infty}=\sqrt{\|\mathbf{X}\|_{1}\|\mathbf{X}\|_{\infty}}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.4.m4.5"><semantics id="S5.SS0.SSS0.Px5.p1.4.m4.5a"><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.5.6" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.cmml"><msub id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.1.cmml"><mo id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.2.1" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.1.1.cmml">‖</mo><mi id="S5.SS0.SSS0.Px5.p1.4.m4.5.5" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.5.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.2.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.1.1.cmml">‖</mo></mrow><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.4" xref="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.3.cmml"><mn id="S5.SS0.SSS0.Px5.p1.4.m4.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.4.m4.1.1.1.1.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.4.1" xref="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.2" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.2.cmml">∞</mi></mrow></msub><mo id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.1" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.1.cmml">=</mo><msqrt id="S5.SS0.SSS0.Px5.p1.4.m4.4.4" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.cmml"><msub id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.1.cmml"><mo id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.2.1" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.1.1.cmml">‖</mo><mi id="S5.SS0.SSS0.Px5.p1.4.m4.3.3.1.1" xref="S5.SS0.SSS0.Px5.p1.4.m4.3.3.1.1.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.2.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.1.1.cmml">‖</mo></mrow><mn id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.3" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.3.cmml">1</mn></msub><mo id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.3" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.3.cmml">⁢</mo><msub id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.1.cmml"><mo id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.2.1" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.1.1.cmml">‖</mo><mi id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.2" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.2.cmml">𝐗</mi><mo id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.2.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.1.1.cmml">‖</mo></mrow><mi id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.3" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.3.cmml">∞</mi></msub></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.4.m4.5b"><apply id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6"><eq id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.1"></eq><apply id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.2"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.6.2.2.2.1">norm</csymbol><ci id="S5.SS0.SSS0.Px5.p1.4.m4.5.5.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.5.5">𝐗</ci></apply><list id="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.4"><cn id="S5.SS0.SSS0.Px5.p1.4.m4.1.1.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.4.m4.1.1.1.1">1</cn><infinity id="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.2.2.2.2"></infinity></list></apply><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4"><root id="S5.SS0.SSS0.Px5.p1.4.m4.4.4a.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4"></root><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2"><times id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.3"></times><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.2"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.2.2.1">norm</csymbol><ci id="S5.SS0.SSS0.Px5.p1.4.m4.3.3.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.3.3.1.1">𝐗</ci></apply><cn id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.3.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.4.3">1</cn></apply><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.2"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.2.2.1">norm</csymbol><ci id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.2">𝐗</ci></apply><infinity id="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.3.cmml" xref="S5.SS0.SSS0.Px5.p1.4.m4.4.4.2.5.3"></infinity></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.4.m4.5c">\|\mathbf{X}\|_{1,\infty}=\sqrt{\|\mathbf{X}\|_{1}\|\mathbf{X}\|_{\infty}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.4.m4.5d">∥ bold_X ∥ start_POSTSUBSCRIPT 1 , ∞ end_POSTSUBSCRIPT = square-root start_ARG ∥ bold_X ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ bold_X ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>.
To quantify this metric human-friendly, we recompute the ratio between the residual rank and the original rank of <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.5.m5.1"><semantics id="S5.SS0.SSS0.Px5.p1.5.m5.1a"><mi id="S5.SS0.SSS0.Px5.p1.5.m5.1.1" xref="S5.SS0.SSS0.Px5.p1.5.m5.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.5.m5.1b"><ci id="S5.SS0.SSS0.Px5.p1.5.m5.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.5.m5.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.5.m5.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.5.m5.1d">bold_X</annotation></semantics></math> after each attention module as <math alttext="\|\mathrm{res}(\mathbf{X}_{l})\|_{1,\infty}/\|\mathbf{X}_{l}\|_{1,\infty}" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.6.m6.6"><semantics id="S5.SS0.SSS0.Px5.p1.6.m6.6a"><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.6.6" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.cmml"><msub id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.2.cmml"><mo id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.2.1.cmml">‖</mo><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.3" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.3.cmml">res</mi><mo id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.3" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.3" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.2.1.cmml">‖</mo></mrow><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.4" xref="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.3.cmml"><mn id="S5.SS0.SSS0.Px5.p1.6.m6.1.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.1.1.1.1.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.4.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.2" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.2.cmml">∞</mi></mrow></msub><mo id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.3" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.3.cmml">/</mo><msub id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.cmml"><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.2.cmml"><mo id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.2" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.2.1.cmml">‖</mo><msub id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.cmml"><mi id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.2" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.2.cmml">𝐗</mi><mi id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.3" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.3.cmml">l</mi></msub><mo id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.3" stretchy="false" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.2.1.cmml">‖</mo></mrow><mrow id="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.4" xref="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.3.cmml"><mn id="S5.SS0.SSS0.Px5.p1.6.m6.3.3.1.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.3.3.1.1.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.4.1" xref="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.3.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.2" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.2.cmml">∞</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.6.m6.6b"><apply id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6"><divide id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.3"></divide><apply id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.2">norm</csymbol><apply id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1"><times id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.2"></times><ci id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.3">res</ci><apply id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.5.5.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><list id="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.4"><cn id="S5.SS0.SSS0.Px5.p1.6.m6.1.1.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.6.m6.1.1.1.1">1</cn><infinity id="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.2.2.2.2"></infinity></list></apply><apply id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2">subscript</csymbol><apply id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.2.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.2">norm</csymbol><apply id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1">subscript</csymbol><ci id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.2">𝐗</ci><ci id="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.6.6.2.1.1.1.3">𝑙</ci></apply></apply><list id="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.3.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.4"><cn id="S5.SS0.SSS0.Px5.p1.6.m6.3.3.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.6.m6.3.3.1.1">1</cn><infinity id="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.2.cmml" xref="S5.SS0.SSS0.Px5.p1.6.m6.4.4.2.2"></infinity></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.6.m6.6c">\|\mathrm{res}(\mathbf{X}_{l})\|_{1,\infty}/\|\mathbf{X}_{l}\|_{1,\infty}</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.6.m6.6d">∥ roman_res ( bold_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 1 , ∞ end_POSTSUBSCRIPT / ∥ bold_X start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 1 , ∞ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="l=0,1,\ldots,L" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px5.p1.7.m7.4"><semantics id="S5.SS0.SSS0.Px5.p1.7.m7.4a"><mrow id="S5.SS0.SSS0.Px5.p1.7.m7.4.5" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.cmml"><mi id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.2" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.2.cmml">l</mi><mo id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.1" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.1.cmml">=</mo><mrow id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.2" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.1.cmml"><mn id="S5.SS0.SSS0.Px5.p1.7.m7.1.1" xref="S5.SS0.SSS0.Px5.p1.7.m7.1.1.cmml">0</mn><mo id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.2.1" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.1.cmml">,</mo><mn id="S5.SS0.SSS0.Px5.p1.7.m7.2.2" xref="S5.SS0.SSS0.Px5.p1.7.m7.2.2.cmml">1</mn><mo id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.2.2" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.1.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.7.m7.3.3" mathvariant="normal" xref="S5.SS0.SSS0.Px5.p1.7.m7.3.3.cmml">…</mi><mo id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.2.3" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.1.cmml">,</mo><mi id="S5.SS0.SSS0.Px5.p1.7.m7.4.4" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px5.p1.7.m7.4b"><apply id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5"><eq id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.1.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.1"></eq><ci id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.2.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.2">𝑙</ci><list id="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.1.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.5.3.2"><cn id="S5.SS0.SSS0.Px5.p1.7.m7.1.1.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.7.m7.1.1">0</cn><cn id="S5.SS0.SSS0.Px5.p1.7.m7.2.2.cmml" type="integer" xref="S5.SS0.SSS0.Px5.p1.7.m7.2.2">1</cn><ci id="S5.SS0.SSS0.Px5.p1.7.m7.3.3.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.3.3">…</ci><ci id="S5.SS0.SSS0.Px5.p1.7.m7.4.4.cmml" xref="S5.SS0.SSS0.Px5.p1.7.m7.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px5.p1.7.m7.4c">l=0,1,\ldots,L</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px5.p1.7.m7.4d">italic_l = 0 , 1 , … , italic_L</annotation></semantics></math>.
The comparisons between the vanilla method, <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px5.p1.7.1">TAIA</span> and TOA trained and evaluated on MATH, are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5.F4.sf3" title="In Figure 4 ‣ Response to RQ5: TAIA increases the representation rank of self-attention. ‣ 5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4(c)</span></a>.
We notice a negligible difference between the baseline and TOA, indicating that simply training the self-attention modules does not affect dealing with OOD data.
Notably, <span class="ltx_text ltx_font_smallcaps" id="S5.SS0.SSS0.Px5.p1.7.2">TAIA</span> significantly increases the residual rank of activations of self-attention modules across all layers, which promises high expressiveness and generality.</p>
</div>
<figure class="ltx_figure" id="S5.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="796" id="S5.F4.sf1.g1" src="x6.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="795" id="S5.F4.sf2.g1" src="x7.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="804" id="S5.F4.sf3.g1" src="x8.png" width="821"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.sf3.2.1.1" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">
(a)Average performance with different sizes of fine-tuning datasets; (b) The few-shot performance on MATH; (c) The layer-wise residual rank of the hidden states on MATH.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We revisit the intrinsic properties of LLM fine-tuning and determine that supervised fine-tuning poses minimal requirements for updated FFN parameters. Building on this insight, we introduce <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">TAIA</span>, an inference-time intervention strategy designed to address data scarcity challenges in real-world applications of LLMs.
<span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">TAIA</span> adheres to the traditional fine-tuning technique but only retains updated self-attention parameters for inference. This approach demonstrates superior generalization ability across various contexts. The high generality of <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.3">TAIA</span> enables effective training using a mixture of limited in-domain data and extensive OOD data. This method enhances LLM performance on downstream tasks while filtering out undesired information from the fine-tuning set, such as hallucination interference or the decline of few-shot capability.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments and Disclosure of Funding</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We thank Jiangtao Feng for his valuable suggestions on the paper structure. We also thank the anonymous reviewers for their insightful comments and suggestions.
This work is supported by National Key R&amp;D Program of China (No. 2022ZD0162101), National Natural Science Foundation of China (No. 62106140) and STCSM (No. 21511101100, No. 22DZ2229005)</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.5.5.1" style="font-size:90%;">AlKhamissi et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.7.1" style="font-size:90%;">
Badr AlKhamissi, Millicent Li, Asli Celikyilmaz, Mona Diab, and Marjan Ghazvininejad.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.8.1" style="font-size:90%;">A review on language models as knowledge bases.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.9.1" style="font-size:90%;">arXiv preprint arXiv:2204.06031</em><span class="ltx_text" id="bib.bib1.10.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.5.5.1" style="font-size:90%;">Anil et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.7.1" style="font-size:90%;">
Rohan Anil, Andrew M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin, Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng Chen, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.8.1" style="font-size:90%;">Palm 2 technical report.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.9.1" style="font-size:90%;">arXiv preprint arXiv:2305.10403</em><span class="ltx_text" id="bib.bib2.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.5.5.1" style="font-size:90%;">Bai et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.7.1" style="font-size:90%;">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, Junyang Lin, Runji Lin, Dayiheng Liu, Gao Liu, Chengqiang Lu, Keming Lu, Jianxin Ma, Rui Men, Xingzhang Ren, Xuancheng Ren, Chuanqi Tan, Sinan Tan, Jianhong Tu, Peng Wang, Shijie Wang, Wei Wang, Shengguang Wu, Benfeng Xu, Jin Xu, An Yang, Hao Yang, Jian Yang, Shusheng Yang, Yang Yao, Bowen Yu, Hongyi Yuan, Zheng Yuan, Jianwei Zhang, Xingxuan Zhang, Yichang Zhang, Zhenru Zhang, Chang Zhou, Jingren Zhou, Xiaohuan Zhou, and Tianhang Zhu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.8.1" style="font-size:90%;">Qwen technical report.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.9.1" style="font-size:90%;">arXiv preprint arXiv:2309.16609</em><span class="ltx_text" id="bib.bib3.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.5.5.1" style="font-size:90%;">Bai et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">
Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova Dassarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, Nicholas Joseph, Saurav Kadavath, John Kernion, Tom Conerly, Sheer El-Showk, Nelson Elhage, Zac Hatfield-Dodds, Danny Hernandez, Tristan Hume, Scott Johnston, Shauna Kravec, Liane Lovitt, Neel Nanda, Catherine Olsson, Dario Amodei, Tom B. Brown, Jack Clark, Sam McCandlish, Christopher Olah, Benjamin Mann, and Jared Kaplan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.8.1" style="font-size:90%;">Training a helpful and harmless assistant with reinforcement learning from human feedback.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.9.1" style="font-size:90%;">ArXiv</em><span class="ltx_text" id="bib.bib4.10.2" style="font-size:90%;">, abs/2204.05862, 2022.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.11.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:248118878" style="font-size:90%;" title="">https://api.semanticscholar.org/CorpusID:248118878</a><span class="ltx_text" id="bib.bib4.12.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.5.5.1" style="font-size:90%;">Bietti et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">
Alberto Bietti, Vivien Cabannes, Diane Bouchacourt, Herve Jegou, and Leon Bottou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.8.1" style="font-size:90%;">Birth of a transformer: A memory viewpoint.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.9.1" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib5.10.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.5.5.1" style="font-size:90%;">Brown et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.7.1" style="font-size:90%;">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.8.1" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib6.10.2" style="font-size:90%;">, 33:1877–1901, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.5.5.1" style="font-size:90%;">Cao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.7.1" style="font-size:90%;">
Yihan Cao, Yanbin Kang, and Lichao Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.8.1" style="font-size:90%;">Instruction mining: High-quality instruction data selection for large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.9.1" style="font-size:90%;">arXiv preprint arXiv:2307.06290</em><span class="ltx_text" id="bib.bib7.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.5.5.1" style="font-size:90%;">Chang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">
Yupeng Chang, Xu Wang, Jindong Wang, Yuan Wu, Linyi Yang, Kaijie Zhu, Hao Chen, Xiaoyuan Yi, Cunxiang Wang, Yidong Wang, Wei Ye, Yue Zhang, Yi Chang, Philip S. Yu, Qiang Yang, and Xing Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.8.1" style="font-size:90%;">A survey on evaluation of large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.9.1" style="font-size:90%;">ACM Trans. Intell. Syst. Technol.</em><span class="ltx_text" id="bib.bib8.10.2" style="font-size:90%;">, 15(3), mar 2024.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.11.1" style="font-size:90%;">ISSN 2157-6904.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.1145/3641289</span><span class="ltx_text" id="bib.bib8.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3641289" style="font-size:90%;" title="">https://doi.org/10.1145/3641289</a><span class="ltx_text" id="bib.bib8.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.5.5.1" style="font-size:90%;">Chen et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.7.1" style="font-size:90%;">
Junying Chen, Xidong Wang, Anningzhe Gao, Feng Jiang, Shunian Chen, Hongbo Zhang, Dingjie Song, Wenya Xie, Chuyi Kong, Jianquan Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.8.1" style="font-size:90%;">Huatuogpt-ii, one-stage training for medical adaption of llms.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.9.1" style="font-size:90%;">arXiv preprint arXiv:2311.09774</em><span class="ltx_text" id="bib.bib9.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.5.5.1" style="font-size:90%;">Chen et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.7.1" style="font-size:90%;">
Yangyi Chen, Hongcheng Gao, Ganqu Cui, Fanchao Qi, Longtao Huang, Zhiyuan Liu, and Maosong Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.8.1" style="font-size:90%;">Why should adversarial perturbations be imperceptible? rethink the research paradigm in adversarial NLP.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.9.1" style="font-size:90%;">In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib10.10.2" style="font-size:90%;">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib10.11.3" style="font-size:90%;">, pages 11222–11237, Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2022.emnlp-main.771</span><span class="ltx_text" id="bib.bib10.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.emnlp-main.771" style="font-size:90%;" title="">https://aclanthology.org/2022.emnlp-main.771</a><span class="ltx_text" id="bib.bib10.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.5.5.1" style="font-size:90%;">Chung et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.7.1" style="font-size:90%;">
Hyung Won Chung, Le Hou, Shayne Longpre, Barret Zoph, Yi Tay, William Fedus, Yunxuan Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.8.1" style="font-size:90%;">Scaling instruction-finetuned language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.9.1" style="font-size:90%;">Journal of Machine Learning Research</em><span class="ltx_text" id="bib.bib11.10.2" style="font-size:90%;">, 25(70):1–53, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.5.5.1" style="font-size:90%;">Cobbe et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.8.1" style="font-size:90%;">Training verifiers to solve math word problems.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.9.1" style="font-size:90%;">arXiv preprint arXiv:2110.14168</em><span class="ltx_text" id="bib.bib12.10.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.5.5.1" style="font-size:90%;">Dong et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">
Yihe Dong, Jean-Baptiste Cordonnier, and Andreas Loukas.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.8.1" style="font-size:90%;">Attention is not all you need: Pure attention loses rank doubly exponentially with depth.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib13.10.2" style="font-size:90%;">International Conference on Machine Learning</em><span class="ltx_text" id="bib.bib13.11.3" style="font-size:90%;">, pages 2793–2803. PMLR, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.5.5.1" style="font-size:90%;">Dou et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">
Shihan Dou, Enyu Zhou, Yan Liu, Songyang Gao, Jun Zhao, Wei Shen, Yuhao Zhou, Zhiheng Xi, Xiao Wang, Xiaoran Fan, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.8.1" style="font-size:90%;">Loramoe: Revolutionizing mixture of experts for maintaining world knowledge in language model alignment.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.9.1" style="font-size:90%;">arXiv preprint arXiv:2312.09979</em><span class="ltx_text" id="bib.bib14.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.5.5.1" style="font-size:90%;">Elhage et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">
Nelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.8.1" style="font-size:90%;">A mathematical framework for transformer circuits.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.9.1" style="font-size:90%;">Transformer Circuits Thread</em><span class="ltx_text" id="bib.bib15.10.2" style="font-size:90%;">, 1:1, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.5.5.1" style="font-size:90%;">Ganguli et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.7.1" style="font-size:90%;">
Deep Ganguli, Liane Lovitt, Jackson Kernion, Amanda Askell, Yuntao Bai, Saurav Kadavath, Ben Mann, Ethan Perez, Nicholas Schiefer, Kamal Ndousse, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.8.1" style="font-size:90%;">Red teaming language models to reduce harms: Methods, scaling behaviors, and lessons learned.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.9.1" style="font-size:90%;">arXiv preprint arXiv:2209.07858</em><span class="ltx_text" id="bib.bib16.10.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.5.5.1" style="font-size:90%;">Gekhman et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">
Zorik Gekhman, Gal Yona, Roee Aharoni, Matan Eyal, Amir Feder, Roi Reichart, and Jonathan Herzig.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.8.1" style="font-size:90%;">Does fine-tuning llms on new knowledge encourage hallucinations?
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.9.1" style="font-size:90%;">arXiv preprint arXiv:2405.05904</em><span class="ltx_text" id="bib.bib17.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.5.5.1" style="font-size:90%;">Geva et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.7.1" style="font-size:90%;">
Mor Geva, Roei Schuster, Jonathan Berant, and Omer Levy.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.8.1" style="font-size:90%;">Transformer feed-forward layers are key-value memories.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.9.1" style="font-size:90%;">arXiv preprint arXiv:2012.14913</em><span class="ltx_text" id="bib.bib18.10.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.5.5.1" style="font-size:90%;">Hendrycks et al. [2021a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.8.1" style="font-size:90%;">Measuring massive multitask language understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib19.10.2" style="font-size:90%;">International Conference on Learning Representations</em><span class="ltx_text" id="bib.bib19.11.3" style="font-size:90%;">, 2021a.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.12.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=d7KBjmI3GmQ" style="font-size:90%;" title="">https://openreview.net/forum?id=d7KBjmI3GmQ</a><span class="ltx_text" id="bib.bib19.13.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.5.5.1" style="font-size:90%;">Hendrycks et al. [2021b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">
Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.8.1" style="font-size:90%;">Measuring mathematical problem solving with the math dataset.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib20.10.2" style="font-size:90%;">, 2021b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.5.5.1" style="font-size:90%;">Hu et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.7.1" style="font-size:90%;">
Edward J Hu, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, Weizhu Chen, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.8.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib21.10.2" style="font-size:90%;">International Conference on Learning Representations</em><span class="ltx_text" id="bib.bib21.11.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.5.5.1" style="font-size:90%;">Huang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.7.1" style="font-size:90%;">
Yuzhen Huang, Yuzhuo Bai, Zhihao Zhu, Junlei Zhang, Jinghan Zhang, Tangjun Su, Junteng Liu, Chuancheng Lv, Yikai Zhang, Yao Fu, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.8.1" style="font-size:90%;">C-eval: A multi-level multi-discipline chinese evaluation suite for foundation models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.9.1" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib22.10.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.5.5.1" style="font-size:90%;">Jiang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.7.1" style="font-size:90%;">
Albert Q. Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou Hanna, Florian Bressand, Gianna Lengyel, Guillaume Bour, Guillaume Lample, Lélio Renard Lavaud, Lucile Saulnier, Marie-Anne Lachaux, Pierre Stock, Sandeep Subramanian, Sophia Yang, Szymon Antoniak, Teven Le Scao, Théophile Gervet, Thibaut Lavril, Thomas Wang, Timothée Lacroix, and William El Sayed.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.8.1" style="font-size:90%;">Mixtral of experts, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.5.5.1" style="font-size:90%;">Kim et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.7.1" style="font-size:90%;">
Seungone Kim, Se Joo, Doyoung Kim, Joel Jang, Seonghyeon Ye, Jamin Shin, and Minjoon Seo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.8.1" style="font-size:90%;">The CoT collection: Improving zero-shot and few-shot learning of language models via chain-of-thought fine-tuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.9.1" style="font-size:90%;">In Houda Bouamor, Juan Pino, and Kalika Bali, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib24.10.2" style="font-size:90%;">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib24.11.3" style="font-size:90%;">, pages 12685–12708, Singapore, December 2023. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2023.emnlp-main.782</span><span class="ltx_text" id="bib.bib24.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.emnlp-main.782" style="font-size:90%;" title="">https://aclanthology.org/2023.emnlp-main.782</a><span class="ltx_text" id="bib.bib24.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.5.5.1" style="font-size:90%;">Kirkpatrick et al. [2017]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.7.1" style="font-size:90%;">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.8.1" style="font-size:90%;">Overcoming catastrophic forgetting in neural networks.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.9.1" style="font-size:90%;">Proceedings of the national academy of sciences</em><span class="ltx_text" id="bib.bib25.10.2" style="font-size:90%;">, 114(13):3521–3526, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.5.5.1" style="font-size:90%;">Kumar et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.7.1" style="font-size:90%;">
Divyanshu Kumar, Anurakt Kumar, Sahil Agarwal, and Prashanth Harshangi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.8.1" style="font-size:90%;">Increased llm vulnerabilities from fine-tuning and quantization.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.9.1" style="font-size:90%;">arXiv preprint arXiv:2404.04392</em><span class="ltx_text" id="bib.bib26.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.5.5.1" style="font-size:90%;">Li et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">
Kenneth Li, Oam Patel, Fernanda Viégas, Hanspeter Pfister, and Martin Wattenberg.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.8.1" style="font-size:90%;">Inference-time intervention: Eliciting truthful answers from a language model.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.9.1" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib27.10.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.5.5.1" style="font-size:90%;">Li et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.7.1" style="font-size:90%;">
Raymond Li, Loubna Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov, Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.8.1" style="font-size:90%;">Starcoder: may the source be with you!
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.9.1" style="font-size:90%;">arXiv preprint arXiv:2305.06161</em><span class="ltx_text" id="bib.bib28.10.2" style="font-size:90%;">, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.5.5.1" style="font-size:90%;">Li et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">
Xuechen Li, Tianyi Zhang, Yann Dubois, Rohan Taori, Ishaan Gulrajani, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.8.1" style="font-size:90%;">Alpacaeval: An automatic evaluator of instruction-following models.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/tatsu-lab/alpaca_eval" style="font-size:90%;" title="">https://github.com/tatsu-lab/alpaca_eval</a><span class="ltx_text" id="bib.bib29.9.1" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.5.5.1" style="font-size:90%;">Liao et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.7.1" style="font-size:90%;">
Yusheng Liao, Shuyang Jiang, Yu Wang, and Yanfeng Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.8.1" style="font-size:90%;">Ming-moe: Enhancing medical multi-task learning in large language models with sparse mixture of low-rank adapter experts.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.9.1" style="font-size:90%;">arXiv preprint arXiv:2404.09027</em><span class="ltx_text" id="bib.bib30.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.5.5.1" style="font-size:90%;">Liu et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.7.1" style="font-size:90%;">
Jian Liu, Leyang Cui, Hanmeng Liu, Dandan Huang, Yile Wang, and Yue Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.8.1" style="font-size:90%;">Logiqa: A challenge dataset for machine reading comprehension with logical reasoning.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.9.1" style="font-size:90%;">arXiv preprint arXiv:2007.08124</em><span class="ltx_text" id="bib.bib31.10.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.5.5.1" style="font-size:90%;">Liu et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.7.1" style="font-size:90%;">
Junling Liu, Peilin Zhou, Yining Hua, Dading Chong, Zhongyu Tian, Andrew Liu, Helin Wang, Chenyu You, Zhenhua Guo, Lei Zhu, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.8.1" style="font-size:90%;">Benchmarking large language models on cmexam–a comprehensive chinese medical exam dataset.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.9.1" style="font-size:90%;">arXiv preprint arXiv:2306.03030</em><span class="ltx_text" id="bib.bib32.10.2" style="font-size:90%;">, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.5.5.1" style="font-size:90%;">Liu et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.7.1" style="font-size:90%;">
Shih-Yang Liu, Chien-Yi Wang, Hongxu Yin, Pavlo Molchanov, Yu-Chiang Frank Wang, Kwang-Ting Cheng, and Min-Hung Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.8.1" style="font-size:90%;">Dora: Weight-decomposed low-rank adaptation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.9.1" style="font-size:90%;">arXiv preprint arXiv:2402.09353</em><span class="ltx_text" id="bib.bib33.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.5.5.1" style="font-size:90%;">Liu et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.7.1" style="font-size:90%;">
Xiao Liu, Hao Yu, Hanchen Zhang, Yifan Xu, Xuanyu Lei, Hanyu Lai, Yu Gu, Hangliang Ding, Kaiwen Men, Kejuan Yang, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.8.1" style="font-size:90%;">Agentbench: Evaluating llms as agents.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.9.1" style="font-size:90%;">arXiv preprint arXiv:2308.03688</em><span class="ltx_text" id="bib.bib34.10.2" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.5.5.1" style="font-size:90%;">Lozhkov et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.7.1" style="font-size:90%;">
Anton Lozhkov, Raymond Li, Loubna Ben Allal, Federico Cassano, Joel Lamy-Poirier, Nouamane Tazi, Ao Tang, Dmytro Pykhtar, Jiawei Liu, Yuxiang Wei, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.8.1" style="font-size:90%;">Starcoder 2 and the stack v2: The next generation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.9.1" style="font-size:90%;">arXiv preprint arXiv:2402.19173</em><span class="ltx_text" id="bib.bib35.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.5.5.1" style="font-size:90%;">Luo et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.7.1" style="font-size:90%;">
Haipeng Luo, Qingfeng Sun, Can Xu, Pu Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.8.1" style="font-size:90%;">Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.9.1" style="font-size:90%;">arXiv preprint arXiv:2308.09583</em><span class="ltx_text" id="bib.bib36.10.2" style="font-size:90%;">, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.5.5.1" style="font-size:90%;">Luo et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.7.1" style="font-size:90%;">
Yun Luo, Zhen Yang, Fandong Meng, Yafu Li, Jie Zhou, and Yue Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.8.1" style="font-size:90%;">An empirical study of catastrophic forgetting in large language models during continual fine-tuning.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.9.1" style="font-size:90%;">arXiv preprint arXiv:2308.08747</em><span class="ltx_text" id="bib.bib37.10.2" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.5.5.1" style="font-size:90%;">Luo et al. [2023c]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.7.1" style="font-size:90%;">
Ziyang Luo, Can Xu, Pu Zhao, Qingfeng Sun, Xiubo Geng, Wenxiang Hu, Chongyang Tao, Jing Ma, Qingwei Lin, and Daxin Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.8.1" style="font-size:90%;">Wizardcoder: Empowering code large language models with evol-instruct.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.9.1" style="font-size:90%;">arXiv preprint arXiv:2306.08568</em><span class="ltx_text" id="bib.bib38.10.2" style="font-size:90%;">, 2023c.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.5.5.1" style="font-size:90%;">Madotto et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.7.1" style="font-size:90%;">
Andrea Madotto, Zhaojiang Lin, Zhenpeng Zhou, Seungwhan Moon, Paul Crook, Bing Liu, Zhou Yu, Eunjoon Cho, Pascale Fung, and Zhiguang Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.8.1" style="font-size:90%;">Continual learning in task-oriented dialogue systems.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.9.1" style="font-size:90%;">In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and Scott Wen-tau Yih, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib39.10.2" style="font-size:90%;">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib39.11.3" style="font-size:90%;">, pages 7452–7467, Online and Punta Cana, Dominican Republic, November 2021. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2021.emnlp-main.590</span><span class="ltx_text" id="bib.bib39.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.emnlp-main.590" style="font-size:90%;" title="">https://aclanthology.org/2021.emnlp-main.590</a><span class="ltx_text" id="bib.bib39.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.5.5.1" style="font-size:90%;">Meng et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.7.1" style="font-size:90%;">
Kevin Meng, David Bau, Alex Andonian, and Yonatan Belinkov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.8.1" style="font-size:90%;">Locating and editing factual associations in gpt.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.9.1" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib40.10.2" style="font-size:90%;">, 35:17359–17372, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.5.5.1" style="font-size:90%;">Mishra et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.7.1" style="font-size:90%;">
Swaroop Mishra, Daniel Khashabi, Chitta Baral, and Hannaneh Hajishirzi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.8.1" style="font-size:90%;">Cross-task generalization via natural language crowdsourcing instructions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib41.10.2" style="font-size:90%;">ACL</em><span class="ltx_text" id="bib.bib41.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.5.5.1" style="font-size:90%;">Narayan et al. [2018a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.7.1" style="font-size:90%;">
Shashi Narayan, Shay B. Cohen, and Mirella Lapata.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.8.1" style="font-size:90%;">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.9.1" style="font-size:90%;">In Ellen Riloff, David Chiang, Julia Hockenmaier, and Jun’ichi Tsujii, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib42.10.2" style="font-size:90%;">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib42.11.3" style="font-size:90%;">, pages 1797–1807, Brussels, Belgium, October-November 2018a. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/D18-1206</span><span class="ltx_text" id="bib.bib42.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D18-1206" style="font-size:90%;" title="">https://aclanthology.org/D18-1206</a><span class="ltx_text" id="bib.bib42.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.5.5.1" style="font-size:90%;">Narayan et al. [2018b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.7.1" style="font-size:90%;">
Shashi Narayan, Shay B. Cohen, and Mirella Lapata.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.8.1" style="font-size:90%;">Don’t give me the details, just the summary! Topic-aware convolutional neural networks for extreme summarization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib43.10.2" style="font-size:90%;">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib43.11.3" style="font-size:90%;">, Brussels, Belgium, 2018b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.5.5.1" style="font-size:90%;">Olsson et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.7.1" style="font-size:90%;">
Catherine Olsson, Nelson Elhage, Neel Nanda, Nicholas Joseph, Nova DasSarma, Tom Henighan, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.8.1" style="font-size:90%;">In-context learning and induction heads.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.9.1" style="font-size:90%;">arXiv preprint arXiv:2209.11895</em><span class="ltx_text" id="bib.bib44.10.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.4.4.1" style="font-size:90%;">OpenAI [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.6.1" style="font-size:90%;">
OpenAI.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.7.1" style="font-size:90%;">GPT-4 technical report.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.8.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib45.9.2" style="font-size:90%;">, abs/2303.08774, 2023.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.10.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.48550/arXiv.2303.08774</span><span class="ltx_text" id="bib.bib45.11.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.5.5.1" style="font-size:90%;">Ouyang et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.7.1" style="font-size:90%;">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.8.1" style="font-size:90%;">Training language models to follow instructions with human feedback.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib46.10.2" style="font-size:90%;">, 35:27730–27744, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.5.5.1" style="font-size:90%;">Pal et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.7.1" style="font-size:90%;">
Ankit Pal, Logesh Kumar Umapathi, and Malaikannan Sankarasubbu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.8.1" style="font-size:90%;">Medmcqa: A large-scale multi-subject multi-choice dataset for medical domain question answering.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.9.1" style="font-size:90%;">In Gerardo Flores, George H Chen, Tom Pollard, Joyce C Ho, and Tristan Naumann, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib47.10.2" style="font-size:90%;">Proceedings of the Conference on Health, Inference, and Learning</em><span class="ltx_text" id="bib.bib47.11.3" style="font-size:90%;">, volume 174 of </span><em class="ltx_emph ltx_font_italic" id="bib.bib47.12.4" style="font-size:90%;">Proceedings of Machine Learning Research</em><span class="ltx_text" id="bib.bib47.13.5" style="font-size:90%;">, pages 248–260. PMLR, 07–08 Apr 2022.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v174/pal22a.html" style="font-size:90%;" title="">https://proceedings.mlr.press/v174/pal22a.html</a><span class="ltx_text" id="bib.bib47.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.5.5.1" style="font-size:90%;">Patel et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.7.1" style="font-size:90%;">
Arkil Patel, Satwik Bhattamishra, and Navin Goyal.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.8.1" style="font-size:90%;">Are NLP models really able to solve simple math word problems?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib48.10.2" style="font-size:90%;">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em><span class="ltx_text" id="bib.bib48.11.3" style="font-size:90%;">, pages 2080–2094, Online, June 2021. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2021.naacl-main.168</span><span class="ltx_text" id="bib.bib48.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.naacl-main.168" style="font-size:90%;" title="">https://aclanthology.org/2021.naacl-main.168</a><span class="ltx_text" id="bib.bib48.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.5.5.1" style="font-size:90%;">Peng et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.7.1" style="font-size:90%;">
Baolin Peng, Chunyuan Li, Pengcheng He, Michel Galley, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.8.1" style="font-size:90%;">Instruction tuning with gpt-4.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.9.1" style="font-size:90%;">arXiv preprint arXiv:2304.03277</em><span class="ltx_text" id="bib.bib49.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib50.5.5.1" style="font-size:90%;">Petroni et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.7.1" style="font-size:90%;">
Fabio Petroni, Tim Rocktäschel, Sebastian Riedel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, and Alexander Miller.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.8.1" style="font-size:90%;">Language models as knowledge bases?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.9.1" style="font-size:90%;">In Kentaro Inui, Jing Jiang, Vincent Ng, and Xiaojun Wan, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib50.10.2" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em><span class="ltx_text" id="bib.bib50.11.3" style="font-size:90%;">, pages 2463–2473, Hong Kong, China, November 2019. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/D19-1250</span><span class="ltx_text" id="bib.bib50.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D19-1250" style="font-size:90%;" title="">https://aclanthology.org/D19-1250</a><span class="ltx_text" id="bib.bib50.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib51.5.5.1" style="font-size:90%;">Qi et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.7.1" style="font-size:90%;">
Xiangyu Qi, Yi Zeng, Tinghao Xie, Pin-Yu Chen, Ruoxi Jia, Prateek Mittal, and Peter Henderson.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.8.1" style="font-size:90%;">Fine-tuning aligned language models compromises safety, even when users do not intend to!
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.9.1" style="font-size:90%;">arXiv preprint arXiv:2310.03693</em><span class="ltx_text" id="bib.bib51.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib52.5.5.1" style="font-size:90%;">Qiu et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.7.1" style="font-size:90%;">
Pengcheng Qiu, Chaoyi Wu, Xiaoman Zhang, Weixiong Lin, Haicheng Wang, Ya Zhang, Yanfeng Wang, and Weidi Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.8.1" style="font-size:90%;">Towards building multilingual language model for medicine.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.9.1" style="font-size:90%;">arXiv preprint arXiv:2402.13963</em><span class="ltx_text" id="bib.bib52.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib53.5.5.1" style="font-size:90%;">Rajbhandari et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.7.1" style="font-size:90%;">
Samyam Rajbhandari, Jeff Rasley, Olatunji Ruwase, and Yuxiong He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.8.1" style="font-size:90%;">Zero: Memory optimizations toward training trillion parameter models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib53.10.2" style="font-size:90%;">SC20: International Conference for High Performance Computing, Networking, Storage and Analysis</em><span class="ltx_text" id="bib.bib53.11.3" style="font-size:90%;">, pages 1–16. IEEE, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib54.5.5.1" style="font-size:90%;">Rajpurkar et al. [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.7.1" style="font-size:90%;">
Pranav Rajpurkar, Robin Jia, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.8.1" style="font-size:90%;">Know what you don’t know: Unanswerable questions for SQuAD.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.9.1" style="font-size:90%;">In Iryna Gurevych and Yusuke Miyao, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib54.10.2" style="font-size:90%;">Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers)</em><span class="ltx_text" id="bib.bib54.11.3" style="font-size:90%;">, pages 784–789, Melbourne, Australia, July 2018. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/P18-2124</span><span class="ltx_text" id="bib.bib54.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P18-2124" style="font-size:90%;" title="">https://aclanthology.org/P18-2124</a><span class="ltx_text" id="bib.bib54.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib55.5.5.1" style="font-size:90%;">Ramachandran et al. [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.7.1" style="font-size:90%;">
Prajit Ramachandran, Barret Zoph, and Quoc V. Le.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.8.1" style="font-size:90%;">Searching for activation functions, 2018.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.9.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SkBYYyZRZ" style="font-size:90%;" title="">https://openreview.net/forum?id=SkBYYyZRZ</a><span class="ltx_text" id="bib.bib55.10.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib56.5.5.1" style="font-size:90%;">Roberts et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.7.1" style="font-size:90%;">
Adam Roberts, Colin Raffel, and Noam Shazeer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.8.1" style="font-size:90%;">How much knowledge can you pack into the parameters of a language model?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.9.1" style="font-size:90%;">In Bonnie Webber, Trevor Cohn, Yulan He, and Yang Liu, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib56.10.2" style="font-size:90%;">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em><span class="ltx_text" id="bib.bib56.11.3" style="font-size:90%;">, pages 5418–5426, Online, November 2020. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2020.emnlp-main.437</span><span class="ltx_text" id="bib.bib56.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.emnlp-main.437" style="font-size:90%;" title="">https://aclanthology.org/2020.emnlp-main.437</a><span class="ltx_text" id="bib.bib56.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib57.4.4.1" style="font-size:90%;">RyokoAI [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.6.1" style="font-size:90%;">
RyokoAI.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.7.1" style="font-size:90%;">ShareGPT52K Dataset.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/RyokoAI/ShareGPT52K" style="font-size:90%;" title="">https://huggingface.co/datasets/RyokoAI/ShareGPT52K</a><span class="ltx_text" id="bib.bib57.8.1" style="font-size:90%;">, 2023.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.9.1" style="font-size:90%;">Accessed: 2024-05-21.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib58.4.4.1" style="font-size:90%;">Shazeer [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.6.1" style="font-size:90%;">
Noam Shazeer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.7.1" style="font-size:90%;">Glu variants improve transformer.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.8.1" style="font-size:90%;">arXiv preprint arXiv:2002.05202</em><span class="ltx_text" id="bib.bib58.9.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib59.5.5.1" style="font-size:90%;">Shi et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.7.1" style="font-size:90%;">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Rich James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.8.1" style="font-size:90%;">Replug: Retrieval-augmented black-box language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.9.1" style="font-size:90%;">arXiv preprint arXiv:2301.12652</em><span class="ltx_text" id="bib.bib59.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib60.5.5.1" style="font-size:90%;">Speer et al. [2017]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.7.1" style="font-size:90%;">
Robyn Speer, Joshua Chin, and Catherine Havasi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.8.1" style="font-size:90%;">Conceptnet 5.5: An open multilingual graph of general knowledge.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib60.10.2" style="font-size:90%;">Proceedings of the AAAI conference on artificial intelligence</em><span class="ltx_text" id="bib.bib60.11.3" style="font-size:90%;">, volume 31, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib61.5.5.1" style="font-size:90%;">Su et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.7.1" style="font-size:90%;">
Jianlin Su, Murtadha Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.8.1" style="font-size:90%;">Roformer: Enhanced transformer with rotary position embedding.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib61.9.1" style="font-size:90%;">Neurocomputing</em><span class="ltx_text" id="bib.bib61.10.2" style="font-size:90%;">, 568:127063, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib62.5.5.1" style="font-size:90%;">Suzgun et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.7.1" style="font-size:90%;">
Mirac Suzgun, Nathan Scales, Nathanael Schärli, Sebastian Gehrmann, Yi Tay, Hyung Won Chung, Aakanksha Chowdhery, Quoc V Le, Ed H Chi, Denny Zhou, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.8.1" style="font-size:90%;">Challenging big-bench tasks and whether chain-of-thought can solve them.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.9.1" style="font-size:90%;">arXiv preprint arXiv:2210.09261</em><span class="ltx_text" id="bib.bib62.10.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib63.5.5.1" style="font-size:90%;">Talmor et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.7.1" style="font-size:90%;">
Alon Talmor, Jonathan Herzig, Nicholas Lourie, and Jonathan Berant.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.8.1" style="font-size:90%;">CommonsenseQA: A question answering challenge targeting commonsense knowledge.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.9.1" style="font-size:90%;">In Jill Burstein, Christy Doran, and Thamar Solorio, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib63.10.2" style="font-size:90%;">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)</em><span class="ltx_text" id="bib.bib63.11.3" style="font-size:90%;">, pages 4149–4158, Minneapolis, Minnesota, June 2019. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/N19-1421</span><span class="ltx_text" id="bib.bib63.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/N19-1421" style="font-size:90%;" title="">https://aclanthology.org/N19-1421</a><span class="ltx_text" id="bib.bib63.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib64.5.5.1" style="font-size:90%;">Toshniwal et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.7.1" style="font-size:90%;">
Shubham Toshniwal, Ivan Moshkov, Sean Narenthiran, Daria Gitman, Fei Jia, and Igor Gitman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.8.1" style="font-size:90%;">Openmathinstruct-1: A 1.8 million math instruction tuning dataset.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.9.1" style="font-size:90%;">arXiv preprint arXiv: Arxiv-2402.10176</em><span class="ltx_text" id="bib.bib64.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib65.5.5.1" style="font-size:90%;">Touvron et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.7.1" style="font-size:90%;">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.8.1" style="font-size:90%;">Llama: Open and efficient foundation language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib65.9.1" style="font-size:90%;">arXiv preprint arXiv:2302.13971</em><span class="ltx_text" id="bib.bib65.10.2" style="font-size:90%;">, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib66.5.5.1" style="font-size:90%;">Touvron et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.7.1" style="font-size:90%;">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.8.1" style="font-size:90%;">Llama 2: Open foundation and fine-tuned chat models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.9.1" style="font-size:90%;">arXiv preprint arXiv:2307.09288</em><span class="ltx_text" id="bib.bib66.10.2" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib67.5.5.1" style="font-size:90%;">Wang et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.7.1" style="font-size:90%;">
Ruida Wang, Wangchunshu Zhou, and Mrinmaya Sachan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.8.1" style="font-size:90%;">Let’s synthesize step by step: Iterative dataset synthesis with large language models by extrapolating errors from small models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.9.1" style="font-size:90%;">In Houda Bouamor, Juan Pino, and Kalika Bali, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib67.10.2" style="font-size:90%;">Findings of the Association for Computational Linguistics: EMNLP 2023</em><span class="ltx_text" id="bib.bib67.11.3" style="font-size:90%;">, pages 11817–11831, Singapore, December 2023a. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2023.findings-emnlp.791</span><span class="ltx_text" id="bib.bib67.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.findings-emnlp.791" style="font-size:90%;" title="">https://aclanthology.org/2023.findings-emnlp.791</a><span class="ltx_text" id="bib.bib67.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib68.5.5.1" style="font-size:90%;">Wang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.7.1" style="font-size:90%;">
Yihan Wang, Si Si, Daliang Li, Michal Lukasik, Felix Yu, Cho-Jui Hsieh, Inderjit S Dhillon, and Sanjiv Kumar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.8.1" style="font-size:90%;">Two-stage LLM fine-tuning with less specialization and more generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib68.10.2" style="font-size:90%;">The Twelfth International Conference on Learning Representations</em><span class="ltx_text" id="bib.bib68.11.3" style="font-size:90%;">, 2024.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.12.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=pCEgna6Qco" style="font-size:90%;" title="">https://openreview.net/forum?id=pCEgna6Qco</a><span class="ltx_text" id="bib.bib68.13.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib69.5.5.1" style="font-size:90%;">Wang et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.7.1" style="font-size:90%;">
Yizhong Wang, Swaroop Mishra, Pegah Alipoormolabashi, Yeganeh Kordi, Amirreza Mirzaei, Anjana Arunkumar, Arjun Ashok, Arut Selvan Dhanasekaran, Atharva Naik, David Stap, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.8.1" style="font-size:90%;">Super-naturalinstructions:generalization via declarative instructions on 1600+ tasks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib69.10.2" style="font-size:90%;">EMNLP</em><span class="ltx_text" id="bib.bib69.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib70.5.5.1" style="font-size:90%;">Wang et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.7.1" style="font-size:90%;">
Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A. Smith, Daniel Khashabi, and Hannaneh Hajishirzi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.8.1" style="font-size:90%;">Self-instruct: Aligning language models with self-generated instructions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.9.1" style="font-size:90%;">In Anna Rogers, Jordan Boyd-Graber, and Naoaki Okazaki, editors, </span><em class="ltx_emph ltx_font_italic" id="bib.bib70.10.2" style="font-size:90%;">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em><span class="ltx_text" id="bib.bib70.11.3" style="font-size:90%;">, pages 13484–13508, Toronto, Canada, July 2023b. Association for Computational Linguistics.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.12.1" style="font-size:90%;">doi: </span><span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self" style="font-size:90%;">10.18653/v1/2023.acl-long.754</span><span class="ltx_text" id="bib.bib70.13.2" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.14.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.754" style="font-size:90%;" title="">https://aclanthology.org/2023.acl-long.754</a><span class="ltx_text" id="bib.bib70.15.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib71.5.5.1" style="font-size:90%;">Wei et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.7.1" style="font-size:90%;">
Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.8.1" style="font-size:90%;">Finetuned language models are zero-shot learners.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib71.9.1" style="font-size:90%;">arXiv preprint arXiv:2109.01652</em><span class="ltx_text" id="bib.bib71.10.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib72.5.5.1" style="font-size:90%;">Wei et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.7.1" style="font-size:90%;">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.8.1" style="font-size:90%;">Chain-of-thought prompting elicits reasoning in large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib72.10.2" style="font-size:90%;">, 35:24824–24837, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib73.5.5.1" style="font-size:90%;">William et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.7.1" style="font-size:90%;">
Todt William, Babaei Ramtin, and Pedram Babaei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.8.1" style="font-size:90%;">Fin-llama: Efficient finetuning of quantized llms for finance.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Bavest/fin-llama" style="font-size:90%;" title="">https://github.com/Bavest/fin-llama</a><span class="ltx_text" id="bib.bib73.9.1" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib74.5.5.1" style="font-size:90%;">Wu et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.7.1" style="font-size:90%;">
Chaoyi Wu, Weixiong Lin, Xiaoman Zhang, Ya Zhang, Weidi Xie, and Yanfeng Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.8.1" style="font-size:90%;">Pmc-llama: toward building open-source language models for medicine.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib74.9.1" style="font-size:90%;">Journal of the American Medical Informatics Association</em><span class="ltx_text" id="bib.bib74.10.2" style="font-size:90%;">, page ocae045, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib75.5.5.1" style="font-size:90%;">Wu et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.7.1" style="font-size:90%;">
Xuansheng Wu, Wenlin Yao, Jianshu Chen, Xiaoman Pan, Xiaoyang Wang, Ninghao Liu, and Dong Yu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib75.8.1" style="font-size:90%;">From language modeling to instruction following: Understanding the behavior shift in llms after instruction tuning.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib75.9.1" style="font-size:90%;">arXiv preprint arXiv:2310.00492</em><span class="ltx_text" id="bib.bib75.10.2" style="font-size:90%;">, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib76.5.5.1" style="font-size:90%;">Wu et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.7.1" style="font-size:90%;">
Xun Wu, Shaohan Huang, and Furu Wei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.8.1" style="font-size:90%;">Mole: Mixture of lora experts.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib76.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib76.10.2" style="font-size:90%;">The Twelfth International Conference on Learning Representations</em><span class="ltx_text" id="bib.bib76.11.3" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib77.5.5.1" style="font-size:90%;">Yang et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.7.1" style="font-size:90%;">
Hongyang Yang, Xiao-Yang Liu, and Christina Dan Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib77.8.1" style="font-size:90%;">Fingpt: Open-source financial large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib77.9.1" style="font-size:90%;">arXiv preprint arXiv:2306.06031</em><span class="ltx_text" id="bib.bib77.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib78.5.5.1" style="font-size:90%;">Yang et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.7.1" style="font-size:90%;">
Zhaorui Yang, Qian Liu, Tianyu Pang, Han Wang, Haozhe Feng, Minfeng Zhu, and Wei Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib78.8.1" style="font-size:90%;">Self-distillation bridges distribution gap in language model fine-tuning.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib78.9.1" style="font-size:90%;">arXiv preprint arXiv:2402.13669</em><span class="ltx_text" id="bib.bib78.10.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib79.5.5.1" style="font-size:90%;">Ye et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.7.1" style="font-size:90%;">
Peng Ye, Yongqi Huang, Chongjun Tu, Minglei Li, Tao Chen, Tong He, and Wanli Ouyang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib79.8.1" style="font-size:90%;">Partial fine-tuning: A successor to full fine-tuning for vision transformers.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib79.9.1" style="font-size:90%;">arXiv preprint arXiv:2312.15681</em><span class="ltx_text" id="bib.bib79.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib80.5.5.1" style="font-size:90%;">Yu et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.7.1" style="font-size:90%;">
Le Yu, Bowen Yu, Haiyang Yu, Fei Huang, and Yongbin Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib80.8.1" style="font-size:90%;">Language models are super mario: Absorbing abilities from homologous models as a free lunch.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib80.9.1" style="font-size:90%;">arXiv preprint arXiv:2311.03099</em><span class="ltx_text" id="bib.bib80.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib81.4.4.1" style="font-size:90%;">Yu [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.6.1" style="font-size:90%;">
YangMu Yu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib81.7.1" style="font-size:90%;">Cornucopia-llama-fin-chinese.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/jerry1993-tech/Cornucopia-LLaMA-Fin-Chinese" style="font-size:90%;" title="">https://github.com/jerry1993-tech/Cornucopia-LLaMA-Fin-Chinese</a><span class="ltx_text" id="bib.bib81.8.1" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib82.5.5.1" style="font-size:90%;">Yuan et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.7.1" style="font-size:90%;">
Zheng Yuan, Hongyi Yuan, Chengpeng Li, Guanting Dong, Chuanqi Tan, and Chang Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib82.8.1" style="font-size:90%;">Scaling relationship on learning mathematical reasoning with large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib82.9.1" style="font-size:90%;">arXiv preprint arXiv:2308.01825</em><span class="ltx_text" id="bib.bib82.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib83.5.5.1" style="font-size:90%;">Yue et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.7.1" style="font-size:90%;">
Xiang Yue, Xingwei Qu, Ge Zhang, Yao Fu, Wenhao Huang, Huan Sun, Yu Su, and Wenhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib83.8.1" style="font-size:90%;">Mammoth: Building math generalist models through hybrid instruction tuning.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib83.9.1" style="font-size:90%;">arXiv preprint arXiv:2309.05653</em><span class="ltx_text" id="bib.bib83.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib84.5.5.1" style="font-size:90%;">Yun et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.7.1" style="font-size:90%;">
Chulhee Yun, Srinadh Bhojanapalli, Ankit Singh Rawat, Sashank J. Reddi, and Sanjiv Kumar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.8.1" style="font-size:90%;">Are transformers universal approximators of sequence-to-sequence functions?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib84.10.2" style="font-size:90%;">The Eighth International Conference on Learning Representations</em><span class="ltx_text" id="bib.bib84.11.3" style="font-size:90%;">, 2019.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib84.12.1" style="font-size:90%;">URL </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1912.10077" style="font-size:90%;" title="">http://arxiv.org/abs/1912.10077</a><span class="ltx_text" id="bib.bib84.13.2" style="font-size:90%;">.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib85.5.5.1" style="font-size:90%;">Zhang et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.7.1" style="font-size:90%;">
Shengyu Zhang, Linfeng Dong, Xiaoya Li, Sen Zhang, Xiaofei Sun, Shuhe Wang, Jiwei Li, Runyi Hu, Tianwei Zhang, Fei Wu, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib85.8.1" style="font-size:90%;">Instruction tuning for large language models: A survey.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.9.1" style="font-size:90%;">arXiv preprint arXiv:2308.10792</em><span class="ltx_text" id="bib.bib85.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib86.5.5.1" style="font-size:90%;">Zhou et al. [2024]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib86.7.1" style="font-size:90%;">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srinivasan Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib86.8.1" style="font-size:90%;">Lima: Less is more for alignment.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib86.9.1" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib86.10.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A0.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A0.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="506" id="A0.F5.sf1.g1" src="x9.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A0.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A0.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="505" id="A0.F5.sf2.g1" src="x10.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A0.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A0.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="A0.F5.4.2" style="font-size:90%;">(a) The performance of LLMs fine-tuned with three specific downstream datasets on C-Eval and (b) the cosine similarity distribution of the hidden layer. The cosine similarity is calculated as the average distance between the output hidden state of three fine-tuned models. <span class="ltx_text ltx_font_smallcaps" id="A0.F5.4.2.1">TAIA</span> achieves the best performance on C-Eval and has the most consistent hidden state among the three cases.</span></figcaption>
</figure>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Future Work</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1"><span class="ltx_text ltx_font_smallcaps" id="A1.p1.1.1">TAIA</span> has succeeded in harnessing OOD data for fine-tuning LLMs, reducing substantial reliance on in-domain data.
To improve this generalization, there are two main directions to expand this adaptability.
Firstly, we hope to find a minimal set of trainable parameters to guarantee sufficient parameter exploration while reducing distribution aliasing.
Just as Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.F3" title="Figure 3 ‣ 3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a> shows, LLMs tuned with <math alttext="[0,18)" class="ltx_Math" display="inline" id="A1.p1.1.m1.2"><semantics id="A1.p1.1.m1.2a"><mrow id="A1.p1.1.m1.2.3.2" xref="A1.p1.1.m1.2.3.1.cmml"><mo id="A1.p1.1.m1.2.3.2.1" stretchy="false" xref="A1.p1.1.m1.2.3.1.cmml">[</mo><mn id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">0</mn><mo id="A1.p1.1.m1.2.3.2.2" xref="A1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A1.p1.1.m1.2.2" xref="A1.p1.1.m1.2.2.cmml">18</mn><mo id="A1.p1.1.m1.2.3.2.3" stretchy="false" xref="A1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.2b"><interval closure="closed-open" id="A1.p1.1.m1.2.3.1.cmml" xref="A1.p1.1.m1.2.3.2"><cn id="A1.p1.1.m1.1.1.cmml" type="integer" xref="A1.p1.1.m1.1.1">0</cn><cn id="A1.p1.1.m1.2.2.cmml" type="integer" xref="A1.p1.1.m1.2.2">18</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.2c">[0,18)</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.2d">[ 0 , 18 )</annotation></semantics></math> layers of FFN gain higher performance than vanilla fine-tuning with <span class="ltx_text ltx_font_smallcaps" id="A1.p1.1.2">TAIA</span> method.
Coupled with this observation, it is possible to reduce knowledge overlaps between pretrained parameters and downstream ones through a fine-grained selection of tunable parameters.
Secondly, an adaptive parameter maintenance strategy instead of the coarse separation of FFN modules can both improve the generalization of LLMs as well as the adaptation of LLMs on knowledge-intensive tasks.
We hope our work can provide inspiration on how to improve the parameter utilization of LLMs to adapt to universal distribution datasets.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Limitations</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Our experiments are conducted based on the assumption that LLMs have gathered certain task knowledge but cannot well utilize it.
In tasks like summarization <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib42" title=""><span class="ltx_text" style="font-size:90%;">42</span></a>]</cite> or reading comprehension <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib54" title=""><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite>, <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.1">TAIA</span> still needs to learn the task knowledge except for instruction following.
We follow the same experiment setting as §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.SS2" title="4.2 Experiment Details ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a> and use the XSum <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib42" title=""><span class="ltx_text" style="font-size:90%;">42</span></a>]</cite> training set and SQuAD v2.0 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib54" title=""><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite> training set to fine-tune both 1.8B and 7B sizes of Qwen1.5 models.
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A3.T6" title="Table 6 ‣ Appendix C Broader Impact ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">6</span></a> shows that <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.2">TAIA</span> is inferior to the vanilla fine-tuning method when it is unfamiliar with the downstream knowledge.
However, the gap is relatively small (0.7 on SQuAD and 3.21 R-L on XSum on 1.8b scale model), and <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.3">TAIA</span> reverses such gap in 7B LLM in SQuAD v2.0 (-0.7<math alttext="\rightarrow" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mo id="A2.p1.1.m1.1.1" stretchy="false" xref="A2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">→</annotation></semantics></math>+1.38). For the performance on XSum, it is believed that the model needs to learn specific domain knowledge, such as writing style and word usage preferences, to achieve greater overlap with the reference and thus obtain a higher Rouge score. This shows that <span class="ltx_text ltx_font_smallcaps" id="A2.p1.1.4">TAIA</span> is still applicable to unfamiliar tasks and is significantly suitable for well-pretrained LLMs with sufficient domain knowledge.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Broader Impact</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1"><span class="ltx_text ltx_font_smallcaps" id="A3.p1.1.1">TAIA</span> is designed to optimize the fine-tuned LLMs on downstream tasks after tuning on OOD data, by removing the tuned FFN parameters after the normal fine-tuning process.
The potential positive implications imply lower difficulty in applying LLM on data-limited domains, including finance or healthcare, thus increasing the accessibility of LLMs on these scenarios.
<span class="ltx_text ltx_font_smallcaps" id="A3.p1.1.2">TAIA</span> also makes positive impacts on strengthening the safety and helpfulness of fine-tuned LLMs, and thus brings positive social benefits.
Moreover, <span class="ltx_text ltx_font_smallcaps" id="A3.p1.1.3">TAIA</span> does not introduce additional costs and is deployment-friendly.
As such, we do not foresee any immediate negative ethical or societal consequences stemming from our work that are different from those that apply to enabling LLMs with OOD generalization capability.</p>
</div>
<figure class="ltx_table" id="A3.T6">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6: </span>Experiments on two tasks whose knowledge is not fully acquired by base LLMs. <span class="ltx_text ltx_font_smallcaps" id="A3.T6.8.1">TAIA</span> lags behind vanilla fine-tuning methods by a small margin for Qwen1.5-1.8B. However, for the base model with sufficient knowledge like Qwen1.5-7B, <span class="ltx_text ltx_font_smallcaps" id="A3.T6.9.2">TAIA</span> surpasses the vanilla fine-tuning methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T6.10">
<tr class="ltx_tr" id="A3.T6.10.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T6.10.1.1"><span class="ltx_text ltx_font_bold" id="A3.T6.10.1.1.1" style="font-size:90%;">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T6.10.1.2"><span class="ltx_text ltx_font_bold" id="A3.T6.10.1.2.1" style="font-size:90%;">Training Data</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T6.10.1.3"><span class="ltx_text ltx_font_bold" id="A3.T6.10.1.3.1" style="font-size:90%;">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T6.10.1.4"><span class="ltx_text ltx_font_bold" id="A3.T6.10.1.4.1" style="font-size:90%;">SQuAD v2.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T6.10.1.5"><span class="ltx_text ltx_font_bold" id="A3.T6.10.1.5.1" style="font-size:90%;">XSum (R-1/R-2/R-L)</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.2">
<td class="ltx_td ltx_border_t" id="A3.T6.10.2.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.2.2"><span class="ltx_text" id="A3.T6.10.2.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.2.3"><span class="ltx_text" id="A3.T6.10.2.3.1" style="font-size:90%;">Base Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.2.4"><span class="ltx_text" id="A3.T6.10.2.4.1" style="font-size:90%;">84.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.2.5"><span class="ltx_text" id="A3.T6.10.2.5.1" style="font-size:90%;">14.76/3.35/10.05</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.3">
<td class="ltx_td" id="A3.T6.10.3.1"></td>
<td class="ltx_td ltx_border_t" id="A3.T6.10.3.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.3.3"><span class="ltx_text" id="A3.T6.10.3.3.1" style="font-size:90%;">Vanilla</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.3.4"><span class="ltx_text ltx_font_bold" id="A3.T6.10.3.4.1" style="font-size:90%;">91.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.3.5"><span class="ltx_text" id="A3.T6.10.3.5.1" style="font-size:90%;">14.06/2.05/11.36</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.4">
<td class="ltx_td" id="A3.T6.10.4.1"></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.4.2"><span class="ltx_text" id="A3.T6.10.4.2.1" style="font-size:90%;">SQuAD v2.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.10.4.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.4.3.1" style="font-size:90%;background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.4.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.4.4.1" style="font-size:90%;background-color:#E6E6E6;">91.00</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.4.5" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A3.T6.10.4.5.1" style="font-size:90%;background-color:#E6E6E6;">18.88/3.73/12.94</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.5">
<td class="ltx_td" id="A3.T6.10.5.1"></td>
<td class="ltx_td ltx_border_t" id="A3.T6.10.5.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.5.3"><span class="ltx_text" id="A3.T6.10.5.3.1" style="font-size:90%;">Vanilla</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.5.4"><span class="ltx_text" id="A3.T6.10.5.4.1" style="font-size:90%;">72.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.5.5"><span class="ltx_text ltx_font_bold" id="A3.T6.10.5.5.1" style="font-size:90%;">34.26/13.04/27.48</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.6">
<td class="ltx_td ltx_align_center" id="A3.T6.10.6.1"><span class="ltx_text" id="A3.T6.10.6.1.1" style="font-size:90%;">Qwen1.5-1.8B</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.6.2"><span class="ltx_text" id="A3.T6.10.6.2.1" style="font-size:90%;">XSum</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.10.6.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.6.3.1" style="font-size:90%;background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.6.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A3.T6.10.6.4.1" style="font-size:90%;background-color:#E6E6E6;">78.48</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.6.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.6.5.1" style="font-size:90%;background-color:#E6E6E6;">31.32/10.51/24.27</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.7">
<td class="ltx_td ltx_border_t" id="A3.T6.10.7.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.7.2"><span class="ltx_text" id="A3.T6.10.7.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.7.3"><span class="ltx_text" id="A3.T6.10.7.3.1" style="font-size:90%;">Base Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.7.4"><span class="ltx_text" id="A3.T6.10.7.4.1" style="font-size:90%;">92.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.7.5"><span class="ltx_text" id="A3.T6.10.7.5.1" style="font-size:90%;">21.90/6.17/15.17</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.8">
<td class="ltx_td" id="A3.T6.10.8.1"></td>
<td class="ltx_td ltx_border_t" id="A3.T6.10.8.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.8.3"><span class="ltx_text" id="A3.T6.10.8.3.1" style="font-size:90%;">Vanilla</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.8.4"><span class="ltx_text" id="A3.T6.10.8.4.1" style="font-size:90%;">93.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.8.5"><span class="ltx_text" id="A3.T6.10.8.5.1" style="font-size:90%;">16.75/2.65/13.15</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.9">
<td class="ltx_td" id="A3.T6.10.9.1"></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.9.2"><span class="ltx_text" id="A3.T6.10.9.2.1" style="font-size:90%;">SQuAD v2.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.10.9.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.9.3.1" style="font-size:90%;background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.9.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A3.T6.10.9.4.1" style="font-size:90%;background-color:#E6E6E6;">95.27</span></td>
<td class="ltx_td ltx_align_center" id="A3.T6.10.9.5" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A3.T6.10.9.5.1" style="font-size:90%;background-color:#E6E6E6;">25.58/7.66/19.79</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.10">
<td class="ltx_td" id="A3.T6.10.10.1"></td>
<td class="ltx_td ltx_border_t" id="A3.T6.10.10.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.10.10.3"><span class="ltx_text" id="A3.T6.10.10.3.1" style="font-size:90%;">Vanilla</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.10.4"><span class="ltx_text" id="A3.T6.10.10.4.1" style="font-size:90%;">77.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.10.10.5"><span class="ltx_text ltx_font_bold" id="A3.T6.10.10.5.1" style="font-size:90%;">42.23/19.99/34.78</span></td>
</tr>
<tr class="ltx_tr" id="A3.T6.10.11">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T6.10.11.1"><span class="ltx_text" id="A3.T6.10.11.1.1" style="font-size:90%;">Qwen1.5-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T6.10.11.2"><span class="ltx_text" id="A3.T6.10.11.2.1" style="font-size:90%;">XSum</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T6.10.11.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.11.3.1" style="font-size:90%;background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T6.10.11.4" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A3.T6.10.11.4.1" style="font-size:90%;background-color:#E6E6E6;">81.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T6.10.11.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A3.T6.10.11.5.1" style="font-size:90%;background-color:#E6E6E6;">38.51/16.49/31.02</span></td>
</tr>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Related Work</h2>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Supervised Fine-tuning</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p1.1">Supervised Fine-tuning (SFT) is a general methodology to adapt base Large language models (LLM) to downstream tasks and specific domains.
By constructing instruction-input-output pairs on target tasks and training base LLMs on such training data with maximum log-likelihood, open-sourced LLMs pretrained on web data can adapt to various domains via zero-shot or few-shot prompting, including medical <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib74" title=""><span class="ltx_text" style="font-size:90%;">74</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">9</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>, programming <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib38" title=""><span class="ltx_text" style="font-size:90%;">38</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">28</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>, finance <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib77" title=""><span class="ltx_text" style="font-size:90%;">77</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib73" title=""><span class="ltx_text" style="font-size:90%;">73</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib81" title=""><span class="ltx_text" style="font-size:90%;">81</span></a>]</cite>, and math word problems (MWP) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib83" title=""><span class="ltx_text" style="font-size:90%;">83</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib82" title=""><span class="ltx_text" style="font-size:90%;">82</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite>.
Due to the large scale of such domain-specific data, fine-tuning the whole large language model is costly; therefore, parameter-efficient fine-tuning (PEFT) is proposed to achieve comparable downstream performances with negligible fine-tuning consumption.
Among PEFT methods, Low-rank Adaption (LoRA)<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>]</cite> and its variants DoRA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite> are the most successful, introducing two trainable low-rank adapters and significantly saving training resources without imposing inference latency</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Challenges and Limitations of Fine-tuning</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px2.p1.1">Fine-tuning is a straightforward method for adapting LLMs to various downstream tasks, but it incurs several significant drawbacks, including hallucination, harmfulness, catastrophic forgetting, and safety concerns.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Gekhman et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite> indicated that fine-tuning instructs the model to produce factually inaccurate responses, as the training process encourages the generation of information not anchored in its pre-existing knowledge base.
Furthermore, supervised fine-tuning for specific tasks often results in catastrophic forgetting of the initial alignment <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> and creates trade-offs between helpfulness and harmlessness <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>.
Additionally, <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Kumar et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite> highlighted that fine-tuning significantly reduces the resistance of LLMs to jailbreaking, thereby increasing their vulnerability.
<cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Qi et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib51" title=""><span class="ltx_text" style="font-size:90%;">51</span></a>]</cite> also demonstrated that even when benign fine-tuning datasets are used, well-aligned LLMs inevitably become more unsafe and harmful, not to mention the issues arising from red-teaming tuning data.
In contrast, <span class="ltx_text ltx_font_smallcaps" id="A4.SS0.SSS0.Px2.p1.1.1">TAIA</span> can significantly mitigate these drawbacks while still enhancing helpfulness through fine-tuning. By focusing on the intrinsic properties of fine-tuning and developing an inference-time method that leverages only beneficial self-attention updates, <span class="ltx_text ltx_font_smallcaps" id="A4.SS0.SSS0.Px2.p1.1.2">TAIA</span> provides a robust solution to the challenges posed by traditional fine-tuning approaches.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Experiment Details</h2>
<section class="ltx_subsection" id="A5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>PEFT Settings</h3>
<div class="ltx_para" id="A5.SS1.p1">
<p class="ltx_p" id="A5.SS1.p1.1">For LoRA method, we add a LoRA module for each linear layer except the language model head and embedding layer, resulting in the following target modules: <span class="ltx_text ltx_font_typewriter" id="A5.SS1.p1.1.1">[q_proj, k_proj, v_proj, o_proj, gate_proj, up_proj, down_proj]</span>.
For MoLoRA method, we add a vanilla LoRA module for each linear layer in attention modules and an MoLoRA module for each linear layer in FFN modules.
This results in the following attention targets: <span class="ltx_text ltx_font_typewriter" id="A5.SS1.p1.1.2">[q_proj, k_proj, v_proj, o_proj]</span> and FFN targets: <span class="ltx_text ltx_font_typewriter" id="A5.SS1.p1.1.3">[gate_proj, up_proj, down_proj]</span>, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Test Sets Description</h3>
<div class="ltx_para" id="A5.SS2.p1">
<p class="ltx_p" id="A5.SS2.p1.1">We here describe the used seven evaluation sets:</p>
<ol class="ltx_enumerate" id="A5.I1">
<li class="ltx_item" id="A5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A5.I1.i1.p1">
<p class="ltx_p" id="A5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i1.p1.1.1">MATH</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> is a collection of challenging competition mathematics problems containing 5,000 problems in the test set. Each problem in MATH has a full step-by-step solution which can be used to teach models to generate answer derivations and explanations.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A5.I1.i2.p1">
<p class="ltx_p" id="A5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i2.p1.1.1">BIG-Bench Hard</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib62" title=""><span class="ltx_text" style="font-size:90%;">62</span></a>]</cite> (BBH) is a collection of 23 challenging tasks from BIG-Bench. The 6,511 problems are the tasks for which prior language model evaluations did not outperform the average human-rater.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A5.I1.i3.p1">
<p class="ltx_p" id="A5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i3.p1.1.1">CommonsenseQA</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib63" title=""><span class="ltx_text" style="font-size:90%;">63</span></a>]</cite> is to test models’ ability to answer questions using only the parameterized knowledge instead of the context knowledge. It contains 1,000 problems sourced from ConceptNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib60" title=""><span class="ltx_text" style="font-size:90%;">60</span></a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="A5.I1.i4.p1">
<p class="ltx_p" id="A5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i4.p1.1.1">LogiQA</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite> collects questions about natural language inference (NLI) and requires models to infer the conclusion based on provided premises. It contains 653 problems for both English and Chinese subsets.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="A5.I1.i5.p1">
<p class="ltx_p" id="A5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i5.p1.1.1">SVAMP</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a>]</cite> are much simpler datasets compared to MATH, which both test models’ math problem-solving ability. It contains 1,221 problems which are all solvable with one or two simple equations.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="A5.I1.i6.p1">
<p class="ltx_p" id="A5.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i6.p1.1.1">MMedBench</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a>]</cite> contains test sets written in six languages for testing models’ capability in healthcare. Its English subset contains 1,273 problems and its Chinese subset contains 3,426 problems. We use MMB./MMed EN and MMed ZH indicates the English and Chinese subset, respectively.</p>
</div>
</li>
<li class="ltx_item" id="A5.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="A5.I1.i7.p1">
<p class="ltx_p" id="A5.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I1.i7.p1.1.1">MMLU</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> is to measure LLM’s multitask accuracy, which contains 14,421 problems. The test covers 57 tasks including elementary mathematics, US history, computer science, law, and more. To attain high accuracy on this test, models must possess extensive world knowledge and problem-solving ability.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="A5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.3 </span>Fine-tuning Sets Description</h3>
<div class="ltx_para" id="A5.SS3.p1">
<ol class="ltx_enumerate" id="A5.I2">
<li class="ltx_item" id="A5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A5.I2.i1.p1">
<p class="ltx_p" id="A5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i1.p1.1.1">Bilingual Alpaca-GPT4</span> is a dataset composed of Alpaca-GPT4 and Alpaca-GPT4-Zh <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite>, which contains 104k sample data in total.</p>
</div>
</li>
<li class="ltx_item" id="A5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A5.I2.i2.p1">
<p class="ltx_p" id="A5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i2.p1.1.1">COT Collection</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite> is a dataset designed to induce Chain-of-Thought <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib72" title=""><span class="ltx_text" style="font-size:90%;">72</span></a>]</cite> capabilities into language models. While proprietary LLMs excel at generating Chain-of-Thoughts based on prompting, smaller LMs do not have this capability. Thus, by fine-tuning to generate Chain-of-Thoughts, it could acquire such abilities.</p>
</div>
</li>
<li class="ltx_item" id="A5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A5.I2.i3.p1">
<p class="ltx_p" id="A5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i3.p1.1.1">OpenMaths</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib64" title=""><span class="ltx_text" style="font-size:90%;">64</span></a>]</cite> is a math instruction tuning dataset with 1.8M problem-solution pairs generated using a permissively licensed Mixtral-8x7B model <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite>. The problems are from GSM8K <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite> and MATH <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> training subsets and the solutions are synthetically generated by allowing Mixtral model to use a mix of text reasoning and code blocks executed by Python interpreter.</p>
</div>
</li>
<li class="ltx_item" id="A5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="A5.I2.i4.p1">
<p class="ltx_p" id="A5.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i4.p1.1.1">Medical Collection</span> is a collection of bilingual medical multiple choice question answering data with Rational, composed of the Chinese and English subset of MMedBench <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a>]</cite>, CMExam <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, and a subset sampled from MedMCQA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib47" title=""><span class="ltx_text" style="font-size:90%;">47</span></a>]</cite>. It comprises a total of approximately 160k questions, with half in English and half in Chinese.</p>
</div>
</li>
<li class="ltx_item" id="A5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="A5.I2.i5.p1">
<p class="ltx_p" id="A5.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i5.p1.1.1">Xsum</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite> is a dataset for the evaluation of abstractive single-document summarization systems. The dataset consists of 226,711 news articles accompanied with a one-sentence summary. The articles are collected from BBC articles (2010 to 2017) and cover a wide variety of domains (e.g., News, Politics, Sports, Weather, Business, Technology, Science, Health, Family, Education, Entertainment and Arts).</p>
</div>
</li>
<li class="ltx_item" id="A5.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="A5.I2.i6.p1">
<p class="ltx_p" id="A5.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I2.i6.p1.1.1">SQuAD v2.0</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib54" title=""><span class="ltx_text" style="font-size:90%;">54</span></a>]</cite> is a collection of question-answer pairs derived from Wikipedia articles. In SQuAD v2.0, the correct answers to questions can be any sequence of tokens in the given text. SQuAD v2.0 combines the 100,000 questions in SQuAD1.1 with over 50,000 un-answerable questions written adversarially by crowd workers in forms that are similar to the answerable ones.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="A5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.4 </span>Evaluation Details</h3>
<div class="ltx_para" id="A5.SS4.p1">
<p class="ltx_p" id="A5.SS4.p1.1">Our evaluations contain different types of metrics, including Exact Match (EM) and Multiple Choice Accuracy (Acc).
For EM metric, we extract the contents followed by <span class="ltx_text ltx_font_typewriter" id="A5.SS4.p1.1.1">The answer is </span> to reduce evaluation biases.
For different datasets, we adopt different evaluation prompts after the original problem description:</p>
<ol class="ltx_enumerate" id="A5.I3">
<li class="ltx_item" id="A5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A5.I3.i1.p1">
<p class="ltx_p" id="A5.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I3.i1.p1.1.1">MATH</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite>, <span class="ltx_text ltx_font_bold" id="A5.I3.i1.p1.1.2">BIG-Bench Hard</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib62" title=""><span class="ltx_text" style="font-size:90%;">62</span></a>]</cite> (BBH), <span class="ltx_text ltx_font_bold" id="A5.I3.i1.p1.1.3">SVAMP</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a>]</cite>: <span class="ltx_text ltx_font_typewriter" id="A5.I3.i1.p1.1.4">Please format the final answer at the end of the response as: The answer is {answer}.</span></p>
</div>
</li>
<li class="ltx_item" id="A5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A5.I3.i2.p1">
<p class="ltx_p" id="A5.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I3.i2.p1.1.1">CommonsenseQA</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib63" title=""><span class="ltx_text" style="font-size:90%;">63</span></a>]</cite>: <span class="ltx_text ltx_font_typewriter" id="A5.I3.i2.p1.1.2">Let’s think step by step. Please format the final answer at the end of the response as: The answer is {answer}.</span></p>
</div>
</li>
<li class="ltx_item" id="A5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A5.I3.i3.p1">
<p class="ltx_p" id="A5.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A5.I3.i3.p1.1.1">LogiQA</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite>, <span class="ltx_text ltx_font_bold" id="A5.I3.i3.p1.1.2">MMedBench</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib52" title=""><span class="ltx_text" style="font-size:90%;">52</span></a>]</cite>, <span class="ltx_text ltx_font_bold" id="A5.I3.i3.p1.1.3">MMLU</span> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite>: <span class="ltx_text ltx_font_typewriter" id="A5.I3.i3.p1.1.4">Please answer with option letter directly, do not output other information.</span></p>
</div>
</li>
</ol>
<p class="ltx_p" id="A5.SS4.p1.2">We use greedy decoding to maintain that all results are reproducible.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.5 </span>Data Mixing Experiments</h3>
<div class="ltx_para" id="A5.SS5.p1">
<p class="ltx_p" id="A5.SS5.p1.1">We constructed synthetic mixed datasets to investigate the impact of different out-of-distribution (OOD) data ratios on the generalization of <span class="ltx_text ltx_font_smallcaps" id="A5.SS5.p1.1.1">TAIA</span>. We selected medical knowledge as the target domain and chose MMedBench as the in-domain data and test set. Additionally, we designed three different mixed data scenarios:
a) Mixing within the same domain. We selected CMExam <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, which also pertained to the medical domain, as the OOD data and maintained the mixed dataset size at 20k.
b) Mixing across different domains. We chose COT, from the general domain, as the OOD data and kept the mixed dataset size at 20k.
c) Mixing under a constant in-domain data size. We again selected COT as the OOD data, but this time we maintained the in-domain dataset size at 20k.</p>
</div>
<div class="ltx_para" id="A5.SS5.p2">
<p class="ltx_p" id="A5.SS5.p2.2">For the implementation of fine-tuning, we adopt mixture-of-LoRA (MoLoRA) with four experts in total and activate one of them for each token during inference. The rank <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS5.p2.1.m1.1"><semantics id="A5.SS5.p2.1.m1.1a"><mi id="A5.SS5.p2.1.m1.1.1" xref="A5.SS5.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS5.p2.1.m1.1b"><ci id="A5.SS5.p2.1.m1.1.1.cmml" xref="A5.SS5.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS5.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS5.p2.1.m1.1d">italic_α</annotation></semantics></math> of each LoRA in the miture-of-expert (MOE) is set to 16 and the scale factor <math alttext="r" class="ltx_Math" display="inline" id="A5.SS5.p2.2.m2.1"><semantics id="A5.SS5.p2.2.m2.1a"><mi id="A5.SS5.p2.2.m2.1.1" xref="A5.SS5.p2.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A5.SS5.p2.2.m2.1b"><ci id="A5.SS5.p2.2.m2.1.1.cmml" xref="A5.SS5.p2.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS5.p2.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="A5.SS5.p2.2.m2.1d">italic_r</annotation></semantics></math> is set to 32.
We test the 1.8b and 7b sizes of Qwen1.5, and the results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S0.F1" title="Figure 1 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1</span></a>. It is found that <span class="ltx_text ltx_font_smallcaps" id="A5.SS5.p2.2.1">TAIA</span> surpasses the base LLM in all cases, while TOA suffers from performance degradation as the OOD data proportion increases. Additionally, <span class="ltx_text ltx_font_smallcaps" id="A5.SS5.p2.2.2">TAIA</span> can utilize OOD data to a greater extent without being adversely affected by the shifted distribution, thereby reducing the model’s dependency on specialized domain datasets. This is particularly significant for tasks with limited data resources.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.6 </span>Layer-wise FFN Fine-tuning Experiments</h3>
<div class="ltx_para" id="A5.SS6.p1">
<p class="ltx_p" id="A5.SS6.p1.4">Previous work has found that fine-tuning the FFN module can disrupt the knowledge encoded in the model and that fine-tuning the attention module can enhance the model’s ability to follow instructions.
However, we have discovered that without the assistance of the FFN, merely fine-tuning the attention module alone does not achieve the expected results.
To demonstrate this, we conducted experiments where all attention parameters were fine-tuned, while simultaneously fine-tuning FFN parameters at various positions and quantities to observe their impact on model performance. We choose the fine-tuning corpus mixture with 50 percent of OOD data used in the case (b) of the data mixing experiments in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5.SS5" title="E.5 Data Mixing Experiments ‣ Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">E.5</span></a>.
We designed seven experimental setups, including <math alttext="\{[0,6),[0,12),[0,18),[0,24),[6,24),[12,24),[18,24)\}" class="ltx_Math" display="inline" id="A5.SS6.p1.1.m1.21"><semantics id="A5.SS6.p1.1.m1.21a"><mrow id="A5.SS6.p1.1.m1.21.21.7" xref="A5.SS6.p1.1.m1.21.21.8.cmml"><mo id="A5.SS6.p1.1.m1.21.21.7.8" stretchy="false" xref="A5.SS6.p1.1.m1.21.21.8.cmml">{</mo><mrow id="A5.SS6.p1.1.m1.15.15.1.1.2" xref="A5.SS6.p1.1.m1.15.15.1.1.1.cmml"><mo id="A5.SS6.p1.1.m1.15.15.1.1.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.15.15.1.1.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.1.1" xref="A5.SS6.p1.1.m1.1.1.cmml">0</mn><mo id="A5.SS6.p1.1.m1.15.15.1.1.2.2" xref="A5.SS6.p1.1.m1.15.15.1.1.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.2.2" xref="A5.SS6.p1.1.m1.2.2.cmml">6</mn><mo id="A5.SS6.p1.1.m1.15.15.1.1.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.15.15.1.1.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.9" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.16.16.2.2.2" xref="A5.SS6.p1.1.m1.16.16.2.2.1.cmml"><mo id="A5.SS6.p1.1.m1.16.16.2.2.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.16.16.2.2.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.3.3" xref="A5.SS6.p1.1.m1.3.3.cmml">0</mn><mo id="A5.SS6.p1.1.m1.16.16.2.2.2.2" xref="A5.SS6.p1.1.m1.16.16.2.2.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.4.4" xref="A5.SS6.p1.1.m1.4.4.cmml">12</mn><mo id="A5.SS6.p1.1.m1.16.16.2.2.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.16.16.2.2.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.10" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.17.17.3.3.2" xref="A5.SS6.p1.1.m1.17.17.3.3.1.cmml"><mo id="A5.SS6.p1.1.m1.17.17.3.3.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.17.17.3.3.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.5.5" xref="A5.SS6.p1.1.m1.5.5.cmml">0</mn><mo id="A5.SS6.p1.1.m1.17.17.3.3.2.2" xref="A5.SS6.p1.1.m1.17.17.3.3.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.6.6" xref="A5.SS6.p1.1.m1.6.6.cmml">18</mn><mo id="A5.SS6.p1.1.m1.17.17.3.3.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.17.17.3.3.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.11" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.18.18.4.4.2" xref="A5.SS6.p1.1.m1.18.18.4.4.1.cmml"><mo id="A5.SS6.p1.1.m1.18.18.4.4.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.18.18.4.4.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.7.7" xref="A5.SS6.p1.1.m1.7.7.cmml">0</mn><mo id="A5.SS6.p1.1.m1.18.18.4.4.2.2" xref="A5.SS6.p1.1.m1.18.18.4.4.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.8.8" xref="A5.SS6.p1.1.m1.8.8.cmml">24</mn><mo id="A5.SS6.p1.1.m1.18.18.4.4.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.18.18.4.4.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.12" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.19.19.5.5.2" xref="A5.SS6.p1.1.m1.19.19.5.5.1.cmml"><mo id="A5.SS6.p1.1.m1.19.19.5.5.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.19.19.5.5.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.9.9" xref="A5.SS6.p1.1.m1.9.9.cmml">6</mn><mo id="A5.SS6.p1.1.m1.19.19.5.5.2.2" xref="A5.SS6.p1.1.m1.19.19.5.5.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.10.10" xref="A5.SS6.p1.1.m1.10.10.cmml">24</mn><mo id="A5.SS6.p1.1.m1.19.19.5.5.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.19.19.5.5.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.13" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.20.20.6.6.2" xref="A5.SS6.p1.1.m1.20.20.6.6.1.cmml"><mo id="A5.SS6.p1.1.m1.20.20.6.6.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.20.20.6.6.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.11.11" xref="A5.SS6.p1.1.m1.11.11.cmml">12</mn><mo id="A5.SS6.p1.1.m1.20.20.6.6.2.2" xref="A5.SS6.p1.1.m1.20.20.6.6.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.12.12" xref="A5.SS6.p1.1.m1.12.12.cmml">24</mn><mo id="A5.SS6.p1.1.m1.20.20.6.6.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.20.20.6.6.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.14" xref="A5.SS6.p1.1.m1.21.21.8.cmml">,</mo><mrow id="A5.SS6.p1.1.m1.21.21.7.7.2" xref="A5.SS6.p1.1.m1.21.21.7.7.1.cmml"><mo id="A5.SS6.p1.1.m1.21.21.7.7.2.1" stretchy="false" xref="A5.SS6.p1.1.m1.21.21.7.7.1.cmml">[</mo><mn id="A5.SS6.p1.1.m1.13.13" xref="A5.SS6.p1.1.m1.13.13.cmml">18</mn><mo id="A5.SS6.p1.1.m1.21.21.7.7.2.2" xref="A5.SS6.p1.1.m1.21.21.7.7.1.cmml">,</mo><mn id="A5.SS6.p1.1.m1.14.14" xref="A5.SS6.p1.1.m1.14.14.cmml">24</mn><mo id="A5.SS6.p1.1.m1.21.21.7.7.2.3" stretchy="false" xref="A5.SS6.p1.1.m1.21.21.7.7.1.cmml">)</mo></mrow><mo id="A5.SS6.p1.1.m1.21.21.7.15" stretchy="false" xref="A5.SS6.p1.1.m1.21.21.8.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.1.m1.21b"><set id="A5.SS6.p1.1.m1.21.21.8.cmml" xref="A5.SS6.p1.1.m1.21.21.7"><interval closure="closed-open" id="A5.SS6.p1.1.m1.15.15.1.1.1.cmml" xref="A5.SS6.p1.1.m1.15.15.1.1.2"><cn id="A5.SS6.p1.1.m1.1.1.cmml" type="integer" xref="A5.SS6.p1.1.m1.1.1">0</cn><cn id="A5.SS6.p1.1.m1.2.2.cmml" type="integer" xref="A5.SS6.p1.1.m1.2.2">6</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.16.16.2.2.1.cmml" xref="A5.SS6.p1.1.m1.16.16.2.2.2"><cn id="A5.SS6.p1.1.m1.3.3.cmml" type="integer" xref="A5.SS6.p1.1.m1.3.3">0</cn><cn id="A5.SS6.p1.1.m1.4.4.cmml" type="integer" xref="A5.SS6.p1.1.m1.4.4">12</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.17.17.3.3.1.cmml" xref="A5.SS6.p1.1.m1.17.17.3.3.2"><cn id="A5.SS6.p1.1.m1.5.5.cmml" type="integer" xref="A5.SS6.p1.1.m1.5.5">0</cn><cn id="A5.SS6.p1.1.m1.6.6.cmml" type="integer" xref="A5.SS6.p1.1.m1.6.6">18</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.18.18.4.4.1.cmml" xref="A5.SS6.p1.1.m1.18.18.4.4.2"><cn id="A5.SS6.p1.1.m1.7.7.cmml" type="integer" xref="A5.SS6.p1.1.m1.7.7">0</cn><cn id="A5.SS6.p1.1.m1.8.8.cmml" type="integer" xref="A5.SS6.p1.1.m1.8.8">24</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.19.19.5.5.1.cmml" xref="A5.SS6.p1.1.m1.19.19.5.5.2"><cn id="A5.SS6.p1.1.m1.9.9.cmml" type="integer" xref="A5.SS6.p1.1.m1.9.9">6</cn><cn id="A5.SS6.p1.1.m1.10.10.cmml" type="integer" xref="A5.SS6.p1.1.m1.10.10">24</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.20.20.6.6.1.cmml" xref="A5.SS6.p1.1.m1.20.20.6.6.2"><cn id="A5.SS6.p1.1.m1.11.11.cmml" type="integer" xref="A5.SS6.p1.1.m1.11.11">12</cn><cn id="A5.SS6.p1.1.m1.12.12.cmml" type="integer" xref="A5.SS6.p1.1.m1.12.12">24</cn></interval><interval closure="closed-open" id="A5.SS6.p1.1.m1.21.21.7.7.1.cmml" xref="A5.SS6.p1.1.m1.21.21.7.7.2"><cn id="A5.SS6.p1.1.m1.13.13.cmml" type="integer" xref="A5.SS6.p1.1.m1.13.13">18</cn><cn id="A5.SS6.p1.1.m1.14.14.cmml" type="integer" xref="A5.SS6.p1.1.m1.14.14">24</cn></interval></set></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.1.m1.21c">\{[0,6),[0,12),[0,18),[0,24),[6,24),[12,24),[18,24)\}</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.1.m1.21d">{ [ 0 , 6 ) , [ 0 , 12 ) , [ 0 , 18 ) , [ 0 , 24 ) , [ 6 , 24 ) , [ 12 , 24 ) , [ 18 , 24 ) }</annotation></semantics></math>, where <math alttext="[0,6)" class="ltx_Math" display="inline" id="A5.SS6.p1.2.m2.2"><semantics id="A5.SS6.p1.2.m2.2a"><mrow id="A5.SS6.p1.2.m2.2.3.2" xref="A5.SS6.p1.2.m2.2.3.1.cmml"><mo id="A5.SS6.p1.2.m2.2.3.2.1" stretchy="false" xref="A5.SS6.p1.2.m2.2.3.1.cmml">[</mo><mn id="A5.SS6.p1.2.m2.1.1" xref="A5.SS6.p1.2.m2.1.1.cmml">0</mn><mo id="A5.SS6.p1.2.m2.2.3.2.2" xref="A5.SS6.p1.2.m2.2.3.1.cmml">,</mo><mn id="A5.SS6.p1.2.m2.2.2" xref="A5.SS6.p1.2.m2.2.2.cmml">6</mn><mo id="A5.SS6.p1.2.m2.2.3.2.3" stretchy="false" xref="A5.SS6.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.2.m2.2b"><interval closure="closed-open" id="A5.SS6.p1.2.m2.2.3.1.cmml" xref="A5.SS6.p1.2.m2.2.3.2"><cn id="A5.SS6.p1.2.m2.1.1.cmml" type="integer" xref="A5.SS6.p1.2.m2.1.1">0</cn><cn id="A5.SS6.p1.2.m2.2.2.cmml" type="integer" xref="A5.SS6.p1.2.m2.2.2">6</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.2.m2.2c">[0,6)</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.2.m2.2d">[ 0 , 6 )</annotation></semantics></math> indicates that only the FFN modules at layer 1 to 6 (with index 0 to 5) are fine-tuned. We choose Qwen1.5-1.8B as the seed LLM and adopt the LoRA with <math alttext="\alpha=16" class="ltx_Math" display="inline" id="A5.SS6.p1.3.m3.1"><semantics id="A5.SS6.p1.3.m3.1a"><mrow id="A5.SS6.p1.3.m3.1.1" xref="A5.SS6.p1.3.m3.1.1.cmml"><mi id="A5.SS6.p1.3.m3.1.1.2" xref="A5.SS6.p1.3.m3.1.1.2.cmml">α</mi><mo id="A5.SS6.p1.3.m3.1.1.1" xref="A5.SS6.p1.3.m3.1.1.1.cmml">=</mo><mn id="A5.SS6.p1.3.m3.1.1.3" xref="A5.SS6.p1.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.3.m3.1b"><apply id="A5.SS6.p1.3.m3.1.1.cmml" xref="A5.SS6.p1.3.m3.1.1"><eq id="A5.SS6.p1.3.m3.1.1.1.cmml" xref="A5.SS6.p1.3.m3.1.1.1"></eq><ci id="A5.SS6.p1.3.m3.1.1.2.cmml" xref="A5.SS6.p1.3.m3.1.1.2">𝛼</ci><cn id="A5.SS6.p1.3.m3.1.1.3.cmml" type="integer" xref="A5.SS6.p1.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.3.m3.1c">\alpha=16</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.3.m3.1d">italic_α = 16</annotation></semantics></math> and <math alttext="r=32" class="ltx_Math" display="inline" id="A5.SS6.p1.4.m4.1"><semantics id="A5.SS6.p1.4.m4.1a"><mrow id="A5.SS6.p1.4.m4.1.1" xref="A5.SS6.p1.4.m4.1.1.cmml"><mi id="A5.SS6.p1.4.m4.1.1.2" xref="A5.SS6.p1.4.m4.1.1.2.cmml">r</mi><mo id="A5.SS6.p1.4.m4.1.1.1" xref="A5.SS6.p1.4.m4.1.1.1.cmml">=</mo><mn id="A5.SS6.p1.4.m4.1.1.3" xref="A5.SS6.p1.4.m4.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.4.m4.1b"><apply id="A5.SS6.p1.4.m4.1.1.cmml" xref="A5.SS6.p1.4.m4.1.1"><eq id="A5.SS6.p1.4.m4.1.1.1.cmml" xref="A5.SS6.p1.4.m4.1.1.1"></eq><ci id="A5.SS6.p1.4.m4.1.1.2.cmml" xref="A5.SS6.p1.4.m4.1.1.2">𝑟</ci><cn id="A5.SS6.p1.4.m4.1.1.3.cmml" type="integer" xref="A5.SS6.p1.4.m4.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.4.m4.1c">r=32</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.4.m4.1d">italic_r = 32</annotation></semantics></math>.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S3.F3" title="Figure 3 ‣ 3.3 Towards Optimal Parameter Selection Strategy ‣ 3 TAIA: Training All Parameters but Inferring with Only Attention ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>, the performance of <span class="ltx_text ltx_font_smallcaps" id="A5.SS6.p1.4.1">TAIA</span> achieves the best with the fine-tuned FFN modules located at layers 1 to 18.
Besides, with equal parameter quantities, fine-tuning the FFN in the earlier layers aids in the optimization of the attention layers, whereas the later layers do not yield such an improvement.
This shows that the self-attention module functions mostly in early to middle layers, which is also consistent with <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Li et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.7 </span>Comparing with OOD Generalization Methods</h3>
<div class="ltx_para" id="A5.SS7.p1">
<p class="ltx_p" id="A5.SS7.p1.1">Here, we present the implementation details of other OOD generalization methods to ensure the reproducibility of all comparisons.
For LoRACL, we compare the PPL value of the input prompt between the base model and the LoRA-tuned model and pick the model with lower PPL as the evaluation model.</p>
</div>
<div class="ltx_para" id="A5.SS7.p2">
<p class="ltx_p" id="A5.SS7.p2.8">For the consolidation method, the fine-tuning loss can be formulated as the sum of the negative log-likelihood (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S2.E3" title="In Finetuning towards tasks ‣ 2 Preliminaries ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">3</span></a>) and the regularization items:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{reg}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}\Omega_{i}(\theta_{i}-\theta_{init})^{2}" class="ltx_Math" display="block" id="A5.E7.m1.2"><semantics id="A5.E7.m1.2a"><mrow id="A5.E7.m1.2.2" xref="A5.E7.m1.2.2.cmml"><msubsup id="A5.E7.m1.2.2.3" xref="A5.E7.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E7.m1.2.2.3.2.2" xref="A5.E7.m1.2.2.3.2.2.cmml">ℒ</mi><mi id="A5.E7.m1.2.2.3.3" xref="A5.E7.m1.2.2.3.3.cmml">θ</mi><mrow id="A5.E7.m1.2.2.3.2.3" xref="A5.E7.m1.2.2.3.2.3.cmml"><mi id="A5.E7.m1.2.2.3.2.3.2" xref="A5.E7.m1.2.2.3.2.3.2.cmml">r</mi><mo id="A5.E7.m1.2.2.3.2.3.1" xref="A5.E7.m1.2.2.3.2.3.1.cmml">⁢</mo><mi id="A5.E7.m1.2.2.3.2.3.3" xref="A5.E7.m1.2.2.3.2.3.3.cmml">e</mi><mo id="A5.E7.m1.2.2.3.2.3.1a" xref="A5.E7.m1.2.2.3.2.3.1.cmml">⁢</mo><mi id="A5.E7.m1.2.2.3.2.3.4" xref="A5.E7.m1.2.2.3.2.3.4.cmml">g</mi></mrow></msubsup><mo id="A5.E7.m1.2.2.2" xref="A5.E7.m1.2.2.2.cmml">=</mo><mrow id="A5.E7.m1.2.2.1" xref="A5.E7.m1.2.2.1.cmml"><msub id="A5.E7.m1.2.2.1.3" xref="A5.E7.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E7.m1.2.2.1.3.2" xref="A5.E7.m1.2.2.1.3.2.cmml">ℒ</mi><mi id="A5.E7.m1.2.2.1.3.3" xref="A5.E7.m1.2.2.1.3.3.cmml">θ</mi></msub><mo id="A5.E7.m1.2.2.1.2" xref="A5.E7.m1.2.2.1.2.cmml">+</mo><mrow id="A5.E7.m1.2.2.1.1" xref="A5.E7.m1.2.2.1.1.cmml"><mi id="A5.E7.m1.2.2.1.1.3" xref="A5.E7.m1.2.2.1.1.3.cmml">λ</mi><mo id="A5.E7.m1.2.2.1.1.2" xref="A5.E7.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="A5.E7.m1.2.2.1.1.1" xref="A5.E7.m1.2.2.1.1.1.cmml"><munder id="A5.E7.m1.2.2.1.1.1.2" xref="A5.E7.m1.2.2.1.1.1.2.cmml"><mo id="A5.E7.m1.2.2.1.1.1.2.2" movablelimits="false" xref="A5.E7.m1.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="A5.E7.m1.1.1.1" xref="A5.E7.m1.1.1.1.cmml"><msub id="A5.E7.m1.1.1.1.3" xref="A5.E7.m1.1.1.1.3.cmml"><mi id="A5.E7.m1.1.1.1.3.2" xref="A5.E7.m1.1.1.1.3.2.cmml">θ</mi><mi id="A5.E7.m1.1.1.1.3.3" xref="A5.E7.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.E7.m1.1.1.1.2" xref="A5.E7.m1.1.1.1.2.cmml">∈</mo><mrow id="A5.E7.m1.1.1.1.4.2" xref="A5.E7.m1.1.1.1.4.1.cmml"><mo id="A5.E7.m1.1.1.1.4.2.1" stretchy="false" xref="A5.E7.m1.1.1.1.4.1.cmml">{</mo><mi id="A5.E7.m1.1.1.1.1" xref="A5.E7.m1.1.1.1.1.cmml">θ</mi><mo id="A5.E7.m1.1.1.1.4.2.2" stretchy="false" xref="A5.E7.m1.1.1.1.4.1.cmml">}</mo></mrow></mrow></munder><mrow id="A5.E7.m1.2.2.1.1.1.1" xref="A5.E7.m1.2.2.1.1.1.1.cmml"><msub id="A5.E7.m1.2.2.1.1.1.1.3" xref="A5.E7.m1.2.2.1.1.1.1.3.cmml"><mi id="A5.E7.m1.2.2.1.1.1.1.3.2" mathvariant="normal" xref="A5.E7.m1.2.2.1.1.1.1.3.2.cmml">Ω</mi><mi id="A5.E7.m1.2.2.1.1.1.1.3.3" xref="A5.E7.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.E7.m1.2.2.1.1.1.1.2" xref="A5.E7.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msup id="A5.E7.m1.2.2.1.1.1.1.1" xref="A5.E7.m1.2.2.1.1.1.1.1.cmml"><mrow id="A5.E7.m1.2.2.1.1.1.1.1.1.1" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mrow id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1a" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.4" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.4.cmml">i</mi><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1b" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.5" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.5.cmml">t</mi></mrow></msub></mrow><mo id="A5.E7.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A5.E7.m1.2.2.1.1.1.1.1.3" xref="A5.E7.m1.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.E7.m1.2b"><apply id="A5.E7.m1.2.2.cmml" xref="A5.E7.m1.2.2"><eq id="A5.E7.m1.2.2.2.cmml" xref="A5.E7.m1.2.2.2"></eq><apply id="A5.E7.m1.2.2.3.cmml" xref="A5.E7.m1.2.2.3"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.3.1.cmml" xref="A5.E7.m1.2.2.3">subscript</csymbol><apply id="A5.E7.m1.2.2.3.2.cmml" xref="A5.E7.m1.2.2.3"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.3.2.1.cmml" xref="A5.E7.m1.2.2.3">superscript</csymbol><ci id="A5.E7.m1.2.2.3.2.2.cmml" xref="A5.E7.m1.2.2.3.2.2">ℒ</ci><apply id="A5.E7.m1.2.2.3.2.3.cmml" xref="A5.E7.m1.2.2.3.2.3"><times id="A5.E7.m1.2.2.3.2.3.1.cmml" xref="A5.E7.m1.2.2.3.2.3.1"></times><ci id="A5.E7.m1.2.2.3.2.3.2.cmml" xref="A5.E7.m1.2.2.3.2.3.2">𝑟</ci><ci id="A5.E7.m1.2.2.3.2.3.3.cmml" xref="A5.E7.m1.2.2.3.2.3.3">𝑒</ci><ci id="A5.E7.m1.2.2.3.2.3.4.cmml" xref="A5.E7.m1.2.2.3.2.3.4">𝑔</ci></apply></apply><ci id="A5.E7.m1.2.2.3.3.cmml" xref="A5.E7.m1.2.2.3.3">𝜃</ci></apply><apply id="A5.E7.m1.2.2.1.cmml" xref="A5.E7.m1.2.2.1"><plus id="A5.E7.m1.2.2.1.2.cmml" xref="A5.E7.m1.2.2.1.2"></plus><apply id="A5.E7.m1.2.2.1.3.cmml" xref="A5.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.3.1.cmml" xref="A5.E7.m1.2.2.1.3">subscript</csymbol><ci id="A5.E7.m1.2.2.1.3.2.cmml" xref="A5.E7.m1.2.2.1.3.2">ℒ</ci><ci id="A5.E7.m1.2.2.1.3.3.cmml" xref="A5.E7.m1.2.2.1.3.3">𝜃</ci></apply><apply id="A5.E7.m1.2.2.1.1.cmml" xref="A5.E7.m1.2.2.1.1"><times id="A5.E7.m1.2.2.1.1.2.cmml" xref="A5.E7.m1.2.2.1.1.2"></times><ci id="A5.E7.m1.2.2.1.1.3.cmml" xref="A5.E7.m1.2.2.1.1.3">𝜆</ci><apply id="A5.E7.m1.2.2.1.1.1.cmml" xref="A5.E7.m1.2.2.1.1.1"><apply id="A5.E7.m1.2.2.1.1.1.2.cmml" xref="A5.E7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.1.1.2.1.cmml" xref="A5.E7.m1.2.2.1.1.1.2">subscript</csymbol><sum id="A5.E7.m1.2.2.1.1.1.2.2.cmml" xref="A5.E7.m1.2.2.1.1.1.2.2"></sum><apply id="A5.E7.m1.1.1.1.cmml" xref="A5.E7.m1.1.1.1"><in id="A5.E7.m1.1.1.1.2.cmml" xref="A5.E7.m1.1.1.1.2"></in><apply id="A5.E7.m1.1.1.1.3.cmml" xref="A5.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E7.m1.1.1.1.3.1.cmml" xref="A5.E7.m1.1.1.1.3">subscript</csymbol><ci id="A5.E7.m1.1.1.1.3.2.cmml" xref="A5.E7.m1.1.1.1.3.2">𝜃</ci><ci id="A5.E7.m1.1.1.1.3.3.cmml" xref="A5.E7.m1.1.1.1.3.3">𝑖</ci></apply><set id="A5.E7.m1.1.1.1.4.1.cmml" xref="A5.E7.m1.1.1.1.4.2"><ci id="A5.E7.m1.1.1.1.1.cmml" xref="A5.E7.m1.1.1.1.1">𝜃</ci></set></apply></apply><apply id="A5.E7.m1.2.2.1.1.1.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1"><times id="A5.E7.m1.2.2.1.1.1.1.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.2"></times><apply id="A5.E7.m1.2.2.1.1.1.1.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.1.1.1.3.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A5.E7.m1.2.2.1.1.1.1.3.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.3.2">Ω</ci><ci id="A5.E7.m1.2.2.1.1.1.1.3.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply><apply id="A5.E7.m1.2.2.1.1.1.1.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1"><minus id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝜃</ci><apply id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3"><times id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">𝑛</ci><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.4">𝑖</ci><ci id="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="A5.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.5">𝑡</ci></apply></apply></apply><cn id="A5.E7.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="A5.E7.m1.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E7.m1.2c">\mathcal{L}^{reg}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}\Omega_{i}(\theta_{i}-\theta_{init})^{2}</annotation><annotation encoding="application/x-llamapun" id="A5.E7.m1.2d">caligraphic_L start_POSTSUPERSCRIPT italic_r italic_e italic_g end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT + italic_λ ∑ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { italic_θ } end_POSTSUBSCRIPT roman_Ω start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_θ start_POSTSUBSCRIPT italic_i italic_n italic_i italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS7.p2.6">where <math alttext="\{{\theta}\}" class="ltx_Math" display="inline" id="A5.SS7.p2.1.m1.1"><semantics id="A5.SS7.p2.1.m1.1a"><mrow id="A5.SS7.p2.1.m1.1.2.2" xref="A5.SS7.p2.1.m1.1.2.1.cmml"><mo id="A5.SS7.p2.1.m1.1.2.2.1" stretchy="false" xref="A5.SS7.p2.1.m1.1.2.1.cmml">{</mo><mi id="A5.SS7.p2.1.m1.1.1" xref="A5.SS7.p2.1.m1.1.1.cmml">θ</mi><mo id="A5.SS7.p2.1.m1.1.2.2.2" stretchy="false" xref="A5.SS7.p2.1.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.1.m1.1b"><set id="A5.SS7.p2.1.m1.1.2.1.cmml" xref="A5.SS7.p2.1.m1.1.2.2"><ci id="A5.SS7.p2.1.m1.1.1.cmml" xref="A5.SS7.p2.1.m1.1.1">𝜃</ci></set></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.1.m1.1c">\{{\theta}\}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.1.m1.1d">{ italic_θ }</annotation></semantics></math> is the collection of all tunable parameters, <math alttext="\theta_{init}" class="ltx_Math" display="inline" id="A5.SS7.p2.2.m2.1"><semantics id="A5.SS7.p2.2.m2.1a"><msub id="A5.SS7.p2.2.m2.1.1" xref="A5.SS7.p2.2.m2.1.1.cmml"><mi id="A5.SS7.p2.2.m2.1.1.2" xref="A5.SS7.p2.2.m2.1.1.2.cmml">θ</mi><mrow id="A5.SS7.p2.2.m2.1.1.3" xref="A5.SS7.p2.2.m2.1.1.3.cmml"><mi id="A5.SS7.p2.2.m2.1.1.3.2" xref="A5.SS7.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="A5.SS7.p2.2.m2.1.1.3.1" xref="A5.SS7.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.2.m2.1.1.3.3" xref="A5.SS7.p2.2.m2.1.1.3.3.cmml">n</mi><mo id="A5.SS7.p2.2.m2.1.1.3.1a" xref="A5.SS7.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.2.m2.1.1.3.4" xref="A5.SS7.p2.2.m2.1.1.3.4.cmml">i</mi><mo id="A5.SS7.p2.2.m2.1.1.3.1b" xref="A5.SS7.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.2.m2.1.1.3.5" xref="A5.SS7.p2.2.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.2.m2.1b"><apply id="A5.SS7.p2.2.m2.1.1.cmml" xref="A5.SS7.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A5.SS7.p2.2.m2.1.1.1.cmml" xref="A5.SS7.p2.2.m2.1.1">subscript</csymbol><ci id="A5.SS7.p2.2.m2.1.1.2.cmml" xref="A5.SS7.p2.2.m2.1.1.2">𝜃</ci><apply id="A5.SS7.p2.2.m2.1.1.3.cmml" xref="A5.SS7.p2.2.m2.1.1.3"><times id="A5.SS7.p2.2.m2.1.1.3.1.cmml" xref="A5.SS7.p2.2.m2.1.1.3.1"></times><ci id="A5.SS7.p2.2.m2.1.1.3.2.cmml" xref="A5.SS7.p2.2.m2.1.1.3.2">𝑖</ci><ci id="A5.SS7.p2.2.m2.1.1.3.3.cmml" xref="A5.SS7.p2.2.m2.1.1.3.3">𝑛</ci><ci id="A5.SS7.p2.2.m2.1.1.3.4.cmml" xref="A5.SS7.p2.2.m2.1.1.3.4">𝑖</ci><ci id="A5.SS7.p2.2.m2.1.1.3.5.cmml" xref="A5.SS7.p2.2.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.2.m2.1c">\theta_{init}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_i italic_n italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the parameter of the base model and <math alttext="\lambda" class="ltx_Math" display="inline" id="A5.SS7.p2.3.m3.1"><semantics id="A5.SS7.p2.3.m3.1a"><mi id="A5.SS7.p2.3.m3.1.1" xref="A5.SS7.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.3.m3.1b"><ci id="A5.SS7.p2.3.m3.1.1.cmml" xref="A5.SS7.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.3.m3.1d">italic_λ</annotation></semantics></math> is a balance hyperparameter.
Considering that we use the LoRA method to fine-tune the model, the updated parameters <math alttext="\theta_{i}" class="ltx_Math" display="inline" id="A5.SS7.p2.4.m4.1"><semantics id="A5.SS7.p2.4.m4.1a"><msub id="A5.SS7.p2.4.m4.1.1" xref="A5.SS7.p2.4.m4.1.1.cmml"><mi id="A5.SS7.p2.4.m4.1.1.2" xref="A5.SS7.p2.4.m4.1.1.2.cmml">θ</mi><mi id="A5.SS7.p2.4.m4.1.1.3" xref="A5.SS7.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.4.m4.1b"><apply id="A5.SS7.p2.4.m4.1.1.cmml" xref="A5.SS7.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A5.SS7.p2.4.m4.1.1.1.cmml" xref="A5.SS7.p2.4.m4.1.1">subscript</csymbol><ci id="A5.SS7.p2.4.m4.1.1.2.cmml" xref="A5.SS7.p2.4.m4.1.1.2">𝜃</ci><ci id="A5.SS7.p2.4.m4.1.1.3.cmml" xref="A5.SS7.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.4.m4.1c">\theta_{i}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.4.m4.1d">italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be calculated as the sum of the LoRA parameter <math alttext="\Delta\theta_{i}" class="ltx_Math" display="inline" id="A5.SS7.p2.5.m5.1"><semantics id="A5.SS7.p2.5.m5.1a"><mrow id="A5.SS7.p2.5.m5.1.1" xref="A5.SS7.p2.5.m5.1.1.cmml"><mi id="A5.SS7.p2.5.m5.1.1.2" mathvariant="normal" xref="A5.SS7.p2.5.m5.1.1.2.cmml">Δ</mi><mo id="A5.SS7.p2.5.m5.1.1.1" xref="A5.SS7.p2.5.m5.1.1.1.cmml">⁢</mo><msub id="A5.SS7.p2.5.m5.1.1.3" xref="A5.SS7.p2.5.m5.1.1.3.cmml"><mi id="A5.SS7.p2.5.m5.1.1.3.2" xref="A5.SS7.p2.5.m5.1.1.3.2.cmml">θ</mi><mi id="A5.SS7.p2.5.m5.1.1.3.3" xref="A5.SS7.p2.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.5.m5.1b"><apply id="A5.SS7.p2.5.m5.1.1.cmml" xref="A5.SS7.p2.5.m5.1.1"><times id="A5.SS7.p2.5.m5.1.1.1.cmml" xref="A5.SS7.p2.5.m5.1.1.1"></times><ci id="A5.SS7.p2.5.m5.1.1.2.cmml" xref="A5.SS7.p2.5.m5.1.1.2">Δ</ci><apply id="A5.SS7.p2.5.m5.1.1.3.cmml" xref="A5.SS7.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="A5.SS7.p2.5.m5.1.1.3.1.cmml" xref="A5.SS7.p2.5.m5.1.1.3">subscript</csymbol><ci id="A5.SS7.p2.5.m5.1.1.3.2.cmml" xref="A5.SS7.p2.5.m5.1.1.3.2">𝜃</ci><ci id="A5.SS7.p2.5.m5.1.1.3.3.cmml" xref="A5.SS7.p2.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.5.m5.1c">\Delta\theta_{i}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.5.m5.1d">roman_Δ italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the base model: <math alttext="\theta_{i}=\Delta\theta_{i}+\theta_{init}" class="ltx_Math" display="inline" id="A5.SS7.p2.6.m6.1"><semantics id="A5.SS7.p2.6.m6.1a"><mrow id="A5.SS7.p2.6.m6.1.1" xref="A5.SS7.p2.6.m6.1.1.cmml"><msub id="A5.SS7.p2.6.m6.1.1.2" xref="A5.SS7.p2.6.m6.1.1.2.cmml"><mi id="A5.SS7.p2.6.m6.1.1.2.2" xref="A5.SS7.p2.6.m6.1.1.2.2.cmml">θ</mi><mi id="A5.SS7.p2.6.m6.1.1.2.3" xref="A5.SS7.p2.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="A5.SS7.p2.6.m6.1.1.1" xref="A5.SS7.p2.6.m6.1.1.1.cmml">=</mo><mrow id="A5.SS7.p2.6.m6.1.1.3" xref="A5.SS7.p2.6.m6.1.1.3.cmml"><mrow id="A5.SS7.p2.6.m6.1.1.3.2" xref="A5.SS7.p2.6.m6.1.1.3.2.cmml"><mi id="A5.SS7.p2.6.m6.1.1.3.2.2" mathvariant="normal" xref="A5.SS7.p2.6.m6.1.1.3.2.2.cmml">Δ</mi><mo id="A5.SS7.p2.6.m6.1.1.3.2.1" xref="A5.SS7.p2.6.m6.1.1.3.2.1.cmml">⁢</mo><msub id="A5.SS7.p2.6.m6.1.1.3.2.3" xref="A5.SS7.p2.6.m6.1.1.3.2.3.cmml"><mi id="A5.SS7.p2.6.m6.1.1.3.2.3.2" xref="A5.SS7.p2.6.m6.1.1.3.2.3.2.cmml">θ</mi><mi id="A5.SS7.p2.6.m6.1.1.3.2.3.3" xref="A5.SS7.p2.6.m6.1.1.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A5.SS7.p2.6.m6.1.1.3.1" xref="A5.SS7.p2.6.m6.1.1.3.1.cmml">+</mo><msub id="A5.SS7.p2.6.m6.1.1.3.3" xref="A5.SS7.p2.6.m6.1.1.3.3.cmml"><mi id="A5.SS7.p2.6.m6.1.1.3.3.2" xref="A5.SS7.p2.6.m6.1.1.3.3.2.cmml">θ</mi><mrow id="A5.SS7.p2.6.m6.1.1.3.3.3" xref="A5.SS7.p2.6.m6.1.1.3.3.3.cmml"><mi id="A5.SS7.p2.6.m6.1.1.3.3.3.2" xref="A5.SS7.p2.6.m6.1.1.3.3.3.2.cmml">i</mi><mo id="A5.SS7.p2.6.m6.1.1.3.3.3.1" xref="A5.SS7.p2.6.m6.1.1.3.3.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.6.m6.1.1.3.3.3.3" xref="A5.SS7.p2.6.m6.1.1.3.3.3.3.cmml">n</mi><mo id="A5.SS7.p2.6.m6.1.1.3.3.3.1a" xref="A5.SS7.p2.6.m6.1.1.3.3.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.6.m6.1.1.3.3.3.4" xref="A5.SS7.p2.6.m6.1.1.3.3.3.4.cmml">i</mi><mo id="A5.SS7.p2.6.m6.1.1.3.3.3.1b" xref="A5.SS7.p2.6.m6.1.1.3.3.3.1.cmml">⁢</mo><mi id="A5.SS7.p2.6.m6.1.1.3.3.3.5" xref="A5.SS7.p2.6.m6.1.1.3.3.3.5.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.6.m6.1b"><apply id="A5.SS7.p2.6.m6.1.1.cmml" xref="A5.SS7.p2.6.m6.1.1"><eq id="A5.SS7.p2.6.m6.1.1.1.cmml" xref="A5.SS7.p2.6.m6.1.1.1"></eq><apply id="A5.SS7.p2.6.m6.1.1.2.cmml" xref="A5.SS7.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="A5.SS7.p2.6.m6.1.1.2.1.cmml" xref="A5.SS7.p2.6.m6.1.1.2">subscript</csymbol><ci id="A5.SS7.p2.6.m6.1.1.2.2.cmml" xref="A5.SS7.p2.6.m6.1.1.2.2">𝜃</ci><ci id="A5.SS7.p2.6.m6.1.1.2.3.cmml" xref="A5.SS7.p2.6.m6.1.1.2.3">𝑖</ci></apply><apply id="A5.SS7.p2.6.m6.1.1.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3"><plus id="A5.SS7.p2.6.m6.1.1.3.1.cmml" xref="A5.SS7.p2.6.m6.1.1.3.1"></plus><apply id="A5.SS7.p2.6.m6.1.1.3.2.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2"><times id="A5.SS7.p2.6.m6.1.1.3.2.1.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.1"></times><ci id="A5.SS7.p2.6.m6.1.1.3.2.2.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.2">Δ</ci><apply id="A5.SS7.p2.6.m6.1.1.3.2.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="A5.SS7.p2.6.m6.1.1.3.2.3.1.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.3">subscript</csymbol><ci id="A5.SS7.p2.6.m6.1.1.3.2.3.2.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.3.2">𝜃</ci><ci id="A5.SS7.p2.6.m6.1.1.3.2.3.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="A5.SS7.p2.6.m6.1.1.3.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="A5.SS7.p2.6.m6.1.1.3.3.1.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3">subscript</csymbol><ci id="A5.SS7.p2.6.m6.1.1.3.3.2.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.2">𝜃</ci><apply id="A5.SS7.p2.6.m6.1.1.3.3.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3"><times id="A5.SS7.p2.6.m6.1.1.3.3.3.1.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3.1"></times><ci id="A5.SS7.p2.6.m6.1.1.3.3.3.2.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3.2">𝑖</ci><ci id="A5.SS7.p2.6.m6.1.1.3.3.3.3.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3.3">𝑛</ci><ci id="A5.SS7.p2.6.m6.1.1.3.3.3.4.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3.4">𝑖</ci><ci id="A5.SS7.p2.6.m6.1.1.3.3.3.5.cmml" xref="A5.SS7.p2.6.m6.1.1.3.3.3.5">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.6.m6.1c">\theta_{i}=\Delta\theta_{i}+\theta_{init}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.6.m6.1d">italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_Δ italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_θ start_POSTSUBSCRIPT italic_i italic_n italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
We adopt two types of consolidation methods (L2 and EWC) as the baseline. For L2, we add an L2 constraint to tunable parameters:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{L2}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}\Delta\theta_{i}^{2}" class="ltx_Math" display="block" id="A5.E8.m1.1"><semantics id="A5.E8.m1.1a"><mrow id="A5.E8.m1.1.2" xref="A5.E8.m1.1.2.cmml"><msubsup id="A5.E8.m1.1.2.2" xref="A5.E8.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E8.m1.1.2.2.2.2" xref="A5.E8.m1.1.2.2.2.2.cmml">ℒ</mi><mi id="A5.E8.m1.1.2.2.3" xref="A5.E8.m1.1.2.2.3.cmml">θ</mi><mrow id="A5.E8.m1.1.2.2.2.3" xref="A5.E8.m1.1.2.2.2.3.cmml"><mi id="A5.E8.m1.1.2.2.2.3.2" xref="A5.E8.m1.1.2.2.2.3.2.cmml">L</mi><mo id="A5.E8.m1.1.2.2.2.3.1" xref="A5.E8.m1.1.2.2.2.3.1.cmml">⁢</mo><mn id="A5.E8.m1.1.2.2.2.3.3" xref="A5.E8.m1.1.2.2.2.3.3.cmml">2</mn></mrow></msubsup><mo id="A5.E8.m1.1.2.1" xref="A5.E8.m1.1.2.1.cmml">=</mo><mrow id="A5.E8.m1.1.2.3" xref="A5.E8.m1.1.2.3.cmml"><msub id="A5.E8.m1.1.2.3.2" xref="A5.E8.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E8.m1.1.2.3.2.2" xref="A5.E8.m1.1.2.3.2.2.cmml">ℒ</mi><mi id="A5.E8.m1.1.2.3.2.3" xref="A5.E8.m1.1.2.3.2.3.cmml">θ</mi></msub><mo id="A5.E8.m1.1.2.3.1" xref="A5.E8.m1.1.2.3.1.cmml">+</mo><mrow id="A5.E8.m1.1.2.3.3" xref="A5.E8.m1.1.2.3.3.cmml"><mi id="A5.E8.m1.1.2.3.3.2" xref="A5.E8.m1.1.2.3.3.2.cmml">λ</mi><mo id="A5.E8.m1.1.2.3.3.1" xref="A5.E8.m1.1.2.3.3.1.cmml">⁢</mo><mrow id="A5.E8.m1.1.2.3.3.3" xref="A5.E8.m1.1.2.3.3.3.cmml"><munder id="A5.E8.m1.1.2.3.3.3.1" xref="A5.E8.m1.1.2.3.3.3.1.cmml"><mo id="A5.E8.m1.1.2.3.3.3.1.2" movablelimits="false" xref="A5.E8.m1.1.2.3.3.3.1.2.cmml">∑</mo><mrow id="A5.E8.m1.1.1.1" xref="A5.E8.m1.1.1.1.cmml"><msub id="A5.E8.m1.1.1.1.3" xref="A5.E8.m1.1.1.1.3.cmml"><mi id="A5.E8.m1.1.1.1.3.2" xref="A5.E8.m1.1.1.1.3.2.cmml">θ</mi><mi id="A5.E8.m1.1.1.1.3.3" xref="A5.E8.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.E8.m1.1.1.1.2" xref="A5.E8.m1.1.1.1.2.cmml">∈</mo><mrow id="A5.E8.m1.1.1.1.4.2" xref="A5.E8.m1.1.1.1.4.1.cmml"><mo id="A5.E8.m1.1.1.1.4.2.1" stretchy="false" xref="A5.E8.m1.1.1.1.4.1.cmml">{</mo><mi id="A5.E8.m1.1.1.1.1" xref="A5.E8.m1.1.1.1.1.cmml">θ</mi><mo id="A5.E8.m1.1.1.1.4.2.2" stretchy="false" xref="A5.E8.m1.1.1.1.4.1.cmml">}</mo></mrow></mrow></munder><mrow id="A5.E8.m1.1.2.3.3.3.2" xref="A5.E8.m1.1.2.3.3.3.2.cmml"><mi id="A5.E8.m1.1.2.3.3.3.2.2" mathvariant="normal" xref="A5.E8.m1.1.2.3.3.3.2.2.cmml">Δ</mi><mo id="A5.E8.m1.1.2.3.3.3.2.1" xref="A5.E8.m1.1.2.3.3.3.2.1.cmml">⁢</mo><msubsup id="A5.E8.m1.1.2.3.3.3.2.3" xref="A5.E8.m1.1.2.3.3.3.2.3.cmml"><mi id="A5.E8.m1.1.2.3.3.3.2.3.2.2" xref="A5.E8.m1.1.2.3.3.3.2.3.2.2.cmml">θ</mi><mi id="A5.E8.m1.1.2.3.3.3.2.3.2.3" xref="A5.E8.m1.1.2.3.3.3.2.3.2.3.cmml">i</mi><mn id="A5.E8.m1.1.2.3.3.3.2.3.3" xref="A5.E8.m1.1.2.3.3.3.2.3.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.E8.m1.1b"><apply id="A5.E8.m1.1.2.cmml" xref="A5.E8.m1.1.2"><eq id="A5.E8.m1.1.2.1.cmml" xref="A5.E8.m1.1.2.1"></eq><apply id="A5.E8.m1.1.2.2.cmml" xref="A5.E8.m1.1.2.2"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.2.1.cmml" xref="A5.E8.m1.1.2.2">subscript</csymbol><apply id="A5.E8.m1.1.2.2.2.cmml" xref="A5.E8.m1.1.2.2"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.2.2.1.cmml" xref="A5.E8.m1.1.2.2">superscript</csymbol><ci id="A5.E8.m1.1.2.2.2.2.cmml" xref="A5.E8.m1.1.2.2.2.2">ℒ</ci><apply id="A5.E8.m1.1.2.2.2.3.cmml" xref="A5.E8.m1.1.2.2.2.3"><times id="A5.E8.m1.1.2.2.2.3.1.cmml" xref="A5.E8.m1.1.2.2.2.3.1"></times><ci id="A5.E8.m1.1.2.2.2.3.2.cmml" xref="A5.E8.m1.1.2.2.2.3.2">𝐿</ci><cn id="A5.E8.m1.1.2.2.2.3.3.cmml" type="integer" xref="A5.E8.m1.1.2.2.2.3.3">2</cn></apply></apply><ci id="A5.E8.m1.1.2.2.3.cmml" xref="A5.E8.m1.1.2.2.3">𝜃</ci></apply><apply id="A5.E8.m1.1.2.3.cmml" xref="A5.E8.m1.1.2.3"><plus id="A5.E8.m1.1.2.3.1.cmml" xref="A5.E8.m1.1.2.3.1"></plus><apply id="A5.E8.m1.1.2.3.2.cmml" xref="A5.E8.m1.1.2.3.2"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.3.2.1.cmml" xref="A5.E8.m1.1.2.3.2">subscript</csymbol><ci id="A5.E8.m1.1.2.3.2.2.cmml" xref="A5.E8.m1.1.2.3.2.2">ℒ</ci><ci id="A5.E8.m1.1.2.3.2.3.cmml" xref="A5.E8.m1.1.2.3.2.3">𝜃</ci></apply><apply id="A5.E8.m1.1.2.3.3.cmml" xref="A5.E8.m1.1.2.3.3"><times id="A5.E8.m1.1.2.3.3.1.cmml" xref="A5.E8.m1.1.2.3.3.1"></times><ci id="A5.E8.m1.1.2.3.3.2.cmml" xref="A5.E8.m1.1.2.3.3.2">𝜆</ci><apply id="A5.E8.m1.1.2.3.3.3.cmml" xref="A5.E8.m1.1.2.3.3.3"><apply id="A5.E8.m1.1.2.3.3.3.1.cmml" xref="A5.E8.m1.1.2.3.3.3.1"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.3.3.3.1.1.cmml" xref="A5.E8.m1.1.2.3.3.3.1">subscript</csymbol><sum id="A5.E8.m1.1.2.3.3.3.1.2.cmml" xref="A5.E8.m1.1.2.3.3.3.1.2"></sum><apply id="A5.E8.m1.1.1.1.cmml" xref="A5.E8.m1.1.1.1"><in id="A5.E8.m1.1.1.1.2.cmml" xref="A5.E8.m1.1.1.1.2"></in><apply id="A5.E8.m1.1.1.1.3.cmml" xref="A5.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E8.m1.1.1.1.3.1.cmml" xref="A5.E8.m1.1.1.1.3">subscript</csymbol><ci id="A5.E8.m1.1.1.1.3.2.cmml" xref="A5.E8.m1.1.1.1.3.2">𝜃</ci><ci id="A5.E8.m1.1.1.1.3.3.cmml" xref="A5.E8.m1.1.1.1.3.3">𝑖</ci></apply><set id="A5.E8.m1.1.1.1.4.1.cmml" xref="A5.E8.m1.1.1.1.4.2"><ci id="A5.E8.m1.1.1.1.1.cmml" xref="A5.E8.m1.1.1.1.1">𝜃</ci></set></apply></apply><apply id="A5.E8.m1.1.2.3.3.3.2.cmml" xref="A5.E8.m1.1.2.3.3.3.2"><times id="A5.E8.m1.1.2.3.3.3.2.1.cmml" xref="A5.E8.m1.1.2.3.3.3.2.1"></times><ci id="A5.E8.m1.1.2.3.3.3.2.2.cmml" xref="A5.E8.m1.1.2.3.3.3.2.2">Δ</ci><apply id="A5.E8.m1.1.2.3.3.3.2.3.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.3.3.3.2.3.1.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3">superscript</csymbol><apply id="A5.E8.m1.1.2.3.3.3.2.3.2.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="A5.E8.m1.1.2.3.3.3.2.3.2.1.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3">subscript</csymbol><ci id="A5.E8.m1.1.2.3.3.3.2.3.2.2.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3.2.2">𝜃</ci><ci id="A5.E8.m1.1.2.3.3.3.2.3.2.3.cmml" xref="A5.E8.m1.1.2.3.3.3.2.3.2.3">𝑖</ci></apply><cn id="A5.E8.m1.1.2.3.3.3.2.3.3.cmml" type="integer" xref="A5.E8.m1.1.2.3.3.3.2.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E8.m1.1c">\mathcal{L}^{L2}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}\Delta\theta_{i}^{2}</annotation><annotation encoding="application/x-llamapun" id="A5.E8.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_L 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT + italic_λ ∑ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { italic_θ } end_POSTSUBSCRIPT roman_Δ italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS7.p2.9">For EWC, we use the Fisher information matrix to measure the distance between the parameters:</p>
<table class="ltx_equation ltx_eqn_table" id="A5.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{EWC}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}F_{i}\Delta\theta_{i}^{2}" class="ltx_Math" display="block" id="A5.E9.m1.1"><semantics id="A5.E9.m1.1a"><mrow id="A5.E9.m1.1.2" xref="A5.E9.m1.1.2.cmml"><msubsup id="A5.E9.m1.1.2.2" xref="A5.E9.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E9.m1.1.2.2.2.2" xref="A5.E9.m1.1.2.2.2.2.cmml">ℒ</mi><mi id="A5.E9.m1.1.2.2.3" xref="A5.E9.m1.1.2.2.3.cmml">θ</mi><mrow id="A5.E9.m1.1.2.2.2.3" xref="A5.E9.m1.1.2.2.2.3.cmml"><mi id="A5.E9.m1.1.2.2.2.3.2" xref="A5.E9.m1.1.2.2.2.3.2.cmml">E</mi><mo id="A5.E9.m1.1.2.2.2.3.1" xref="A5.E9.m1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A5.E9.m1.1.2.2.2.3.3" xref="A5.E9.m1.1.2.2.2.3.3.cmml">W</mi><mo id="A5.E9.m1.1.2.2.2.3.1a" xref="A5.E9.m1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A5.E9.m1.1.2.2.2.3.4" xref="A5.E9.m1.1.2.2.2.3.4.cmml">C</mi></mrow></msubsup><mo id="A5.E9.m1.1.2.1" xref="A5.E9.m1.1.2.1.cmml">=</mo><mrow id="A5.E9.m1.1.2.3" xref="A5.E9.m1.1.2.3.cmml"><msub id="A5.E9.m1.1.2.3.2" xref="A5.E9.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A5.E9.m1.1.2.3.2.2" xref="A5.E9.m1.1.2.3.2.2.cmml">ℒ</mi><mi id="A5.E9.m1.1.2.3.2.3" xref="A5.E9.m1.1.2.3.2.3.cmml">θ</mi></msub><mo id="A5.E9.m1.1.2.3.1" xref="A5.E9.m1.1.2.3.1.cmml">+</mo><mrow id="A5.E9.m1.1.2.3.3" xref="A5.E9.m1.1.2.3.3.cmml"><mi id="A5.E9.m1.1.2.3.3.2" xref="A5.E9.m1.1.2.3.3.2.cmml">λ</mi><mo id="A5.E9.m1.1.2.3.3.1" xref="A5.E9.m1.1.2.3.3.1.cmml">⁢</mo><mrow id="A5.E9.m1.1.2.3.3.3" xref="A5.E9.m1.1.2.3.3.3.cmml"><munder id="A5.E9.m1.1.2.3.3.3.1" xref="A5.E9.m1.1.2.3.3.3.1.cmml"><mo id="A5.E9.m1.1.2.3.3.3.1.2" movablelimits="false" xref="A5.E9.m1.1.2.3.3.3.1.2.cmml">∑</mo><mrow id="A5.E9.m1.1.1.1" xref="A5.E9.m1.1.1.1.cmml"><msub id="A5.E9.m1.1.1.1.3" xref="A5.E9.m1.1.1.1.3.cmml"><mi id="A5.E9.m1.1.1.1.3.2" xref="A5.E9.m1.1.1.1.3.2.cmml">θ</mi><mi id="A5.E9.m1.1.1.1.3.3" xref="A5.E9.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="A5.E9.m1.1.1.1.2" xref="A5.E9.m1.1.1.1.2.cmml">∈</mo><mrow id="A5.E9.m1.1.1.1.4.2" xref="A5.E9.m1.1.1.1.4.1.cmml"><mo id="A5.E9.m1.1.1.1.4.2.1" stretchy="false" xref="A5.E9.m1.1.1.1.4.1.cmml">{</mo><mi id="A5.E9.m1.1.1.1.1" xref="A5.E9.m1.1.1.1.1.cmml">θ</mi><mo id="A5.E9.m1.1.1.1.4.2.2" stretchy="false" xref="A5.E9.m1.1.1.1.4.1.cmml">}</mo></mrow></mrow></munder><mrow id="A5.E9.m1.1.2.3.3.3.2" xref="A5.E9.m1.1.2.3.3.3.2.cmml"><msub id="A5.E9.m1.1.2.3.3.3.2.2" xref="A5.E9.m1.1.2.3.3.3.2.2.cmml"><mi id="A5.E9.m1.1.2.3.3.3.2.2.2" xref="A5.E9.m1.1.2.3.3.3.2.2.2.cmml">F</mi><mi id="A5.E9.m1.1.2.3.3.3.2.2.3" xref="A5.E9.m1.1.2.3.3.3.2.2.3.cmml">i</mi></msub><mo id="A5.E9.m1.1.2.3.3.3.2.1" xref="A5.E9.m1.1.2.3.3.3.2.1.cmml">⁢</mo><mi id="A5.E9.m1.1.2.3.3.3.2.3" mathvariant="normal" xref="A5.E9.m1.1.2.3.3.3.2.3.cmml">Δ</mi><mo id="A5.E9.m1.1.2.3.3.3.2.1a" xref="A5.E9.m1.1.2.3.3.3.2.1.cmml">⁢</mo><msubsup id="A5.E9.m1.1.2.3.3.3.2.4" xref="A5.E9.m1.1.2.3.3.3.2.4.cmml"><mi id="A5.E9.m1.1.2.3.3.3.2.4.2.2" xref="A5.E9.m1.1.2.3.3.3.2.4.2.2.cmml">θ</mi><mi id="A5.E9.m1.1.2.3.3.3.2.4.2.3" xref="A5.E9.m1.1.2.3.3.3.2.4.2.3.cmml">i</mi><mn id="A5.E9.m1.1.2.3.3.3.2.4.3" xref="A5.E9.m1.1.2.3.3.3.2.4.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.E9.m1.1b"><apply id="A5.E9.m1.1.2.cmml" xref="A5.E9.m1.1.2"><eq id="A5.E9.m1.1.2.1.cmml" xref="A5.E9.m1.1.2.1"></eq><apply id="A5.E9.m1.1.2.2.cmml" xref="A5.E9.m1.1.2.2"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.2.1.cmml" xref="A5.E9.m1.1.2.2">subscript</csymbol><apply id="A5.E9.m1.1.2.2.2.cmml" xref="A5.E9.m1.1.2.2"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.2.2.1.cmml" xref="A5.E9.m1.1.2.2">superscript</csymbol><ci id="A5.E9.m1.1.2.2.2.2.cmml" xref="A5.E9.m1.1.2.2.2.2">ℒ</ci><apply id="A5.E9.m1.1.2.2.2.3.cmml" xref="A5.E9.m1.1.2.2.2.3"><times id="A5.E9.m1.1.2.2.2.3.1.cmml" xref="A5.E9.m1.1.2.2.2.3.1"></times><ci id="A5.E9.m1.1.2.2.2.3.2.cmml" xref="A5.E9.m1.1.2.2.2.3.2">𝐸</ci><ci id="A5.E9.m1.1.2.2.2.3.3.cmml" xref="A5.E9.m1.1.2.2.2.3.3">𝑊</ci><ci id="A5.E9.m1.1.2.2.2.3.4.cmml" xref="A5.E9.m1.1.2.2.2.3.4">𝐶</ci></apply></apply><ci id="A5.E9.m1.1.2.2.3.cmml" xref="A5.E9.m1.1.2.2.3">𝜃</ci></apply><apply id="A5.E9.m1.1.2.3.cmml" xref="A5.E9.m1.1.2.3"><plus id="A5.E9.m1.1.2.3.1.cmml" xref="A5.E9.m1.1.2.3.1"></plus><apply id="A5.E9.m1.1.2.3.2.cmml" xref="A5.E9.m1.1.2.3.2"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.3.2.1.cmml" xref="A5.E9.m1.1.2.3.2">subscript</csymbol><ci id="A5.E9.m1.1.2.3.2.2.cmml" xref="A5.E9.m1.1.2.3.2.2">ℒ</ci><ci id="A5.E9.m1.1.2.3.2.3.cmml" xref="A5.E9.m1.1.2.3.2.3">𝜃</ci></apply><apply id="A5.E9.m1.1.2.3.3.cmml" xref="A5.E9.m1.1.2.3.3"><times id="A5.E9.m1.1.2.3.3.1.cmml" xref="A5.E9.m1.1.2.3.3.1"></times><ci id="A5.E9.m1.1.2.3.3.2.cmml" xref="A5.E9.m1.1.2.3.3.2">𝜆</ci><apply id="A5.E9.m1.1.2.3.3.3.cmml" xref="A5.E9.m1.1.2.3.3.3"><apply id="A5.E9.m1.1.2.3.3.3.1.cmml" xref="A5.E9.m1.1.2.3.3.3.1"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.3.3.3.1.1.cmml" xref="A5.E9.m1.1.2.3.3.3.1">subscript</csymbol><sum id="A5.E9.m1.1.2.3.3.3.1.2.cmml" xref="A5.E9.m1.1.2.3.3.3.1.2"></sum><apply id="A5.E9.m1.1.1.1.cmml" xref="A5.E9.m1.1.1.1"><in id="A5.E9.m1.1.1.1.2.cmml" xref="A5.E9.m1.1.1.1.2"></in><apply id="A5.E9.m1.1.1.1.3.cmml" xref="A5.E9.m1.1.1.1.3"><csymbol cd="ambiguous" id="A5.E9.m1.1.1.1.3.1.cmml" xref="A5.E9.m1.1.1.1.3">subscript</csymbol><ci id="A5.E9.m1.1.1.1.3.2.cmml" xref="A5.E9.m1.1.1.1.3.2">𝜃</ci><ci id="A5.E9.m1.1.1.1.3.3.cmml" xref="A5.E9.m1.1.1.1.3.3">𝑖</ci></apply><set id="A5.E9.m1.1.1.1.4.1.cmml" xref="A5.E9.m1.1.1.1.4.2"><ci id="A5.E9.m1.1.1.1.1.cmml" xref="A5.E9.m1.1.1.1.1">𝜃</ci></set></apply></apply><apply id="A5.E9.m1.1.2.3.3.3.2.cmml" xref="A5.E9.m1.1.2.3.3.3.2"><times id="A5.E9.m1.1.2.3.3.3.2.1.cmml" xref="A5.E9.m1.1.2.3.3.3.2.1"></times><apply id="A5.E9.m1.1.2.3.3.3.2.2.cmml" xref="A5.E9.m1.1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.3.3.3.2.2.1.cmml" xref="A5.E9.m1.1.2.3.3.3.2.2">subscript</csymbol><ci id="A5.E9.m1.1.2.3.3.3.2.2.2.cmml" xref="A5.E9.m1.1.2.3.3.3.2.2.2">𝐹</ci><ci id="A5.E9.m1.1.2.3.3.3.2.2.3.cmml" xref="A5.E9.m1.1.2.3.3.3.2.2.3">𝑖</ci></apply><ci id="A5.E9.m1.1.2.3.3.3.2.3.cmml" xref="A5.E9.m1.1.2.3.3.3.2.3">Δ</ci><apply id="A5.E9.m1.1.2.3.3.3.2.4.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.3.3.3.2.4.1.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4">superscript</csymbol><apply id="A5.E9.m1.1.2.3.3.3.2.4.2.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4"><csymbol cd="ambiguous" id="A5.E9.m1.1.2.3.3.3.2.4.2.1.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4">subscript</csymbol><ci id="A5.E9.m1.1.2.3.3.3.2.4.2.2.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4.2.2">𝜃</ci><ci id="A5.E9.m1.1.2.3.3.3.2.4.2.3.cmml" xref="A5.E9.m1.1.2.3.3.3.2.4.2.3">𝑖</ci></apply><cn id="A5.E9.m1.1.2.3.3.3.2.4.3.cmml" type="integer" xref="A5.E9.m1.1.2.3.3.3.2.4.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.E9.m1.1c">\mathcal{L}^{EWC}_{\theta}=\mathcal{L}_{\theta}+\lambda\sum_{\theta_{i}\in\{%
\theta\}}F_{i}\Delta\theta_{i}^{2}</annotation><annotation encoding="application/x-llamapun" id="A5.E9.m1.1d">caligraphic_L start_POSTSUPERSCRIPT italic_E italic_W italic_C end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT + italic_λ ∑ start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { italic_θ } end_POSTSUBSCRIPT italic_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_Δ italic_θ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.SS7.p2.7">where <math alttext="F_{i}" class="ltx_Math" display="inline" id="A5.SS7.p2.7.m1.1"><semantics id="A5.SS7.p2.7.m1.1a"><msub id="A5.SS7.p2.7.m1.1.1" xref="A5.SS7.p2.7.m1.1.1.cmml"><mi id="A5.SS7.p2.7.m1.1.1.2" xref="A5.SS7.p2.7.m1.1.1.2.cmml">F</mi><mi id="A5.SS7.p2.7.m1.1.1.3" xref="A5.SS7.p2.7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS7.p2.7.m1.1b"><apply id="A5.SS7.p2.7.m1.1.1.cmml" xref="A5.SS7.p2.7.m1.1.1"><csymbol cd="ambiguous" id="A5.SS7.p2.7.m1.1.1.1.cmml" xref="A5.SS7.p2.7.m1.1.1">subscript</csymbol><ci id="A5.SS7.p2.7.m1.1.1.2.cmml" xref="A5.SS7.p2.7.m1.1.1.2">𝐹</ci><ci id="A5.SS7.p2.7.m1.1.1.3.cmml" xref="A5.SS7.p2.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS7.p2.7.m1.1c">F_{i}</annotation><annotation encoding="application/x-llamapun" id="A5.SS7.p2.7.m1.1d">italic_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is estimated by calculating the batch average of the squared gradients of the parameters.</p>
</div>
<div class="ltx_para" id="A5.SS7.p3">
<p class="ltx_p" id="A5.SS7.p3.1">For Self-Distill, we first use the official prompt of <cite class="ltx_cite ltx_citemacro_citet"><span class="ltx_text" style="font-size:90%;">Yang et al.</span> [<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib78" title=""><span class="ltx_text" style="font-size:90%;">78</span></a>]</cite> to generate the distilled Alpaca-GPT4 dataset using Qwen1.5-1.8B and fine-tune it using the distilled dataset with the same experiment setting with vanilla fine-tuning.</p>
</div>
<figure class="ltx_table" id="A5.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A5.T7.4.1.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="A5.T7.5.2" style="font-size:90%;">Comparison of <span class="ltx_text ltx_font_smallcaps" id="A5.T7.5.2.1">TAIA</span> with vanilla fine-tuning on hallucination resistance. When fine-tuned on datasets with different quality levels, <span class="ltx_text ltx_font_smallcaps" id="A5.T7.5.2.2">TAIA</span> harvests lower performance drops than vanilla fine-tuning, showing its strong generalization in distilling out hallucinated features.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A5.T7.6">
<tr class="ltx_tr" id="A5.T7.6.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.1.1"><span class="ltx_text ltx_font_bold" id="A5.T7.6.1.1.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T7.6.1.2"><span class="ltx_text ltx_font_bold" id="A5.T7.6.1.2.1">Qwen1.5 1.8B</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T7.6.1.3"><span class="ltx_text ltx_font_bold" id="A5.T7.6.1.3.1">Qwen1.5 7B</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T7.6.1.4"><span class="ltx_text ltx_font_bold" id="A5.T7.6.1.4.1">LLaMA2 7B</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A5.T7.6.1.5"><span class="ltx_text ltx_font_bold" id="A5.T7.6.1.5.1">LLaMA3 8B</span></td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T7.6.2.1">Base Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T7.6.2.2">4.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T7.6.2.3">24.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T7.6.2.4">7.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T7.6.2.5">26.31</td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.3">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="A5.T7.6.3.1"><span class="ltx_text ltx_font_italic" id="A5.T7.6.3.1.1">ShareGPT-52K</span></td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.4">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.4.1">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.4.2">1.22</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.4.3">1.67</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.4.4">1.99</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.4.5">3.52</td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.5">
<td class="ltx_td ltx_align_center" id="A5.T7.6.5.1"><span class="ltx_text ltx_font_smallcaps" id="A5.T7.6.5.1.1">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A5.T7.6.5.2"><span class="ltx_text ltx_font_bold" id="A5.T7.6.5.2.1">4.37</span></td>
<td class="ltx_td ltx_align_center" id="A5.T7.6.5.3"><span class="ltx_text ltx_font_bold" id="A5.T7.6.5.3.1">9.68</span></td>
<td class="ltx_td ltx_align_center" id="A5.T7.6.5.4"><span class="ltx_text ltx_font_bold" id="A5.T7.6.5.4.1">4.87</span></td>
<td class="ltx_td ltx_align_center" id="A5.T7.6.5.5"><span class="ltx_text ltx_font_bold" id="A5.T7.6.5.5.1">7.64</span></td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.6">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="A5.T7.6.6.1"><span class="ltx_text ltx_font_italic" id="A5.T7.6.6.1.1">Alpaca-GPT4</span></td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.7">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.7.1">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.7.2"><span class="ltx_text ltx_font_bold" id="A5.T7.6.7.2.1">5.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.7.3">10.42</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.7.4">7.46</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T7.6.7.5">16.34</td>
</tr>
<tr class="ltx_tr" id="A5.T7.6.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T7.6.8.1"><span class="ltx_text ltx_font_smallcaps" id="A5.T7.6.8.1.1">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T7.6.8.2">4.98</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T7.6.8.3"><span class="ltx_text ltx_font_bold" id="A5.T7.6.8.3.1">11.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T7.6.8.4"><span class="ltx_text ltx_font_bold" id="A5.T7.6.8.4.1">9.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T7.6.8.5"><span class="ltx_text ltx_font_bold" id="A5.T7.6.8.5.1">18.33</span></td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Supplementary Experiments</h2>
<section class="ltx_subsection" id="A6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>More Results of <span class="ltx_text ltx_font_smallcaps" id="A6.SS1.1.1">TAIA</span> on Helpfulness</h3>
<div class="ltx_para" id="A6.SS1.p1">
<p class="ltx_p" id="A6.SS1.p1.1">We here discuss the effect of data quality on <span class="ltx_text ltx_font_smallcaps" id="A6.SS1.p1.1.1">TAIA</span>.
We select two fine-tuning datasets, ShareGPT-52K <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib57" title=""><span class="ltx_text" style="font-size:90%;">57</span></a>]</cite> generated from <span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.1.2">gpt-3.5-turbo</span> and Alpaca-GPT4 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite> generated from GPT4 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">45</span></a>]</cite>.
ShareGPT-52K collects data from both GPT API and websites, so it contains noisy samples or hallucinations, including misspelled words or repeated sentences.
On the other hand, Alpaca-GPT4 collects samples generated through Self-Instruct <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib70" title=""><span class="ltx_text" style="font-size:90%;">70</span></a>]</cite>, in which the automatic generation process guarantees fewer noisy contents.
We aim to verify whether <span class="ltx_text ltx_font_smallcaps" id="A6.SS1.p1.1.3">TAIA</span> still benefits from low-quality data.
We choose Alpaca-Eval <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite> as the evaluation set which uses GPT4 as the evaluator.
We use the same hyperparameter settings as §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S4.SS2" title="4.2 Experiment Details ‣ 4 Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a> to train each model family on these two datasets and display the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A5.T7" title="Table 7 ‣ E.7 Comparing with OOD Generalization Methods ‣ Appendix E Experiment Details ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">7</span></a>.
We observe that the noisy contents bring a significant decrease in helpfulness across all LLM families with the vanilla fine-tuning technique.
In contrast, <span class="ltx_text ltx_font_smallcaps" id="A6.SS1.p1.1.4">TAIA</span> reduces such performance drops, especially when tuned in the ShareGPT-52K dataset, and even harvests higher helpfulness than base LLMs when they are relatively weak (e.g., Qwen 1.8B and LLaMA2 7B).</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Different LoRA Ranks Experiments</h3>
<div class="ltx_para" id="A6.SS2.p1">
<p class="ltx_p" id="A6.SS2.p1.6">In this section, we explore the impact of varying the LoRA ranks in the attention and FFN modules on the TAIA. We fine-tuned the Qwen1.5-1.8B model on the medical collection dataset and tested its performance on the general knowledge benchmark under different conditions. We use <math alttext="ar" class="ltx_Math" display="inline" id="A6.SS2.p1.1.m1.1"><semantics id="A6.SS2.p1.1.m1.1a"><mrow id="A6.SS2.p1.1.m1.1.1" xref="A6.SS2.p1.1.m1.1.1.cmml"><mi id="A6.SS2.p1.1.m1.1.1.2" xref="A6.SS2.p1.1.m1.1.1.2.cmml">a</mi><mo id="A6.SS2.p1.1.m1.1.1.1" xref="A6.SS2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.1.m1.1.1.3" xref="A6.SS2.p1.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.1.m1.1b"><apply id="A6.SS2.p1.1.m1.1.1.cmml" xref="A6.SS2.p1.1.m1.1.1"><times id="A6.SS2.p1.1.m1.1.1.1.cmml" xref="A6.SS2.p1.1.m1.1.1.1"></times><ci id="A6.SS2.p1.1.m1.1.1.2.cmml" xref="A6.SS2.p1.1.m1.1.1.2">𝑎</ci><ci id="A6.SS2.p1.1.m1.1.1.3.cmml" xref="A6.SS2.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.1.m1.1c">ar</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.1.m1.1d">italic_a italic_r</annotation></semantics></math> and <math alttext="fr" class="ltx_Math" display="inline" id="A6.SS2.p1.2.m2.1"><semantics id="A6.SS2.p1.2.m2.1a"><mrow id="A6.SS2.p1.2.m2.1.1" xref="A6.SS2.p1.2.m2.1.1.cmml"><mi id="A6.SS2.p1.2.m2.1.1.2" xref="A6.SS2.p1.2.m2.1.1.2.cmml">f</mi><mo id="A6.SS2.p1.2.m2.1.1.1" xref="A6.SS2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.2.m2.1.1.3" xref="A6.SS2.p1.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.2.m2.1b"><apply id="A6.SS2.p1.2.m2.1.1.cmml" xref="A6.SS2.p1.2.m2.1.1"><times id="A6.SS2.p1.2.m2.1.1.1.cmml" xref="A6.SS2.p1.2.m2.1.1.1"></times><ci id="A6.SS2.p1.2.m2.1.1.2.cmml" xref="A6.SS2.p1.2.m2.1.1.2">𝑓</ci><ci id="A6.SS2.p1.2.m2.1.1.3.cmml" xref="A6.SS2.p1.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.2.m2.1c">fr</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.2.m2.1d">italic_f italic_r</annotation></semantics></math> to represent the rank of attention and FFN modules, respectively. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T13" title="Table 13 ‣ F.6 Model Scaling of TAIA ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">13</span></a>, when the <math alttext="ar" class="ltx_Math" display="inline" id="A6.SS2.p1.3.m3.1"><semantics id="A6.SS2.p1.3.m3.1a"><mrow id="A6.SS2.p1.3.m3.1.1" xref="A6.SS2.p1.3.m3.1.1.cmml"><mi id="A6.SS2.p1.3.m3.1.1.2" xref="A6.SS2.p1.3.m3.1.1.2.cmml">a</mi><mo id="A6.SS2.p1.3.m3.1.1.1" xref="A6.SS2.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.3.m3.1.1.3" xref="A6.SS2.p1.3.m3.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.3.m3.1b"><apply id="A6.SS2.p1.3.m3.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1"><times id="A6.SS2.p1.3.m3.1.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1.1"></times><ci id="A6.SS2.p1.3.m3.1.1.2.cmml" xref="A6.SS2.p1.3.m3.1.1.2">𝑎</ci><ci id="A6.SS2.p1.3.m3.1.1.3.cmml" xref="A6.SS2.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.3.m3.1c">ar</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.3.m3.1d">italic_a italic_r</annotation></semantics></math> is less than or equal to <math alttext="fr" class="ltx_Math" display="inline" id="A6.SS2.p1.4.m4.1"><semantics id="A6.SS2.p1.4.m4.1a"><mrow id="A6.SS2.p1.4.m4.1.1" xref="A6.SS2.p1.4.m4.1.1.cmml"><mi id="A6.SS2.p1.4.m4.1.1.2" xref="A6.SS2.p1.4.m4.1.1.2.cmml">f</mi><mo id="A6.SS2.p1.4.m4.1.1.1" xref="A6.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.4.m4.1.1.3" xref="A6.SS2.p1.4.m4.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.4.m4.1b"><apply id="A6.SS2.p1.4.m4.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1"><times id="A6.SS2.p1.4.m4.1.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1.1"></times><ci id="A6.SS2.p1.4.m4.1.1.2.cmml" xref="A6.SS2.p1.4.m4.1.1.2">𝑓</ci><ci id="A6.SS2.p1.4.m4.1.1.3.cmml" xref="A6.SS2.p1.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.4.m4.1c">fr</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.4.m4.1d">italic_f italic_r</annotation></semantics></math>, the TAIA achieves the best performance among the three cases and significantly surpasses the Vanilla. However, when the <math alttext="ar" class="ltx_Math" display="inline" id="A6.SS2.p1.5.m5.1"><semantics id="A6.SS2.p1.5.m5.1a"><mrow id="A6.SS2.p1.5.m5.1.1" xref="A6.SS2.p1.5.m5.1.1.cmml"><mi id="A6.SS2.p1.5.m5.1.1.2" xref="A6.SS2.p1.5.m5.1.1.2.cmml">a</mi><mo id="A6.SS2.p1.5.m5.1.1.1" xref="A6.SS2.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.5.m5.1.1.3" xref="A6.SS2.p1.5.m5.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.5.m5.1b"><apply id="A6.SS2.p1.5.m5.1.1.cmml" xref="A6.SS2.p1.5.m5.1.1"><times id="A6.SS2.p1.5.m5.1.1.1.cmml" xref="A6.SS2.p1.5.m5.1.1.1"></times><ci id="A6.SS2.p1.5.m5.1.1.2.cmml" xref="A6.SS2.p1.5.m5.1.1.2">𝑎</ci><ci id="A6.SS2.p1.5.m5.1.1.3.cmml" xref="A6.SS2.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.5.m5.1c">ar</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.5.m5.1d">italic_a italic_r</annotation></semantics></math> is larger than <math alttext="fr" class="ltx_Math" display="inline" id="A6.SS2.p1.6.m6.1"><semantics id="A6.SS2.p1.6.m6.1a"><mrow id="A6.SS2.p1.6.m6.1.1" xref="A6.SS2.p1.6.m6.1.1.cmml"><mi id="A6.SS2.p1.6.m6.1.1.2" xref="A6.SS2.p1.6.m6.1.1.2.cmml">f</mi><mo id="A6.SS2.p1.6.m6.1.1.1" xref="A6.SS2.p1.6.m6.1.1.1.cmml">⁢</mo><mi id="A6.SS2.p1.6.m6.1.1.3" xref="A6.SS2.p1.6.m6.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.6.m6.1b"><apply id="A6.SS2.p1.6.m6.1.1.cmml" xref="A6.SS2.p1.6.m6.1.1"><times id="A6.SS2.p1.6.m6.1.1.1.cmml" xref="A6.SS2.p1.6.m6.1.1.1"></times><ci id="A6.SS2.p1.6.m6.1.1.2.cmml" xref="A6.SS2.p1.6.m6.1.1.2">𝑓</ci><ci id="A6.SS2.p1.6.m6.1.1.3.cmml" xref="A6.SS2.p1.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.6.m6.1c">fr</annotation><annotation encoding="application/x-llamapun" id="A6.SS2.p1.6.m6.1d">italic_f italic_r</annotation></semantics></math>, the performance of the TAIA lags behind the TAIF.
This indicates that with more parameter alteration, self-attention will function more as FFN to encode knowledge, which brings significant knowledge overlap with pretrained models and finally results in worse knowledge understanding performances.</p>
</div>
</section>
<section class="ltx_subsection" id="A6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.3 </span>Full Results on Dataset Scales</h3>
<div class="ltx_para" id="A6.SS3.p1">
<p class="ltx_p" id="A6.SS3.p1.1">We present the full experiment results discussed in RQ3 of §<a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S5" title="5 Analysis ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">5</span></a> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T14" title="Table 14 ‣ F.6 Model Scaling of TAIA ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">14</span></a>.</p>
</div>
<figure class="ltx_figure" id="A6.SS3.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="A6.SS3.1.fig1" style="width:221.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="A6.SS3.1.fig1.1" style="width:433.6pt;height:97.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(16.7pt,-3.7pt) scale(1.08329560999449,1.08329560999449) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.SS3.1.fig1.1.1">
<tr class="ltx_tr" id="A6.SS3.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.1.1">Mixing Schedule</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.2.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.3.1">OOD (20K)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.4.1">OOD (40K)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.5.1">OOD (60K)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.1.fig1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.1.6.1">OOD (80K)</span></td>
</tr>
<tr class="ltx_tr" id="A6.SS3.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.2.1">Uniform</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.SS3.1.fig1.1.1.2.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.2.3">58.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.2.4">58.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.2.5">59.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.2.6">57.15</td>
</tr>
<tr class="ltx_tr" id="A6.SS3.1.fig1.1.1.3">
<td class="ltx_td" id="A6.SS3.1.fig1.1.1.3.1"></td>
<td class="ltx_td ltx_align_left" id="A6.SS3.1.fig1.1.1.3.2">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.SS3.1.fig1.1.1.3.3">64.74</td>
<td class="ltx_td ltx_align_center" id="A6.SS3.1.fig1.1.1.3.4"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.3.4.1">64.59</span></td>
<td class="ltx_td ltx_align_center" id="A6.SS3.1.fig1.1.1.3.5">64.62</td>
<td class="ltx_td ltx_align_center" id="A6.SS3.1.fig1.1.1.3.6">64.80</td>
</tr>
<tr class="ltx_tr" id="A6.SS3.1.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.4.1">Linear Annealing</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.SS3.1.fig1.1.1.4.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.4.3">60.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.4.4">58.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.4.5">60.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.1.fig1.1.1.4.6">63.16</td>
</tr>
<tr class="ltx_tr" id="A6.SS3.1.fig1.1.1.5">
<td class="ltx_td ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.1"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.2">TAIA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.3"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.5.3.1">64.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.4">64.42</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.5"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.5.5.1">64.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.1.fig1.1.1.5.6"><span class="ltx_text ltx_font_bold" id="A6.SS3.1.fig1.1.1.5.6.1">65.18</span></td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T8.4.1.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="A6.T8.5.2" style="font-size:90%;">
Data mixture ablation on the OOD data ratio. We compare vanilla LoRA tuning with <span class="ltx_text ltx_font_smallcaps" id="A6.T8.5.2.1">TAIA</span> on two mixture strategies: uniform mixture and linear annealing mixture. <span class="ltx_text ltx_font_smallcaps" id="A6.T8.5.2.2">TAIA</span> achieves best performance under both settings.

</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="A6.SS3.2.fig2" style="width:199.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A6.SS3.2.fig2.1" style="width:433.6pt;height:106.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(34.3pt,-8.5pt) scale(1.18808819683075,1.18808819683075) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.SS3.2.fig2.1.1">
<tr class="ltx_tr" id="A6.SS3.2.fig2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS3.2.fig2.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.1.1.1">Methods</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A6.SS3.2.fig2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.1.2.1">1-stage</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="A6.SS3.2.fig2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.1.3.1">2-stage</span></td>
</tr>
<tr class="ltx_tr" id="A6.SS3.2.fig2.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.SS3.2.fig2.1.1.2.1">ID (20K)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.2.2">OOD (20k)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.2.3">OOD (40k)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.2.4">OOD (60k)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.2.5">OOD (80k)</td>
</tr>
<tr class="ltx_tr" id="A6.SS3.2.fig2.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.1">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.2">62.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.3">28.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.4">26.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.5">30.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS3.2.fig2.1.1.3.6">30.18</td>
</tr>
<tr class="ltx_tr" id="A6.SS3.2.fig2.1.1.4">
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.1">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.2"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.4.2.1">64.07</span></td>
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.3"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.4.3.1">49.71</span></td>
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.4"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.4.4.1">50.61</span></td>
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.5"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.4.5.1">47.43</span></td>
<td class="ltx_td ltx_align_center" id="A6.SS3.2.fig2.1.1.4.6"><span class="ltx_text ltx_font_bold" id="A6.SS3.2.fig2.1.1.4.6.1">51.05</span></td>
</tr>
<tr class="ltx_tr" id="A6.SS3.2.fig2.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.1">TOA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.3">27.99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.4">27.64</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.5">28.92</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS3.2.fig2.1.1.5.6">30.65</td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T9.3.1.1" style="font-size:90%;">Table 9</span>: </span><span class="ltx_text" id="A6.T9.4.2" style="font-size:90%;">
Rather than using the one-stage data mixture training setting, we compare <span class="ltx_text ltx_font_smallcaps" id="A6.T9.4.2.1">TAIA</span> with the vanilla method with a two-stage paradigm, where the ID data is served as the first stage training data and we explicitly separate OOD data in the second stage.

</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.4 </span>More Discussion on ID/OOD Data</h3>
<div class="ltx_para" id="A6.SS4.p1">
<p class="ltx_p" id="A6.SS4.p1.1">We here empirically validate that the mixture of ID and OOD data as the training set of <span class="ltx_text ltx_font_smallcaps" id="A6.SS4.p1.1.1">TAIA</span> is a sweet configuration compared to other settings.
Following the experiment setting in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S0.F1.sf3" title="In Figure 1 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1(c)</span></a>, we fine-tune Qwen1.5-1.8B models with LoRA where <math alttext="r=16,\alpha=32" class="ltx_Math" display="inline" id="A6.SS4.p1.1.m1.2"><semantics id="A6.SS4.p1.1.m1.2a"><mrow id="A6.SS4.p1.1.m1.2.2.2" xref="A6.SS4.p1.1.m1.2.2.3.cmml"><mrow id="A6.SS4.p1.1.m1.1.1.1.1" xref="A6.SS4.p1.1.m1.1.1.1.1.cmml"><mi id="A6.SS4.p1.1.m1.1.1.1.1.2" xref="A6.SS4.p1.1.m1.1.1.1.1.2.cmml">r</mi><mo id="A6.SS4.p1.1.m1.1.1.1.1.1" xref="A6.SS4.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A6.SS4.p1.1.m1.1.1.1.1.3" xref="A6.SS4.p1.1.m1.1.1.1.1.3.cmml">16</mn></mrow><mo id="A6.SS4.p1.1.m1.2.2.2.3" xref="A6.SS4.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="A6.SS4.p1.1.m1.2.2.2.2" xref="A6.SS4.p1.1.m1.2.2.2.2.cmml"><mi id="A6.SS4.p1.1.m1.2.2.2.2.2" xref="A6.SS4.p1.1.m1.2.2.2.2.2.cmml">α</mi><mo id="A6.SS4.p1.1.m1.2.2.2.2.1" xref="A6.SS4.p1.1.m1.2.2.2.2.1.cmml">=</mo><mn id="A6.SS4.p1.1.m1.2.2.2.2.3" xref="A6.SS4.p1.1.m1.2.2.2.2.3.cmml">32</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS4.p1.1.m1.2b"><apply id="A6.SS4.p1.1.m1.2.2.3.cmml" xref="A6.SS4.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="A6.SS4.p1.1.m1.2.2.3a.cmml" xref="A6.SS4.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A6.SS4.p1.1.m1.1.1.1.1.cmml" xref="A6.SS4.p1.1.m1.1.1.1.1"><eq id="A6.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="A6.SS4.p1.1.m1.1.1.1.1.1"></eq><ci id="A6.SS4.p1.1.m1.1.1.1.1.2.cmml" xref="A6.SS4.p1.1.m1.1.1.1.1.2">𝑟</ci><cn id="A6.SS4.p1.1.m1.1.1.1.1.3.cmml" type="integer" xref="A6.SS4.p1.1.m1.1.1.1.1.3">16</cn></apply><apply id="A6.SS4.p1.1.m1.2.2.2.2.cmml" xref="A6.SS4.p1.1.m1.2.2.2.2"><eq id="A6.SS4.p1.1.m1.2.2.2.2.1.cmml" xref="A6.SS4.p1.1.m1.2.2.2.2.1"></eq><ci id="A6.SS4.p1.1.m1.2.2.2.2.2.cmml" xref="A6.SS4.p1.1.m1.2.2.2.2.2">𝛼</ci><cn id="A6.SS4.p1.1.m1.2.2.2.2.3.cmml" type="integer" xref="A6.SS4.p1.1.m1.2.2.2.2.3">32</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS4.p1.1.m1.2c">r=16,\alpha=32</annotation><annotation encoding="application/x-llamapun" id="A6.SS4.p1.1.m1.2d">italic_r = 16 , italic_α = 32</annotation></semantics></math>. We design three types of methods to differentiate the ID and OOD data during the fine-tuning process:</p>
<ol class="ltx_enumerate" id="A6.I1">
<li class="ltx_item" id="A6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A6.I1.i1.p1">
<p class="ltx_p" id="A6.I1.i1.p1.1">Rather than mixing the ID and OOD data evenly in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#S0.F1.sf3" title="In Figure 1 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">1(c)</span></a>, we adopt linear annealing to gradually decrease the proportion of ID data from 1 to 0 as training progresses.</p>
</div>
</li>
<li class="ltx_item" id="A6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A6.I1.i2.p1">
<p class="ltx_p" id="A6.I1.i2.p1.1">We fine-tune the Qwen1.5-1.8B with 20k ID data in the first stage and 20-80k OOD data in the second stage. Note that we adopt 2-stage fine-tuning based on <span class="ltx_text ltx_font_smallcaps" id="A6.I1.i2.p1.1.1">TAIA</span>-tuned models for better performance.</p>
</div>
</li>
<li class="ltx_item" id="A6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="A6.I1.i3.p1">
<p class="ltx_p" id="A6.I1.i3.p1.1">We follow experiment 2’s setting but we fine-tune the Qwen1.5-1.8B with 20-80k OOD data in the first stage and 20k ID data in the second stage.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="A6.SS4.p1.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T8" title="Table 8 ‣ F.3 Full Results on Dataset Scales ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">8</span></a> shows that the linear annealing method can mitigate the noise introduced by OOD data, while TAIA can further enhance the model’s ability to utilize OOD data, thereby achieving higher performance on ID data.
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T9" title="Table 9 ‣ F.3 Full Results on Dataset Scales ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">9</span></a> indicates that the 2-stage fine-tuning of OOD data causes a serious performance drop. The first stage not only fits the model to the ID data distribution but also causes the model to lose its generalization ability, making it more sensitive to the noise introduced by OOD data. As a result, the 2-stage fine-tuning method severely degraded the model’s performance.
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T10" title="Table 10 ‣ F.4 More Discussion on ID/OOD Data ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">10</span></a> demonstrates that compared to the results of Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T9" title="Table 9 ‣ F.3 Full Results on Dataset Scales ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">9</span></a>, the models fine-tuned on the OOD data in the 1-stage retain their generalization ability due to the data diversity of the CoT-Collection. However, the results show that such differentiation of the ID and OOD data still fails to improve performance further in the data mixing scenario.
As a result, we use the simple yet effective data mixing setting and adopt one-stage training methodology across the whole paper.</p>
</div>
<figure class="ltx_figure" id="A6.SS4.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="A6.SS4.1.fig1" style="width:221.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="A6.SS4.1.fig1.1" style="width:433.6pt;height:77.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(15.4pt,-2.8pt) scale(1.07649749614701,1.07649749614701) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.SS4.1.fig1.1.1">
<tr class="ltx_tr" id="A6.SS4.1.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.1.1">Settings</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.2.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.3.1">OOD(20k)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.4.1">OOD(40k)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.5.1">OOD(60k)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.1.fig1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.1.6.1">OOD(80k)</span></td>
</tr>
<tr class="ltx_tr" id="A6.SS4.1.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.1">1-stage</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.2">TAIA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.3"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.2.3.1">62.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.4"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.2.4.1">61.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.5">61.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.2.6">61.23</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.1.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.SS4.1.fig1.1.1.3.1" rowspan="2"><span class="ltx_text" id="A6.SS4.1.fig1.1.1.3.1.1">2-stage (w/ ID data)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.3.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.3.3">59.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.3.4">59.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.3.5">59.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.1.fig1.1.1.3.6">59.25</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.1.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.1.fig1.1.1.4.1">TAIA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.1.fig1.1.1.4.2">60.68</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.1.fig1.1.1.4.3">59.60</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.1.fig1.1.1.4.4">60.97</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.1.fig1.1.1.4.5"><span class="ltx_text ltx_font_bold" id="A6.SS4.1.fig1.1.1.4.5.1">61.44</span></td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T10.2.1.1" style="font-size:90%;">Table 10</span>: </span><span class="ltx_text" id="A6.T10.3.2" style="font-size:90%;">
We follow Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T9" title="Table 9 ‣ F.3 Full Results on Dataset Scales ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">9</span></a>’s setting but we fine-tune the Qwen1.5-1.8B with 20-80k OOD data in the first stage and 20k ID data in the second stage.

</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="A6.SS4.2.fig2" style="width:199.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A6.SS4.2.fig2.1" style="width:433.6pt;height:154.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(90.4pt,-32.2pt) scale(1.71556748244964,1.71556748244964) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.SS4.2.fig2.1.1">
<tr class="ltx_tr" id="A6.SS4.2.fig2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.SS4.2.fig2.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A6.SS4.2.fig2.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.1.2.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.1.2.1.1" style="width:71.3pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.1.2.1.1.1">MATH</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A6.SS4.2.fig2.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.1.3.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.1.3.1.1" style="width:48.4pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.1.3.1.1.1">Medical</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A6.SS4.2.fig2.1.1.1.4">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.1.4.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.1.4.1.1" style="width:54.6pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.1.4.1.1.1">CoT</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.2.fig2.1.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.2.1.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.2.1.1.1" style="width:71.3pt;">Sim/Acc</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.2.2.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.2.2.1.1" style="width:48.4pt;">Sim/Acc</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.2.3.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.2.3.1.1" style="width:54.6pt;">Sim/Acc</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.2.fig2.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.SS4.2.fig2.1.1.3.1">Vanilla</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.3.2.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.3.2.1.1" style="width:71.3pt;">87.50/50.56</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.3.3.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.3.3.1.1" style="width:48.4pt;">78.97/37.74</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A6.SS4.2.fig2.1.1.3.4">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.3.4.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.3.4.1.1" style="width:54.6pt;">77.92/24.67</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.2.fig2.1.1.4">
<td class="ltx_td ltx_align_center" id="A6.SS4.2.fig2.1.1.4.1">TAIF</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A6.SS4.2.fig2.1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.4.2.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.4.2.1.1" style="width:71.3pt;">96.39/54.85</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A6.SS4.2.fig2.1.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.4.3.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.4.3.1.1" style="width:48.4pt;">84.53/45.62</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="A6.SS4.2.fig2.1.1.4.4">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.4.4.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.4.4.1.1" style="width:54.6pt;">85.83/26.75</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A6.SS4.2.fig2.1.1.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.SS4.2.fig2.1.1.5.1">TAIA</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A6.SS4.2.fig2.1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.5.2.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.5.2.1.1" style="width:71.3pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.5.2.1.1.1">96.44/56.32</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A6.SS4.2.fig2.1.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.5.3.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.5.3.1.1" style="width:48.4pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.5.3.1.1.1">95.91/55.57</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A6.SS4.2.fig2.1.1.5.4">
<span class="ltx_inline-block ltx_align_top" id="A6.SS4.2.fig2.1.1.5.4.1">
<span class="ltx_p" id="A6.SS4.2.fig2.1.1.5.4.1.1" style="width:54.6pt;"><span class="ltx_text ltx_font_bold" id="A6.SS4.2.fig2.1.1.5.4.1.1.1">91.92/54.38</span></span>
</span>
</td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T11.2.1.1" style="font-size:90%;">Table 11</span>: </span><span class="ltx_text" id="A6.T11.3.2" style="font-size:90%;">
Similarity/performance comparison with pre-trained models, where ‘Sim’ represents the hidden state similarity with pre-trained model and ‘Acc’ is the downstream performance on C-Eval.

</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="A6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.5 </span>Success of <span class="ltx_text ltx_font_smallcaps" id="A6.SS5.1.1">TAIA</span>: A Similarity Perspective</h3>
<div class="ltx_para" id="A6.SS5.p1">
<p class="ltx_p" id="A6.SS5.p1.1">In this experiment, we measure similarity to the pre-trained model. This would measure whether TAIA is essentially regularizing the model towards the pre-trained model (similar to what L2 or EWC would do, but apparently better).
We compute the hidden state similarity after each layer and average them just as Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A0.F5" title="Figure 5 ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">5</span></a>’s setting.
The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T11" title="Table 11 ‣ F.4 More Discussion on ID/OOD Data ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">11</span></a>.
The results reflect that TAIA regularizes the fine-tuned model in an implicit manner without disturbing the learning and parameter exploration, which happens in other regularization methods like L2 and EWC.</p>
</div>
<figure class="ltx_table" id="A6.T12">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T12.4.1.1" style="font-size:90%;">Table 12</span>: </span><span class="ltx_text" id="A6.T12.5.2" style="font-size:90%;">Model size scaling of <span class="ltx_text ltx_font_smallcaps" id="A6.T12.5.2.1">TAIA</span>. We choose 7B, 14B, 32B of Qwen1.5 series as the pre-trained models. <span class="ltx_text ltx_font_smallcaps" id="A6.T12.5.2.2">TAIA</span> maintains the best performance based on even larger pre-trained models.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A6.T12.6" style="width:433.6pt;height:175.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.3pt,11.1pt) scale(0.888109229073404,0.888109229073404) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.T12.6.1">
<tr class="ltx_tr" id="A6.T12.6.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T12.6.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T12.6.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.1.2.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="A6.T12.6.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.1.3.1">Reasoning</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A6.T12.6.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.1.4.1">Knowledge</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T12.6.1.1.5" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.1.5.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.2">
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.2.1">MATH</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.2.2">BBH</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.2.3">CQA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.2.4">LogiQA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.2.5">SVAMP</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.2.6">MMB</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.2.7">MMLU</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.1" rowspan="3"><span class="ltx_text" id="A6.T12.6.1.3.1.1">Qwen1.5-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.3.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.3">20.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.4">30.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.5">78.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.6">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.3.7">54.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.8">45.09</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.3.9">57.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.3.10">47.11</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.4.1">LoRA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.2">17.90</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.3">36.09</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.4">77.31</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.5">37.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.4.6">57.10</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.7">44.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.4.8">54.89</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.4.9">46.50</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.5.1">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.2">24.98</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.3">43.46</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.4">77.31</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.5">41.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.5.6">67.20</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.7">46.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.5.8">57.29</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.5.9"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.5.9.1">51.27</span></td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.1" rowspan="3"><span class="ltx_text" id="A6.T12.6.1.6.1.1">Qwen1.5-14B</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.6.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.3">45.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.4">43.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.5">77.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.6">47.16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.6.7">83.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.8">51.06</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.6.9">66.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.6.10">59.35</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.7.1">LoRA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.2">38.74</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.3">41.65</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.4">74.45</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.5">41.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.7.6">82.80</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.7">48.15</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.7.8">63.71</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.7.9">55.90</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.8.1">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.2">55.51</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.3">46.06</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.4">77.31</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.5">46.39</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.8.6">83.10</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.7">52.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.8.8">65.48</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.8.9"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.8.9.1">60.92</span></td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T12.6.1.9.1" rowspan="3"><span class="ltx_text" id="A6.T12.6.1.9.1.1">Qwen1.5-32B</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.9.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.3">41.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.4">48.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.5">80.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.6">50.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.9.7">87.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.8">61.04</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T12.6.1.9.9">73.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.6.1.9.10">63.26</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.10.1">LoRA</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.2">39.12</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.3">46.29</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.4">77.81</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.5">49.31</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.10.6">82.60</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.7">59.54</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T12.6.1.10.8">71.02</td>
<td class="ltx_td ltx_align_center" id="A6.T12.6.1.10.9">60.81</td>
</tr>
<tr class="ltx_tr" id="A6.T12.6.1.11">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T12.6.1.11.1">TAIA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.2">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.3">52.63</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.4">82.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.5">48.69</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T12.6.1.11.6">86.20</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.7">61.98</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T12.6.1.11.8">72.63</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.6.1.11.9"><span class="ltx_text ltx_font_bold" id="A6.T12.6.1.11.9.1">63.88</span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="A6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.6 </span>Model Scaling of <span class="ltx_text ltx_font_smallcaps" id="A6.SS6.1.1">TAIA</span>
</h3>
<div class="ltx_para" id="A6.SS6.p1">
<p class="ltx_p" id="A6.SS6.p1.1">To investigate what happens with even larger scale models, we conduct experiments based on the 14B and 32B sizes of Qwen1.5 using LoRA tuning and Alpaca-GPT4 data and show the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T12" title="Table 12 ‣ F.5 Success of TAIA: A Similarity Perspective ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">12</span></a> shows that TAIA still outperforms both the base model and LoRA tuning model with Alpaca-GPT4 data, especially in reasoning tasks like MATH and BBH, which further verifies the effectiveness of TAIA.</p>
</div>
<figure class="ltx_table" id="A6.T13">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T13.2.1.1" style="font-size:90%;">Table 13</span>: </span><span class="ltx_text" id="A6.T13.3.2" style="font-size:90%;">Experiments of the different ranks of Attention/FFN LoRA. The ranks of attention and FFN module are noted as ‘ar’ and ‘fr’, respectively. For example, the case ‘ar4_fr64’ indicates the attention rank is 4, and the FFN rank is 64. The results show that TAIF will have better performance than TAIA only when the attention rank is much greater than the FFN rank.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A6.T13.4" style="width:433.6pt;height:310.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(17.1pt,-12.3pt) scale(1.08585794226097,1.08585794226097) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.T13.4.1">
<tr class="ltx_tr" id="A6.T13.4.1.1">
<td class="ltx_td ltx_border_tt" id="A6.T13.4.1.1.1"></td>
<td class="ltx_td ltx_border_tt" id="A6.T13.4.1.1.2"></td>
<td class="ltx_td ltx_border_tt" id="A6.T13.4.1.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A6.T13.4.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.1.4.1">Knowledge</span></td>
<td class="ltx_td ltx_border_tt" id="A6.T13.4.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.2">
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.1"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.1.1">Training Data</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.2"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.2.1">Model</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.3"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.3.1">Train/Infer</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.4"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.4.1">CMMLU</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.5"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.5.1">MMLU</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.6"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.6.1">C-Eval</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.2.7"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.2.7.1">Avg.</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.1">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.2">Qwen1.5-1.8B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.3">-/-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.4">52.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.5">43.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.6">55.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.3.7">50.62</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.4">
<td class="ltx_td ltx_border_t" id="A6.T13.4.1.4.1"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.4.1.4.2"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.4.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.4.4">39.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.4.5">27.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.4.6">37.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.4.7">34.94</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.5">
<td class="ltx_td" id="A6.T13.4.1.5.1"></td>
<td class="ltx_td" id="A6.T13.4.1.5.2"></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.5.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.5.3.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.5.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.5.4.1" style="background-color:#E6E6E6;">54.58</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.5.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.5.5.1" style="background-color:#E6E6E6;">44.47</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.5.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.5.6.1" style="background-color:#E6E6E6;">55.57</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.5.7" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.5.7.1" style="background-color:#E6E6E6;">51.54</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.6">
<td class="ltx_td" id="A6.T13.4.1.6.1"></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.2"><span class="ltx_text" id="A6.T13.4.1.6.2.1">
<span class="ltx_tabular ltx_align_middle" id="A6.T13.4.1.6.2.1.1">
<span class="ltx_tr" id="A6.T13.4.1.6.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.6.2.1.1.1.1">LoRA</span></span>
<span class="ltx_tr" id="A6.T13.4.1.6.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.6.2.1.1.2.1">ar4_fr4</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.3">TAIF</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.4">47.06</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.5">42.05</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.6">45.62</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.6.7">44.91</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.7">
<td class="ltx_td" id="A6.T13.4.1.7.1"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.4.1.7.2"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.7.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.7.4">45.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.7.5">27.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.7.6">45.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.7.7">39.42</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.8">
<td class="ltx_td" id="A6.T13.4.1.8.1"></td>
<td class="ltx_td" id="A6.T13.4.1.8.2"></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.8.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.8.3.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.8.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.8.4.1" style="background-color:#E6E6E6;">54.20</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.8.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.8.5.1" style="background-color:#E6E6E6;">43.80</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.8.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.8.6.1" style="background-color:#E6E6E6;">56.32</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.8.7" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.8.7.1" style="background-color:#E6E6E6;">51.44</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.9">
<td class="ltx_td" id="A6.T13.4.1.9.1"></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.2"><span class="ltx_text" id="A6.T13.4.1.9.2.1">
<span class="ltx_tabular ltx_align_middle" id="A6.T13.4.1.9.2.1.1">
<span class="ltx_tr" id="A6.T13.4.1.9.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.9.2.1.1.1.1">LoRA</span></span>
<span class="ltx_tr" id="A6.T13.4.1.9.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.9.2.1.1.2.1">ar4_fr64</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.3">TAIF</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.4">45.76</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.5">29.70</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.6">46.14</td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.9.7">40.53</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.10">
<td class="ltx_td" id="A6.T13.4.1.10.1"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.4.1.10.2"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.10.3">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.10.4">45.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.10.5">28.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.10.6">42.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.4.1.10.7">38.88</td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.11">
<td class="ltx_td" id="A6.T13.4.1.11.1"></td>
<td class="ltx_td" id="A6.T13.4.1.11.2"></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.11.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.11.3.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.11.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.11.4.1" style="background-color:#E6E6E6;">51.24</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.11.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.11.5.1" style="background-color:#E6E6E6;">40.26</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.11.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.11.6.1" style="background-color:#E6E6E6;">48.74</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.4.1.11.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T13.4.1.11.7.1" style="background-color:#E6E6E6;">46.75</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.4.1.12">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.1"><span class="ltx_text" id="A6.T13.4.1.12.1.1">Medical Collection</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.2"><span class="ltx_text" id="A6.T13.4.1.12.2.1">
<span class="ltx_tabular ltx_align_middle" id="A6.T13.4.1.12.2.1.1">
<span class="ltx_tr" id="A6.T13.4.1.12.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.12.2.1.1.1.1">LoRA</span></span>
<span class="ltx_tr" id="A6.T13.4.1.12.2.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A6.T13.4.1.12.2.1.1.2.1">ar64_fr4</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.3">TAIF</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.4">54.25</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.5">44.33</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.6">55.65</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.4.1.12.7"><span class="ltx_text ltx_font_bold" id="A6.T13.4.1.12.7.1">51.41</span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="A6.T14">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T14.3.1.1" style="font-size:90%;">Table 14</span>: </span><span class="ltx_text" id="A6.T14.4.2" style="font-size:90%;">Full results of the ablation experiment on fine-tuning data size. We choose six data scales [1k, 10k, 50k, 100k, 200k, 1.8M] to validate <span class="ltx_text ltx_font_smallcaps" id="A6.T14.4.2.1">TAIA</span>’s effectiveness.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A6.T14.5" style="width:433.6pt;height:257.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.4pt,6.2pt) scale(0.954057825713089,0.954057825713089) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.T14.5.1">
<tr class="ltx_tr" id="A6.T14.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T14.5.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.1.1">Data Size</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T14.5.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.2.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="A6.T14.5.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.3.1">Reasoning</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A6.T14.5.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.4.1">Knowledge</span></td>
<td class="ltx_td ltx_border_tt" id="A6.T14.5.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.2">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.1"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.1.1">MATH</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.2"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.2.1">BBH</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.3"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.3.1">CQA.</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.4"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.4.1">LogiQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.2.5"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.5.1">SVAMP</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.6"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.6.1">MMedB.</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.2.7"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.7.1">MMLU</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.2.8"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.2.8.1">Avg.</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.1">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.3.2">Base Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.3">8.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.4">26.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.5">48.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.6">33.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.3.7">44.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.8">32.21</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.3.9">42.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.3.10">33.71</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.4">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.4.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.4.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.3">6.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.4">18.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.5">56.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.6">29.19</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.4.7">35.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.8">26.39</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.4.9">35.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.4.10">29.76</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.5">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.1"><span class="ltx_text" id="A6.T14.5.1.5.1.1">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.5.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.3.1" style="background-color:#E6E6E6;">6.50</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.4.1" style="background-color:#E6E6E6;">21.86</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.5.1" style="background-color:#E6E6E6;">60.77</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.6.1" style="background-color:#E6E6E6;">31.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.5.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.7.1" style="background-color:#E6E6E6;">47.5</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.8.1" style="background-color:#E6E6E6;">27.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.5.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.5.9.1" style="background-color:#E6E6E6;">40.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.5.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.5.10.1" style="background-color:#E6E6E6;">33.76</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.6">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.6.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.6.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.3">7.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.4">18.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.5">51.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.6">34.56</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.6.7">52.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.8">37.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.6.9">44.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.6.10">35.29</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.7">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.1"><span class="ltx_text" id="A6.T14.5.1.7.1.1">10k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.7.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.3.1" style="background-color:#E6E6E6;">8.34</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.4.1" style="background-color:#E6E6E6;">31.64</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.5.1" style="background-color:#E6E6E6;">59.79</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.6.1" style="background-color:#E6E6E6;">33.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.7.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.7.1" style="background-color:#E6E6E6;">49.10</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.8.1" style="background-color:#E6E6E6;">39.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.7.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.7.9.1" style="background-color:#E6E6E6;">44.67</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.7.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.7.10.1" style="background-color:#E6E6E6;">38.10</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.8">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.8.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.8.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.3">7.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.4">19.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.5">55.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.6">30.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.8.7">52.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.8">37.71</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.8.9">45.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.8.10">35.45</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.9">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.1"><span class="ltx_text" id="A6.T14.5.1.9.1.1">50k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.9.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.3.1" style="background-color:#E6E6E6;">8.54</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.4.1" style="background-color:#E6E6E6;">32.42</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.5.1" style="background-color:#E6E6E6;">61.67</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.6.1" style="background-color:#E6E6E6;">32.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.9.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.7.1" style="background-color:#E6E6E6;">49.10</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.8.1" style="background-color:#E6E6E6;">39.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.9.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.9.9.1" style="background-color:#E6E6E6;">45.16</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.9.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.9.10.1" style="background-color:#E6E6E6;">38.49</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.10">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.10.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.10.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.3">7.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.4">20.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.5">59.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.6">33.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.10.7">53.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.8">38.81</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.10.9">44.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.10.10">36.85</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.11">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.1"><span class="ltx_text" id="A6.T14.5.1.11.1.1">100k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.11.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.3.1" style="background-color:#E6E6E6;">8.02</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.4.1" style="background-color:#E6E6E6;">30.90</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.5.1" style="background-color:#E6E6E6;">63.72</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.6.1" style="background-color:#E6E6E6;">30.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.11.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.7.1" style="background-color:#E6E6E6;">47.80</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.8.1" style="background-color:#E6E6E6;">37.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.11.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.11.9.1" style="background-color:#E6E6E6;">45.57</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.11.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.11.10.1" style="background-color:#E6E6E6;">37.78</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.12">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.12.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.12.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.3">7.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.4">19.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.5">56.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.6">30.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.12.7">52.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.8">38.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.12.9">46.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.12.10">36.04</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.13">
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.1"><span class="ltx_text" id="A6.T14.5.1.13.1.1">200k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.13.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.3.1" style="background-color:#E6E6E6;">8.44</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.4.1" style="background-color:#E6E6E6;">26.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.5.1" style="background-color:#E6E6E6;">60.77</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.6.1" style="background-color:#E6E6E6;">31.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.13.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.7.1" style="background-color:#E6E6E6;">58.33</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.8.1" style="background-color:#E6E6E6;">38.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T14.5.1.13.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.13.9.1" style="background-color:#E6E6E6;">42.54</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.1.13.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.13.10.1" style="background-color:#E6E6E6;">38.03</span></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.14">
<td class="ltx_td ltx_border_t" id="A6.T14.5.1.14.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.14.2">Vanilla</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.3">7.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.4">15.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.5">75.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.6">34.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.14.7">65.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.8">38.10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T14.5.1.14.9">44.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.1.14.10">40.07</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.1.15">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.1"><span class="ltx_text" id="A6.T14.5.1.15.1.1">1.8M</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T14.5.1.15.2" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.2.1" style="background-color:#E6E6E6;">TAIA</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.3" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.3.1" style="background-color:#E6E6E6;">8.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.4" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.4.1" style="background-color:#E6E6E6;">30.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.5" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.5.1" style="background-color:#E6E6E6;">66.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.6" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.6.1" style="background-color:#E6E6E6;">33.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T14.5.1.15.7" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.7.1" style="background-color:#E6E6E6;">58.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.8" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.8.1" style="background-color:#E6E6E6;">39.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T14.5.1.15.9" style="background-color:#E6E6E6;"><span class="ltx_text" id="A6.T14.5.1.15.9.1" style="background-color:#E6E6E6;">47.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.1.15.10" style="background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.15.10.1" style="background-color:#E6E6E6;">40.53</span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="A6.T15">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A6.T15.4.1.1" style="font-size:90%;">Table 15</span>: </span><span class="ltx_text" id="A6.T15.5.2" style="font-size:90%;">Variability of <span class="ltx_text ltx_font_smallcaps" id="A6.T15.5.2.1">TAIA</span>. <span class="ltx_text ltx_font_smallcaps" id="A6.T15.5.2.2">TAIA</span> performs generally more superior to the vanilla LoRA fine-tuning.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A6.T15.6" style="width:433.6pt;height:152.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.9pt,4.9pt) scale(0.939699984150797,0.939699984150797) ;">
<table class="ltx_tabular ltx_align_middle" id="A6.T15.6.1">
<tr class="ltx_tr" id="A6.T15.6.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T15.6.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T15.6.1.1.1.1">Setting</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T15.6.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T15.6.1.1.2.1">Infer Mode</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="A6.T15.6.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T15.6.1.1.3.1">Reasoning</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A6.T15.6.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T15.6.1.1.4.1">Knowledge</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T15.6.1.1.5" rowspan="2"><span class="ltx_text ltx_font_bold" id="A6.T15.6.1.1.5.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.2">
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.2.1">MATH</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.2.2">BBH</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.2.3">CQA</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.2.4">LogiQA</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.2.5">SVAMP</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.2.6">MMB</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.2.7">MMLU</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.3">
<td class="ltx_td ltx_border_t" id="A6.T15.6.1.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.3.2">Base</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.3">20.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.4">30.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.5">78.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.6">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.3.7">54.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.8">45.09</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.3.9">57.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.3.10">47.11</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.1" rowspan="2"><span class="ltx_text" id="A6.T15.6.1.4.1.1">Run1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.4.2">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.3">17.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.4">36.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.5">77.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.6">37.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.4.7">57.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.8">44.85</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.4.9">54.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.4.10">46.50</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.5.1">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.2">24.98</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.3">43.46</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.4">77.31</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.5">41.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.5.6">67.20</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.7">46.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.5.8">57.29</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.5.9">51.27</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.1" rowspan="2"><span class="ltx_text" id="A6.T15.6.1.6.1.1">Run2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.6.2">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.3">18.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.4">38.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.5">75.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.6">36.25</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.6.7">56.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.8">44.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.6.9">55.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.6.10">46.54</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.7.1">TAIA</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.2">26.52</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.3">43.33</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.4">75.76</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.5">41.56</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.7.6">67.60</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.7">46.27</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T15.6.1.7.8">57.36</td>
<td class="ltx_td ltx_align_center" id="A6.T15.6.1.7.9">51.20</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T15.6.1.8.1" rowspan="2"><span class="ltx_text" id="A6.T15.6.1.8.1.1">Run3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.8.2">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.3">18.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.4">38.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.5">76.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.6">36.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.8.7">56.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.8">44.46</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T15.6.1.8.9">55.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.6.1.8.10">46.69</td>
</tr>
<tr class="ltx_tr" id="A6.T15.6.1.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T15.6.1.9.1">TAIA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.2">27.02</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.3">43.56</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.4">76.41</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.5">41.56</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T15.6.1.9.6">67.90</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.7">46.11</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T15.6.1.9.8">57.12</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.6.1.9.9">51.38</td>
</tr>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="A6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.7 </span>Variability of <span class="ltx_text ltx_font_smallcaps" id="A6.SS7.1.1">TAIA</span>
</h3>
<div class="ltx_para" id="A6.SS7.p1">
<p class="ltx_p" id="A6.SS7.p1.1">In this section, we validate that <span class="ltx_text ltx_font_smallcaps" id="A6.SS7.p1.1.1">TAIA</span> is a robust method that is hardly affected by random seeds.
To this end, we choose Qwen1.5 7B as the base model and Alpaca-GPT4 as the training data, and repeat the training process for three runs.
The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A6.T15" title="Table 15 ‣ F.6 Model Scaling of TAIA ‣ Appendix F Supplementary Experiments ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">15</span></a>.
We observe that the improvements do not vary among different runs, which emphasizes the robustness of TAIA.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Formalize the utility of <span class="ltx_text ltx_font_smallcaps" id="A7.1.1">TAIA</span>
</h2>
<div class="ltx_para" id="A7.p1">
<p class="ltx_p" id="A7.p1.4">Suppose an LLM <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="A7.p1.1.m1.1"><semantics id="A7.p1.1.m1.1a"><msub id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml"><mi id="A7.p1.1.m1.1.1.2" xref="A7.p1.1.m1.1.1.2.cmml">p</mi><mi id="A7.p1.1.m1.1.1.3" xref="A7.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b"><apply id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A7.p1.1.m1.1.1.1.cmml" xref="A7.p1.1.m1.1.1">subscript</csymbol><ci id="A7.p1.1.m1.1.1.2.cmml" xref="A7.p1.1.m1.1.1.2">𝑝</ci><ci id="A7.p1.1.m1.1.1.3.cmml" xref="A7.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">p_{\theta}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> containing pretrained weight <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.2.m2.1"><semantics id="A7.p1.2.m2.1a"><msub id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml"><mi id="A7.p1.2.m2.1.1.2" xref="A7.p1.2.m2.1.1.2.cmml">θ</mi><mn id="A7.p1.2.m2.1.1.3" xref="A7.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b"><apply id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A7.p1.2.m2.1.1.1.cmml" xref="A7.p1.2.m2.1.1">subscript</csymbol><ci id="A7.p1.2.m2.1.1.2.cmml" xref="A7.p1.2.m2.1.1.2">𝜃</ci><cn id="A7.p1.2.m2.1.1.3.cmml" type="integer" xref="A7.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.2.m2.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the vanilla LoRA-tuned model yields <math alttext="\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.3.m3.1"><semantics id="A7.p1.3.m3.1a"><mrow id="A7.p1.3.m3.1.1" xref="A7.p1.3.m3.1.1.cmml"><mi id="A7.p1.3.m3.1.1.2" mathvariant="normal" xref="A7.p1.3.m3.1.1.2.cmml">Δ</mi><mo id="A7.p1.3.m3.1.1.1" xref="A7.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="A7.p1.3.m3.1.1.3" xref="A7.p1.3.m3.1.1.3.cmml"><mi id="A7.p1.3.m3.1.1.3.2" xref="A7.p1.3.m3.1.1.3.2.cmml">θ</mi><mn id="A7.p1.3.m3.1.1.3.3" xref="A7.p1.3.m3.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.3.m3.1b"><apply id="A7.p1.3.m3.1.1.cmml" xref="A7.p1.3.m3.1.1"><times id="A7.p1.3.m3.1.1.1.cmml" xref="A7.p1.3.m3.1.1.1"></times><ci id="A7.p1.3.m3.1.1.2.cmml" xref="A7.p1.3.m3.1.1.2">Δ</ci><apply id="A7.p1.3.m3.1.1.3.cmml" xref="A7.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.1.3.1.cmml" xref="A7.p1.3.m3.1.1.3">subscript</csymbol><ci id="A7.p1.3.m3.1.1.3.2.cmml" xref="A7.p1.3.m3.1.1.3.2">𝜃</ci><cn id="A7.p1.3.m3.1.1.3.3.cmml" type="integer" xref="A7.p1.3.m3.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.3.m3.1c">\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.3.m3.1d">roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> weight which is to be merged back to pretrained weight and has a relatively small norm. Suppose a simplified neural network layer with nonlinear operators, a layer normalization layer <math alttext="\mathrm{LayerNorm}(X)=\frac{X-\mu}{\sigma}" class="ltx_Math" display="inline" id="A7.p1.4.m4.1"><semantics id="A7.p1.4.m4.1a"><mrow id="A7.p1.4.m4.1.2" xref="A7.p1.4.m4.1.2.cmml"><mrow id="A7.p1.4.m4.1.2.2" xref="A7.p1.4.m4.1.2.2.cmml"><mi id="A7.p1.4.m4.1.2.2.2" xref="A7.p1.4.m4.1.2.2.2.cmml">LayerNorm</mi><mo id="A7.p1.4.m4.1.2.2.1" xref="A7.p1.4.m4.1.2.2.1.cmml">⁢</mo><mrow id="A7.p1.4.m4.1.2.2.3.2" xref="A7.p1.4.m4.1.2.2.cmml"><mo id="A7.p1.4.m4.1.2.2.3.2.1" stretchy="false" xref="A7.p1.4.m4.1.2.2.cmml">(</mo><mi id="A7.p1.4.m4.1.1" xref="A7.p1.4.m4.1.1.cmml">X</mi><mo id="A7.p1.4.m4.1.2.2.3.2.2" stretchy="false" xref="A7.p1.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="A7.p1.4.m4.1.2.1" xref="A7.p1.4.m4.1.2.1.cmml">=</mo><mfrac id="A7.p1.4.m4.1.2.3" xref="A7.p1.4.m4.1.2.3.cmml"><mrow id="A7.p1.4.m4.1.2.3.2" xref="A7.p1.4.m4.1.2.3.2.cmml"><mi id="A7.p1.4.m4.1.2.3.2.2" xref="A7.p1.4.m4.1.2.3.2.2.cmml">X</mi><mo id="A7.p1.4.m4.1.2.3.2.1" xref="A7.p1.4.m4.1.2.3.2.1.cmml">−</mo><mi id="A7.p1.4.m4.1.2.3.2.3" xref="A7.p1.4.m4.1.2.3.2.3.cmml">μ</mi></mrow><mi id="A7.p1.4.m4.1.2.3.3" xref="A7.p1.4.m4.1.2.3.3.cmml">σ</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.4.m4.1b"><apply id="A7.p1.4.m4.1.2.cmml" xref="A7.p1.4.m4.1.2"><eq id="A7.p1.4.m4.1.2.1.cmml" xref="A7.p1.4.m4.1.2.1"></eq><apply id="A7.p1.4.m4.1.2.2.cmml" xref="A7.p1.4.m4.1.2.2"><times id="A7.p1.4.m4.1.2.2.1.cmml" xref="A7.p1.4.m4.1.2.2.1"></times><ci id="A7.p1.4.m4.1.2.2.2.cmml" xref="A7.p1.4.m4.1.2.2.2">LayerNorm</ci><ci id="A7.p1.4.m4.1.1.cmml" xref="A7.p1.4.m4.1.1">𝑋</ci></apply><apply id="A7.p1.4.m4.1.2.3.cmml" xref="A7.p1.4.m4.1.2.3"><divide id="A7.p1.4.m4.1.2.3.1.cmml" xref="A7.p1.4.m4.1.2.3"></divide><apply id="A7.p1.4.m4.1.2.3.2.cmml" xref="A7.p1.4.m4.1.2.3.2"><minus id="A7.p1.4.m4.1.2.3.2.1.cmml" xref="A7.p1.4.m4.1.2.3.2.1"></minus><ci id="A7.p1.4.m4.1.2.3.2.2.cmml" xref="A7.p1.4.m4.1.2.3.2.2">𝑋</ci><ci id="A7.p1.4.m4.1.2.3.2.3.cmml" xref="A7.p1.4.m4.1.2.3.2.3">𝜇</ci></apply><ci id="A7.p1.4.m4.1.2.3.3.cmml" xref="A7.p1.4.m4.1.2.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.4.m4.1c">\mathrm{LayerNorm}(X)=\frac{X-\mu}{\sigma}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.4.m4.1d">roman_LayerNorm ( italic_X ) = divide start_ARG italic_X - italic_μ end_ARG start_ARG italic_σ end_ARG</annotation></semantics></math> and a residual connection:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{W}(X)=\text{Act}(Wx)" class="ltx_Math" display="block" id="A7.E10.m1.2"><semantics id="A7.E10.m1.2a"><mrow id="A7.E10.m1.2.2" xref="A7.E10.m1.2.2.cmml"><mrow id="A7.E10.m1.2.2.3" xref="A7.E10.m1.2.2.3.cmml"><msub id="A7.E10.m1.2.2.3.2" xref="A7.E10.m1.2.2.3.2.cmml"><mi id="A7.E10.m1.2.2.3.2.2" xref="A7.E10.m1.2.2.3.2.2.cmml">M</mi><mi id="A7.E10.m1.2.2.3.2.3" xref="A7.E10.m1.2.2.3.2.3.cmml">W</mi></msub><mo id="A7.E10.m1.2.2.3.1" xref="A7.E10.m1.2.2.3.1.cmml">⁢</mo><mrow id="A7.E10.m1.2.2.3.3.2" xref="A7.E10.m1.2.2.3.cmml"><mo id="A7.E10.m1.2.2.3.3.2.1" stretchy="false" xref="A7.E10.m1.2.2.3.cmml">(</mo><mi id="A7.E10.m1.1.1" xref="A7.E10.m1.1.1.cmml">X</mi><mo id="A7.E10.m1.2.2.3.3.2.2" stretchy="false" xref="A7.E10.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A7.E10.m1.2.2.2" xref="A7.E10.m1.2.2.2.cmml">=</mo><mrow id="A7.E10.m1.2.2.1" xref="A7.E10.m1.2.2.1.cmml"><mtext id="A7.E10.m1.2.2.1.3" xref="A7.E10.m1.2.2.1.3a.cmml">Act</mtext><mo id="A7.E10.m1.2.2.1.2" xref="A7.E10.m1.2.2.1.2.cmml">⁢</mo><mrow id="A7.E10.m1.2.2.1.1.1" xref="A7.E10.m1.2.2.1.1.1.1.cmml"><mo id="A7.E10.m1.2.2.1.1.1.2" stretchy="false" xref="A7.E10.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.E10.m1.2.2.1.1.1.1" xref="A7.E10.m1.2.2.1.1.1.1.cmml"><mi id="A7.E10.m1.2.2.1.1.1.1.2" xref="A7.E10.m1.2.2.1.1.1.1.2.cmml">W</mi><mo id="A7.E10.m1.2.2.1.1.1.1.1" xref="A7.E10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A7.E10.m1.2.2.1.1.1.1.3" xref="A7.E10.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="A7.E10.m1.2.2.1.1.1.3" stretchy="false" xref="A7.E10.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E10.m1.2b"><apply id="A7.E10.m1.2.2.cmml" xref="A7.E10.m1.2.2"><eq id="A7.E10.m1.2.2.2.cmml" xref="A7.E10.m1.2.2.2"></eq><apply id="A7.E10.m1.2.2.3.cmml" xref="A7.E10.m1.2.2.3"><times id="A7.E10.m1.2.2.3.1.cmml" xref="A7.E10.m1.2.2.3.1"></times><apply id="A7.E10.m1.2.2.3.2.cmml" xref="A7.E10.m1.2.2.3.2"><csymbol cd="ambiguous" id="A7.E10.m1.2.2.3.2.1.cmml" xref="A7.E10.m1.2.2.3.2">subscript</csymbol><ci id="A7.E10.m1.2.2.3.2.2.cmml" xref="A7.E10.m1.2.2.3.2.2">𝑀</ci><ci id="A7.E10.m1.2.2.3.2.3.cmml" xref="A7.E10.m1.2.2.3.2.3">𝑊</ci></apply><ci id="A7.E10.m1.1.1.cmml" xref="A7.E10.m1.1.1">𝑋</ci></apply><apply id="A7.E10.m1.2.2.1.cmml" xref="A7.E10.m1.2.2.1"><times id="A7.E10.m1.2.2.1.2.cmml" xref="A7.E10.m1.2.2.1.2"></times><ci id="A7.E10.m1.2.2.1.3a.cmml" xref="A7.E10.m1.2.2.1.3"><mtext id="A7.E10.m1.2.2.1.3.cmml" xref="A7.E10.m1.2.2.1.3">Act</mtext></ci><apply id="A7.E10.m1.2.2.1.1.1.1.cmml" xref="A7.E10.m1.2.2.1.1.1"><times id="A7.E10.m1.2.2.1.1.1.1.1.cmml" xref="A7.E10.m1.2.2.1.1.1.1.1"></times><ci id="A7.E10.m1.2.2.1.1.1.1.2.cmml" xref="A7.E10.m1.2.2.1.1.1.1.2">𝑊</ci><ci id="A7.E10.m1.2.2.1.1.1.1.3.cmml" xref="A7.E10.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E10.m1.2c">M_{W}(X)=\text{Act}(Wx)</annotation><annotation encoding="application/x-llamapun" id="A7.E10.m1.2d">italic_M start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT ( italic_X ) = Act ( italic_W italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p1.7">As the magnitude of <math alttext="\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.5.m1.1"><semantics id="A7.p1.5.m1.1a"><mrow id="A7.p1.5.m1.1.1" xref="A7.p1.5.m1.1.1.cmml"><mi id="A7.p1.5.m1.1.1.2" mathvariant="normal" xref="A7.p1.5.m1.1.1.2.cmml">Δ</mi><mo id="A7.p1.5.m1.1.1.1" xref="A7.p1.5.m1.1.1.1.cmml">⁢</mo><msub id="A7.p1.5.m1.1.1.3" xref="A7.p1.5.m1.1.1.3.cmml"><mi id="A7.p1.5.m1.1.1.3.2" xref="A7.p1.5.m1.1.1.3.2.cmml">θ</mi><mn id="A7.p1.5.m1.1.1.3.3" xref="A7.p1.5.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.5.m1.1b"><apply id="A7.p1.5.m1.1.1.cmml" xref="A7.p1.5.m1.1.1"><times id="A7.p1.5.m1.1.1.1.cmml" xref="A7.p1.5.m1.1.1.1"></times><ci id="A7.p1.5.m1.1.1.2.cmml" xref="A7.p1.5.m1.1.1.2">Δ</ci><apply id="A7.p1.5.m1.1.1.3.cmml" xref="A7.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="A7.p1.5.m1.1.1.3.1.cmml" xref="A7.p1.5.m1.1.1.3">subscript</csymbol><ci id="A7.p1.5.m1.1.1.3.2.cmml" xref="A7.p1.5.m1.1.1.3.2">𝜃</ci><cn id="A7.p1.5.m1.1.1.3.3.cmml" type="integer" xref="A7.p1.5.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.5.m1.1c">\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.5.m1.1d">roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is quite small compared with <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.6.m2.1"><semantics id="A7.p1.6.m2.1a"><msub id="A7.p1.6.m2.1.1" xref="A7.p1.6.m2.1.1.cmml"><mi id="A7.p1.6.m2.1.1.2" xref="A7.p1.6.m2.1.1.2.cmml">θ</mi><mn id="A7.p1.6.m2.1.1.3" xref="A7.p1.6.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p1.6.m2.1b"><apply id="A7.p1.6.m2.1.1.cmml" xref="A7.p1.6.m2.1.1"><csymbol cd="ambiguous" id="A7.p1.6.m2.1.1.1.cmml" xref="A7.p1.6.m2.1.1">subscript</csymbol><ci id="A7.p1.6.m2.1.1.2.cmml" xref="A7.p1.6.m2.1.1.2">𝜃</ci><cn id="A7.p1.6.m2.1.1.3.cmml" type="integer" xref="A7.p1.6.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.6.m2.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.6.m2.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we perform a first-order Taylor expansion on <math alttext="M_{\theta_{0}+\Delta\theta_{0}}(X)" class="ltx_Math" display="inline" id="A7.p1.7.m3.1"><semantics id="A7.p1.7.m3.1a"><mrow id="A7.p1.7.m3.1.2" xref="A7.p1.7.m3.1.2.cmml"><msub id="A7.p1.7.m3.1.2.2" xref="A7.p1.7.m3.1.2.2.cmml"><mi id="A7.p1.7.m3.1.2.2.2" xref="A7.p1.7.m3.1.2.2.2.cmml">M</mi><mrow id="A7.p1.7.m3.1.2.2.3" xref="A7.p1.7.m3.1.2.2.3.cmml"><msub id="A7.p1.7.m3.1.2.2.3.2" xref="A7.p1.7.m3.1.2.2.3.2.cmml"><mi id="A7.p1.7.m3.1.2.2.3.2.2" xref="A7.p1.7.m3.1.2.2.3.2.2.cmml">θ</mi><mn id="A7.p1.7.m3.1.2.2.3.2.3" xref="A7.p1.7.m3.1.2.2.3.2.3.cmml">0</mn></msub><mo id="A7.p1.7.m3.1.2.2.3.1" xref="A7.p1.7.m3.1.2.2.3.1.cmml">+</mo><mrow id="A7.p1.7.m3.1.2.2.3.3" xref="A7.p1.7.m3.1.2.2.3.3.cmml"><mi id="A7.p1.7.m3.1.2.2.3.3.2" mathvariant="normal" xref="A7.p1.7.m3.1.2.2.3.3.2.cmml">Δ</mi><mo id="A7.p1.7.m3.1.2.2.3.3.1" xref="A7.p1.7.m3.1.2.2.3.3.1.cmml">⁢</mo><msub id="A7.p1.7.m3.1.2.2.3.3.3" xref="A7.p1.7.m3.1.2.2.3.3.3.cmml"><mi id="A7.p1.7.m3.1.2.2.3.3.3.2" xref="A7.p1.7.m3.1.2.2.3.3.3.2.cmml">θ</mi><mn id="A7.p1.7.m3.1.2.2.3.3.3.3" xref="A7.p1.7.m3.1.2.2.3.3.3.3.cmml">0</mn></msub></mrow></mrow></msub><mo id="A7.p1.7.m3.1.2.1" xref="A7.p1.7.m3.1.2.1.cmml">⁢</mo><mrow id="A7.p1.7.m3.1.2.3.2" xref="A7.p1.7.m3.1.2.cmml"><mo id="A7.p1.7.m3.1.2.3.2.1" stretchy="false" xref="A7.p1.7.m3.1.2.cmml">(</mo><mi id="A7.p1.7.m3.1.1" xref="A7.p1.7.m3.1.1.cmml">X</mi><mo id="A7.p1.7.m3.1.2.3.2.2" stretchy="false" xref="A7.p1.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.7.m3.1b"><apply id="A7.p1.7.m3.1.2.cmml" xref="A7.p1.7.m3.1.2"><times id="A7.p1.7.m3.1.2.1.cmml" xref="A7.p1.7.m3.1.2.1"></times><apply id="A7.p1.7.m3.1.2.2.cmml" xref="A7.p1.7.m3.1.2.2"><csymbol cd="ambiguous" id="A7.p1.7.m3.1.2.2.1.cmml" xref="A7.p1.7.m3.1.2.2">subscript</csymbol><ci id="A7.p1.7.m3.1.2.2.2.cmml" xref="A7.p1.7.m3.1.2.2.2">𝑀</ci><apply id="A7.p1.7.m3.1.2.2.3.cmml" xref="A7.p1.7.m3.1.2.2.3"><plus id="A7.p1.7.m3.1.2.2.3.1.cmml" xref="A7.p1.7.m3.1.2.2.3.1"></plus><apply id="A7.p1.7.m3.1.2.2.3.2.cmml" xref="A7.p1.7.m3.1.2.2.3.2"><csymbol cd="ambiguous" id="A7.p1.7.m3.1.2.2.3.2.1.cmml" xref="A7.p1.7.m3.1.2.2.3.2">subscript</csymbol><ci id="A7.p1.7.m3.1.2.2.3.2.2.cmml" xref="A7.p1.7.m3.1.2.2.3.2.2">𝜃</ci><cn id="A7.p1.7.m3.1.2.2.3.2.3.cmml" type="integer" xref="A7.p1.7.m3.1.2.2.3.2.3">0</cn></apply><apply id="A7.p1.7.m3.1.2.2.3.3.cmml" xref="A7.p1.7.m3.1.2.2.3.3"><times id="A7.p1.7.m3.1.2.2.3.3.1.cmml" xref="A7.p1.7.m3.1.2.2.3.3.1"></times><ci id="A7.p1.7.m3.1.2.2.3.3.2.cmml" xref="A7.p1.7.m3.1.2.2.3.3.2">Δ</ci><apply id="A7.p1.7.m3.1.2.2.3.3.3.cmml" xref="A7.p1.7.m3.1.2.2.3.3.3"><csymbol cd="ambiguous" id="A7.p1.7.m3.1.2.2.3.3.3.1.cmml" xref="A7.p1.7.m3.1.2.2.3.3.3">subscript</csymbol><ci id="A7.p1.7.m3.1.2.2.3.3.3.2.cmml" xref="A7.p1.7.m3.1.2.2.3.3.3.2">𝜃</ci><cn id="A7.p1.7.m3.1.2.2.3.3.3.3.cmml" type="integer" xref="A7.p1.7.m3.1.2.2.3.3.3.3">0</cn></apply></apply></apply></apply><ci id="A7.p1.7.m3.1.1.cmml" xref="A7.p1.7.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.7.m3.1c">M_{\theta_{0}+\Delta\theta_{0}}(X)</annotation><annotation encoding="application/x-llamapun" id="A7.p1.7.m3.1d">italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{\theta_{0}+\Delta\theta_{0}}(X)\approx M_{\theta_{0}}(X)+J_{\theta_{0}}(X)%
\Delta\theta_{0}" class="ltx_Math" display="block" id="A7.E11.m1.3"><semantics id="A7.E11.m1.3a"><mrow id="A7.E11.m1.3.4" xref="A7.E11.m1.3.4.cmml"><mrow id="A7.E11.m1.3.4.2" xref="A7.E11.m1.3.4.2.cmml"><msub id="A7.E11.m1.3.4.2.2" xref="A7.E11.m1.3.4.2.2.cmml"><mi id="A7.E11.m1.3.4.2.2.2" xref="A7.E11.m1.3.4.2.2.2.cmml">M</mi><mrow id="A7.E11.m1.3.4.2.2.3" xref="A7.E11.m1.3.4.2.2.3.cmml"><msub id="A7.E11.m1.3.4.2.2.3.2" xref="A7.E11.m1.3.4.2.2.3.2.cmml"><mi id="A7.E11.m1.3.4.2.2.3.2.2" xref="A7.E11.m1.3.4.2.2.3.2.2.cmml">θ</mi><mn id="A7.E11.m1.3.4.2.2.3.2.3" xref="A7.E11.m1.3.4.2.2.3.2.3.cmml">0</mn></msub><mo id="A7.E11.m1.3.4.2.2.3.1" xref="A7.E11.m1.3.4.2.2.3.1.cmml">+</mo><mrow id="A7.E11.m1.3.4.2.2.3.3" xref="A7.E11.m1.3.4.2.2.3.3.cmml"><mi id="A7.E11.m1.3.4.2.2.3.3.2" mathvariant="normal" xref="A7.E11.m1.3.4.2.2.3.3.2.cmml">Δ</mi><mo id="A7.E11.m1.3.4.2.2.3.3.1" xref="A7.E11.m1.3.4.2.2.3.3.1.cmml">⁢</mo><msub id="A7.E11.m1.3.4.2.2.3.3.3" xref="A7.E11.m1.3.4.2.2.3.3.3.cmml"><mi id="A7.E11.m1.3.4.2.2.3.3.3.2" xref="A7.E11.m1.3.4.2.2.3.3.3.2.cmml">θ</mi><mn id="A7.E11.m1.3.4.2.2.3.3.3.3" xref="A7.E11.m1.3.4.2.2.3.3.3.3.cmml">0</mn></msub></mrow></mrow></msub><mo id="A7.E11.m1.3.4.2.1" xref="A7.E11.m1.3.4.2.1.cmml">⁢</mo><mrow id="A7.E11.m1.3.4.2.3.2" xref="A7.E11.m1.3.4.2.cmml"><mo id="A7.E11.m1.3.4.2.3.2.1" stretchy="false" xref="A7.E11.m1.3.4.2.cmml">(</mo><mi id="A7.E11.m1.1.1" xref="A7.E11.m1.1.1.cmml">X</mi><mo id="A7.E11.m1.3.4.2.3.2.2" stretchy="false" xref="A7.E11.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="A7.E11.m1.3.4.1" xref="A7.E11.m1.3.4.1.cmml">≈</mo><mrow id="A7.E11.m1.3.4.3" xref="A7.E11.m1.3.4.3.cmml"><mrow id="A7.E11.m1.3.4.3.2" xref="A7.E11.m1.3.4.3.2.cmml"><msub id="A7.E11.m1.3.4.3.2.2" xref="A7.E11.m1.3.4.3.2.2.cmml"><mi id="A7.E11.m1.3.4.3.2.2.2" xref="A7.E11.m1.3.4.3.2.2.2.cmml">M</mi><msub id="A7.E11.m1.3.4.3.2.2.3" xref="A7.E11.m1.3.4.3.2.2.3.cmml"><mi id="A7.E11.m1.3.4.3.2.2.3.2" xref="A7.E11.m1.3.4.3.2.2.3.2.cmml">θ</mi><mn id="A7.E11.m1.3.4.3.2.2.3.3" xref="A7.E11.m1.3.4.3.2.2.3.3.cmml">0</mn></msub></msub><mo id="A7.E11.m1.3.4.3.2.1" xref="A7.E11.m1.3.4.3.2.1.cmml">⁢</mo><mrow id="A7.E11.m1.3.4.3.2.3.2" xref="A7.E11.m1.3.4.3.2.cmml"><mo id="A7.E11.m1.3.4.3.2.3.2.1" stretchy="false" xref="A7.E11.m1.3.4.3.2.cmml">(</mo><mi id="A7.E11.m1.2.2" xref="A7.E11.m1.2.2.cmml">X</mi><mo id="A7.E11.m1.3.4.3.2.3.2.2" stretchy="false" xref="A7.E11.m1.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="A7.E11.m1.3.4.3.1" xref="A7.E11.m1.3.4.3.1.cmml">+</mo><mrow id="A7.E11.m1.3.4.3.3" xref="A7.E11.m1.3.4.3.3.cmml"><msub id="A7.E11.m1.3.4.3.3.2" xref="A7.E11.m1.3.4.3.3.2.cmml"><mi id="A7.E11.m1.3.4.3.3.2.2" xref="A7.E11.m1.3.4.3.3.2.2.cmml">J</mi><msub id="A7.E11.m1.3.4.3.3.2.3" xref="A7.E11.m1.3.4.3.3.2.3.cmml"><mi id="A7.E11.m1.3.4.3.3.2.3.2" xref="A7.E11.m1.3.4.3.3.2.3.2.cmml">θ</mi><mn id="A7.E11.m1.3.4.3.3.2.3.3" xref="A7.E11.m1.3.4.3.3.2.3.3.cmml">0</mn></msub></msub><mo id="A7.E11.m1.3.4.3.3.1" xref="A7.E11.m1.3.4.3.3.1.cmml">⁢</mo><mrow id="A7.E11.m1.3.4.3.3.3.2" xref="A7.E11.m1.3.4.3.3.cmml"><mo id="A7.E11.m1.3.4.3.3.3.2.1" stretchy="false" xref="A7.E11.m1.3.4.3.3.cmml">(</mo><mi id="A7.E11.m1.3.3" xref="A7.E11.m1.3.3.cmml">X</mi><mo id="A7.E11.m1.3.4.3.3.3.2.2" stretchy="false" xref="A7.E11.m1.3.4.3.3.cmml">)</mo></mrow><mo id="A7.E11.m1.3.4.3.3.1a" xref="A7.E11.m1.3.4.3.3.1.cmml">⁢</mo><mi id="A7.E11.m1.3.4.3.3.4" mathvariant="normal" xref="A7.E11.m1.3.4.3.3.4.cmml">Δ</mi><mo id="A7.E11.m1.3.4.3.3.1b" xref="A7.E11.m1.3.4.3.3.1.cmml">⁢</mo><msub id="A7.E11.m1.3.4.3.3.5" xref="A7.E11.m1.3.4.3.3.5.cmml"><mi id="A7.E11.m1.3.4.3.3.5.2" xref="A7.E11.m1.3.4.3.3.5.2.cmml">θ</mi><mn id="A7.E11.m1.3.4.3.3.5.3" xref="A7.E11.m1.3.4.3.3.5.3.cmml">0</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E11.m1.3b"><apply id="A7.E11.m1.3.4.cmml" xref="A7.E11.m1.3.4"><approx id="A7.E11.m1.3.4.1.cmml" xref="A7.E11.m1.3.4.1"></approx><apply id="A7.E11.m1.3.4.2.cmml" xref="A7.E11.m1.3.4.2"><times id="A7.E11.m1.3.4.2.1.cmml" xref="A7.E11.m1.3.4.2.1"></times><apply id="A7.E11.m1.3.4.2.2.cmml" xref="A7.E11.m1.3.4.2.2"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.2.2.1.cmml" xref="A7.E11.m1.3.4.2.2">subscript</csymbol><ci id="A7.E11.m1.3.4.2.2.2.cmml" xref="A7.E11.m1.3.4.2.2.2">𝑀</ci><apply id="A7.E11.m1.3.4.2.2.3.cmml" xref="A7.E11.m1.3.4.2.2.3"><plus id="A7.E11.m1.3.4.2.2.3.1.cmml" xref="A7.E11.m1.3.4.2.2.3.1"></plus><apply id="A7.E11.m1.3.4.2.2.3.2.cmml" xref="A7.E11.m1.3.4.2.2.3.2"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.2.2.3.2.1.cmml" xref="A7.E11.m1.3.4.2.2.3.2">subscript</csymbol><ci id="A7.E11.m1.3.4.2.2.3.2.2.cmml" xref="A7.E11.m1.3.4.2.2.3.2.2">𝜃</ci><cn id="A7.E11.m1.3.4.2.2.3.2.3.cmml" type="integer" xref="A7.E11.m1.3.4.2.2.3.2.3">0</cn></apply><apply id="A7.E11.m1.3.4.2.2.3.3.cmml" xref="A7.E11.m1.3.4.2.2.3.3"><times id="A7.E11.m1.3.4.2.2.3.3.1.cmml" xref="A7.E11.m1.3.4.2.2.3.3.1"></times><ci id="A7.E11.m1.3.4.2.2.3.3.2.cmml" xref="A7.E11.m1.3.4.2.2.3.3.2">Δ</ci><apply id="A7.E11.m1.3.4.2.2.3.3.3.cmml" xref="A7.E11.m1.3.4.2.2.3.3.3"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.2.2.3.3.3.1.cmml" xref="A7.E11.m1.3.4.2.2.3.3.3">subscript</csymbol><ci id="A7.E11.m1.3.4.2.2.3.3.3.2.cmml" xref="A7.E11.m1.3.4.2.2.3.3.3.2">𝜃</ci><cn id="A7.E11.m1.3.4.2.2.3.3.3.3.cmml" type="integer" xref="A7.E11.m1.3.4.2.2.3.3.3.3">0</cn></apply></apply></apply></apply><ci id="A7.E11.m1.1.1.cmml" xref="A7.E11.m1.1.1">𝑋</ci></apply><apply id="A7.E11.m1.3.4.3.cmml" xref="A7.E11.m1.3.4.3"><plus id="A7.E11.m1.3.4.3.1.cmml" xref="A7.E11.m1.3.4.3.1"></plus><apply id="A7.E11.m1.3.4.3.2.cmml" xref="A7.E11.m1.3.4.3.2"><times id="A7.E11.m1.3.4.3.2.1.cmml" xref="A7.E11.m1.3.4.3.2.1"></times><apply id="A7.E11.m1.3.4.3.2.2.cmml" xref="A7.E11.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.3.2.2.1.cmml" xref="A7.E11.m1.3.4.3.2.2">subscript</csymbol><ci id="A7.E11.m1.3.4.3.2.2.2.cmml" xref="A7.E11.m1.3.4.3.2.2.2">𝑀</ci><apply id="A7.E11.m1.3.4.3.2.2.3.cmml" xref="A7.E11.m1.3.4.3.2.2.3"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.3.2.2.3.1.cmml" xref="A7.E11.m1.3.4.3.2.2.3">subscript</csymbol><ci id="A7.E11.m1.3.4.3.2.2.3.2.cmml" xref="A7.E11.m1.3.4.3.2.2.3.2">𝜃</ci><cn id="A7.E11.m1.3.4.3.2.2.3.3.cmml" type="integer" xref="A7.E11.m1.3.4.3.2.2.3.3">0</cn></apply></apply><ci id="A7.E11.m1.2.2.cmml" xref="A7.E11.m1.2.2">𝑋</ci></apply><apply id="A7.E11.m1.3.4.3.3.cmml" xref="A7.E11.m1.3.4.3.3"><times id="A7.E11.m1.3.4.3.3.1.cmml" xref="A7.E11.m1.3.4.3.3.1"></times><apply id="A7.E11.m1.3.4.3.3.2.cmml" xref="A7.E11.m1.3.4.3.3.2"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.3.3.2.1.cmml" xref="A7.E11.m1.3.4.3.3.2">subscript</csymbol><ci id="A7.E11.m1.3.4.3.3.2.2.cmml" xref="A7.E11.m1.3.4.3.3.2.2">𝐽</ci><apply id="A7.E11.m1.3.4.3.3.2.3.cmml" xref="A7.E11.m1.3.4.3.3.2.3"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.3.3.2.3.1.cmml" xref="A7.E11.m1.3.4.3.3.2.3">subscript</csymbol><ci id="A7.E11.m1.3.4.3.3.2.3.2.cmml" xref="A7.E11.m1.3.4.3.3.2.3.2">𝜃</ci><cn id="A7.E11.m1.3.4.3.3.2.3.3.cmml" type="integer" xref="A7.E11.m1.3.4.3.3.2.3.3">0</cn></apply></apply><ci id="A7.E11.m1.3.3.cmml" xref="A7.E11.m1.3.3">𝑋</ci><ci id="A7.E11.m1.3.4.3.3.4.cmml" xref="A7.E11.m1.3.4.3.3.4">Δ</ci><apply id="A7.E11.m1.3.4.3.3.5.cmml" xref="A7.E11.m1.3.4.3.3.5"><csymbol cd="ambiguous" id="A7.E11.m1.3.4.3.3.5.1.cmml" xref="A7.E11.m1.3.4.3.3.5">subscript</csymbol><ci id="A7.E11.m1.3.4.3.3.5.2.cmml" xref="A7.E11.m1.3.4.3.3.5.2">𝜃</ci><cn id="A7.E11.m1.3.4.3.3.5.3.cmml" type="integer" xref="A7.E11.m1.3.4.3.3.5.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E11.m1.3c">M_{\theta_{0}+\Delta\theta_{0}}(X)\approx M_{\theta_{0}}(X)+J_{\theta_{0}}(X)%
\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.E11.m1.3d">italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) ≈ italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) + italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p1.15">where <math alttext="J_{\theta_{0}}(X)" class="ltx_Math" display="inline" id="A7.p1.8.m1.1"><semantics id="A7.p1.8.m1.1a"><mrow id="A7.p1.8.m1.1.2" xref="A7.p1.8.m1.1.2.cmml"><msub id="A7.p1.8.m1.1.2.2" xref="A7.p1.8.m1.1.2.2.cmml"><mi id="A7.p1.8.m1.1.2.2.2" xref="A7.p1.8.m1.1.2.2.2.cmml">J</mi><msub id="A7.p1.8.m1.1.2.2.3" xref="A7.p1.8.m1.1.2.2.3.cmml"><mi id="A7.p1.8.m1.1.2.2.3.2" xref="A7.p1.8.m1.1.2.2.3.2.cmml">θ</mi><mn id="A7.p1.8.m1.1.2.2.3.3" xref="A7.p1.8.m1.1.2.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p1.8.m1.1.2.1" xref="A7.p1.8.m1.1.2.1.cmml">⁢</mo><mrow id="A7.p1.8.m1.1.2.3.2" xref="A7.p1.8.m1.1.2.cmml"><mo id="A7.p1.8.m1.1.2.3.2.1" stretchy="false" xref="A7.p1.8.m1.1.2.cmml">(</mo><mi id="A7.p1.8.m1.1.1" xref="A7.p1.8.m1.1.1.cmml">X</mi><mo id="A7.p1.8.m1.1.2.3.2.2" stretchy="false" xref="A7.p1.8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.8.m1.1b"><apply id="A7.p1.8.m1.1.2.cmml" xref="A7.p1.8.m1.1.2"><times id="A7.p1.8.m1.1.2.1.cmml" xref="A7.p1.8.m1.1.2.1"></times><apply id="A7.p1.8.m1.1.2.2.cmml" xref="A7.p1.8.m1.1.2.2"><csymbol cd="ambiguous" id="A7.p1.8.m1.1.2.2.1.cmml" xref="A7.p1.8.m1.1.2.2">subscript</csymbol><ci id="A7.p1.8.m1.1.2.2.2.cmml" xref="A7.p1.8.m1.1.2.2.2">𝐽</ci><apply id="A7.p1.8.m1.1.2.2.3.cmml" xref="A7.p1.8.m1.1.2.2.3"><csymbol cd="ambiguous" id="A7.p1.8.m1.1.2.2.3.1.cmml" xref="A7.p1.8.m1.1.2.2.3">subscript</csymbol><ci id="A7.p1.8.m1.1.2.2.3.2.cmml" xref="A7.p1.8.m1.1.2.2.3.2">𝜃</ci><cn id="A7.p1.8.m1.1.2.2.3.3.cmml" type="integer" xref="A7.p1.8.m1.1.2.2.3.3">0</cn></apply></apply><ci id="A7.p1.8.m1.1.1.cmml" xref="A7.p1.8.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.8.m1.1c">J_{\theta_{0}}(X)</annotation><annotation encoding="application/x-llamapun" id="A7.p1.8.m1.1d">italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math> is the Jacobian matrix of <math alttext="M_{\theta_{0}}(X)" class="ltx_Math" display="inline" id="A7.p1.9.m2.1"><semantics id="A7.p1.9.m2.1a"><mrow id="A7.p1.9.m2.1.2" xref="A7.p1.9.m2.1.2.cmml"><msub id="A7.p1.9.m2.1.2.2" xref="A7.p1.9.m2.1.2.2.cmml"><mi id="A7.p1.9.m2.1.2.2.2" xref="A7.p1.9.m2.1.2.2.2.cmml">M</mi><msub id="A7.p1.9.m2.1.2.2.3" xref="A7.p1.9.m2.1.2.2.3.cmml"><mi id="A7.p1.9.m2.1.2.2.3.2" xref="A7.p1.9.m2.1.2.2.3.2.cmml">θ</mi><mn id="A7.p1.9.m2.1.2.2.3.3" xref="A7.p1.9.m2.1.2.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p1.9.m2.1.2.1" xref="A7.p1.9.m2.1.2.1.cmml">⁢</mo><mrow id="A7.p1.9.m2.1.2.3.2" xref="A7.p1.9.m2.1.2.cmml"><mo id="A7.p1.9.m2.1.2.3.2.1" stretchy="false" xref="A7.p1.9.m2.1.2.cmml">(</mo><mi id="A7.p1.9.m2.1.1" xref="A7.p1.9.m2.1.1.cmml">X</mi><mo id="A7.p1.9.m2.1.2.3.2.2" stretchy="false" xref="A7.p1.9.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.9.m2.1b"><apply id="A7.p1.9.m2.1.2.cmml" xref="A7.p1.9.m2.1.2"><times id="A7.p1.9.m2.1.2.1.cmml" xref="A7.p1.9.m2.1.2.1"></times><apply id="A7.p1.9.m2.1.2.2.cmml" xref="A7.p1.9.m2.1.2.2"><csymbol cd="ambiguous" id="A7.p1.9.m2.1.2.2.1.cmml" xref="A7.p1.9.m2.1.2.2">subscript</csymbol><ci id="A7.p1.9.m2.1.2.2.2.cmml" xref="A7.p1.9.m2.1.2.2.2">𝑀</ci><apply id="A7.p1.9.m2.1.2.2.3.cmml" xref="A7.p1.9.m2.1.2.2.3"><csymbol cd="ambiguous" id="A7.p1.9.m2.1.2.2.3.1.cmml" xref="A7.p1.9.m2.1.2.2.3">subscript</csymbol><ci id="A7.p1.9.m2.1.2.2.3.2.cmml" xref="A7.p1.9.m2.1.2.2.3.2">𝜃</ci><cn id="A7.p1.9.m2.1.2.2.3.3.cmml" type="integer" xref="A7.p1.9.m2.1.2.2.3.3">0</cn></apply></apply><ci id="A7.p1.9.m2.1.1.cmml" xref="A7.p1.9.m2.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.9.m2.1c">M_{\theta_{0}}(X)</annotation><annotation encoding="application/x-llamapun" id="A7.p1.9.m2.1d">italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math> for <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.10.m3.1"><semantics id="A7.p1.10.m3.1a"><msub id="A7.p1.10.m3.1.1" xref="A7.p1.10.m3.1.1.cmml"><mi id="A7.p1.10.m3.1.1.2" xref="A7.p1.10.m3.1.1.2.cmml">θ</mi><mn id="A7.p1.10.m3.1.1.3" xref="A7.p1.10.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p1.10.m3.1b"><apply id="A7.p1.10.m3.1.1.cmml" xref="A7.p1.10.m3.1.1"><csymbol cd="ambiguous" id="A7.p1.10.m3.1.1.1.cmml" xref="A7.p1.10.m3.1.1">subscript</csymbol><ci id="A7.p1.10.m3.1.1.2.cmml" xref="A7.p1.10.m3.1.1.2">𝜃</ci><cn id="A7.p1.10.m3.1.1.3.cmml" type="integer" xref="A7.p1.10.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.10.m3.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.10.m3.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. We define <math alttext="z=X+M_{\theta_{0}}(X)" class="ltx_Math" display="inline" id="A7.p1.11.m4.1"><semantics id="A7.p1.11.m4.1a"><mrow id="A7.p1.11.m4.1.2" xref="A7.p1.11.m4.1.2.cmml"><mi id="A7.p1.11.m4.1.2.2" xref="A7.p1.11.m4.1.2.2.cmml">z</mi><mo id="A7.p1.11.m4.1.2.1" xref="A7.p1.11.m4.1.2.1.cmml">=</mo><mrow id="A7.p1.11.m4.1.2.3" xref="A7.p1.11.m4.1.2.3.cmml"><mi id="A7.p1.11.m4.1.2.3.2" xref="A7.p1.11.m4.1.2.3.2.cmml">X</mi><mo id="A7.p1.11.m4.1.2.3.1" xref="A7.p1.11.m4.1.2.3.1.cmml">+</mo><mrow id="A7.p1.11.m4.1.2.3.3" xref="A7.p1.11.m4.1.2.3.3.cmml"><msub id="A7.p1.11.m4.1.2.3.3.2" xref="A7.p1.11.m4.1.2.3.3.2.cmml"><mi id="A7.p1.11.m4.1.2.3.3.2.2" xref="A7.p1.11.m4.1.2.3.3.2.2.cmml">M</mi><msub id="A7.p1.11.m4.1.2.3.3.2.3" xref="A7.p1.11.m4.1.2.3.3.2.3.cmml"><mi id="A7.p1.11.m4.1.2.3.3.2.3.2" xref="A7.p1.11.m4.1.2.3.3.2.3.2.cmml">θ</mi><mn id="A7.p1.11.m4.1.2.3.3.2.3.3" xref="A7.p1.11.m4.1.2.3.3.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p1.11.m4.1.2.3.3.1" xref="A7.p1.11.m4.1.2.3.3.1.cmml">⁢</mo><mrow id="A7.p1.11.m4.1.2.3.3.3.2" xref="A7.p1.11.m4.1.2.3.3.cmml"><mo id="A7.p1.11.m4.1.2.3.3.3.2.1" stretchy="false" xref="A7.p1.11.m4.1.2.3.3.cmml">(</mo><mi id="A7.p1.11.m4.1.1" xref="A7.p1.11.m4.1.1.cmml">X</mi><mo id="A7.p1.11.m4.1.2.3.3.3.2.2" stretchy="false" xref="A7.p1.11.m4.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.11.m4.1b"><apply id="A7.p1.11.m4.1.2.cmml" xref="A7.p1.11.m4.1.2"><eq id="A7.p1.11.m4.1.2.1.cmml" xref="A7.p1.11.m4.1.2.1"></eq><ci id="A7.p1.11.m4.1.2.2.cmml" xref="A7.p1.11.m4.1.2.2">𝑧</ci><apply id="A7.p1.11.m4.1.2.3.cmml" xref="A7.p1.11.m4.1.2.3"><plus id="A7.p1.11.m4.1.2.3.1.cmml" xref="A7.p1.11.m4.1.2.3.1"></plus><ci id="A7.p1.11.m4.1.2.3.2.cmml" xref="A7.p1.11.m4.1.2.3.2">𝑋</ci><apply id="A7.p1.11.m4.1.2.3.3.cmml" xref="A7.p1.11.m4.1.2.3.3"><times id="A7.p1.11.m4.1.2.3.3.1.cmml" xref="A7.p1.11.m4.1.2.3.3.1"></times><apply id="A7.p1.11.m4.1.2.3.3.2.cmml" xref="A7.p1.11.m4.1.2.3.3.2"><csymbol cd="ambiguous" id="A7.p1.11.m4.1.2.3.3.2.1.cmml" xref="A7.p1.11.m4.1.2.3.3.2">subscript</csymbol><ci id="A7.p1.11.m4.1.2.3.3.2.2.cmml" xref="A7.p1.11.m4.1.2.3.3.2.2">𝑀</ci><apply id="A7.p1.11.m4.1.2.3.3.2.3.cmml" xref="A7.p1.11.m4.1.2.3.3.2.3"><csymbol cd="ambiguous" id="A7.p1.11.m4.1.2.3.3.2.3.1.cmml" xref="A7.p1.11.m4.1.2.3.3.2.3">subscript</csymbol><ci id="A7.p1.11.m4.1.2.3.3.2.3.2.cmml" xref="A7.p1.11.m4.1.2.3.3.2.3.2">𝜃</ci><cn id="A7.p1.11.m4.1.2.3.3.2.3.3.cmml" type="integer" xref="A7.p1.11.m4.1.2.3.3.2.3.3">0</cn></apply></apply><ci id="A7.p1.11.m4.1.1.cmml" xref="A7.p1.11.m4.1.1">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.11.m4.1c">z=X+M_{\theta_{0}}(X)</annotation><annotation encoding="application/x-llamapun" id="A7.p1.11.m4.1d">italic_z = italic_X + italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X )</annotation></semantics></math> and <math alttext="z^{\prime}=X+M_{\theta_{0}}(X)+J_{\theta_{0}}(X)\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.12.m5.2"><semantics id="A7.p1.12.m5.2a"><mrow id="A7.p1.12.m5.2.3" xref="A7.p1.12.m5.2.3.cmml"><msup id="A7.p1.12.m5.2.3.2" xref="A7.p1.12.m5.2.3.2.cmml"><mi id="A7.p1.12.m5.2.3.2.2" xref="A7.p1.12.m5.2.3.2.2.cmml">z</mi><mo id="A7.p1.12.m5.2.3.2.3" xref="A7.p1.12.m5.2.3.2.3.cmml">′</mo></msup><mo id="A7.p1.12.m5.2.3.1" xref="A7.p1.12.m5.2.3.1.cmml">=</mo><mrow id="A7.p1.12.m5.2.3.3" xref="A7.p1.12.m5.2.3.3.cmml"><mi id="A7.p1.12.m5.2.3.3.2" xref="A7.p1.12.m5.2.3.3.2.cmml">X</mi><mo id="A7.p1.12.m5.2.3.3.1" xref="A7.p1.12.m5.2.3.3.1.cmml">+</mo><mrow id="A7.p1.12.m5.2.3.3.3" xref="A7.p1.12.m5.2.3.3.3.cmml"><msub id="A7.p1.12.m5.2.3.3.3.2" xref="A7.p1.12.m5.2.3.3.3.2.cmml"><mi id="A7.p1.12.m5.2.3.3.3.2.2" xref="A7.p1.12.m5.2.3.3.3.2.2.cmml">M</mi><msub id="A7.p1.12.m5.2.3.3.3.2.3" xref="A7.p1.12.m5.2.3.3.3.2.3.cmml"><mi id="A7.p1.12.m5.2.3.3.3.2.3.2" xref="A7.p1.12.m5.2.3.3.3.2.3.2.cmml">θ</mi><mn id="A7.p1.12.m5.2.3.3.3.2.3.3" xref="A7.p1.12.m5.2.3.3.3.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p1.12.m5.2.3.3.3.1" xref="A7.p1.12.m5.2.3.3.3.1.cmml">⁢</mo><mrow id="A7.p1.12.m5.2.3.3.3.3.2" xref="A7.p1.12.m5.2.3.3.3.cmml"><mo id="A7.p1.12.m5.2.3.3.3.3.2.1" stretchy="false" xref="A7.p1.12.m5.2.3.3.3.cmml">(</mo><mi id="A7.p1.12.m5.1.1" xref="A7.p1.12.m5.1.1.cmml">X</mi><mo id="A7.p1.12.m5.2.3.3.3.3.2.2" stretchy="false" xref="A7.p1.12.m5.2.3.3.3.cmml">)</mo></mrow></mrow><mo id="A7.p1.12.m5.2.3.3.1a" xref="A7.p1.12.m5.2.3.3.1.cmml">+</mo><mrow id="A7.p1.12.m5.2.3.3.4" xref="A7.p1.12.m5.2.3.3.4.cmml"><msub id="A7.p1.12.m5.2.3.3.4.2" xref="A7.p1.12.m5.2.3.3.4.2.cmml"><mi id="A7.p1.12.m5.2.3.3.4.2.2" xref="A7.p1.12.m5.2.3.3.4.2.2.cmml">J</mi><msub id="A7.p1.12.m5.2.3.3.4.2.3" xref="A7.p1.12.m5.2.3.3.4.2.3.cmml"><mi id="A7.p1.12.m5.2.3.3.4.2.3.2" xref="A7.p1.12.m5.2.3.3.4.2.3.2.cmml">θ</mi><mn id="A7.p1.12.m5.2.3.3.4.2.3.3" xref="A7.p1.12.m5.2.3.3.4.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p1.12.m5.2.3.3.4.1" xref="A7.p1.12.m5.2.3.3.4.1.cmml">⁢</mo><mrow id="A7.p1.12.m5.2.3.3.4.3.2" xref="A7.p1.12.m5.2.3.3.4.cmml"><mo id="A7.p1.12.m5.2.3.3.4.3.2.1" stretchy="false" xref="A7.p1.12.m5.2.3.3.4.cmml">(</mo><mi id="A7.p1.12.m5.2.2" xref="A7.p1.12.m5.2.2.cmml">X</mi><mo id="A7.p1.12.m5.2.3.3.4.3.2.2" stretchy="false" xref="A7.p1.12.m5.2.3.3.4.cmml">)</mo></mrow><mo id="A7.p1.12.m5.2.3.3.4.1a" xref="A7.p1.12.m5.2.3.3.4.1.cmml">⁢</mo><mi id="A7.p1.12.m5.2.3.3.4.4" mathvariant="normal" xref="A7.p1.12.m5.2.3.3.4.4.cmml">Δ</mi><mo id="A7.p1.12.m5.2.3.3.4.1b" xref="A7.p1.12.m5.2.3.3.4.1.cmml">⁢</mo><msub id="A7.p1.12.m5.2.3.3.4.5" xref="A7.p1.12.m5.2.3.3.4.5.cmml"><mi id="A7.p1.12.m5.2.3.3.4.5.2" xref="A7.p1.12.m5.2.3.3.4.5.2.cmml">θ</mi><mn id="A7.p1.12.m5.2.3.3.4.5.3" xref="A7.p1.12.m5.2.3.3.4.5.3.cmml">0</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.12.m5.2b"><apply id="A7.p1.12.m5.2.3.cmml" xref="A7.p1.12.m5.2.3"><eq id="A7.p1.12.m5.2.3.1.cmml" xref="A7.p1.12.m5.2.3.1"></eq><apply id="A7.p1.12.m5.2.3.2.cmml" xref="A7.p1.12.m5.2.3.2"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.2.1.cmml" xref="A7.p1.12.m5.2.3.2">superscript</csymbol><ci id="A7.p1.12.m5.2.3.2.2.cmml" xref="A7.p1.12.m5.2.3.2.2">𝑧</ci><ci id="A7.p1.12.m5.2.3.2.3.cmml" xref="A7.p1.12.m5.2.3.2.3">′</ci></apply><apply id="A7.p1.12.m5.2.3.3.cmml" xref="A7.p1.12.m5.2.3.3"><plus id="A7.p1.12.m5.2.3.3.1.cmml" xref="A7.p1.12.m5.2.3.3.1"></plus><ci id="A7.p1.12.m5.2.3.3.2.cmml" xref="A7.p1.12.m5.2.3.3.2">𝑋</ci><apply id="A7.p1.12.m5.2.3.3.3.cmml" xref="A7.p1.12.m5.2.3.3.3"><times id="A7.p1.12.m5.2.3.3.3.1.cmml" xref="A7.p1.12.m5.2.3.3.3.1"></times><apply id="A7.p1.12.m5.2.3.3.3.2.cmml" xref="A7.p1.12.m5.2.3.3.3.2"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.3.3.2.1.cmml" xref="A7.p1.12.m5.2.3.3.3.2">subscript</csymbol><ci id="A7.p1.12.m5.2.3.3.3.2.2.cmml" xref="A7.p1.12.m5.2.3.3.3.2.2">𝑀</ci><apply id="A7.p1.12.m5.2.3.3.3.2.3.cmml" xref="A7.p1.12.m5.2.3.3.3.2.3"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.3.3.2.3.1.cmml" xref="A7.p1.12.m5.2.3.3.3.2.3">subscript</csymbol><ci id="A7.p1.12.m5.2.3.3.3.2.3.2.cmml" xref="A7.p1.12.m5.2.3.3.3.2.3.2">𝜃</ci><cn id="A7.p1.12.m5.2.3.3.3.2.3.3.cmml" type="integer" xref="A7.p1.12.m5.2.3.3.3.2.3.3">0</cn></apply></apply><ci id="A7.p1.12.m5.1.1.cmml" xref="A7.p1.12.m5.1.1">𝑋</ci></apply><apply id="A7.p1.12.m5.2.3.3.4.cmml" xref="A7.p1.12.m5.2.3.3.4"><times id="A7.p1.12.m5.2.3.3.4.1.cmml" xref="A7.p1.12.m5.2.3.3.4.1"></times><apply id="A7.p1.12.m5.2.3.3.4.2.cmml" xref="A7.p1.12.m5.2.3.3.4.2"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.3.4.2.1.cmml" xref="A7.p1.12.m5.2.3.3.4.2">subscript</csymbol><ci id="A7.p1.12.m5.2.3.3.4.2.2.cmml" xref="A7.p1.12.m5.2.3.3.4.2.2">𝐽</ci><apply id="A7.p1.12.m5.2.3.3.4.2.3.cmml" xref="A7.p1.12.m5.2.3.3.4.2.3"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.3.4.2.3.1.cmml" xref="A7.p1.12.m5.2.3.3.4.2.3">subscript</csymbol><ci id="A7.p1.12.m5.2.3.3.4.2.3.2.cmml" xref="A7.p1.12.m5.2.3.3.4.2.3.2">𝜃</ci><cn id="A7.p1.12.m5.2.3.3.4.2.3.3.cmml" type="integer" xref="A7.p1.12.m5.2.3.3.4.2.3.3">0</cn></apply></apply><ci id="A7.p1.12.m5.2.2.cmml" xref="A7.p1.12.m5.2.2">𝑋</ci><ci id="A7.p1.12.m5.2.3.3.4.4.cmml" xref="A7.p1.12.m5.2.3.3.4.4">Δ</ci><apply id="A7.p1.12.m5.2.3.3.4.5.cmml" xref="A7.p1.12.m5.2.3.3.4.5"><csymbol cd="ambiguous" id="A7.p1.12.m5.2.3.3.4.5.1.cmml" xref="A7.p1.12.m5.2.3.3.4.5">subscript</csymbol><ci id="A7.p1.12.m5.2.3.3.4.5.2.cmml" xref="A7.p1.12.m5.2.3.3.4.5.2">𝜃</ci><cn id="A7.p1.12.m5.2.3.3.4.5.3.cmml" type="integer" xref="A7.p1.12.m5.2.3.3.4.5.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.12.m5.2c">z^{\prime}=X+M_{\theta_{0}}(X)+J_{\theta_{0}}(X)\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.12.m5.2d">italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_X + italic_M start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) + italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to compare <math alttext="\mathrm{LayerNorm(z)}" class="ltx_Math" display="inline" id="A7.p1.13.m6.1"><semantics id="A7.p1.13.m6.1a"><mrow id="A7.p1.13.m6.1.2" xref="A7.p1.13.m6.1.2.cmml"><mi id="A7.p1.13.m6.1.2.2" xref="A7.p1.13.m6.1.2.2.cmml">LayerNorm</mi><mo id="A7.p1.13.m6.1.2.1" xref="A7.p1.13.m6.1.2.1.cmml">⁢</mo><mrow id="A7.p1.13.m6.1.2.3.2" xref="A7.p1.13.m6.1.2.cmml"><mo id="A7.p1.13.m6.1.2.3.2.1" stretchy="false" xref="A7.p1.13.m6.1.2.cmml">(</mo><mi id="A7.p1.13.m6.1.1" mathvariant="normal" xref="A7.p1.13.m6.1.1.cmml">z</mi><mo id="A7.p1.13.m6.1.2.3.2.2" stretchy="false" xref="A7.p1.13.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.13.m6.1b"><apply id="A7.p1.13.m6.1.2.cmml" xref="A7.p1.13.m6.1.2"><times id="A7.p1.13.m6.1.2.1.cmml" xref="A7.p1.13.m6.1.2.1"></times><ci id="A7.p1.13.m6.1.2.2.cmml" xref="A7.p1.13.m6.1.2.2">LayerNorm</ci><ci id="A7.p1.13.m6.1.1.cmml" xref="A7.p1.13.m6.1.1">z</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.13.m6.1c">\mathrm{LayerNorm(z)}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.13.m6.1d">roman_LayerNorm ( roman_z )</annotation></semantics></math> and <math alttext="\text{LayerNorm}(z^{\prime})" class="ltx_Math" display="inline" id="A7.p1.14.m7.1"><semantics id="A7.p1.14.m7.1a"><mrow id="A7.p1.14.m7.1.1" xref="A7.p1.14.m7.1.1.cmml"><mtext id="A7.p1.14.m7.1.1.3" xref="A7.p1.14.m7.1.1.3a.cmml">LayerNorm</mtext><mo id="A7.p1.14.m7.1.1.2" xref="A7.p1.14.m7.1.1.2.cmml">⁢</mo><mrow id="A7.p1.14.m7.1.1.1.1" xref="A7.p1.14.m7.1.1.1.1.1.cmml"><mo id="A7.p1.14.m7.1.1.1.1.2" stretchy="false" xref="A7.p1.14.m7.1.1.1.1.1.cmml">(</mo><msup id="A7.p1.14.m7.1.1.1.1.1" xref="A7.p1.14.m7.1.1.1.1.1.cmml"><mi id="A7.p1.14.m7.1.1.1.1.1.2" xref="A7.p1.14.m7.1.1.1.1.1.2.cmml">z</mi><mo id="A7.p1.14.m7.1.1.1.1.1.3" xref="A7.p1.14.m7.1.1.1.1.1.3.cmml">′</mo></msup><mo id="A7.p1.14.m7.1.1.1.1.3" stretchy="false" xref="A7.p1.14.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.14.m7.1b"><apply id="A7.p1.14.m7.1.1.cmml" xref="A7.p1.14.m7.1.1"><times id="A7.p1.14.m7.1.1.2.cmml" xref="A7.p1.14.m7.1.1.2"></times><ci id="A7.p1.14.m7.1.1.3a.cmml" xref="A7.p1.14.m7.1.1.3"><mtext id="A7.p1.14.m7.1.1.3.cmml" xref="A7.p1.14.m7.1.1.3">LayerNorm</mtext></ci><apply id="A7.p1.14.m7.1.1.1.1.1.cmml" xref="A7.p1.14.m7.1.1.1.1"><csymbol cd="ambiguous" id="A7.p1.14.m7.1.1.1.1.1.1.cmml" xref="A7.p1.14.m7.1.1.1.1">superscript</csymbol><ci id="A7.p1.14.m7.1.1.1.1.1.2.cmml" xref="A7.p1.14.m7.1.1.1.1.1.2">𝑧</ci><ci id="A7.p1.14.m7.1.1.1.1.1.3.cmml" xref="A7.p1.14.m7.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.14.m7.1c">\text{LayerNorm}(z^{\prime})</annotation><annotation encoding="application/x-llamapun" id="A7.p1.14.m7.1d">LayerNorm ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>. Compare the addition of <math alttext="\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p1.15.m8.1"><semantics id="A7.p1.15.m8.1a"><mrow id="A7.p1.15.m8.1.1" xref="A7.p1.15.m8.1.1.cmml"><mi id="A7.p1.15.m8.1.1.2" mathvariant="normal" xref="A7.p1.15.m8.1.1.2.cmml">Δ</mi><mo id="A7.p1.15.m8.1.1.1" xref="A7.p1.15.m8.1.1.1.cmml">⁢</mo><msub id="A7.p1.15.m8.1.1.3" xref="A7.p1.15.m8.1.1.3.cmml"><mi id="A7.p1.15.m8.1.1.3.2" xref="A7.p1.15.m8.1.1.3.2.cmml">θ</mi><mn id="A7.p1.15.m8.1.1.3.3" xref="A7.p1.15.m8.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.15.m8.1b"><apply id="A7.p1.15.m8.1.1.cmml" xref="A7.p1.15.m8.1.1"><times id="A7.p1.15.m8.1.1.1.cmml" xref="A7.p1.15.m8.1.1.1"></times><ci id="A7.p1.15.m8.1.1.2.cmml" xref="A7.p1.15.m8.1.1.2">Δ</ci><apply id="A7.p1.15.m8.1.1.3.cmml" xref="A7.p1.15.m8.1.1.3"><csymbol cd="ambiguous" id="A7.p1.15.m8.1.1.3.1.cmml" xref="A7.p1.15.m8.1.1.3">subscript</csymbol><ci id="A7.p1.15.m8.1.1.3.2.cmml" xref="A7.p1.15.m8.1.1.3.2">𝜃</ci><cn id="A7.p1.15.m8.1.1.3.3.cmml" type="integer" xref="A7.p1.15.m8.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.15.m8.1c">\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.15.m8.1d">roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> inside the transformer module:</p>
</div>
<div class="ltx_para" id="A7.p2">
<table class="ltx_equation ltx_eqn_table" id="A7.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X=\text{LayerNorm}(z)\quad X^{\prime}=\text{LayerNorm}(z^{\prime})" class="ltx_Math" display="block" id="A7.E12.m1.3"><semantics id="A7.E12.m1.3a"><mrow id="A7.E12.m1.3.3.2" xref="A7.E12.m1.3.3.3.cmml"><mrow id="A7.E12.m1.2.2.1.1" xref="A7.E12.m1.2.2.1.1.cmml"><mi id="A7.E12.m1.2.2.1.1.2" xref="A7.E12.m1.2.2.1.1.2.cmml">X</mi><mo id="A7.E12.m1.2.2.1.1.1" xref="A7.E12.m1.2.2.1.1.1.cmml">=</mo><mrow id="A7.E12.m1.2.2.1.1.3" xref="A7.E12.m1.2.2.1.1.3.cmml"><mtext id="A7.E12.m1.2.2.1.1.3.2" xref="A7.E12.m1.2.2.1.1.3.2a.cmml">LayerNorm</mtext><mo id="A7.E12.m1.2.2.1.1.3.1" xref="A7.E12.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A7.E12.m1.2.2.1.1.3.3.2" xref="A7.E12.m1.2.2.1.1.3.cmml"><mo id="A7.E12.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="A7.E12.m1.2.2.1.1.3.cmml">(</mo><mi id="A7.E12.m1.1.1" xref="A7.E12.m1.1.1.cmml">z</mi><mo id="A7.E12.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="A7.E12.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mspace id="A7.E12.m1.3.3.2.3" width="1em" xref="A7.E12.m1.3.3.3a.cmml"></mspace><mrow id="A7.E12.m1.3.3.2.2" xref="A7.E12.m1.3.3.2.2.cmml"><msup id="A7.E12.m1.3.3.2.2.3" xref="A7.E12.m1.3.3.2.2.3.cmml"><mi id="A7.E12.m1.3.3.2.2.3.2" xref="A7.E12.m1.3.3.2.2.3.2.cmml">X</mi><mo id="A7.E12.m1.3.3.2.2.3.3" xref="A7.E12.m1.3.3.2.2.3.3.cmml">′</mo></msup><mo id="A7.E12.m1.3.3.2.2.2" xref="A7.E12.m1.3.3.2.2.2.cmml">=</mo><mrow id="A7.E12.m1.3.3.2.2.1" xref="A7.E12.m1.3.3.2.2.1.cmml"><mtext id="A7.E12.m1.3.3.2.2.1.3" xref="A7.E12.m1.3.3.2.2.1.3a.cmml">LayerNorm</mtext><mo id="A7.E12.m1.3.3.2.2.1.2" xref="A7.E12.m1.3.3.2.2.1.2.cmml">⁢</mo><mrow id="A7.E12.m1.3.3.2.2.1.1.1" xref="A7.E12.m1.3.3.2.2.1.1.1.1.cmml"><mo id="A7.E12.m1.3.3.2.2.1.1.1.2" stretchy="false" xref="A7.E12.m1.3.3.2.2.1.1.1.1.cmml">(</mo><msup id="A7.E12.m1.3.3.2.2.1.1.1.1" xref="A7.E12.m1.3.3.2.2.1.1.1.1.cmml"><mi id="A7.E12.m1.3.3.2.2.1.1.1.1.2" xref="A7.E12.m1.3.3.2.2.1.1.1.1.2.cmml">z</mi><mo id="A7.E12.m1.3.3.2.2.1.1.1.1.3" xref="A7.E12.m1.3.3.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="A7.E12.m1.3.3.2.2.1.1.1.3" stretchy="false" xref="A7.E12.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E12.m1.3b"><apply id="A7.E12.m1.3.3.3.cmml" xref="A7.E12.m1.3.3.2"><csymbol cd="ambiguous" id="A7.E12.m1.3.3.3a.cmml" xref="A7.E12.m1.3.3.2.3">formulae-sequence</csymbol><apply id="A7.E12.m1.2.2.1.1.cmml" xref="A7.E12.m1.2.2.1.1"><eq id="A7.E12.m1.2.2.1.1.1.cmml" xref="A7.E12.m1.2.2.1.1.1"></eq><ci id="A7.E12.m1.2.2.1.1.2.cmml" xref="A7.E12.m1.2.2.1.1.2">𝑋</ci><apply id="A7.E12.m1.2.2.1.1.3.cmml" xref="A7.E12.m1.2.2.1.1.3"><times id="A7.E12.m1.2.2.1.1.3.1.cmml" xref="A7.E12.m1.2.2.1.1.3.1"></times><ci id="A7.E12.m1.2.2.1.1.3.2a.cmml" xref="A7.E12.m1.2.2.1.1.3.2"><mtext id="A7.E12.m1.2.2.1.1.3.2.cmml" xref="A7.E12.m1.2.2.1.1.3.2">LayerNorm</mtext></ci><ci id="A7.E12.m1.1.1.cmml" xref="A7.E12.m1.1.1">𝑧</ci></apply></apply><apply id="A7.E12.m1.3.3.2.2.cmml" xref="A7.E12.m1.3.3.2.2"><eq id="A7.E12.m1.3.3.2.2.2.cmml" xref="A7.E12.m1.3.3.2.2.2"></eq><apply id="A7.E12.m1.3.3.2.2.3.cmml" xref="A7.E12.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="A7.E12.m1.3.3.2.2.3.1.cmml" xref="A7.E12.m1.3.3.2.2.3">superscript</csymbol><ci id="A7.E12.m1.3.3.2.2.3.2.cmml" xref="A7.E12.m1.3.3.2.2.3.2">𝑋</ci><ci id="A7.E12.m1.3.3.2.2.3.3.cmml" xref="A7.E12.m1.3.3.2.2.3.3">′</ci></apply><apply id="A7.E12.m1.3.3.2.2.1.cmml" xref="A7.E12.m1.3.3.2.2.1"><times id="A7.E12.m1.3.3.2.2.1.2.cmml" xref="A7.E12.m1.3.3.2.2.1.2"></times><ci id="A7.E12.m1.3.3.2.2.1.3a.cmml" xref="A7.E12.m1.3.3.2.2.1.3"><mtext id="A7.E12.m1.3.3.2.2.1.3.cmml" xref="A7.E12.m1.3.3.2.2.1.3">LayerNorm</mtext></ci><apply id="A7.E12.m1.3.3.2.2.1.1.1.1.cmml" xref="A7.E12.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A7.E12.m1.3.3.2.2.1.1.1.1.1.cmml" xref="A7.E12.m1.3.3.2.2.1.1.1">superscript</csymbol><ci id="A7.E12.m1.3.3.2.2.1.1.1.1.2.cmml" xref="A7.E12.m1.3.3.2.2.1.1.1.1.2">𝑧</ci><ci id="A7.E12.m1.3.3.2.2.1.1.1.1.3.cmml" xref="A7.E12.m1.3.3.2.2.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E12.m1.3c">X=\text{LayerNorm}(z)\quad X^{\prime}=\text{LayerNorm}(z^{\prime})</annotation><annotation encoding="application/x-llamapun" id="A7.E12.m1.3d">italic_X = LayerNorm ( italic_z ) italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = LayerNorm ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A7.p3">
<p class="ltx_p" id="A7.p3.1">Considering <math alttext="z^{\prime}=z+J_{\theta_{0}}(X)\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p3.1.m1.1"><semantics id="A7.p3.1.m1.1a"><mrow id="A7.p3.1.m1.1.2" xref="A7.p3.1.m1.1.2.cmml"><msup id="A7.p3.1.m1.1.2.2" xref="A7.p3.1.m1.1.2.2.cmml"><mi id="A7.p3.1.m1.1.2.2.2" xref="A7.p3.1.m1.1.2.2.2.cmml">z</mi><mo id="A7.p3.1.m1.1.2.2.3" xref="A7.p3.1.m1.1.2.2.3.cmml">′</mo></msup><mo id="A7.p3.1.m1.1.2.1" xref="A7.p3.1.m1.1.2.1.cmml">=</mo><mrow id="A7.p3.1.m1.1.2.3" xref="A7.p3.1.m1.1.2.3.cmml"><mi id="A7.p3.1.m1.1.2.3.2" xref="A7.p3.1.m1.1.2.3.2.cmml">z</mi><mo id="A7.p3.1.m1.1.2.3.1" xref="A7.p3.1.m1.1.2.3.1.cmml">+</mo><mrow id="A7.p3.1.m1.1.2.3.3" xref="A7.p3.1.m1.1.2.3.3.cmml"><msub id="A7.p3.1.m1.1.2.3.3.2" xref="A7.p3.1.m1.1.2.3.3.2.cmml"><mi id="A7.p3.1.m1.1.2.3.3.2.2" xref="A7.p3.1.m1.1.2.3.3.2.2.cmml">J</mi><msub id="A7.p3.1.m1.1.2.3.3.2.3" xref="A7.p3.1.m1.1.2.3.3.2.3.cmml"><mi id="A7.p3.1.m1.1.2.3.3.2.3.2" xref="A7.p3.1.m1.1.2.3.3.2.3.2.cmml">θ</mi><mn id="A7.p3.1.m1.1.2.3.3.2.3.3" xref="A7.p3.1.m1.1.2.3.3.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p3.1.m1.1.2.3.3.1" xref="A7.p3.1.m1.1.2.3.3.1.cmml">⁢</mo><mrow id="A7.p3.1.m1.1.2.3.3.3.2" xref="A7.p3.1.m1.1.2.3.3.cmml"><mo id="A7.p3.1.m1.1.2.3.3.3.2.1" stretchy="false" xref="A7.p3.1.m1.1.2.3.3.cmml">(</mo><mi id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml">X</mi><mo id="A7.p3.1.m1.1.2.3.3.3.2.2" stretchy="false" xref="A7.p3.1.m1.1.2.3.3.cmml">)</mo></mrow><mo id="A7.p3.1.m1.1.2.3.3.1a" xref="A7.p3.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="A7.p3.1.m1.1.2.3.3.4" mathvariant="normal" xref="A7.p3.1.m1.1.2.3.3.4.cmml">Δ</mi><mo id="A7.p3.1.m1.1.2.3.3.1b" xref="A7.p3.1.m1.1.2.3.3.1.cmml">⁢</mo><msub id="A7.p3.1.m1.1.2.3.3.5" xref="A7.p3.1.m1.1.2.3.3.5.cmml"><mi id="A7.p3.1.m1.1.2.3.3.5.2" xref="A7.p3.1.m1.1.2.3.3.5.2.cmml">θ</mi><mn id="A7.p3.1.m1.1.2.3.3.5.3" xref="A7.p3.1.m1.1.2.3.3.5.3.cmml">0</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b"><apply id="A7.p3.1.m1.1.2.cmml" xref="A7.p3.1.m1.1.2"><eq id="A7.p3.1.m1.1.2.1.cmml" xref="A7.p3.1.m1.1.2.1"></eq><apply id="A7.p3.1.m1.1.2.2.cmml" xref="A7.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.2.2.1.cmml" xref="A7.p3.1.m1.1.2.2">superscript</csymbol><ci id="A7.p3.1.m1.1.2.2.2.cmml" xref="A7.p3.1.m1.1.2.2.2">𝑧</ci><ci id="A7.p3.1.m1.1.2.2.3.cmml" xref="A7.p3.1.m1.1.2.2.3">′</ci></apply><apply id="A7.p3.1.m1.1.2.3.cmml" xref="A7.p3.1.m1.1.2.3"><plus id="A7.p3.1.m1.1.2.3.1.cmml" xref="A7.p3.1.m1.1.2.3.1"></plus><ci id="A7.p3.1.m1.1.2.3.2.cmml" xref="A7.p3.1.m1.1.2.3.2">𝑧</ci><apply id="A7.p3.1.m1.1.2.3.3.cmml" xref="A7.p3.1.m1.1.2.3.3"><times id="A7.p3.1.m1.1.2.3.3.1.cmml" xref="A7.p3.1.m1.1.2.3.3.1"></times><apply id="A7.p3.1.m1.1.2.3.3.2.cmml" xref="A7.p3.1.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.2.3.3.2.1.cmml" xref="A7.p3.1.m1.1.2.3.3.2">subscript</csymbol><ci id="A7.p3.1.m1.1.2.3.3.2.2.cmml" xref="A7.p3.1.m1.1.2.3.3.2.2">𝐽</ci><apply id="A7.p3.1.m1.1.2.3.3.2.3.cmml" xref="A7.p3.1.m1.1.2.3.3.2.3"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.2.3.3.2.3.1.cmml" xref="A7.p3.1.m1.1.2.3.3.2.3">subscript</csymbol><ci id="A7.p3.1.m1.1.2.3.3.2.3.2.cmml" xref="A7.p3.1.m1.1.2.3.3.2.3.2">𝜃</ci><cn id="A7.p3.1.m1.1.2.3.3.2.3.3.cmml" type="integer" xref="A7.p3.1.m1.1.2.3.3.2.3.3">0</cn></apply></apply><ci id="A7.p3.1.m1.1.1.cmml" xref="A7.p3.1.m1.1.1">𝑋</ci><ci id="A7.p3.1.m1.1.2.3.3.4.cmml" xref="A7.p3.1.m1.1.2.3.3.4">Δ</ci><apply id="A7.p3.1.m1.1.2.3.3.5.cmml" xref="A7.p3.1.m1.1.2.3.3.5"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.2.3.3.5.1.cmml" xref="A7.p3.1.m1.1.2.3.3.5">subscript</csymbol><ci id="A7.p3.1.m1.1.2.3.3.5.2.cmml" xref="A7.p3.1.m1.1.2.3.3.5.2">𝜃</ci><cn id="A7.p3.1.m1.1.2.3.3.5.3.cmml" type="integer" xref="A7.p3.1.m1.1.2.3.3.5.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">z^{\prime}=z+J_{\theta_{0}}(X)\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p3.1.m1.1d">italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_z + italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we have</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{z^{\prime}}\approx\mu_{z}+\mu_{J_{\theta_{0}}(X)\Delta\theta_{0}}\quad%
\sigma_{z^{\prime}}\approx\sigma_{z}" class="ltx_Math" display="block" id="A7.E13.m1.3"><semantics id="A7.E13.m1.3a"><mrow id="A7.E13.m1.3.3.2" xref="A7.E13.m1.3.3.3.cmml"><mrow id="A7.E13.m1.2.2.1.1" xref="A7.E13.m1.2.2.1.1.cmml"><msub id="A7.E13.m1.2.2.1.1.2" xref="A7.E13.m1.2.2.1.1.2.cmml"><mi id="A7.E13.m1.2.2.1.1.2.2" xref="A7.E13.m1.2.2.1.1.2.2.cmml">μ</mi><msup id="A7.E13.m1.2.2.1.1.2.3" xref="A7.E13.m1.2.2.1.1.2.3.cmml"><mi id="A7.E13.m1.2.2.1.1.2.3.2" xref="A7.E13.m1.2.2.1.1.2.3.2.cmml">z</mi><mo id="A7.E13.m1.2.2.1.1.2.3.3" xref="A7.E13.m1.2.2.1.1.2.3.3.cmml">′</mo></msup></msub><mo id="A7.E13.m1.2.2.1.1.1" xref="A7.E13.m1.2.2.1.1.1.cmml">≈</mo><mrow id="A7.E13.m1.2.2.1.1.3" xref="A7.E13.m1.2.2.1.1.3.cmml"><msub id="A7.E13.m1.2.2.1.1.3.2" xref="A7.E13.m1.2.2.1.1.3.2.cmml"><mi id="A7.E13.m1.2.2.1.1.3.2.2" xref="A7.E13.m1.2.2.1.1.3.2.2.cmml">μ</mi><mi id="A7.E13.m1.2.2.1.1.3.2.3" xref="A7.E13.m1.2.2.1.1.3.2.3.cmml">z</mi></msub><mo id="A7.E13.m1.2.2.1.1.3.1" xref="A7.E13.m1.2.2.1.1.3.1.cmml">+</mo><msub id="A7.E13.m1.2.2.1.1.3.3" xref="A7.E13.m1.2.2.1.1.3.3.cmml"><mi id="A7.E13.m1.2.2.1.1.3.3.2" xref="A7.E13.m1.2.2.1.1.3.3.2.cmml">μ</mi><mrow id="A7.E13.m1.1.1.1" xref="A7.E13.m1.1.1.1.cmml"><msub id="A7.E13.m1.1.1.1.3" xref="A7.E13.m1.1.1.1.3.cmml"><mi id="A7.E13.m1.1.1.1.3.2" xref="A7.E13.m1.1.1.1.3.2.cmml">J</mi><msub id="A7.E13.m1.1.1.1.3.3" xref="A7.E13.m1.1.1.1.3.3.cmml"><mi id="A7.E13.m1.1.1.1.3.3.2" xref="A7.E13.m1.1.1.1.3.3.2.cmml">θ</mi><mn id="A7.E13.m1.1.1.1.3.3.3" xref="A7.E13.m1.1.1.1.3.3.3.cmml">0</mn></msub></msub><mo id="A7.E13.m1.1.1.1.2" xref="A7.E13.m1.1.1.1.2.cmml">⁢</mo><mrow id="A7.E13.m1.1.1.1.4.2" xref="A7.E13.m1.1.1.1.cmml"><mo id="A7.E13.m1.1.1.1.4.2.1" stretchy="false" xref="A7.E13.m1.1.1.1.cmml">(</mo><mi id="A7.E13.m1.1.1.1.1" xref="A7.E13.m1.1.1.1.1.cmml">X</mi><mo id="A7.E13.m1.1.1.1.4.2.2" stretchy="false" xref="A7.E13.m1.1.1.1.cmml">)</mo></mrow><mo id="A7.E13.m1.1.1.1.2a" xref="A7.E13.m1.1.1.1.2.cmml">⁢</mo><mi id="A7.E13.m1.1.1.1.5" mathvariant="normal" xref="A7.E13.m1.1.1.1.5.cmml">Δ</mi><mo id="A7.E13.m1.1.1.1.2b" xref="A7.E13.m1.1.1.1.2.cmml">⁢</mo><msub id="A7.E13.m1.1.1.1.6" xref="A7.E13.m1.1.1.1.6.cmml"><mi id="A7.E13.m1.1.1.1.6.2" xref="A7.E13.m1.1.1.1.6.2.cmml">θ</mi><mn id="A7.E13.m1.1.1.1.6.3" xref="A7.E13.m1.1.1.1.6.3.cmml">0</mn></msub></mrow></msub></mrow></mrow><mspace id="A7.E13.m1.3.3.2.3" width="1em" xref="A7.E13.m1.3.3.3a.cmml"></mspace><mrow id="A7.E13.m1.3.3.2.2" xref="A7.E13.m1.3.3.2.2.cmml"><msub id="A7.E13.m1.3.3.2.2.2" xref="A7.E13.m1.3.3.2.2.2.cmml"><mi id="A7.E13.m1.3.3.2.2.2.2" xref="A7.E13.m1.3.3.2.2.2.2.cmml">σ</mi><msup id="A7.E13.m1.3.3.2.2.2.3" xref="A7.E13.m1.3.3.2.2.2.3.cmml"><mi id="A7.E13.m1.3.3.2.2.2.3.2" xref="A7.E13.m1.3.3.2.2.2.3.2.cmml">z</mi><mo id="A7.E13.m1.3.3.2.2.2.3.3" xref="A7.E13.m1.3.3.2.2.2.3.3.cmml">′</mo></msup></msub><mo id="A7.E13.m1.3.3.2.2.1" xref="A7.E13.m1.3.3.2.2.1.cmml">≈</mo><msub id="A7.E13.m1.3.3.2.2.3" xref="A7.E13.m1.3.3.2.2.3.cmml"><mi id="A7.E13.m1.3.3.2.2.3.2" xref="A7.E13.m1.3.3.2.2.3.2.cmml">σ</mi><mi id="A7.E13.m1.3.3.2.2.3.3" xref="A7.E13.m1.3.3.2.2.3.3.cmml">z</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E13.m1.3b"><apply id="A7.E13.m1.3.3.3.cmml" xref="A7.E13.m1.3.3.2"><csymbol cd="ambiguous" id="A7.E13.m1.3.3.3a.cmml" xref="A7.E13.m1.3.3.2.3">formulae-sequence</csymbol><apply id="A7.E13.m1.2.2.1.1.cmml" xref="A7.E13.m1.2.2.1.1"><approx id="A7.E13.m1.2.2.1.1.1.cmml" xref="A7.E13.m1.2.2.1.1.1"></approx><apply id="A7.E13.m1.2.2.1.1.2.cmml" xref="A7.E13.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A7.E13.m1.2.2.1.1.2.1.cmml" xref="A7.E13.m1.2.2.1.1.2">subscript</csymbol><ci id="A7.E13.m1.2.2.1.1.2.2.cmml" xref="A7.E13.m1.2.2.1.1.2.2">𝜇</ci><apply id="A7.E13.m1.2.2.1.1.2.3.cmml" xref="A7.E13.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A7.E13.m1.2.2.1.1.2.3.1.cmml" xref="A7.E13.m1.2.2.1.1.2.3">superscript</csymbol><ci id="A7.E13.m1.2.2.1.1.2.3.2.cmml" xref="A7.E13.m1.2.2.1.1.2.3.2">𝑧</ci><ci id="A7.E13.m1.2.2.1.1.2.3.3.cmml" xref="A7.E13.m1.2.2.1.1.2.3.3">′</ci></apply></apply><apply id="A7.E13.m1.2.2.1.1.3.cmml" xref="A7.E13.m1.2.2.1.1.3"><plus id="A7.E13.m1.2.2.1.1.3.1.cmml" xref="A7.E13.m1.2.2.1.1.3.1"></plus><apply id="A7.E13.m1.2.2.1.1.3.2.cmml" xref="A7.E13.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A7.E13.m1.2.2.1.1.3.2.1.cmml" xref="A7.E13.m1.2.2.1.1.3.2">subscript</csymbol><ci id="A7.E13.m1.2.2.1.1.3.2.2.cmml" xref="A7.E13.m1.2.2.1.1.3.2.2">𝜇</ci><ci id="A7.E13.m1.2.2.1.1.3.2.3.cmml" xref="A7.E13.m1.2.2.1.1.3.2.3">𝑧</ci></apply><apply id="A7.E13.m1.2.2.1.1.3.3.cmml" xref="A7.E13.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A7.E13.m1.2.2.1.1.3.3.1.cmml" xref="A7.E13.m1.2.2.1.1.3.3">subscript</csymbol><ci id="A7.E13.m1.2.2.1.1.3.3.2.cmml" xref="A7.E13.m1.2.2.1.1.3.3.2">𝜇</ci><apply id="A7.E13.m1.1.1.1.cmml" xref="A7.E13.m1.1.1.1"><times id="A7.E13.m1.1.1.1.2.cmml" xref="A7.E13.m1.1.1.1.2"></times><apply id="A7.E13.m1.1.1.1.3.cmml" xref="A7.E13.m1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E13.m1.1.1.1.3.1.cmml" xref="A7.E13.m1.1.1.1.3">subscript</csymbol><ci id="A7.E13.m1.1.1.1.3.2.cmml" xref="A7.E13.m1.1.1.1.3.2">𝐽</ci><apply id="A7.E13.m1.1.1.1.3.3.cmml" xref="A7.E13.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E13.m1.1.1.1.3.3.1.cmml" xref="A7.E13.m1.1.1.1.3.3">subscript</csymbol><ci id="A7.E13.m1.1.1.1.3.3.2.cmml" xref="A7.E13.m1.1.1.1.3.3.2">𝜃</ci><cn id="A7.E13.m1.1.1.1.3.3.3.cmml" type="integer" xref="A7.E13.m1.1.1.1.3.3.3">0</cn></apply></apply><ci id="A7.E13.m1.1.1.1.1.cmml" xref="A7.E13.m1.1.1.1.1">𝑋</ci><ci id="A7.E13.m1.1.1.1.5.cmml" xref="A7.E13.m1.1.1.1.5">Δ</ci><apply id="A7.E13.m1.1.1.1.6.cmml" xref="A7.E13.m1.1.1.1.6"><csymbol cd="ambiguous" id="A7.E13.m1.1.1.1.6.1.cmml" xref="A7.E13.m1.1.1.1.6">subscript</csymbol><ci id="A7.E13.m1.1.1.1.6.2.cmml" xref="A7.E13.m1.1.1.1.6.2">𝜃</ci><cn id="A7.E13.m1.1.1.1.6.3.cmml" type="integer" xref="A7.E13.m1.1.1.1.6.3">0</cn></apply></apply></apply></apply></apply><apply id="A7.E13.m1.3.3.2.2.cmml" xref="A7.E13.m1.3.3.2.2"><approx id="A7.E13.m1.3.3.2.2.1.cmml" xref="A7.E13.m1.3.3.2.2.1"></approx><apply id="A7.E13.m1.3.3.2.2.2.cmml" xref="A7.E13.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A7.E13.m1.3.3.2.2.2.1.cmml" xref="A7.E13.m1.3.3.2.2.2">subscript</csymbol><ci id="A7.E13.m1.3.3.2.2.2.2.cmml" xref="A7.E13.m1.3.3.2.2.2.2">𝜎</ci><apply id="A7.E13.m1.3.3.2.2.2.3.cmml" xref="A7.E13.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="A7.E13.m1.3.3.2.2.2.3.1.cmml" xref="A7.E13.m1.3.3.2.2.2.3">superscript</csymbol><ci id="A7.E13.m1.3.3.2.2.2.3.2.cmml" xref="A7.E13.m1.3.3.2.2.2.3.2">𝑧</ci><ci id="A7.E13.m1.3.3.2.2.2.3.3.cmml" xref="A7.E13.m1.3.3.2.2.2.3.3">′</ci></apply></apply><apply id="A7.E13.m1.3.3.2.2.3.cmml" xref="A7.E13.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="A7.E13.m1.3.3.2.2.3.1.cmml" xref="A7.E13.m1.3.3.2.2.3">subscript</csymbol><ci id="A7.E13.m1.3.3.2.2.3.2.cmml" xref="A7.E13.m1.3.3.2.2.3.2">𝜎</ci><ci id="A7.E13.m1.3.3.2.2.3.3.cmml" xref="A7.E13.m1.3.3.2.2.3.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E13.m1.3c">\mu_{z^{\prime}}\approx\mu_{z}+\mu_{J_{\theta_{0}}(X)\Delta\theta_{0}}\quad%
\sigma_{z^{\prime}}\approx\sigma_{z}</annotation><annotation encoding="application/x-llamapun" id="A7.E13.m1.3d">italic_μ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ≈ italic_μ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_μ start_POSTSUBSCRIPT italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ≈ italic_σ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p3.4">Since <math alttext="|\Delta\theta_{0}|" class="ltx_Math" display="inline" id="A7.p3.2.m1.1"><semantics id="A7.p3.2.m1.1a"><mrow id="A7.p3.2.m1.1.1.1" xref="A7.p3.2.m1.1.1.2.cmml"><mo id="A7.p3.2.m1.1.1.1.2" stretchy="false" xref="A7.p3.2.m1.1.1.2.1.cmml">|</mo><mrow id="A7.p3.2.m1.1.1.1.1" xref="A7.p3.2.m1.1.1.1.1.cmml"><mi id="A7.p3.2.m1.1.1.1.1.2" mathvariant="normal" xref="A7.p3.2.m1.1.1.1.1.2.cmml">Δ</mi><mo id="A7.p3.2.m1.1.1.1.1.1" xref="A7.p3.2.m1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p3.2.m1.1.1.1.1.3" xref="A7.p3.2.m1.1.1.1.1.3.cmml"><mi id="A7.p3.2.m1.1.1.1.1.3.2" xref="A7.p3.2.m1.1.1.1.1.3.2.cmml">θ</mi><mn id="A7.p3.2.m1.1.1.1.1.3.3" xref="A7.p3.2.m1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A7.p3.2.m1.1.1.1.3" stretchy="false" xref="A7.p3.2.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.2.m1.1b"><apply id="A7.p3.2.m1.1.1.2.cmml" xref="A7.p3.2.m1.1.1.1"><abs id="A7.p3.2.m1.1.1.2.1.cmml" xref="A7.p3.2.m1.1.1.1.2"></abs><apply id="A7.p3.2.m1.1.1.1.1.cmml" xref="A7.p3.2.m1.1.1.1.1"><times id="A7.p3.2.m1.1.1.1.1.1.cmml" xref="A7.p3.2.m1.1.1.1.1.1"></times><ci id="A7.p3.2.m1.1.1.1.1.2.cmml" xref="A7.p3.2.m1.1.1.1.1.2">Δ</ci><apply id="A7.p3.2.m1.1.1.1.1.3.cmml" xref="A7.p3.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p3.2.m1.1.1.1.1.3.1.cmml" xref="A7.p3.2.m1.1.1.1.1.3">subscript</csymbol><ci id="A7.p3.2.m1.1.1.1.1.3.2.cmml" xref="A7.p3.2.m1.1.1.1.1.3.2">𝜃</ci><cn id="A7.p3.2.m1.1.1.1.1.3.3.cmml" type="integer" xref="A7.p3.2.m1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.2.m1.1c">|\Delta\theta_{0}|</annotation><annotation encoding="application/x-llamapun" id="A7.p3.2.m1.1d">| roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT |</annotation></semantics></math> is quite small compared to <math alttext="\theta_{0}" class="ltx_Math" display="inline" id="A7.p3.3.m2.1"><semantics id="A7.p3.3.m2.1a"><msub id="A7.p3.3.m2.1.1" xref="A7.p3.3.m2.1.1.cmml"><mi id="A7.p3.3.m2.1.1.2" xref="A7.p3.3.m2.1.1.2.cmml">θ</mi><mn id="A7.p3.3.m2.1.1.3" xref="A7.p3.3.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p3.3.m2.1b"><apply id="A7.p3.3.m2.1.1.cmml" xref="A7.p3.3.m2.1.1"><csymbol cd="ambiguous" id="A7.p3.3.m2.1.1.1.cmml" xref="A7.p3.3.m2.1.1">subscript</csymbol><ci id="A7.p3.3.m2.1.1.2.cmml" xref="A7.p3.3.m2.1.1.2">𝜃</ci><cn id="A7.p3.3.m2.1.1.3.cmml" type="integer" xref="A7.p3.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.3.m2.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p3.3.m2.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="J_{\theta_{0}}(X)\Delta\theta_{0}" class="ltx_Math" display="inline" id="A7.p3.4.m3.1"><semantics id="A7.p3.4.m3.1a"><mrow id="A7.p3.4.m3.1.2" xref="A7.p3.4.m3.1.2.cmml"><msub id="A7.p3.4.m3.1.2.2" xref="A7.p3.4.m3.1.2.2.cmml"><mi id="A7.p3.4.m3.1.2.2.2" xref="A7.p3.4.m3.1.2.2.2.cmml">J</mi><msub id="A7.p3.4.m3.1.2.2.3" xref="A7.p3.4.m3.1.2.2.3.cmml"><mi id="A7.p3.4.m3.1.2.2.3.2" xref="A7.p3.4.m3.1.2.2.3.2.cmml">θ</mi><mn id="A7.p3.4.m3.1.2.2.3.3" xref="A7.p3.4.m3.1.2.2.3.3.cmml">0</mn></msub></msub><mo id="A7.p3.4.m3.1.2.1" xref="A7.p3.4.m3.1.2.1.cmml">⁢</mo><mrow id="A7.p3.4.m3.1.2.3.2" xref="A7.p3.4.m3.1.2.cmml"><mo id="A7.p3.4.m3.1.2.3.2.1" stretchy="false" xref="A7.p3.4.m3.1.2.cmml">(</mo><mi id="A7.p3.4.m3.1.1" xref="A7.p3.4.m3.1.1.cmml">X</mi><mo id="A7.p3.4.m3.1.2.3.2.2" stretchy="false" xref="A7.p3.4.m3.1.2.cmml">)</mo></mrow><mo id="A7.p3.4.m3.1.2.1a" xref="A7.p3.4.m3.1.2.1.cmml">⁢</mo><mi id="A7.p3.4.m3.1.2.4" mathvariant="normal" xref="A7.p3.4.m3.1.2.4.cmml">Δ</mi><mo id="A7.p3.4.m3.1.2.1b" xref="A7.p3.4.m3.1.2.1.cmml">⁢</mo><msub id="A7.p3.4.m3.1.2.5" xref="A7.p3.4.m3.1.2.5.cmml"><mi id="A7.p3.4.m3.1.2.5.2" xref="A7.p3.4.m3.1.2.5.2.cmml">θ</mi><mn id="A7.p3.4.m3.1.2.5.3" xref="A7.p3.4.m3.1.2.5.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.4.m3.1b"><apply id="A7.p3.4.m3.1.2.cmml" xref="A7.p3.4.m3.1.2"><times id="A7.p3.4.m3.1.2.1.cmml" xref="A7.p3.4.m3.1.2.1"></times><apply id="A7.p3.4.m3.1.2.2.cmml" xref="A7.p3.4.m3.1.2.2"><csymbol cd="ambiguous" id="A7.p3.4.m3.1.2.2.1.cmml" xref="A7.p3.4.m3.1.2.2">subscript</csymbol><ci id="A7.p3.4.m3.1.2.2.2.cmml" xref="A7.p3.4.m3.1.2.2.2">𝐽</ci><apply id="A7.p3.4.m3.1.2.2.3.cmml" xref="A7.p3.4.m3.1.2.2.3"><csymbol cd="ambiguous" id="A7.p3.4.m3.1.2.2.3.1.cmml" xref="A7.p3.4.m3.1.2.2.3">subscript</csymbol><ci id="A7.p3.4.m3.1.2.2.3.2.cmml" xref="A7.p3.4.m3.1.2.2.3.2">𝜃</ci><cn id="A7.p3.4.m3.1.2.2.3.3.cmml" type="integer" xref="A7.p3.4.m3.1.2.2.3.3">0</cn></apply></apply><ci id="A7.p3.4.m3.1.1.cmml" xref="A7.p3.4.m3.1.1">𝑋</ci><ci id="A7.p3.4.m3.1.2.4.cmml" xref="A7.p3.4.m3.1.2.4">Δ</ci><apply id="A7.p3.4.m3.1.2.5.cmml" xref="A7.p3.4.m3.1.2.5"><csymbol cd="ambiguous" id="A7.p3.4.m3.1.2.5.1.cmml" xref="A7.p3.4.m3.1.2.5">subscript</csymbol><ci id="A7.p3.4.m3.1.2.5.2.cmml" xref="A7.p3.4.m3.1.2.5.2">𝜃</ci><cn id="A7.p3.4.m3.1.2.5.3.cmml" type="integer" xref="A7.p3.4.m3.1.2.5.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.4.m3.1c">J_{\theta_{0}}(X)\Delta\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A7.p3.4.m3.1d">italic_J start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) roman_Δ italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is also of small norm, which can be considered to be ignored for the mean and standard deviation. Based on it, we have</p>
</div>
<div class="ltx_para" id="A7.p4">
<table class="ltx_equation ltx_eqn_table" id="A7.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{LayerNorm}(z^{\prime})\approx\text{LayerNorm}(z)" class="ltx_Math" display="block" id="A7.Ex2.m1.2"><semantics id="A7.Ex2.m1.2a"><mrow id="A7.Ex2.m1.2.2" xref="A7.Ex2.m1.2.2.cmml"><mrow id="A7.Ex2.m1.2.2.1" xref="A7.Ex2.m1.2.2.1.cmml"><mtext id="A7.Ex2.m1.2.2.1.3" xref="A7.Ex2.m1.2.2.1.3a.cmml">LayerNorm</mtext><mo id="A7.Ex2.m1.2.2.1.2" xref="A7.Ex2.m1.2.2.1.2.cmml">⁢</mo><mrow id="A7.Ex2.m1.2.2.1.1.1" xref="A7.Ex2.m1.2.2.1.1.1.1.cmml"><mo id="A7.Ex2.m1.2.2.1.1.1.2" stretchy="false" xref="A7.Ex2.m1.2.2.1.1.1.1.cmml">(</mo><msup id="A7.Ex2.m1.2.2.1.1.1.1" xref="A7.Ex2.m1.2.2.1.1.1.1.cmml"><mi id="A7.Ex2.m1.2.2.1.1.1.1.2" xref="A7.Ex2.m1.2.2.1.1.1.1.2.cmml">z</mi><mo id="A7.Ex2.m1.2.2.1.1.1.1.3" xref="A7.Ex2.m1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="A7.Ex2.m1.2.2.1.1.1.3" stretchy="false" xref="A7.Ex2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex2.m1.2.2.2" xref="A7.Ex2.m1.2.2.2.cmml">≈</mo><mrow id="A7.Ex2.m1.2.2.3" xref="A7.Ex2.m1.2.2.3.cmml"><mtext id="A7.Ex2.m1.2.2.3.2" xref="A7.Ex2.m1.2.2.3.2a.cmml">LayerNorm</mtext><mo id="A7.Ex2.m1.2.2.3.1" xref="A7.Ex2.m1.2.2.3.1.cmml">⁢</mo><mrow id="A7.Ex2.m1.2.2.3.3.2" xref="A7.Ex2.m1.2.2.3.cmml"><mo id="A7.Ex2.m1.2.2.3.3.2.1" stretchy="false" xref="A7.Ex2.m1.2.2.3.cmml">(</mo><mi id="A7.Ex2.m1.1.1" xref="A7.Ex2.m1.1.1.cmml">z</mi><mo id="A7.Ex2.m1.2.2.3.3.2.2" stretchy="false" xref="A7.Ex2.m1.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex2.m1.2b"><apply id="A7.Ex2.m1.2.2.cmml" xref="A7.Ex2.m1.2.2"><approx id="A7.Ex2.m1.2.2.2.cmml" xref="A7.Ex2.m1.2.2.2"></approx><apply id="A7.Ex2.m1.2.2.1.cmml" xref="A7.Ex2.m1.2.2.1"><times id="A7.Ex2.m1.2.2.1.2.cmml" xref="A7.Ex2.m1.2.2.1.2"></times><ci id="A7.Ex2.m1.2.2.1.3a.cmml" xref="A7.Ex2.m1.2.2.1.3"><mtext id="A7.Ex2.m1.2.2.1.3.cmml" xref="A7.Ex2.m1.2.2.1.3">LayerNorm</mtext></ci><apply id="A7.Ex2.m1.2.2.1.1.1.1.cmml" xref="A7.Ex2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A7.Ex2.m1.2.2.1.1.1.1.1.cmml" xref="A7.Ex2.m1.2.2.1.1.1">superscript</csymbol><ci id="A7.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="A7.Ex2.m1.2.2.1.1.1.1.2">𝑧</ci><ci id="A7.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="A7.Ex2.m1.2.2.1.1.1.1.3">′</ci></apply></apply><apply id="A7.Ex2.m1.2.2.3.cmml" xref="A7.Ex2.m1.2.2.3"><times id="A7.Ex2.m1.2.2.3.1.cmml" xref="A7.Ex2.m1.2.2.3.1"></times><ci id="A7.Ex2.m1.2.2.3.2a.cmml" xref="A7.Ex2.m1.2.2.3.2"><mtext id="A7.Ex2.m1.2.2.3.2.cmml" xref="A7.Ex2.m1.2.2.3.2">LayerNorm</mtext></ci><ci id="A7.Ex2.m1.1.1.cmml" xref="A7.Ex2.m1.1.1">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex2.m1.2c">\text{LayerNorm}(z^{\prime})\approx\text{LayerNorm}(z)</annotation><annotation encoding="application/x-llamapun" id="A7.Ex2.m1.2d">LayerNorm ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ≈ LayerNorm ( italic_z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A7.p5">
<p class="ltx_p" id="A7.p5.3">In other words, if the updated parameter is small enough compared to the pretrained model, the output distribution after each submodule remains consistent with the pretrained model. Meanwhile, we need to prove that the perturbation brought by attention is far lower than that brought by FFN so that the removal of FFN results in higher improvement than the removal of attention modules. Specifically, omitting the multi-head mechanism, self-attention is formalized as such:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attn}(X)=\text{SoftMax}\left(\frac{XW_{q}(XW_{k})^{\top}}{\sqrt{d_{k}}}%
\right)XW_{v}" class="ltx_Math" display="block" id="A7.E14.m1.2"><semantics id="A7.E14.m1.2a"><mrow id="A7.E14.m1.2.3" xref="A7.E14.m1.2.3.cmml"><mrow id="A7.E14.m1.2.3.2" xref="A7.E14.m1.2.3.2.cmml"><mtext id="A7.E14.m1.2.3.2.2" xref="A7.E14.m1.2.3.2.2a.cmml">Attn</mtext><mo id="A7.E14.m1.2.3.2.1" xref="A7.E14.m1.2.3.2.1.cmml">⁢</mo><mrow id="A7.E14.m1.2.3.2.3.2" xref="A7.E14.m1.2.3.2.cmml"><mo id="A7.E14.m1.2.3.2.3.2.1" stretchy="false" xref="A7.E14.m1.2.3.2.cmml">(</mo><mi id="A7.E14.m1.2.2" xref="A7.E14.m1.2.2.cmml">X</mi><mo id="A7.E14.m1.2.3.2.3.2.2" stretchy="false" xref="A7.E14.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="A7.E14.m1.2.3.1" xref="A7.E14.m1.2.3.1.cmml">=</mo><mrow id="A7.E14.m1.2.3.3" xref="A7.E14.m1.2.3.3.cmml"><mtext id="A7.E14.m1.2.3.3.2" xref="A7.E14.m1.2.3.3.2a.cmml">SoftMax</mtext><mo id="A7.E14.m1.2.3.3.1" xref="A7.E14.m1.2.3.3.1.cmml">⁢</mo><mrow id="A7.E14.m1.2.3.3.3.2" xref="A7.E14.m1.1.1.cmml"><mo id="A7.E14.m1.2.3.3.3.2.1" xref="A7.E14.m1.1.1.cmml">(</mo><mfrac id="A7.E14.m1.1.1" xref="A7.E14.m1.1.1.cmml"><mrow id="A7.E14.m1.1.1.1" xref="A7.E14.m1.1.1.1.cmml"><mi id="A7.E14.m1.1.1.1.3" xref="A7.E14.m1.1.1.1.3.cmml">X</mi><mo id="A7.E14.m1.1.1.1.2" xref="A7.E14.m1.1.1.1.2.cmml">⁢</mo><msub id="A7.E14.m1.1.1.1.4" xref="A7.E14.m1.1.1.1.4.cmml"><mi id="A7.E14.m1.1.1.1.4.2" xref="A7.E14.m1.1.1.1.4.2.cmml">W</mi><mi id="A7.E14.m1.1.1.1.4.3" xref="A7.E14.m1.1.1.1.4.3.cmml">q</mi></msub><mo id="A7.E14.m1.1.1.1.2a" xref="A7.E14.m1.1.1.1.2.cmml">⁢</mo><msup id="A7.E14.m1.1.1.1.1" xref="A7.E14.m1.1.1.1.1.cmml"><mrow id="A7.E14.m1.1.1.1.1.1.1" xref="A7.E14.m1.1.1.1.1.1.1.1.cmml"><mo id="A7.E14.m1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E14.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E14.m1.1.1.1.1.1.1.1" xref="A7.E14.m1.1.1.1.1.1.1.1.cmml"><mi id="A7.E14.m1.1.1.1.1.1.1.1.2" xref="A7.E14.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="A7.E14.m1.1.1.1.1.1.1.1.1" xref="A7.E14.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.E14.m1.1.1.1.1.1.1.1.3" xref="A7.E14.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E14.m1.1.1.1.1.1.1.1.3.2" xref="A7.E14.m1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="A7.E14.m1.1.1.1.1.1.1.1.3.3" xref="A7.E14.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A7.E14.m1.1.1.1.1.1.1.3" stretchy="false" xref="A7.E14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.E14.m1.1.1.1.1.3" xref="A7.E14.m1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><msqrt id="A7.E14.m1.1.1.3" xref="A7.E14.m1.1.1.3.cmml"><msub id="A7.E14.m1.1.1.3.2" xref="A7.E14.m1.1.1.3.2.cmml"><mi id="A7.E14.m1.1.1.3.2.2" xref="A7.E14.m1.1.1.3.2.2.cmml">d</mi><mi id="A7.E14.m1.1.1.3.2.3" xref="A7.E14.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="A7.E14.m1.2.3.3.3.2.2" xref="A7.E14.m1.1.1.cmml">)</mo></mrow><mo id="A7.E14.m1.2.3.3.1a" xref="A7.E14.m1.2.3.3.1.cmml">⁢</mo><mi id="A7.E14.m1.2.3.3.4" xref="A7.E14.m1.2.3.3.4.cmml">X</mi><mo id="A7.E14.m1.2.3.3.1b" xref="A7.E14.m1.2.3.3.1.cmml">⁢</mo><msub id="A7.E14.m1.2.3.3.5" xref="A7.E14.m1.2.3.3.5.cmml"><mi id="A7.E14.m1.2.3.3.5.2" xref="A7.E14.m1.2.3.3.5.2.cmml">W</mi><mi id="A7.E14.m1.2.3.3.5.3" xref="A7.E14.m1.2.3.3.5.3.cmml">v</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E14.m1.2b"><apply id="A7.E14.m1.2.3.cmml" xref="A7.E14.m1.2.3"><eq id="A7.E14.m1.2.3.1.cmml" xref="A7.E14.m1.2.3.1"></eq><apply id="A7.E14.m1.2.3.2.cmml" xref="A7.E14.m1.2.3.2"><times id="A7.E14.m1.2.3.2.1.cmml" xref="A7.E14.m1.2.3.2.1"></times><ci id="A7.E14.m1.2.3.2.2a.cmml" xref="A7.E14.m1.2.3.2.2"><mtext id="A7.E14.m1.2.3.2.2.cmml" xref="A7.E14.m1.2.3.2.2">Attn</mtext></ci><ci id="A7.E14.m1.2.2.cmml" xref="A7.E14.m1.2.2">𝑋</ci></apply><apply id="A7.E14.m1.2.3.3.cmml" xref="A7.E14.m1.2.3.3"><times id="A7.E14.m1.2.3.3.1.cmml" xref="A7.E14.m1.2.3.3.1"></times><ci id="A7.E14.m1.2.3.3.2a.cmml" xref="A7.E14.m1.2.3.3.2"><mtext id="A7.E14.m1.2.3.3.2.cmml" xref="A7.E14.m1.2.3.3.2">SoftMax</mtext></ci><apply id="A7.E14.m1.1.1.cmml" xref="A7.E14.m1.2.3.3.3.2"><divide id="A7.E14.m1.1.1.2.cmml" xref="A7.E14.m1.2.3.3.3.2"></divide><apply id="A7.E14.m1.1.1.1.cmml" xref="A7.E14.m1.1.1.1"><times id="A7.E14.m1.1.1.1.2.cmml" xref="A7.E14.m1.1.1.1.2"></times><ci id="A7.E14.m1.1.1.1.3.cmml" xref="A7.E14.m1.1.1.1.3">𝑋</ci><apply id="A7.E14.m1.1.1.1.4.cmml" xref="A7.E14.m1.1.1.1.4"><csymbol cd="ambiguous" id="A7.E14.m1.1.1.1.4.1.cmml" xref="A7.E14.m1.1.1.1.4">subscript</csymbol><ci id="A7.E14.m1.1.1.1.4.2.cmml" xref="A7.E14.m1.1.1.1.4.2">𝑊</ci><ci id="A7.E14.m1.1.1.1.4.3.cmml" xref="A7.E14.m1.1.1.1.4.3">𝑞</ci></apply><apply id="A7.E14.m1.1.1.1.1.cmml" xref="A7.E14.m1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E14.m1.1.1.1.1.2.cmml" xref="A7.E14.m1.1.1.1.1">superscript</csymbol><apply id="A7.E14.m1.1.1.1.1.1.1.1.cmml" xref="A7.E14.m1.1.1.1.1.1.1"><times id="A7.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.1"></times><ci id="A7.E14.m1.1.1.1.1.1.1.1.2.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="A7.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E14.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E14.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="A7.E14.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E14.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="A7.E14.m1.1.1.1.1.3.cmml" xref="A7.E14.m1.1.1.1.1.3">top</csymbol></apply></apply><apply id="A7.E14.m1.1.1.3.cmml" xref="A7.E14.m1.1.1.3"><root id="A7.E14.m1.1.1.3a.cmml" xref="A7.E14.m1.1.1.3"></root><apply id="A7.E14.m1.1.1.3.2.cmml" xref="A7.E14.m1.1.1.3.2"><csymbol cd="ambiguous" id="A7.E14.m1.1.1.3.2.1.cmml" xref="A7.E14.m1.1.1.3.2">subscript</csymbol><ci id="A7.E14.m1.1.1.3.2.2.cmml" xref="A7.E14.m1.1.1.3.2.2">𝑑</ci><ci id="A7.E14.m1.1.1.3.2.3.cmml" xref="A7.E14.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply><ci id="A7.E14.m1.2.3.3.4.cmml" xref="A7.E14.m1.2.3.3.4">𝑋</ci><apply id="A7.E14.m1.2.3.3.5.cmml" xref="A7.E14.m1.2.3.3.5"><csymbol cd="ambiguous" id="A7.E14.m1.2.3.3.5.1.cmml" xref="A7.E14.m1.2.3.3.5">subscript</csymbol><ci id="A7.E14.m1.2.3.3.5.2.cmml" xref="A7.E14.m1.2.3.3.5.2">𝑊</ci><ci id="A7.E14.m1.2.3.3.5.3.cmml" xref="A7.E14.m1.2.3.3.5.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E14.m1.2c">\text{Attn}(X)=\text{SoftMax}\left(\frac{XW_{q}(XW_{k})^{\top}}{\sqrt{d_{k}}}%
\right)XW_{v}</annotation><annotation encoding="application/x-llamapun" id="A7.E14.m1.2d">Attn ( italic_X ) = SoftMax ( divide start_ARG italic_X italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_X italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_X italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p5.2">where <math alttext="X\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="A7.p5.1.m1.1"><semantics id="A7.p5.1.m1.1a"><mrow id="A7.p5.1.m1.1.1" xref="A7.p5.1.m1.1.1.cmml"><mi id="A7.p5.1.m1.1.1.2" xref="A7.p5.1.m1.1.1.2.cmml">X</mi><mo id="A7.p5.1.m1.1.1.1" xref="A7.p5.1.m1.1.1.1.cmml">∈</mo><msup id="A7.p5.1.m1.1.1.3" xref="A7.p5.1.m1.1.1.3.cmml"><mi id="A7.p5.1.m1.1.1.3.2" xref="A7.p5.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A7.p5.1.m1.1.1.3.3" xref="A7.p5.1.m1.1.1.3.3.cmml"><mi id="A7.p5.1.m1.1.1.3.3.2" xref="A7.p5.1.m1.1.1.3.3.2.cmml">n</mi><mo id="A7.p5.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A7.p5.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A7.p5.1.m1.1.1.3.3.3" xref="A7.p5.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A7.p5.1.m1.1b"><apply id="A7.p5.1.m1.1.1.cmml" xref="A7.p5.1.m1.1.1"><in id="A7.p5.1.m1.1.1.1.cmml" xref="A7.p5.1.m1.1.1.1"></in><ci id="A7.p5.1.m1.1.1.2.cmml" xref="A7.p5.1.m1.1.1.2">𝑋</ci><apply id="A7.p5.1.m1.1.1.3.cmml" xref="A7.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="A7.p5.1.m1.1.1.3.1.cmml" xref="A7.p5.1.m1.1.1.3">superscript</csymbol><ci id="A7.p5.1.m1.1.1.3.2.cmml" xref="A7.p5.1.m1.1.1.3.2">ℝ</ci><apply id="A7.p5.1.m1.1.1.3.3.cmml" xref="A7.p5.1.m1.1.1.3.3"><times id="A7.p5.1.m1.1.1.3.3.1.cmml" xref="A7.p5.1.m1.1.1.3.3.1"></times><ci id="A7.p5.1.m1.1.1.3.3.2.cmml" xref="A7.p5.1.m1.1.1.3.3.2">𝑛</ci><ci id="A7.p5.1.m1.1.1.3.3.3.cmml" xref="A7.p5.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p5.1.m1.1c">X\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="A7.p5.1.m1.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="W_{q},W_{k}\in\mathbb{R}^{d\times d_{k}},W_{v}\in\mathbb{R}^{d\times d_{v}}" class="ltx_Math" display="inline" id="A7.p5.2.m2.2"><semantics id="A7.p5.2.m2.2a"><mrow id="A7.p5.2.m2.2.2.2" xref="A7.p5.2.m2.2.2.3.cmml"><mrow id="A7.p5.2.m2.1.1.1.1" xref="A7.p5.2.m2.1.1.1.1.cmml"><mrow id="A7.p5.2.m2.1.1.1.1.2.2" xref="A7.p5.2.m2.1.1.1.1.2.3.cmml"><msub id="A7.p5.2.m2.1.1.1.1.1.1.1" xref="A7.p5.2.m2.1.1.1.1.1.1.1.cmml"><mi id="A7.p5.2.m2.1.1.1.1.1.1.1.2" xref="A7.p5.2.m2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="A7.p5.2.m2.1.1.1.1.1.1.1.3" xref="A7.p5.2.m2.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="A7.p5.2.m2.1.1.1.1.2.2.3" xref="A7.p5.2.m2.1.1.1.1.2.3.cmml">,</mo><msub id="A7.p5.2.m2.1.1.1.1.2.2.2" xref="A7.p5.2.m2.1.1.1.1.2.2.2.cmml"><mi id="A7.p5.2.m2.1.1.1.1.2.2.2.2" xref="A7.p5.2.m2.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="A7.p5.2.m2.1.1.1.1.2.2.2.3" xref="A7.p5.2.m2.1.1.1.1.2.2.2.3.cmml">k</mi></msub></mrow><mo id="A7.p5.2.m2.1.1.1.1.3" xref="A7.p5.2.m2.1.1.1.1.3.cmml">∈</mo><msup id="A7.p5.2.m2.1.1.1.1.4" xref="A7.p5.2.m2.1.1.1.1.4.cmml"><mi id="A7.p5.2.m2.1.1.1.1.4.2" xref="A7.p5.2.m2.1.1.1.1.4.2.cmml">ℝ</mi><mrow id="A7.p5.2.m2.1.1.1.1.4.3" xref="A7.p5.2.m2.1.1.1.1.4.3.cmml"><mi id="A7.p5.2.m2.1.1.1.1.4.3.2" xref="A7.p5.2.m2.1.1.1.1.4.3.2.cmml">d</mi><mo id="A7.p5.2.m2.1.1.1.1.4.3.1" lspace="0.222em" rspace="0.222em" xref="A7.p5.2.m2.1.1.1.1.4.3.1.cmml">×</mo><msub id="A7.p5.2.m2.1.1.1.1.4.3.3" xref="A7.p5.2.m2.1.1.1.1.4.3.3.cmml"><mi id="A7.p5.2.m2.1.1.1.1.4.3.3.2" xref="A7.p5.2.m2.1.1.1.1.4.3.3.2.cmml">d</mi><mi id="A7.p5.2.m2.1.1.1.1.4.3.3.3" xref="A7.p5.2.m2.1.1.1.1.4.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><mo id="A7.p5.2.m2.2.2.2.3" xref="A7.p5.2.m2.2.2.3a.cmml">,</mo><mrow id="A7.p5.2.m2.2.2.2.2" xref="A7.p5.2.m2.2.2.2.2.cmml"><msub id="A7.p5.2.m2.2.2.2.2.2" xref="A7.p5.2.m2.2.2.2.2.2.cmml"><mi id="A7.p5.2.m2.2.2.2.2.2.2" xref="A7.p5.2.m2.2.2.2.2.2.2.cmml">W</mi><mi id="A7.p5.2.m2.2.2.2.2.2.3" xref="A7.p5.2.m2.2.2.2.2.2.3.cmml">v</mi></msub><mo id="A7.p5.2.m2.2.2.2.2.1" xref="A7.p5.2.m2.2.2.2.2.1.cmml">∈</mo><msup id="A7.p5.2.m2.2.2.2.2.3" xref="A7.p5.2.m2.2.2.2.2.3.cmml"><mi id="A7.p5.2.m2.2.2.2.2.3.2" xref="A7.p5.2.m2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="A7.p5.2.m2.2.2.2.2.3.3" xref="A7.p5.2.m2.2.2.2.2.3.3.cmml"><mi id="A7.p5.2.m2.2.2.2.2.3.3.2" xref="A7.p5.2.m2.2.2.2.2.3.3.2.cmml">d</mi><mo id="A7.p5.2.m2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A7.p5.2.m2.2.2.2.2.3.3.1.cmml">×</mo><msub id="A7.p5.2.m2.2.2.2.2.3.3.3" xref="A7.p5.2.m2.2.2.2.2.3.3.3.cmml"><mi id="A7.p5.2.m2.2.2.2.2.3.3.3.2" xref="A7.p5.2.m2.2.2.2.2.3.3.3.2.cmml">d</mi><mi id="A7.p5.2.m2.2.2.2.2.3.3.3.3" xref="A7.p5.2.m2.2.2.2.2.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p5.2.m2.2b"><apply id="A7.p5.2.m2.2.2.3.cmml" xref="A7.p5.2.m2.2.2.2"><csymbol cd="ambiguous" id="A7.p5.2.m2.2.2.3a.cmml" xref="A7.p5.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="A7.p5.2.m2.1.1.1.1.cmml" xref="A7.p5.2.m2.1.1.1.1"><in id="A7.p5.2.m2.1.1.1.1.3.cmml" xref="A7.p5.2.m2.1.1.1.1.3"></in><list id="A7.p5.2.m2.1.1.1.1.2.3.cmml" xref="A7.p5.2.m2.1.1.1.1.2.2"><apply id="A7.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="A7.p5.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p5.2.m2.1.1.1.1.1.1.1.1.cmml" xref="A7.p5.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.p5.2.m2.1.1.1.1.1.1.1.2.cmml" xref="A7.p5.2.m2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="A7.p5.2.m2.1.1.1.1.1.1.1.3.cmml" xref="A7.p5.2.m2.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="A7.p5.2.m2.1.1.1.1.2.2.2.cmml" xref="A7.p5.2.m2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A7.p5.2.m2.1.1.1.1.2.2.2.1.cmml" xref="A7.p5.2.m2.1.1.1.1.2.2.2">subscript</csymbol><ci id="A7.p5.2.m2.1.1.1.1.2.2.2.2.cmml" xref="A7.p5.2.m2.1.1.1.1.2.2.2.2">𝑊</ci><ci id="A7.p5.2.m2.1.1.1.1.2.2.2.3.cmml" xref="A7.p5.2.m2.1.1.1.1.2.2.2.3">𝑘</ci></apply></list><apply id="A7.p5.2.m2.1.1.1.1.4.cmml" xref="A7.p5.2.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="A7.p5.2.m2.1.1.1.1.4.1.cmml" xref="A7.p5.2.m2.1.1.1.1.4">superscript</csymbol><ci id="A7.p5.2.m2.1.1.1.1.4.2.cmml" xref="A7.p5.2.m2.1.1.1.1.4.2">ℝ</ci><apply id="A7.p5.2.m2.1.1.1.1.4.3.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3"><times id="A7.p5.2.m2.1.1.1.1.4.3.1.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.1"></times><ci id="A7.p5.2.m2.1.1.1.1.4.3.2.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.2">𝑑</ci><apply id="A7.p5.2.m2.1.1.1.1.4.3.3.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="A7.p5.2.m2.1.1.1.1.4.3.3.1.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.3">subscript</csymbol><ci id="A7.p5.2.m2.1.1.1.1.4.3.3.2.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.3.2">𝑑</ci><ci id="A7.p5.2.m2.1.1.1.1.4.3.3.3.cmml" xref="A7.p5.2.m2.1.1.1.1.4.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="A7.p5.2.m2.2.2.2.2.cmml" xref="A7.p5.2.m2.2.2.2.2"><in id="A7.p5.2.m2.2.2.2.2.1.cmml" xref="A7.p5.2.m2.2.2.2.2.1"></in><apply id="A7.p5.2.m2.2.2.2.2.2.cmml" xref="A7.p5.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A7.p5.2.m2.2.2.2.2.2.1.cmml" xref="A7.p5.2.m2.2.2.2.2.2">subscript</csymbol><ci id="A7.p5.2.m2.2.2.2.2.2.2.cmml" xref="A7.p5.2.m2.2.2.2.2.2.2">𝑊</ci><ci id="A7.p5.2.m2.2.2.2.2.2.3.cmml" xref="A7.p5.2.m2.2.2.2.2.2.3">𝑣</ci></apply><apply id="A7.p5.2.m2.2.2.2.2.3.cmml" xref="A7.p5.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="A7.p5.2.m2.2.2.2.2.3.1.cmml" xref="A7.p5.2.m2.2.2.2.2.3">superscript</csymbol><ci id="A7.p5.2.m2.2.2.2.2.3.2.cmml" xref="A7.p5.2.m2.2.2.2.2.3.2">ℝ</ci><apply id="A7.p5.2.m2.2.2.2.2.3.3.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3"><times id="A7.p5.2.m2.2.2.2.2.3.3.1.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.1"></times><ci id="A7.p5.2.m2.2.2.2.2.3.3.2.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.2">𝑑</ci><apply id="A7.p5.2.m2.2.2.2.2.3.3.3.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="A7.p5.2.m2.2.2.2.2.3.3.3.1.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.3">subscript</csymbol><ci id="A7.p5.2.m2.2.2.2.2.3.3.3.2.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.3.2">𝑑</ci><ci id="A7.p5.2.m2.2.2.2.2.3.3.3.3.cmml" xref="A7.p5.2.m2.2.2.2.2.3.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p5.2.m2.2c">W_{q},W_{k}\in\mathbb{R}^{d\times d_{k}},W_{v}\in\mathbb{R}^{d\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="A7.p5.2.m2.2d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
<div class="ltx_para" id="A7.p6">
<p class="ltx_p" id="A7.p6.1">For small perturbations <math alttext="\Delta W_{q},\Delta W_{k},\Delta W_{v}" class="ltx_Math" display="inline" id="A7.p6.1.m1.3"><semantics id="A7.p6.1.m1.3a"><mrow id="A7.p6.1.m1.3.3.3" xref="A7.p6.1.m1.3.3.4.cmml"><mrow id="A7.p6.1.m1.1.1.1.1" xref="A7.p6.1.m1.1.1.1.1.cmml"><mi id="A7.p6.1.m1.1.1.1.1.2" mathvariant="normal" xref="A7.p6.1.m1.1.1.1.1.2.cmml">Δ</mi><mo id="A7.p6.1.m1.1.1.1.1.1" xref="A7.p6.1.m1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p6.1.m1.1.1.1.1.3" xref="A7.p6.1.m1.1.1.1.1.3.cmml"><mi id="A7.p6.1.m1.1.1.1.1.3.2" xref="A7.p6.1.m1.1.1.1.1.3.2.cmml">W</mi><mi id="A7.p6.1.m1.1.1.1.1.3.3" xref="A7.p6.1.m1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A7.p6.1.m1.3.3.3.4" xref="A7.p6.1.m1.3.3.4.cmml">,</mo><mrow id="A7.p6.1.m1.2.2.2.2" xref="A7.p6.1.m1.2.2.2.2.cmml"><mi id="A7.p6.1.m1.2.2.2.2.2" mathvariant="normal" xref="A7.p6.1.m1.2.2.2.2.2.cmml">Δ</mi><mo id="A7.p6.1.m1.2.2.2.2.1" xref="A7.p6.1.m1.2.2.2.2.1.cmml">⁢</mo><msub id="A7.p6.1.m1.2.2.2.2.3" xref="A7.p6.1.m1.2.2.2.2.3.cmml"><mi id="A7.p6.1.m1.2.2.2.2.3.2" xref="A7.p6.1.m1.2.2.2.2.3.2.cmml">W</mi><mi id="A7.p6.1.m1.2.2.2.2.3.3" xref="A7.p6.1.m1.2.2.2.2.3.3.cmml">k</mi></msub></mrow><mo id="A7.p6.1.m1.3.3.3.5" xref="A7.p6.1.m1.3.3.4.cmml">,</mo><mrow id="A7.p6.1.m1.3.3.3.3" xref="A7.p6.1.m1.3.3.3.3.cmml"><mi id="A7.p6.1.m1.3.3.3.3.2" mathvariant="normal" xref="A7.p6.1.m1.3.3.3.3.2.cmml">Δ</mi><mo id="A7.p6.1.m1.3.3.3.3.1" xref="A7.p6.1.m1.3.3.3.3.1.cmml">⁢</mo><msub id="A7.p6.1.m1.3.3.3.3.3" xref="A7.p6.1.m1.3.3.3.3.3.cmml"><mi id="A7.p6.1.m1.3.3.3.3.3.2" xref="A7.p6.1.m1.3.3.3.3.3.2.cmml">W</mi><mi id="A7.p6.1.m1.3.3.3.3.3.3" xref="A7.p6.1.m1.3.3.3.3.3.3.cmml">v</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p6.1.m1.3b"><list id="A7.p6.1.m1.3.3.4.cmml" xref="A7.p6.1.m1.3.3.3"><apply id="A7.p6.1.m1.1.1.1.1.cmml" xref="A7.p6.1.m1.1.1.1.1"><times id="A7.p6.1.m1.1.1.1.1.1.cmml" xref="A7.p6.1.m1.1.1.1.1.1"></times><ci id="A7.p6.1.m1.1.1.1.1.2.cmml" xref="A7.p6.1.m1.1.1.1.1.2">Δ</ci><apply id="A7.p6.1.m1.1.1.1.1.3.cmml" xref="A7.p6.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p6.1.m1.1.1.1.1.3.1.cmml" xref="A7.p6.1.m1.1.1.1.1.3">subscript</csymbol><ci id="A7.p6.1.m1.1.1.1.1.3.2.cmml" xref="A7.p6.1.m1.1.1.1.1.3.2">𝑊</ci><ci id="A7.p6.1.m1.1.1.1.1.3.3.cmml" xref="A7.p6.1.m1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="A7.p6.1.m1.2.2.2.2.cmml" xref="A7.p6.1.m1.2.2.2.2"><times id="A7.p6.1.m1.2.2.2.2.1.cmml" xref="A7.p6.1.m1.2.2.2.2.1"></times><ci id="A7.p6.1.m1.2.2.2.2.2.cmml" xref="A7.p6.1.m1.2.2.2.2.2">Δ</ci><apply id="A7.p6.1.m1.2.2.2.2.3.cmml" xref="A7.p6.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="A7.p6.1.m1.2.2.2.2.3.1.cmml" xref="A7.p6.1.m1.2.2.2.2.3">subscript</csymbol><ci id="A7.p6.1.m1.2.2.2.2.3.2.cmml" xref="A7.p6.1.m1.2.2.2.2.3.2">𝑊</ci><ci id="A7.p6.1.m1.2.2.2.2.3.3.cmml" xref="A7.p6.1.m1.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="A7.p6.1.m1.3.3.3.3.cmml" xref="A7.p6.1.m1.3.3.3.3"><times id="A7.p6.1.m1.3.3.3.3.1.cmml" xref="A7.p6.1.m1.3.3.3.3.1"></times><ci id="A7.p6.1.m1.3.3.3.3.2.cmml" xref="A7.p6.1.m1.3.3.3.3.2">Δ</ci><apply id="A7.p6.1.m1.3.3.3.3.3.cmml" xref="A7.p6.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A7.p6.1.m1.3.3.3.3.3.1.cmml" xref="A7.p6.1.m1.3.3.3.3.3">subscript</csymbol><ci id="A7.p6.1.m1.3.3.3.3.3.2.cmml" xref="A7.p6.1.m1.3.3.3.3.3.2">𝑊</ci><ci id="A7.p6.1.m1.3.3.3.3.3.3.cmml" xref="A7.p6.1.m1.3.3.3.3.3.3">𝑣</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A7.p6.1.m1.3c">\Delta W_{q},\Delta W_{k},\Delta W_{v}</annotation><annotation encoding="application/x-llamapun" id="A7.p6.1.m1.3d">roman_Δ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , roman_Δ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , roman_Δ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, the perturbed Attention output is:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Attn}_{\Delta}(X)=\text{SoftMax}\left(\frac{X(W_{q}+\Delta W_{q})(X(W_{k%
}+\Delta W_{k}))^{\top}}{\sqrt{d_{k}}}\right)X(W_{v}+\Delta W_{v})" class="ltx_Math" display="block" id="A7.E15.m1.4"><semantics id="A7.E15.m1.4a"><mrow id="A7.E15.m1.4.4" xref="A7.E15.m1.4.4.cmml"><mrow id="A7.E15.m1.4.4.3" xref="A7.E15.m1.4.4.3.cmml"><msub id="A7.E15.m1.4.4.3.2" xref="A7.E15.m1.4.4.3.2.cmml"><mtext id="A7.E15.m1.4.4.3.2.2" xref="A7.E15.m1.4.4.3.2.2a.cmml">Attn</mtext><mi id="A7.E15.m1.4.4.3.2.3" mathvariant="normal" xref="A7.E15.m1.4.4.3.2.3.cmml">Δ</mi></msub><mo id="A7.E15.m1.4.4.3.1" xref="A7.E15.m1.4.4.3.1.cmml">⁢</mo><mrow id="A7.E15.m1.4.4.3.3.2" xref="A7.E15.m1.4.4.3.cmml"><mo id="A7.E15.m1.4.4.3.3.2.1" stretchy="false" xref="A7.E15.m1.4.4.3.cmml">(</mo><mi id="A7.E15.m1.3.3" xref="A7.E15.m1.3.3.cmml">X</mi><mo id="A7.E15.m1.4.4.3.3.2.2" stretchy="false" xref="A7.E15.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="A7.E15.m1.4.4.2" xref="A7.E15.m1.4.4.2.cmml">=</mo><mrow id="A7.E15.m1.4.4.1" xref="A7.E15.m1.4.4.1.cmml"><mtext id="A7.E15.m1.4.4.1.3" xref="A7.E15.m1.4.4.1.3a.cmml">SoftMax</mtext><mo id="A7.E15.m1.4.4.1.2" xref="A7.E15.m1.4.4.1.2.cmml">⁢</mo><mrow id="A7.E15.m1.4.4.1.4.2" xref="A7.E15.m1.2.2.cmml"><mo id="A7.E15.m1.4.4.1.4.2.1" xref="A7.E15.m1.2.2.cmml">(</mo><mfrac id="A7.E15.m1.2.2" xref="A7.E15.m1.2.2.cmml"><mrow id="A7.E15.m1.2.2.2" xref="A7.E15.m1.2.2.2.cmml"><mi id="A7.E15.m1.2.2.2.4" xref="A7.E15.m1.2.2.2.4.cmml">X</mi><mo id="A7.E15.m1.2.2.2.3" xref="A7.E15.m1.2.2.2.3.cmml">⁢</mo><mrow id="A7.E15.m1.1.1.1.1.1" xref="A7.E15.m1.1.1.1.1.1.1.cmml"><mo id="A7.E15.m1.1.1.1.1.1.2" stretchy="false" xref="A7.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E15.m1.1.1.1.1.1.1" xref="A7.E15.m1.1.1.1.1.1.1.cmml"><msub id="A7.E15.m1.1.1.1.1.1.1.2" xref="A7.E15.m1.1.1.1.1.1.1.2.cmml"><mi id="A7.E15.m1.1.1.1.1.1.1.2.2" xref="A7.E15.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="A7.E15.m1.1.1.1.1.1.1.2.3" xref="A7.E15.m1.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo id="A7.E15.m1.1.1.1.1.1.1.1" xref="A7.E15.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A7.E15.m1.1.1.1.1.1.1.3" xref="A7.E15.m1.1.1.1.1.1.1.3.cmml"><mi id="A7.E15.m1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A7.E15.m1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="A7.E15.m1.1.1.1.1.1.1.3.1" xref="A7.E15.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A7.E15.m1.1.1.1.1.1.1.3.3" xref="A7.E15.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E15.m1.1.1.1.1.1.1.3.3.2" xref="A7.E15.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="A7.E15.m1.1.1.1.1.1.1.3.3.3" xref="A7.E15.m1.1.1.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="A7.E15.m1.1.1.1.1.1.3" stretchy="false" xref="A7.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.E15.m1.2.2.2.3a" xref="A7.E15.m1.2.2.2.3.cmml">⁢</mo><msup id="A7.E15.m1.2.2.2.2" xref="A7.E15.m1.2.2.2.2.cmml"><mrow id="A7.E15.m1.2.2.2.2.1.1" xref="A7.E15.m1.2.2.2.2.1.1.1.cmml"><mo id="A7.E15.m1.2.2.2.2.1.1.2" stretchy="false" xref="A7.E15.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A7.E15.m1.2.2.2.2.1.1.1" xref="A7.E15.m1.2.2.2.2.1.1.1.cmml"><mi id="A7.E15.m1.2.2.2.2.1.1.1.3" xref="A7.E15.m1.2.2.2.2.1.1.1.3.cmml">X</mi><mo id="A7.E15.m1.2.2.2.2.1.1.1.2" xref="A7.E15.m1.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A7.E15.m1.2.2.2.2.1.1.1.1.1" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="A7.E15.m1.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.1" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.1" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.2" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.3" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="A7.E15.m1.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E15.m1.2.2.2.2.1.1.3" stretchy="false" xref="A7.E15.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A7.E15.m1.2.2.2.2.3" xref="A7.E15.m1.2.2.2.2.3.cmml">⊤</mo></msup></mrow><msqrt id="A7.E15.m1.2.2.4" xref="A7.E15.m1.2.2.4.cmml"><msub id="A7.E15.m1.2.2.4.2" xref="A7.E15.m1.2.2.4.2.cmml"><mi id="A7.E15.m1.2.2.4.2.2" xref="A7.E15.m1.2.2.4.2.2.cmml">d</mi><mi id="A7.E15.m1.2.2.4.2.3" xref="A7.E15.m1.2.2.4.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="A7.E15.m1.4.4.1.4.2.2" xref="A7.E15.m1.2.2.cmml">)</mo></mrow><mo id="A7.E15.m1.4.4.1.2a" xref="A7.E15.m1.4.4.1.2.cmml">⁢</mo><mi id="A7.E15.m1.4.4.1.5" xref="A7.E15.m1.4.4.1.5.cmml">X</mi><mo id="A7.E15.m1.4.4.1.2b" xref="A7.E15.m1.4.4.1.2.cmml">⁢</mo><mrow id="A7.E15.m1.4.4.1.1.1" xref="A7.E15.m1.4.4.1.1.1.1.cmml"><mo id="A7.E15.m1.4.4.1.1.1.2" stretchy="false" xref="A7.E15.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A7.E15.m1.4.4.1.1.1.1" xref="A7.E15.m1.4.4.1.1.1.1.cmml"><msub id="A7.E15.m1.4.4.1.1.1.1.2" xref="A7.E15.m1.4.4.1.1.1.1.2.cmml"><mi id="A7.E15.m1.4.4.1.1.1.1.2.2" xref="A7.E15.m1.4.4.1.1.1.1.2.2.cmml">W</mi><mi id="A7.E15.m1.4.4.1.1.1.1.2.3" xref="A7.E15.m1.4.4.1.1.1.1.2.3.cmml">v</mi></msub><mo id="A7.E15.m1.4.4.1.1.1.1.1" xref="A7.E15.m1.4.4.1.1.1.1.1.cmml">+</mo><mrow id="A7.E15.m1.4.4.1.1.1.1.3" xref="A7.E15.m1.4.4.1.1.1.1.3.cmml"><mi id="A7.E15.m1.4.4.1.1.1.1.3.2" mathvariant="normal" xref="A7.E15.m1.4.4.1.1.1.1.3.2.cmml">Δ</mi><mo id="A7.E15.m1.4.4.1.1.1.1.3.1" xref="A7.E15.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><msub id="A7.E15.m1.4.4.1.1.1.1.3.3" xref="A7.E15.m1.4.4.1.1.1.1.3.3.cmml"><mi id="A7.E15.m1.4.4.1.1.1.1.3.3.2" xref="A7.E15.m1.4.4.1.1.1.1.3.3.2.cmml">W</mi><mi id="A7.E15.m1.4.4.1.1.1.1.3.3.3" xref="A7.E15.m1.4.4.1.1.1.1.3.3.3.cmml">v</mi></msub></mrow></mrow><mo id="A7.E15.m1.4.4.1.1.1.3" stretchy="false" xref="A7.E15.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E15.m1.4b"><apply id="A7.E15.m1.4.4.cmml" xref="A7.E15.m1.4.4"><eq id="A7.E15.m1.4.4.2.cmml" xref="A7.E15.m1.4.4.2"></eq><apply id="A7.E15.m1.4.4.3.cmml" xref="A7.E15.m1.4.4.3"><times id="A7.E15.m1.4.4.3.1.cmml" xref="A7.E15.m1.4.4.3.1"></times><apply id="A7.E15.m1.4.4.3.2.cmml" xref="A7.E15.m1.4.4.3.2"><csymbol cd="ambiguous" id="A7.E15.m1.4.4.3.2.1.cmml" xref="A7.E15.m1.4.4.3.2">subscript</csymbol><ci id="A7.E15.m1.4.4.3.2.2a.cmml" xref="A7.E15.m1.4.4.3.2.2"><mtext id="A7.E15.m1.4.4.3.2.2.cmml" xref="A7.E15.m1.4.4.3.2.2">Attn</mtext></ci><ci id="A7.E15.m1.4.4.3.2.3.cmml" xref="A7.E15.m1.4.4.3.2.3">Δ</ci></apply><ci id="A7.E15.m1.3.3.cmml" xref="A7.E15.m1.3.3">𝑋</ci></apply><apply id="A7.E15.m1.4.4.1.cmml" xref="A7.E15.m1.4.4.1"><times id="A7.E15.m1.4.4.1.2.cmml" xref="A7.E15.m1.4.4.1.2"></times><ci id="A7.E15.m1.4.4.1.3a.cmml" xref="A7.E15.m1.4.4.1.3"><mtext id="A7.E15.m1.4.4.1.3.cmml" xref="A7.E15.m1.4.4.1.3">SoftMax</mtext></ci><apply id="A7.E15.m1.2.2.cmml" xref="A7.E15.m1.4.4.1.4.2"><divide id="A7.E15.m1.2.2.3.cmml" xref="A7.E15.m1.4.4.1.4.2"></divide><apply id="A7.E15.m1.2.2.2.cmml" xref="A7.E15.m1.2.2.2"><times id="A7.E15.m1.2.2.2.3.cmml" xref="A7.E15.m1.2.2.2.3"></times><ci id="A7.E15.m1.2.2.2.4.cmml" xref="A7.E15.m1.2.2.2.4">𝑋</ci><apply id="A7.E15.m1.1.1.1.1.1.1.cmml" xref="A7.E15.m1.1.1.1.1.1"><plus id="A7.E15.m1.1.1.1.1.1.1.1.cmml" xref="A7.E15.m1.1.1.1.1.1.1.1"></plus><apply id="A7.E15.m1.1.1.1.1.1.1.2.cmml" xref="A7.E15.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E15.m1.1.1.1.1.1.1.2.1.cmml" xref="A7.E15.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E15.m1.1.1.1.1.1.1.2.2.cmml" xref="A7.E15.m1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="A7.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="A7.E15.m1.1.1.1.1.1.1.2.3">𝑞</ci></apply><apply id="A7.E15.m1.1.1.1.1.1.1.3.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3"><times id="A7.E15.m1.1.1.1.1.1.1.3.1.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.1"></times><ci id="A7.E15.m1.1.1.1.1.1.1.3.2.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.2">Δ</ci><apply id="A7.E15.m1.1.1.1.1.1.1.3.3.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E15.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E15.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="A7.E15.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A7.E15.m1.1.1.1.1.1.1.3.3.3">𝑞</ci></apply></apply></apply><apply id="A7.E15.m1.2.2.2.2.cmml" xref="A7.E15.m1.2.2.2.2"><csymbol cd="ambiguous" id="A7.E15.m1.2.2.2.2.2.cmml" xref="A7.E15.m1.2.2.2.2">superscript</csymbol><apply id="A7.E15.m1.2.2.2.2.1.1.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1"><times id="A7.E15.m1.2.2.2.2.1.1.1.2.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.2"></times><ci id="A7.E15.m1.2.2.2.2.1.1.1.3.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.3">𝑋</ci><apply id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1"><plus id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.1"></plus><apply id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝑊</ci><ci id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3"><times id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.1"></times><ci id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.2">Δ</ci><apply id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="A7.E15.m1.2.2.2.2.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply><csymbol cd="latexml" id="A7.E15.m1.2.2.2.2.3.cmml" xref="A7.E15.m1.2.2.2.2.3">top</csymbol></apply></apply><apply id="A7.E15.m1.2.2.4.cmml" xref="A7.E15.m1.2.2.4"><root id="A7.E15.m1.2.2.4a.cmml" xref="A7.E15.m1.2.2.4"></root><apply id="A7.E15.m1.2.2.4.2.cmml" xref="A7.E15.m1.2.2.4.2"><csymbol cd="ambiguous" id="A7.E15.m1.2.2.4.2.1.cmml" xref="A7.E15.m1.2.2.4.2">subscript</csymbol><ci id="A7.E15.m1.2.2.4.2.2.cmml" xref="A7.E15.m1.2.2.4.2.2">𝑑</ci><ci id="A7.E15.m1.2.2.4.2.3.cmml" xref="A7.E15.m1.2.2.4.2.3">𝑘</ci></apply></apply></apply><ci id="A7.E15.m1.4.4.1.5.cmml" xref="A7.E15.m1.4.4.1.5">𝑋</ci><apply id="A7.E15.m1.4.4.1.1.1.1.cmml" xref="A7.E15.m1.4.4.1.1.1"><plus id="A7.E15.m1.4.4.1.1.1.1.1.cmml" xref="A7.E15.m1.4.4.1.1.1.1.1"></plus><apply id="A7.E15.m1.4.4.1.1.1.1.2.cmml" xref="A7.E15.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E15.m1.4.4.1.1.1.1.2.1.cmml" xref="A7.E15.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="A7.E15.m1.4.4.1.1.1.1.2.2.cmml" xref="A7.E15.m1.4.4.1.1.1.1.2.2">𝑊</ci><ci id="A7.E15.m1.4.4.1.1.1.1.2.3.cmml" xref="A7.E15.m1.4.4.1.1.1.1.2.3">𝑣</ci></apply><apply id="A7.E15.m1.4.4.1.1.1.1.3.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3"><times id="A7.E15.m1.4.4.1.1.1.1.3.1.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.1"></times><ci id="A7.E15.m1.4.4.1.1.1.1.3.2.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.2">Δ</ci><apply id="A7.E15.m1.4.4.1.1.1.1.3.3.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E15.m1.4.4.1.1.1.1.3.3.1.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E15.m1.4.4.1.1.1.1.3.3.2.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.3.2">𝑊</ci><ci id="A7.E15.m1.4.4.1.1.1.1.3.3.3.cmml" xref="A7.E15.m1.4.4.1.1.1.1.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E15.m1.4c">\text{Attn}_{\Delta}(X)=\text{SoftMax}\left(\frac{X(W_{q}+\Delta W_{q})(X(W_{k%
}+\Delta W_{k}))^{\top}}{\sqrt{d_{k}}}\right)X(W_{v}+\Delta W_{v})</annotation><annotation encoding="application/x-llamapun" id="A7.E15.m1.4d">Attn start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ( italic_X ) = SoftMax ( divide start_ARG italic_X ( italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT + roman_Δ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) ( italic_X ( italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + roman_Δ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_X ( italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + roman_Δ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p6.2">Using the first-order Taylor expansion, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta\text{Attn}(X)\approx\frac{\partial\text{Attn}(X)}{\partial W_{q}}\Delta
W%
_{q}+\frac{\partial\text{Attn}(X)}{\partial W_{k}}\Delta W_{k}+\frac{\partial%
\text{Attn}(X)}{\partial W_{v}}\Delta W_{v}" class="ltx_Math" display="block" id="A7.E16.m1.4"><semantics id="A7.E16.m1.4a"><mrow id="A7.E16.m1.4.5" xref="A7.E16.m1.4.5.cmml"><mrow id="A7.E16.m1.4.5.2" xref="A7.E16.m1.4.5.2.cmml"><mi id="A7.E16.m1.4.5.2.2" mathvariant="normal" xref="A7.E16.m1.4.5.2.2.cmml">Δ</mi><mo id="A7.E16.m1.4.5.2.1" xref="A7.E16.m1.4.5.2.1.cmml">⁢</mo><mtext id="A7.E16.m1.4.5.2.3" xref="A7.E16.m1.4.5.2.3a.cmml">Attn</mtext><mo id="A7.E16.m1.4.5.2.1a" xref="A7.E16.m1.4.5.2.1.cmml">⁢</mo><mrow id="A7.E16.m1.4.5.2.4.2" xref="A7.E16.m1.4.5.2.cmml"><mo id="A7.E16.m1.4.5.2.4.2.1" stretchy="false" xref="A7.E16.m1.4.5.2.cmml">(</mo><mi id="A7.E16.m1.4.4" xref="A7.E16.m1.4.4.cmml">X</mi><mo id="A7.E16.m1.4.5.2.4.2.2" stretchy="false" xref="A7.E16.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="A7.E16.m1.4.5.1" xref="A7.E16.m1.4.5.1.cmml">≈</mo><mrow id="A7.E16.m1.4.5.3" xref="A7.E16.m1.4.5.3.cmml"><mrow id="A7.E16.m1.4.5.3.2" xref="A7.E16.m1.4.5.3.2.cmml"><mfrac id="A7.E16.m1.1.1" xref="A7.E16.m1.1.1.cmml"><mrow id="A7.E16.m1.1.1.1" xref="A7.E16.m1.1.1.1.cmml"><mo id="A7.E16.m1.1.1.1.2" rspace="0em" xref="A7.E16.m1.1.1.1.2.cmml">∂</mo><mrow id="A7.E16.m1.1.1.1.3" xref="A7.E16.m1.1.1.1.3.cmml"><mtext id="A7.E16.m1.1.1.1.3.2" xref="A7.E16.m1.1.1.1.3.2a.cmml">Attn</mtext><mo id="A7.E16.m1.1.1.1.3.1" xref="A7.E16.m1.1.1.1.3.1.cmml">⁢</mo><mrow id="A7.E16.m1.1.1.1.3.3.2" xref="A7.E16.m1.1.1.1.3.cmml"><mo id="A7.E16.m1.1.1.1.3.3.2.1" stretchy="false" xref="A7.E16.m1.1.1.1.3.cmml">(</mo><mi id="A7.E16.m1.1.1.1.1" xref="A7.E16.m1.1.1.1.1.cmml">X</mi><mo id="A7.E16.m1.1.1.1.3.3.2.2" stretchy="false" xref="A7.E16.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A7.E16.m1.1.1.3" xref="A7.E16.m1.1.1.3.cmml"><mo id="A7.E16.m1.1.1.3.1" rspace="0em" xref="A7.E16.m1.1.1.3.1.cmml">∂</mo><msub id="A7.E16.m1.1.1.3.2" xref="A7.E16.m1.1.1.3.2.cmml"><mi id="A7.E16.m1.1.1.3.2.2" xref="A7.E16.m1.1.1.3.2.2.cmml">W</mi><mi id="A7.E16.m1.1.1.3.2.3" xref="A7.E16.m1.1.1.3.2.3.cmml">q</mi></msub></mrow></mfrac><mo id="A7.E16.m1.4.5.3.2.1" xref="A7.E16.m1.4.5.3.2.1.cmml">⁢</mo><mi id="A7.E16.m1.4.5.3.2.2" mathvariant="normal" xref="A7.E16.m1.4.5.3.2.2.cmml">Δ</mi><mo id="A7.E16.m1.4.5.3.2.1a" xref="A7.E16.m1.4.5.3.2.1.cmml">⁢</mo><msub id="A7.E16.m1.4.5.3.2.3" xref="A7.E16.m1.4.5.3.2.3.cmml"><mi id="A7.E16.m1.4.5.3.2.3.2" xref="A7.E16.m1.4.5.3.2.3.2.cmml">W</mi><mi id="A7.E16.m1.4.5.3.2.3.3" xref="A7.E16.m1.4.5.3.2.3.3.cmml">q</mi></msub></mrow><mo id="A7.E16.m1.4.5.3.1" xref="A7.E16.m1.4.5.3.1.cmml">+</mo><mrow id="A7.E16.m1.4.5.3.3" xref="A7.E16.m1.4.5.3.3.cmml"><mfrac id="A7.E16.m1.2.2" xref="A7.E16.m1.2.2.cmml"><mrow id="A7.E16.m1.2.2.1" xref="A7.E16.m1.2.2.1.cmml"><mo id="A7.E16.m1.2.2.1.2" rspace="0em" xref="A7.E16.m1.2.2.1.2.cmml">∂</mo><mrow id="A7.E16.m1.2.2.1.3" xref="A7.E16.m1.2.2.1.3.cmml"><mtext id="A7.E16.m1.2.2.1.3.2" xref="A7.E16.m1.2.2.1.3.2a.cmml">Attn</mtext><mo id="A7.E16.m1.2.2.1.3.1" xref="A7.E16.m1.2.2.1.3.1.cmml">⁢</mo><mrow id="A7.E16.m1.2.2.1.3.3.2" xref="A7.E16.m1.2.2.1.3.cmml"><mo id="A7.E16.m1.2.2.1.3.3.2.1" stretchy="false" xref="A7.E16.m1.2.2.1.3.cmml">(</mo><mi id="A7.E16.m1.2.2.1.1" xref="A7.E16.m1.2.2.1.1.cmml">X</mi><mo id="A7.E16.m1.2.2.1.3.3.2.2" stretchy="false" xref="A7.E16.m1.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A7.E16.m1.2.2.3" xref="A7.E16.m1.2.2.3.cmml"><mo id="A7.E16.m1.2.2.3.1" rspace="0em" xref="A7.E16.m1.2.2.3.1.cmml">∂</mo><msub id="A7.E16.m1.2.2.3.2" xref="A7.E16.m1.2.2.3.2.cmml"><mi id="A7.E16.m1.2.2.3.2.2" xref="A7.E16.m1.2.2.3.2.2.cmml">W</mi><mi id="A7.E16.m1.2.2.3.2.3" xref="A7.E16.m1.2.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo id="A7.E16.m1.4.5.3.3.1" xref="A7.E16.m1.4.5.3.3.1.cmml">⁢</mo><mi id="A7.E16.m1.4.5.3.3.2" mathvariant="normal" xref="A7.E16.m1.4.5.3.3.2.cmml">Δ</mi><mo id="A7.E16.m1.4.5.3.3.1a" xref="A7.E16.m1.4.5.3.3.1.cmml">⁢</mo><msub id="A7.E16.m1.4.5.3.3.3" xref="A7.E16.m1.4.5.3.3.3.cmml"><mi id="A7.E16.m1.4.5.3.3.3.2" xref="A7.E16.m1.4.5.3.3.3.2.cmml">W</mi><mi id="A7.E16.m1.4.5.3.3.3.3" xref="A7.E16.m1.4.5.3.3.3.3.cmml">k</mi></msub></mrow><mo id="A7.E16.m1.4.5.3.1a" xref="A7.E16.m1.4.5.3.1.cmml">+</mo><mrow id="A7.E16.m1.4.5.3.4" xref="A7.E16.m1.4.5.3.4.cmml"><mfrac id="A7.E16.m1.3.3" xref="A7.E16.m1.3.3.cmml"><mrow id="A7.E16.m1.3.3.1" xref="A7.E16.m1.3.3.1.cmml"><mo id="A7.E16.m1.3.3.1.2" rspace="0em" xref="A7.E16.m1.3.3.1.2.cmml">∂</mo><mrow id="A7.E16.m1.3.3.1.3" xref="A7.E16.m1.3.3.1.3.cmml"><mtext id="A7.E16.m1.3.3.1.3.2" xref="A7.E16.m1.3.3.1.3.2a.cmml">Attn</mtext><mo id="A7.E16.m1.3.3.1.3.1" xref="A7.E16.m1.3.3.1.3.1.cmml">⁢</mo><mrow id="A7.E16.m1.3.3.1.3.3.2" xref="A7.E16.m1.3.3.1.3.cmml"><mo id="A7.E16.m1.3.3.1.3.3.2.1" stretchy="false" xref="A7.E16.m1.3.3.1.3.cmml">(</mo><mi id="A7.E16.m1.3.3.1.1" xref="A7.E16.m1.3.3.1.1.cmml">X</mi><mo id="A7.E16.m1.3.3.1.3.3.2.2" stretchy="false" xref="A7.E16.m1.3.3.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A7.E16.m1.3.3.3" xref="A7.E16.m1.3.3.3.cmml"><mo id="A7.E16.m1.3.3.3.1" rspace="0em" xref="A7.E16.m1.3.3.3.1.cmml">∂</mo><msub id="A7.E16.m1.3.3.3.2" xref="A7.E16.m1.3.3.3.2.cmml"><mi id="A7.E16.m1.3.3.3.2.2" xref="A7.E16.m1.3.3.3.2.2.cmml">W</mi><mi id="A7.E16.m1.3.3.3.2.3" xref="A7.E16.m1.3.3.3.2.3.cmml">v</mi></msub></mrow></mfrac><mo id="A7.E16.m1.4.5.3.4.1" xref="A7.E16.m1.4.5.3.4.1.cmml">⁢</mo><mi id="A7.E16.m1.4.5.3.4.2" mathvariant="normal" xref="A7.E16.m1.4.5.3.4.2.cmml">Δ</mi><mo id="A7.E16.m1.4.5.3.4.1a" xref="A7.E16.m1.4.5.3.4.1.cmml">⁢</mo><msub id="A7.E16.m1.4.5.3.4.3" xref="A7.E16.m1.4.5.3.4.3.cmml"><mi id="A7.E16.m1.4.5.3.4.3.2" xref="A7.E16.m1.4.5.3.4.3.2.cmml">W</mi><mi id="A7.E16.m1.4.5.3.4.3.3" xref="A7.E16.m1.4.5.3.4.3.3.cmml">v</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E16.m1.4b"><apply id="A7.E16.m1.4.5.cmml" xref="A7.E16.m1.4.5"><approx id="A7.E16.m1.4.5.1.cmml" xref="A7.E16.m1.4.5.1"></approx><apply id="A7.E16.m1.4.5.2.cmml" xref="A7.E16.m1.4.5.2"><times id="A7.E16.m1.4.5.2.1.cmml" xref="A7.E16.m1.4.5.2.1"></times><ci id="A7.E16.m1.4.5.2.2.cmml" xref="A7.E16.m1.4.5.2.2">Δ</ci><ci id="A7.E16.m1.4.5.2.3a.cmml" xref="A7.E16.m1.4.5.2.3"><mtext id="A7.E16.m1.4.5.2.3.cmml" xref="A7.E16.m1.4.5.2.3">Attn</mtext></ci><ci id="A7.E16.m1.4.4.cmml" xref="A7.E16.m1.4.4">𝑋</ci></apply><apply id="A7.E16.m1.4.5.3.cmml" xref="A7.E16.m1.4.5.3"><plus id="A7.E16.m1.4.5.3.1.cmml" xref="A7.E16.m1.4.5.3.1"></plus><apply id="A7.E16.m1.4.5.3.2.cmml" xref="A7.E16.m1.4.5.3.2"><times id="A7.E16.m1.4.5.3.2.1.cmml" xref="A7.E16.m1.4.5.3.2.1"></times><apply id="A7.E16.m1.1.1.cmml" xref="A7.E16.m1.1.1"><divide id="A7.E16.m1.1.1.2.cmml" xref="A7.E16.m1.1.1"></divide><apply id="A7.E16.m1.1.1.1.cmml" xref="A7.E16.m1.1.1.1"><partialdiff id="A7.E16.m1.1.1.1.2.cmml" xref="A7.E16.m1.1.1.1.2"></partialdiff><apply id="A7.E16.m1.1.1.1.3.cmml" xref="A7.E16.m1.1.1.1.3"><times id="A7.E16.m1.1.1.1.3.1.cmml" xref="A7.E16.m1.1.1.1.3.1"></times><ci id="A7.E16.m1.1.1.1.3.2a.cmml" xref="A7.E16.m1.1.1.1.3.2"><mtext id="A7.E16.m1.1.1.1.3.2.cmml" xref="A7.E16.m1.1.1.1.3.2">Attn</mtext></ci><ci id="A7.E16.m1.1.1.1.1.cmml" xref="A7.E16.m1.1.1.1.1">𝑋</ci></apply></apply><apply id="A7.E16.m1.1.1.3.cmml" xref="A7.E16.m1.1.1.3"><partialdiff id="A7.E16.m1.1.1.3.1.cmml" xref="A7.E16.m1.1.1.3.1"></partialdiff><apply id="A7.E16.m1.1.1.3.2.cmml" xref="A7.E16.m1.1.1.3.2"><csymbol cd="ambiguous" id="A7.E16.m1.1.1.3.2.1.cmml" xref="A7.E16.m1.1.1.3.2">subscript</csymbol><ci id="A7.E16.m1.1.1.3.2.2.cmml" xref="A7.E16.m1.1.1.3.2.2">𝑊</ci><ci id="A7.E16.m1.1.1.3.2.3.cmml" xref="A7.E16.m1.1.1.3.2.3">𝑞</ci></apply></apply></apply><ci id="A7.E16.m1.4.5.3.2.2.cmml" xref="A7.E16.m1.4.5.3.2.2">Δ</ci><apply id="A7.E16.m1.4.5.3.2.3.cmml" xref="A7.E16.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="A7.E16.m1.4.5.3.2.3.1.cmml" xref="A7.E16.m1.4.5.3.2.3">subscript</csymbol><ci id="A7.E16.m1.4.5.3.2.3.2.cmml" xref="A7.E16.m1.4.5.3.2.3.2">𝑊</ci><ci id="A7.E16.m1.4.5.3.2.3.3.cmml" xref="A7.E16.m1.4.5.3.2.3.3">𝑞</ci></apply></apply><apply id="A7.E16.m1.4.5.3.3.cmml" xref="A7.E16.m1.4.5.3.3"><times id="A7.E16.m1.4.5.3.3.1.cmml" xref="A7.E16.m1.4.5.3.3.1"></times><apply id="A7.E16.m1.2.2.cmml" xref="A7.E16.m1.2.2"><divide id="A7.E16.m1.2.2.2.cmml" xref="A7.E16.m1.2.2"></divide><apply id="A7.E16.m1.2.2.1.cmml" xref="A7.E16.m1.2.2.1"><partialdiff id="A7.E16.m1.2.2.1.2.cmml" xref="A7.E16.m1.2.2.1.2"></partialdiff><apply id="A7.E16.m1.2.2.1.3.cmml" xref="A7.E16.m1.2.2.1.3"><times id="A7.E16.m1.2.2.1.3.1.cmml" xref="A7.E16.m1.2.2.1.3.1"></times><ci id="A7.E16.m1.2.2.1.3.2a.cmml" xref="A7.E16.m1.2.2.1.3.2"><mtext id="A7.E16.m1.2.2.1.3.2.cmml" xref="A7.E16.m1.2.2.1.3.2">Attn</mtext></ci><ci id="A7.E16.m1.2.2.1.1.cmml" xref="A7.E16.m1.2.2.1.1">𝑋</ci></apply></apply><apply id="A7.E16.m1.2.2.3.cmml" xref="A7.E16.m1.2.2.3"><partialdiff id="A7.E16.m1.2.2.3.1.cmml" xref="A7.E16.m1.2.2.3.1"></partialdiff><apply id="A7.E16.m1.2.2.3.2.cmml" xref="A7.E16.m1.2.2.3.2"><csymbol cd="ambiguous" id="A7.E16.m1.2.2.3.2.1.cmml" xref="A7.E16.m1.2.2.3.2">subscript</csymbol><ci id="A7.E16.m1.2.2.3.2.2.cmml" xref="A7.E16.m1.2.2.3.2.2">𝑊</ci><ci id="A7.E16.m1.2.2.3.2.3.cmml" xref="A7.E16.m1.2.2.3.2.3">𝑘</ci></apply></apply></apply><ci id="A7.E16.m1.4.5.3.3.2.cmml" xref="A7.E16.m1.4.5.3.3.2">Δ</ci><apply id="A7.E16.m1.4.5.3.3.3.cmml" xref="A7.E16.m1.4.5.3.3.3"><csymbol cd="ambiguous" id="A7.E16.m1.4.5.3.3.3.1.cmml" xref="A7.E16.m1.4.5.3.3.3">subscript</csymbol><ci id="A7.E16.m1.4.5.3.3.3.2.cmml" xref="A7.E16.m1.4.5.3.3.3.2">𝑊</ci><ci id="A7.E16.m1.4.5.3.3.3.3.cmml" xref="A7.E16.m1.4.5.3.3.3.3">𝑘</ci></apply></apply><apply id="A7.E16.m1.4.5.3.4.cmml" xref="A7.E16.m1.4.5.3.4"><times id="A7.E16.m1.4.5.3.4.1.cmml" xref="A7.E16.m1.4.5.3.4.1"></times><apply id="A7.E16.m1.3.3.cmml" xref="A7.E16.m1.3.3"><divide id="A7.E16.m1.3.3.2.cmml" xref="A7.E16.m1.3.3"></divide><apply id="A7.E16.m1.3.3.1.cmml" xref="A7.E16.m1.3.3.1"><partialdiff id="A7.E16.m1.3.3.1.2.cmml" xref="A7.E16.m1.3.3.1.2"></partialdiff><apply id="A7.E16.m1.3.3.1.3.cmml" xref="A7.E16.m1.3.3.1.3"><times id="A7.E16.m1.3.3.1.3.1.cmml" xref="A7.E16.m1.3.3.1.3.1"></times><ci id="A7.E16.m1.3.3.1.3.2a.cmml" xref="A7.E16.m1.3.3.1.3.2"><mtext id="A7.E16.m1.3.3.1.3.2.cmml" xref="A7.E16.m1.3.3.1.3.2">Attn</mtext></ci><ci id="A7.E16.m1.3.3.1.1.cmml" xref="A7.E16.m1.3.3.1.1">𝑋</ci></apply></apply><apply id="A7.E16.m1.3.3.3.cmml" xref="A7.E16.m1.3.3.3"><partialdiff id="A7.E16.m1.3.3.3.1.cmml" xref="A7.E16.m1.3.3.3.1"></partialdiff><apply id="A7.E16.m1.3.3.3.2.cmml" xref="A7.E16.m1.3.3.3.2"><csymbol cd="ambiguous" id="A7.E16.m1.3.3.3.2.1.cmml" xref="A7.E16.m1.3.3.3.2">subscript</csymbol><ci id="A7.E16.m1.3.3.3.2.2.cmml" xref="A7.E16.m1.3.3.3.2.2">𝑊</ci><ci id="A7.E16.m1.3.3.3.2.3.cmml" xref="A7.E16.m1.3.3.3.2.3">𝑣</ci></apply></apply></apply><ci id="A7.E16.m1.4.5.3.4.2.cmml" xref="A7.E16.m1.4.5.3.4.2">Δ</ci><apply id="A7.E16.m1.4.5.3.4.3.cmml" xref="A7.E16.m1.4.5.3.4.3"><csymbol cd="ambiguous" id="A7.E16.m1.4.5.3.4.3.1.cmml" xref="A7.E16.m1.4.5.3.4.3">subscript</csymbol><ci id="A7.E16.m1.4.5.3.4.3.2.cmml" xref="A7.E16.m1.4.5.3.4.3.2">𝑊</ci><ci id="A7.E16.m1.4.5.3.4.3.3.cmml" xref="A7.E16.m1.4.5.3.4.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E16.m1.4c">\Delta\text{Attn}(X)\approx\frac{\partial\text{Attn}(X)}{\partial W_{q}}\Delta
W%
_{q}+\frac{\partial\text{Attn}(X)}{\partial W_{k}}\Delta W_{k}+\frac{\partial%
\text{Attn}(X)}{\partial W_{v}}\Delta W_{v}</annotation><annotation encoding="application/x-llamapun" id="A7.E16.m1.4d">roman_Δ Attn ( italic_X ) ≈ divide start_ARG ∂ Attn ( italic_X ) end_ARG start_ARG ∂ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG roman_Δ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT + divide start_ARG ∂ Attn ( italic_X ) end_ARG start_ARG ∂ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG roman_Δ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + divide start_ARG ∂ Attn ( italic_X ) end_ARG start_ARG ∂ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_ARG roman_Δ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A7.p7">
<p class="ltx_p" id="A7.p7.4">Using the first-order Taylor expansion and the partial derivatives of softmax, we obtain the perturbation bound of attention:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx5">
<tbody id="A7.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\|\Delta\text{Attn}(X)\|\leq\frac{1}{\sqrt{d_{k}}}(\|(\text{diag}%
(P)-PP^{\top})X(XW_{k})^{\top}XW_{v}\|\|\Delta W_{q}\|" class="ltx_math_unparsed" display="inline" id="A7.Ex3.m1.2"><semantics id="A7.Ex3.m1.2a"><mrow id="A7.Ex3.m1.2b"><mo id="A7.Ex3.m1.2.3" rspace="0.167em">∥</mo><mi id="A7.Ex3.m1.2.4" mathvariant="normal">Δ</mi><mtext id="A7.Ex3.m1.2.5">Attn</mtext><mrow id="A7.Ex3.m1.2.6"><mo id="A7.Ex3.m1.2.6.1" stretchy="false">(</mo><mi id="A7.Ex3.m1.1.1">X</mi><mo id="A7.Ex3.m1.2.6.2" stretchy="false">)</mo></mrow><mo id="A7.Ex3.m1.2.7" lspace="0em" rspace="0.0835em">∥</mo><mo id="A7.Ex3.m1.2.8" lspace="0.0835em">≤</mo><mstyle displaystyle="true" id="A7.Ex3.m1.2.9"><mfrac id="A7.Ex3.m1.2.9a"><mn id="A7.Ex3.m1.2.9.2">1</mn><msqrt id="A7.Ex3.m1.2.9.3"><msub id="A7.Ex3.m1.2.9.3.2"><mi id="A7.Ex3.m1.2.9.3.2.2">d</mi><mi id="A7.Ex3.m1.2.9.3.2.3">k</mi></msub></msqrt></mfrac></mstyle><mrow id="A7.Ex3.m1.2.10"><mo id="A7.Ex3.m1.2.10.1" stretchy="false">(</mo><mo id="A7.Ex3.m1.2.10.2" lspace="0em" rspace="0.167em">∥</mo><mrow id="A7.Ex3.m1.2.10.3"><mo id="A7.Ex3.m1.2.10.3.1" stretchy="false">(</mo><mtext id="A7.Ex3.m1.2.10.3.2">diag</mtext><mrow id="A7.Ex3.m1.2.10.3.3"><mo id="A7.Ex3.m1.2.10.3.3.1" stretchy="false">(</mo><mi id="A7.Ex3.m1.2.2">P</mi><mo id="A7.Ex3.m1.2.10.3.3.2" stretchy="false">)</mo></mrow><mo id="A7.Ex3.m1.2.10.3.4">−</mo><mi id="A7.Ex3.m1.2.10.3.5">P</mi><msup id="A7.Ex3.m1.2.10.3.6"><mi id="A7.Ex3.m1.2.10.3.6.2">P</mi><mo id="A7.Ex3.m1.2.10.3.6.3">⊤</mo></msup><mo id="A7.Ex3.m1.2.10.3.7" stretchy="false">)</mo></mrow><mi id="A7.Ex3.m1.2.10.4">X</mi><msup id="A7.Ex3.m1.2.10.5"><mrow id="A7.Ex3.m1.2.10.5.2"><mo id="A7.Ex3.m1.2.10.5.2.1" stretchy="false">(</mo><mi id="A7.Ex3.m1.2.10.5.2.2">X</mi><msub id="A7.Ex3.m1.2.10.5.2.3"><mi id="A7.Ex3.m1.2.10.5.2.3.2">W</mi><mi id="A7.Ex3.m1.2.10.5.2.3.3">k</mi></msub><mo id="A7.Ex3.m1.2.10.5.2.4" stretchy="false">)</mo></mrow><mo id="A7.Ex3.m1.2.10.5.3">⊤</mo></msup><mi id="A7.Ex3.m1.2.10.6">X</mi><msub id="A7.Ex3.m1.2.10.7"><mi id="A7.Ex3.m1.2.10.7.2">W</mi><mi id="A7.Ex3.m1.2.10.7.3">v</mi></msub><mo id="A7.Ex3.m1.2.10.8" lspace="0em" rspace="0.0835em">∥</mo><mo id="A7.Ex3.m1.2.10.9" lspace="0.0835em" rspace="0.167em">∥</mo><mi id="A7.Ex3.m1.2.10.10" mathvariant="normal">Δ</mi><msub id="A7.Ex3.m1.2.10.11"><mi id="A7.Ex3.m1.2.10.11.2">W</mi><mi id="A7.Ex3.m1.2.10.11.3">q</mi></msub><mo id="A7.Ex3.m1.2.10.12" lspace="0em">∥</mo></mrow></mrow><annotation encoding="application/x-tex" id="A7.Ex3.m1.2c">\displaystyle\|\Delta\text{Attn}(X)\|\leq\frac{1}{\sqrt{d_{k}}}(\|(\text{diag}%
(P)-PP^{\top})X(XW_{k})^{\top}XW_{v}\|\|\Delta W_{q}\|</annotation><annotation encoding="application/x-llamapun" id="A7.Ex3.m1.2d">∥ roman_Δ Attn ( italic_X ) ∥ ≤ divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ( ∥ ( diag ( italic_P ) - italic_P italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) italic_X ( italic_X italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_X italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥ ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle+\|(\text{diag}(P)-PP^{\top})XW_{q}^{\top}XXW_{v}\|\|\Delta W_{k}%
\|)+\|P^{\top}X\|\|\Delta W_{v}\|" class="ltx_math_unparsed" display="inline" id="A7.Ex4.m1.1"><semantics id="A7.Ex4.m1.1a"><mrow id="A7.Ex4.m1.1b"><mo id="A7.Ex4.m1.1.2" rspace="0em">+</mo><mo id="A7.Ex4.m1.1.3" lspace="0em" rspace="0.167em">∥</mo><mrow id="A7.Ex4.m1.1.4"><mo id="A7.Ex4.m1.1.4.1" stretchy="false">(</mo><mtext id="A7.Ex4.m1.1.4.2">diag</mtext><mrow id="A7.Ex4.m1.1.4.3"><mo id="A7.Ex4.m1.1.4.3.1" stretchy="false">(</mo><mi id="A7.Ex4.m1.1.1">P</mi><mo id="A7.Ex4.m1.1.4.3.2" stretchy="false">)</mo></mrow><mo id="A7.Ex4.m1.1.4.4">−</mo><mi id="A7.Ex4.m1.1.4.5">P</mi><msup id="A7.Ex4.m1.1.4.6"><mi id="A7.Ex4.m1.1.4.6.2">P</mi><mo id="A7.Ex4.m1.1.4.6.3">⊤</mo></msup><mo id="A7.Ex4.m1.1.4.7" stretchy="false">)</mo></mrow><mi id="A7.Ex4.m1.1.5">X</mi><msubsup id="A7.Ex4.m1.1.6"><mi id="A7.Ex4.m1.1.6.2.2">W</mi><mi id="A7.Ex4.m1.1.6.2.3">q</mi><mo id="A7.Ex4.m1.1.6.3">⊤</mo></msubsup><mi id="A7.Ex4.m1.1.7">X</mi><mi id="A7.Ex4.m1.1.8">X</mi><msub id="A7.Ex4.m1.1.9"><mi id="A7.Ex4.m1.1.9.2">W</mi><mi id="A7.Ex4.m1.1.9.3">v</mi></msub><mo id="A7.Ex4.m1.1.10" lspace="0em" rspace="0.0835em">∥</mo><mo id="A7.Ex4.m1.1.11" lspace="0.0835em" rspace="0.167em">∥</mo><mi id="A7.Ex4.m1.1.12" mathvariant="normal">Δ</mi><msub id="A7.Ex4.m1.1.13"><mi id="A7.Ex4.m1.1.13.2">W</mi><mi id="A7.Ex4.m1.1.13.3">k</mi></msub><mo id="A7.Ex4.m1.1.14" lspace="0em" rspace="0.167em">∥</mo><mo id="A7.Ex4.m1.1.15" stretchy="false">)</mo><mo id="A7.Ex4.m1.1.16" rspace="0em">+</mo><mo id="A7.Ex4.m1.1.17" lspace="0em" rspace="0.167em">∥</mo><mi id="A7.Ex4.m1.1.18">P</mi><msup id="A7.Ex4.m1.1.19"><mi id="A7.Ex4.m1.1.19a"></mi><mo id="A7.Ex4.m1.1.19.1">⊤</mo></msup><mi id="A7.Ex4.m1.1.20">X</mi><mo id="A7.Ex4.m1.1.21" lspace="0em" rspace="0.0835em">∥</mo><mo id="A7.Ex4.m1.1.22" lspace="0.0835em" rspace="0.167em">∥</mo><mi id="A7.Ex4.m1.1.23" mathvariant="normal">Δ</mi><mi id="A7.Ex4.m1.1.24">W</mi><msub id="A7.Ex4.m1.1.25"><mi id="A7.Ex4.m1.1.25a"></mi><mi id="A7.Ex4.m1.1.25.1">v</mi></msub><mo id="A7.Ex4.m1.1.26" lspace="0em">∥</mo></mrow><annotation encoding="application/x-tex" id="A7.Ex4.m1.1c">\displaystyle+\|(\text{diag}(P)-PP^{\top})XW_{q}^{\top}XXW_{v}\|\|\Delta W_{k}%
\|)+\|P^{\top}X\|\|\Delta W_{v}\|</annotation><annotation encoding="application/x-llamapun" id="A7.Ex4.m1.1d">+ ∥ ( diag ( italic_P ) - italic_P italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) italic_X italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_X italic_X italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥ ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ ) + ∥ italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_X ∥ ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p7.3">where <math alttext="P=\text{SoftMax}(\frac{XW_{q}(XW_{k})^{\top}}{\sqrt{d_{k}}})" class="ltx_Math" display="inline" id="A7.p7.1.m1.1"><semantics id="A7.p7.1.m1.1a"><mrow id="A7.p7.1.m1.1.2" xref="A7.p7.1.m1.1.2.cmml"><mi id="A7.p7.1.m1.1.2.2" xref="A7.p7.1.m1.1.2.2.cmml">P</mi><mo id="A7.p7.1.m1.1.2.1" xref="A7.p7.1.m1.1.2.1.cmml">=</mo><mrow id="A7.p7.1.m1.1.2.3" xref="A7.p7.1.m1.1.2.3.cmml"><mtext id="A7.p7.1.m1.1.2.3.2" xref="A7.p7.1.m1.1.2.3.2a.cmml">SoftMax</mtext><mo id="A7.p7.1.m1.1.2.3.1" xref="A7.p7.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="A7.p7.1.m1.1.2.3.3.2" xref="A7.p7.1.m1.1.1.cmml"><mo id="A7.p7.1.m1.1.2.3.3.2.1" stretchy="false" xref="A7.p7.1.m1.1.1.cmml">(</mo><mfrac id="A7.p7.1.m1.1.1" xref="A7.p7.1.m1.1.1.cmml"><mrow id="A7.p7.1.m1.1.1.1" xref="A7.p7.1.m1.1.1.1.cmml"><mi id="A7.p7.1.m1.1.1.1.3" xref="A7.p7.1.m1.1.1.1.3.cmml">X</mi><mo id="A7.p7.1.m1.1.1.1.2" xref="A7.p7.1.m1.1.1.1.2.cmml">⁢</mo><msub id="A7.p7.1.m1.1.1.1.4" xref="A7.p7.1.m1.1.1.1.4.cmml"><mi id="A7.p7.1.m1.1.1.1.4.2" xref="A7.p7.1.m1.1.1.1.4.2.cmml">W</mi><mi id="A7.p7.1.m1.1.1.1.4.3" xref="A7.p7.1.m1.1.1.1.4.3.cmml">q</mi></msub><mo id="A7.p7.1.m1.1.1.1.2a" xref="A7.p7.1.m1.1.1.1.2.cmml">⁢</mo><msup id="A7.p7.1.m1.1.1.1.1" xref="A7.p7.1.m1.1.1.1.1.cmml"><mrow id="A7.p7.1.m1.1.1.1.1.1.1" xref="A7.p7.1.m1.1.1.1.1.1.1.1.cmml"><mo id="A7.p7.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A7.p7.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.p7.1.m1.1.1.1.1.1.1.1" xref="A7.p7.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A7.p7.1.m1.1.1.1.1.1.1.1.2" xref="A7.p7.1.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="A7.p7.1.m1.1.1.1.1.1.1.1.1" xref="A7.p7.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p7.1.m1.1.1.1.1.1.1.1.3" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.p7.1.m1.1.1.1.1.1.1.1.3.2" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="A7.p7.1.m1.1.1.1.1.1.1.1.3.3" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A7.p7.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A7.p7.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.p7.1.m1.1.1.1.1.3" xref="A7.p7.1.m1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><msqrt id="A7.p7.1.m1.1.1.3" xref="A7.p7.1.m1.1.1.3.cmml"><msub id="A7.p7.1.m1.1.1.3.2" xref="A7.p7.1.m1.1.1.3.2.cmml"><mi id="A7.p7.1.m1.1.1.3.2.2" xref="A7.p7.1.m1.1.1.3.2.2.cmml">d</mi><mi id="A7.p7.1.m1.1.1.3.2.3" xref="A7.p7.1.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="A7.p7.1.m1.1.2.3.3.2.2" stretchy="false" xref="A7.p7.1.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p7.1.m1.1b"><apply id="A7.p7.1.m1.1.2.cmml" xref="A7.p7.1.m1.1.2"><eq id="A7.p7.1.m1.1.2.1.cmml" xref="A7.p7.1.m1.1.2.1"></eq><ci id="A7.p7.1.m1.1.2.2.cmml" xref="A7.p7.1.m1.1.2.2">𝑃</ci><apply id="A7.p7.1.m1.1.2.3.cmml" xref="A7.p7.1.m1.1.2.3"><times id="A7.p7.1.m1.1.2.3.1.cmml" xref="A7.p7.1.m1.1.2.3.1"></times><ci id="A7.p7.1.m1.1.2.3.2a.cmml" xref="A7.p7.1.m1.1.2.3.2"><mtext id="A7.p7.1.m1.1.2.3.2.cmml" xref="A7.p7.1.m1.1.2.3.2">SoftMax</mtext></ci><apply id="A7.p7.1.m1.1.1.cmml" xref="A7.p7.1.m1.1.2.3.3.2"><divide id="A7.p7.1.m1.1.1.2.cmml" xref="A7.p7.1.m1.1.2.3.3.2"></divide><apply id="A7.p7.1.m1.1.1.1.cmml" xref="A7.p7.1.m1.1.1.1"><times id="A7.p7.1.m1.1.1.1.2.cmml" xref="A7.p7.1.m1.1.1.1.2"></times><ci id="A7.p7.1.m1.1.1.1.3.cmml" xref="A7.p7.1.m1.1.1.1.3">𝑋</ci><apply id="A7.p7.1.m1.1.1.1.4.cmml" xref="A7.p7.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="A7.p7.1.m1.1.1.1.4.1.cmml" xref="A7.p7.1.m1.1.1.1.4">subscript</csymbol><ci id="A7.p7.1.m1.1.1.1.4.2.cmml" xref="A7.p7.1.m1.1.1.1.4.2">𝑊</ci><ci id="A7.p7.1.m1.1.1.1.4.3.cmml" xref="A7.p7.1.m1.1.1.1.4.3">𝑞</ci></apply><apply id="A7.p7.1.m1.1.1.1.1.cmml" xref="A7.p7.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p7.1.m1.1.1.1.1.2.cmml" xref="A7.p7.1.m1.1.1.1.1">superscript</csymbol><apply id="A7.p7.1.m1.1.1.1.1.1.1.1.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1"><times id="A7.p7.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.1"></times><ci id="A7.p7.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="A7.p7.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p7.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p7.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="A7.p7.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.p7.1.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="A7.p7.1.m1.1.1.1.1.3.cmml" xref="A7.p7.1.m1.1.1.1.1.3">top</csymbol></apply></apply><apply id="A7.p7.1.m1.1.1.3.cmml" xref="A7.p7.1.m1.1.1.3"><root id="A7.p7.1.m1.1.1.3a.cmml" xref="A7.p7.1.m1.1.1.3"></root><apply id="A7.p7.1.m1.1.1.3.2.cmml" xref="A7.p7.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A7.p7.1.m1.1.1.3.2.1.cmml" xref="A7.p7.1.m1.1.1.3.2">subscript</csymbol><ci id="A7.p7.1.m1.1.1.3.2.2.cmml" xref="A7.p7.1.m1.1.1.3.2.2">𝑑</ci><ci id="A7.p7.1.m1.1.1.3.2.3.cmml" xref="A7.p7.1.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p7.1.m1.1c">P=\text{SoftMax}(\frac{XW_{q}(XW_{k})^{\top}}{\sqrt{d_{k}}})</annotation><annotation encoding="application/x-llamapun" id="A7.p7.1.m1.1d">italic_P = SoftMax ( divide start_ARG italic_X italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_X italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG )</annotation></semantics></math> We simplify the bound as such <math alttext="\|\Delta\text{Attn}(X)\|\leq C_{attn}(\|\Delta W_{q}\|+\|\Delta W_{k}\|+\|%
\Delta W_{v}\|)" class="ltx_Math" display="inline" id="A7.p7.2.m2.3"><semantics id="A7.p7.2.m2.3a"><mrow id="A7.p7.2.m2.3.3" xref="A7.p7.2.m2.3.3.cmml"><mrow id="A7.p7.2.m2.2.2.1.1" xref="A7.p7.2.m2.2.2.1.2.cmml"><mo id="A7.p7.2.m2.2.2.1.1.2" stretchy="false" xref="A7.p7.2.m2.2.2.1.2.1.cmml">‖</mo><mrow id="A7.p7.2.m2.2.2.1.1.1" xref="A7.p7.2.m2.2.2.1.1.1.cmml"><mi id="A7.p7.2.m2.2.2.1.1.1.2" mathvariant="normal" xref="A7.p7.2.m2.2.2.1.1.1.2.cmml">Δ</mi><mo id="A7.p7.2.m2.2.2.1.1.1.1" xref="A7.p7.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mtext id="A7.p7.2.m2.2.2.1.1.1.3" xref="A7.p7.2.m2.2.2.1.1.1.3a.cmml">Attn</mtext><mo id="A7.p7.2.m2.2.2.1.1.1.1a" xref="A7.p7.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A7.p7.2.m2.2.2.1.1.1.4.2" xref="A7.p7.2.m2.2.2.1.1.1.cmml"><mo id="A7.p7.2.m2.2.2.1.1.1.4.2.1" stretchy="false" xref="A7.p7.2.m2.2.2.1.1.1.cmml">(</mo><mi id="A7.p7.2.m2.1.1" xref="A7.p7.2.m2.1.1.cmml">X</mi><mo id="A7.p7.2.m2.2.2.1.1.1.4.2.2" stretchy="false" xref="A7.p7.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p7.2.m2.2.2.1.1.3" stretchy="false" xref="A7.p7.2.m2.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A7.p7.2.m2.3.3.3" xref="A7.p7.2.m2.3.3.3.cmml">≤</mo><mrow id="A7.p7.2.m2.3.3.2" xref="A7.p7.2.m2.3.3.2.cmml"><msub id="A7.p7.2.m2.3.3.2.3" xref="A7.p7.2.m2.3.3.2.3.cmml"><mi id="A7.p7.2.m2.3.3.2.3.2" xref="A7.p7.2.m2.3.3.2.3.2.cmml">C</mi><mrow id="A7.p7.2.m2.3.3.2.3.3" xref="A7.p7.2.m2.3.3.2.3.3.cmml"><mi id="A7.p7.2.m2.3.3.2.3.3.2" xref="A7.p7.2.m2.3.3.2.3.3.2.cmml">a</mi><mo id="A7.p7.2.m2.3.3.2.3.3.1" xref="A7.p7.2.m2.3.3.2.3.3.1.cmml">⁢</mo><mi id="A7.p7.2.m2.3.3.2.3.3.3" xref="A7.p7.2.m2.3.3.2.3.3.3.cmml">t</mi><mo id="A7.p7.2.m2.3.3.2.3.3.1a" xref="A7.p7.2.m2.3.3.2.3.3.1.cmml">⁢</mo><mi id="A7.p7.2.m2.3.3.2.3.3.4" xref="A7.p7.2.m2.3.3.2.3.3.4.cmml">t</mi><mo id="A7.p7.2.m2.3.3.2.3.3.1b" xref="A7.p7.2.m2.3.3.2.3.3.1.cmml">⁢</mo><mi id="A7.p7.2.m2.3.3.2.3.3.5" xref="A7.p7.2.m2.3.3.2.3.3.5.cmml">n</mi></mrow></msub><mo id="A7.p7.2.m2.3.3.2.2" xref="A7.p7.2.m2.3.3.2.2.cmml">⁢</mo><mrow id="A7.p7.2.m2.3.3.2.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.cmml"><mo id="A7.p7.2.m2.3.3.2.1.1.2" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.cmml">(</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.cmml"><mrow id="A7.p7.2.m2.3.3.2.1.1.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.1.2.cmml"><mo id="A7.p7.2.m2.3.3.2.1.1.1.1.1.2" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.2" mathvariant="normal" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.2" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.3" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.1.1.1.3" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.1.4" xref="A7.p7.2.m2.3.3.2.1.1.1.4.cmml">+</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1.2.1" xref="A7.p7.2.m2.3.3.2.1.1.1.2.2.cmml"><mo id="A7.p7.2.m2.3.3.2.1.1.1.2.1.2" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.2.2.1.cmml">‖</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.2" mathvariant="normal" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.2.cmml">Δ</mi><mo id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.2" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.2.cmml">W</mi><mi id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.3" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.1.2.1.3" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.2.2.1.cmml">‖</mo></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.1.4a" xref="A7.p7.2.m2.3.3.2.1.1.1.4.cmml">+</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1.3.1" xref="A7.p7.2.m2.3.3.2.1.1.1.3.2.cmml"><mo id="A7.p7.2.m2.3.3.2.1.1.1.3.1.2" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.3.2.1.cmml">‖</mo><mrow id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.2" mathvariant="normal" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.2.cmml">Δ</mi><mo id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.1" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.1.cmml">⁢</mo><msub id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.cmml"><mi id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.2" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.2.cmml">W</mi><mi id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.3" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.3.cmml">v</mi></msub></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.1.3.1.3" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.3.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.p7.2.m2.3.3.2.1.1.3" stretchy="false" xref="A7.p7.2.m2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p7.2.m2.3b"><apply id="A7.p7.2.m2.3.3.cmml" xref="A7.p7.2.m2.3.3"><leq id="A7.p7.2.m2.3.3.3.cmml" xref="A7.p7.2.m2.3.3.3"></leq><apply id="A7.p7.2.m2.2.2.1.2.cmml" xref="A7.p7.2.m2.2.2.1.1"><csymbol cd="latexml" id="A7.p7.2.m2.2.2.1.2.1.cmml" xref="A7.p7.2.m2.2.2.1.1.2">norm</csymbol><apply id="A7.p7.2.m2.2.2.1.1.1.cmml" xref="A7.p7.2.m2.2.2.1.1.1"><times id="A7.p7.2.m2.2.2.1.1.1.1.cmml" xref="A7.p7.2.m2.2.2.1.1.1.1"></times><ci id="A7.p7.2.m2.2.2.1.1.1.2.cmml" xref="A7.p7.2.m2.2.2.1.1.1.2">Δ</ci><ci id="A7.p7.2.m2.2.2.1.1.1.3a.cmml" xref="A7.p7.2.m2.2.2.1.1.1.3"><mtext id="A7.p7.2.m2.2.2.1.1.1.3.cmml" xref="A7.p7.2.m2.2.2.1.1.1.3">Attn</mtext></ci><ci id="A7.p7.2.m2.1.1.cmml" xref="A7.p7.2.m2.1.1">𝑋</ci></apply></apply><apply id="A7.p7.2.m2.3.3.2.cmml" xref="A7.p7.2.m2.3.3.2"><times id="A7.p7.2.m2.3.3.2.2.cmml" xref="A7.p7.2.m2.3.3.2.2"></times><apply id="A7.p7.2.m2.3.3.2.3.cmml" xref="A7.p7.2.m2.3.3.2.3"><csymbol cd="ambiguous" id="A7.p7.2.m2.3.3.2.3.1.cmml" xref="A7.p7.2.m2.3.3.2.3">subscript</csymbol><ci id="A7.p7.2.m2.3.3.2.3.2.cmml" xref="A7.p7.2.m2.3.3.2.3.2">𝐶</ci><apply id="A7.p7.2.m2.3.3.2.3.3.cmml" xref="A7.p7.2.m2.3.3.2.3.3"><times id="A7.p7.2.m2.3.3.2.3.3.1.cmml" xref="A7.p7.2.m2.3.3.2.3.3.1"></times><ci id="A7.p7.2.m2.3.3.2.3.3.2.cmml" xref="A7.p7.2.m2.3.3.2.3.3.2">𝑎</ci><ci id="A7.p7.2.m2.3.3.2.3.3.3.cmml" xref="A7.p7.2.m2.3.3.2.3.3.3">𝑡</ci><ci id="A7.p7.2.m2.3.3.2.3.3.4.cmml" xref="A7.p7.2.m2.3.3.2.3.3.4">𝑡</ci><ci id="A7.p7.2.m2.3.3.2.3.3.5.cmml" xref="A7.p7.2.m2.3.3.2.3.3.5">𝑛</ci></apply></apply><apply id="A7.p7.2.m2.3.3.2.1.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1"><plus id="A7.p7.2.m2.3.3.2.1.1.1.4.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.4"></plus><apply id="A7.p7.2.m2.3.3.2.1.1.1.1.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1"><csymbol cd="latexml" id="A7.p7.2.m2.3.3.2.1.1.1.1.2.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.2">norm</csymbol><apply id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1"><times id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.1"></times><ci id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.2">Δ</ci><apply id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.2">𝑊</ci><ci id="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply><apply id="A7.p7.2.m2.3.3.2.1.1.1.2.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1"><csymbol cd="latexml" id="A7.p7.2.m2.3.3.2.1.1.1.2.2.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.2">norm</csymbol><apply id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1"><times id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.1"></times><ci id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.2">Δ</ci><apply id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3">subscript</csymbol><ci id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.2">𝑊</ci><ci id="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.2.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="A7.p7.2.m2.3.3.2.1.1.1.3.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1"><csymbol cd="latexml" id="A7.p7.2.m2.3.3.2.1.1.1.3.2.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.2">norm</csymbol><apply id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1"><times id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.1"></times><ci id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.2">Δ</ci><apply id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.1.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3">subscript</csymbol><ci id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.2.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.2">𝑊</ci><ci id="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.3.cmml" xref="A7.p7.2.m2.3.3.2.1.1.1.3.1.1.3.3">𝑣</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p7.2.m2.3c">\|\Delta\text{Attn}(X)\|\leq C_{attn}(\|\Delta W_{q}\|+\|\Delta W_{k}\|+\|%
\Delta W_{v}\|)</annotation><annotation encoding="application/x-llamapun" id="A7.p7.2.m2.3d">∥ roman_Δ Attn ( italic_X ) ∥ ≤ italic_C start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT ( ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∥ + ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ + ∥ roman_Δ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥ )</annotation></semantics></math> where <math alttext="C_{attn}=\frac{\|X\|^{3}\|W_{k}\|\|W_{v}\|}{\sqrt{d_{k}}}\|\text{diag}(P)-PP^{%
\top}\|" class="ltx_Math" display="inline" id="A7.p7.3.m3.5"><semantics id="A7.p7.3.m3.5a"><mrow id="A7.p7.3.m3.5.5" xref="A7.p7.3.m3.5.5.cmml"><msub id="A7.p7.3.m3.5.5.3" xref="A7.p7.3.m3.5.5.3.cmml"><mi id="A7.p7.3.m3.5.5.3.2" xref="A7.p7.3.m3.5.5.3.2.cmml">C</mi><mrow id="A7.p7.3.m3.5.5.3.3" xref="A7.p7.3.m3.5.5.3.3.cmml"><mi id="A7.p7.3.m3.5.5.3.3.2" xref="A7.p7.3.m3.5.5.3.3.2.cmml">a</mi><mo id="A7.p7.3.m3.5.5.3.3.1" xref="A7.p7.3.m3.5.5.3.3.1.cmml">⁢</mo><mi id="A7.p7.3.m3.5.5.3.3.3" xref="A7.p7.3.m3.5.5.3.3.3.cmml">t</mi><mo id="A7.p7.3.m3.5.5.3.3.1a" xref="A7.p7.3.m3.5.5.3.3.1.cmml">⁢</mo><mi id="A7.p7.3.m3.5.5.3.3.4" xref="A7.p7.3.m3.5.5.3.3.4.cmml">t</mi><mo id="A7.p7.3.m3.5.5.3.3.1b" xref="A7.p7.3.m3.5.5.3.3.1.cmml">⁢</mo><mi id="A7.p7.3.m3.5.5.3.3.5" xref="A7.p7.3.m3.5.5.3.3.5.cmml">n</mi></mrow></msub><mo id="A7.p7.3.m3.5.5.2" xref="A7.p7.3.m3.5.5.2.cmml">=</mo><mrow id="A7.p7.3.m3.5.5.1" xref="A7.p7.3.m3.5.5.1.cmml"><mfrac id="A7.p7.3.m3.3.3" xref="A7.p7.3.m3.3.3.cmml"><mrow id="A7.p7.3.m3.3.3.3" xref="A7.p7.3.m3.3.3.3.cmml"><msup id="A7.p7.3.m3.3.3.3.5" xref="A7.p7.3.m3.3.3.3.5.cmml"><mrow id="A7.p7.3.m3.3.3.3.5.2.2" xref="A7.p7.3.m3.3.3.3.5.2.1.cmml"><mo id="A7.p7.3.m3.3.3.3.5.2.2.1" stretchy="false" xref="A7.p7.3.m3.3.3.3.5.2.1.1.cmml">‖</mo><mi id="A7.p7.3.m3.1.1.1.1" xref="A7.p7.3.m3.1.1.1.1.cmml">X</mi><mo id="A7.p7.3.m3.3.3.3.5.2.2.2" stretchy="false" xref="A7.p7.3.m3.3.3.3.5.2.1.1.cmml">‖</mo></mrow><mn id="A7.p7.3.m3.3.3.3.5.3" xref="A7.p7.3.m3.3.3.3.5.3.cmml">3</mn></msup><mo id="A7.p7.3.m3.3.3.3.4" xref="A7.p7.3.m3.3.3.3.4.cmml">⁢</mo><mrow id="A7.p7.3.m3.2.2.2.2.1" xref="A7.p7.3.m3.2.2.2.2.2.cmml"><mo id="A7.p7.3.m3.2.2.2.2.1.2" stretchy="false" xref="A7.p7.3.m3.2.2.2.2.2.1.cmml">‖</mo><msub id="A7.p7.3.m3.2.2.2.2.1.1" xref="A7.p7.3.m3.2.2.2.2.1.1.cmml"><mi id="A7.p7.3.m3.2.2.2.2.1.1.2" xref="A7.p7.3.m3.2.2.2.2.1.1.2.cmml">W</mi><mi id="A7.p7.3.m3.2.2.2.2.1.1.3" xref="A7.p7.3.m3.2.2.2.2.1.1.3.cmml">k</mi></msub><mo id="A7.p7.3.m3.2.2.2.2.1.3" stretchy="false" xref="A7.p7.3.m3.2.2.2.2.2.1.cmml">‖</mo></mrow><mo id="A7.p7.3.m3.3.3.3.4a" xref="A7.p7.3.m3.3.3.3.4.cmml">⁢</mo><mrow id="A7.p7.3.m3.3.3.3.3.1" xref="A7.p7.3.m3.3.3.3.3.2.cmml"><mo id="A7.p7.3.m3.3.3.3.3.1.2" stretchy="false" xref="A7.p7.3.m3.3.3.3.3.2.1.cmml">‖</mo><msub id="A7.p7.3.m3.3.3.3.3.1.1" xref="A7.p7.3.m3.3.3.3.3.1.1.cmml"><mi id="A7.p7.3.m3.3.3.3.3.1.1.2" xref="A7.p7.3.m3.3.3.3.3.1.1.2.cmml">W</mi><mi id="A7.p7.3.m3.3.3.3.3.1.1.3" xref="A7.p7.3.m3.3.3.3.3.1.1.3.cmml">v</mi></msub><mo id="A7.p7.3.m3.3.3.3.3.1.3" stretchy="false" xref="A7.p7.3.m3.3.3.3.3.2.1.cmml">‖</mo></mrow></mrow><msqrt id="A7.p7.3.m3.3.3.5" xref="A7.p7.3.m3.3.3.5.cmml"><msub id="A7.p7.3.m3.3.3.5.2" xref="A7.p7.3.m3.3.3.5.2.cmml"><mi id="A7.p7.3.m3.3.3.5.2.2" xref="A7.p7.3.m3.3.3.5.2.2.cmml">d</mi><mi id="A7.p7.3.m3.3.3.5.2.3" xref="A7.p7.3.m3.3.3.5.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="A7.p7.3.m3.5.5.1.2" xref="A7.p7.3.m3.5.5.1.2.cmml">⁢</mo><mrow id="A7.p7.3.m3.5.5.1.1.1" xref="A7.p7.3.m3.5.5.1.1.2.cmml"><mo id="A7.p7.3.m3.5.5.1.1.1.2" stretchy="false" xref="A7.p7.3.m3.5.5.1.1.2.1.cmml">‖</mo><mrow id="A7.p7.3.m3.5.5.1.1.1.1" xref="A7.p7.3.m3.5.5.1.1.1.1.cmml"><mrow id="A7.p7.3.m3.5.5.1.1.1.1.2" xref="A7.p7.3.m3.5.5.1.1.1.1.2.cmml"><mtext id="A7.p7.3.m3.5.5.1.1.1.1.2.2" xref="A7.p7.3.m3.5.5.1.1.1.1.2.2a.cmml">diag</mtext><mo id="A7.p7.3.m3.5.5.1.1.1.1.2.1" xref="A7.p7.3.m3.5.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A7.p7.3.m3.5.5.1.1.1.1.2.3.2" xref="A7.p7.3.m3.5.5.1.1.1.1.2.cmml"><mo id="A7.p7.3.m3.5.5.1.1.1.1.2.3.2.1" stretchy="false" xref="A7.p7.3.m3.5.5.1.1.1.1.2.cmml">(</mo><mi id="A7.p7.3.m3.4.4" xref="A7.p7.3.m3.4.4.cmml">P</mi><mo id="A7.p7.3.m3.5.5.1.1.1.1.2.3.2.2" stretchy="false" xref="A7.p7.3.m3.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A7.p7.3.m3.5.5.1.1.1.1.1" xref="A7.p7.3.m3.5.5.1.1.1.1.1.cmml">−</mo><mrow id="A7.p7.3.m3.5.5.1.1.1.1.3" xref="A7.p7.3.m3.5.5.1.1.1.1.3.cmml"><mi id="A7.p7.3.m3.5.5.1.1.1.1.3.2" xref="A7.p7.3.m3.5.5.1.1.1.1.3.2.cmml">P</mi><mo id="A7.p7.3.m3.5.5.1.1.1.1.3.1" xref="A7.p7.3.m3.5.5.1.1.1.1.3.1.cmml">⁢</mo><msup id="A7.p7.3.m3.5.5.1.1.1.1.3.3" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3.cmml"><mi id="A7.p7.3.m3.5.5.1.1.1.1.3.3.2" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3.2.cmml">P</mi><mo id="A7.p7.3.m3.5.5.1.1.1.1.3.3.3" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><mo id="A7.p7.3.m3.5.5.1.1.1.3" stretchy="false" xref="A7.p7.3.m3.5.5.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p7.3.m3.5b"><apply id="A7.p7.3.m3.5.5.cmml" xref="A7.p7.3.m3.5.5"><eq id="A7.p7.3.m3.5.5.2.cmml" xref="A7.p7.3.m3.5.5.2"></eq><apply id="A7.p7.3.m3.5.5.3.cmml" xref="A7.p7.3.m3.5.5.3"><csymbol cd="ambiguous" id="A7.p7.3.m3.5.5.3.1.cmml" xref="A7.p7.3.m3.5.5.3">subscript</csymbol><ci id="A7.p7.3.m3.5.5.3.2.cmml" xref="A7.p7.3.m3.5.5.3.2">𝐶</ci><apply id="A7.p7.3.m3.5.5.3.3.cmml" xref="A7.p7.3.m3.5.5.3.3"><times id="A7.p7.3.m3.5.5.3.3.1.cmml" xref="A7.p7.3.m3.5.5.3.3.1"></times><ci id="A7.p7.3.m3.5.5.3.3.2.cmml" xref="A7.p7.3.m3.5.5.3.3.2">𝑎</ci><ci id="A7.p7.3.m3.5.5.3.3.3.cmml" xref="A7.p7.3.m3.5.5.3.3.3">𝑡</ci><ci id="A7.p7.3.m3.5.5.3.3.4.cmml" xref="A7.p7.3.m3.5.5.3.3.4">𝑡</ci><ci id="A7.p7.3.m3.5.5.3.3.5.cmml" xref="A7.p7.3.m3.5.5.3.3.5">𝑛</ci></apply></apply><apply id="A7.p7.3.m3.5.5.1.cmml" xref="A7.p7.3.m3.5.5.1"><times id="A7.p7.3.m3.5.5.1.2.cmml" xref="A7.p7.3.m3.5.5.1.2"></times><apply id="A7.p7.3.m3.3.3.cmml" xref="A7.p7.3.m3.3.3"><divide id="A7.p7.3.m3.3.3.4.cmml" xref="A7.p7.3.m3.3.3"></divide><apply id="A7.p7.3.m3.3.3.3.cmml" xref="A7.p7.3.m3.3.3.3"><times id="A7.p7.3.m3.3.3.3.4.cmml" xref="A7.p7.3.m3.3.3.3.4"></times><apply id="A7.p7.3.m3.3.3.3.5.cmml" xref="A7.p7.3.m3.3.3.3.5"><csymbol cd="ambiguous" id="A7.p7.3.m3.3.3.3.5.1.cmml" xref="A7.p7.3.m3.3.3.3.5">superscript</csymbol><apply id="A7.p7.3.m3.3.3.3.5.2.1.cmml" xref="A7.p7.3.m3.3.3.3.5.2.2"><csymbol cd="latexml" id="A7.p7.3.m3.3.3.3.5.2.1.1.cmml" xref="A7.p7.3.m3.3.3.3.5.2.2.1">norm</csymbol><ci id="A7.p7.3.m3.1.1.1.1.cmml" xref="A7.p7.3.m3.1.1.1.1">𝑋</ci></apply><cn id="A7.p7.3.m3.3.3.3.5.3.cmml" type="integer" xref="A7.p7.3.m3.3.3.3.5.3">3</cn></apply><apply id="A7.p7.3.m3.2.2.2.2.2.cmml" xref="A7.p7.3.m3.2.2.2.2.1"><csymbol cd="latexml" id="A7.p7.3.m3.2.2.2.2.2.1.cmml" xref="A7.p7.3.m3.2.2.2.2.1.2">norm</csymbol><apply id="A7.p7.3.m3.2.2.2.2.1.1.cmml" xref="A7.p7.3.m3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A7.p7.3.m3.2.2.2.2.1.1.1.cmml" xref="A7.p7.3.m3.2.2.2.2.1.1">subscript</csymbol><ci id="A7.p7.3.m3.2.2.2.2.1.1.2.cmml" xref="A7.p7.3.m3.2.2.2.2.1.1.2">𝑊</ci><ci id="A7.p7.3.m3.2.2.2.2.1.1.3.cmml" xref="A7.p7.3.m3.2.2.2.2.1.1.3">𝑘</ci></apply></apply><apply id="A7.p7.3.m3.3.3.3.3.2.cmml" xref="A7.p7.3.m3.3.3.3.3.1"><csymbol cd="latexml" id="A7.p7.3.m3.3.3.3.3.2.1.cmml" xref="A7.p7.3.m3.3.3.3.3.1.2">norm</csymbol><apply id="A7.p7.3.m3.3.3.3.3.1.1.cmml" xref="A7.p7.3.m3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="A7.p7.3.m3.3.3.3.3.1.1.1.cmml" xref="A7.p7.3.m3.3.3.3.3.1.1">subscript</csymbol><ci id="A7.p7.3.m3.3.3.3.3.1.1.2.cmml" xref="A7.p7.3.m3.3.3.3.3.1.1.2">𝑊</ci><ci id="A7.p7.3.m3.3.3.3.3.1.1.3.cmml" xref="A7.p7.3.m3.3.3.3.3.1.1.3">𝑣</ci></apply></apply></apply><apply id="A7.p7.3.m3.3.3.5.cmml" xref="A7.p7.3.m3.3.3.5"><root id="A7.p7.3.m3.3.3.5a.cmml" xref="A7.p7.3.m3.3.3.5"></root><apply id="A7.p7.3.m3.3.3.5.2.cmml" xref="A7.p7.3.m3.3.3.5.2"><csymbol cd="ambiguous" id="A7.p7.3.m3.3.3.5.2.1.cmml" xref="A7.p7.3.m3.3.3.5.2">subscript</csymbol><ci id="A7.p7.3.m3.3.3.5.2.2.cmml" xref="A7.p7.3.m3.3.3.5.2.2">𝑑</ci><ci id="A7.p7.3.m3.3.3.5.2.3.cmml" xref="A7.p7.3.m3.3.3.5.2.3">𝑘</ci></apply></apply></apply><apply id="A7.p7.3.m3.5.5.1.1.2.cmml" xref="A7.p7.3.m3.5.5.1.1.1"><csymbol cd="latexml" id="A7.p7.3.m3.5.5.1.1.2.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.2">norm</csymbol><apply id="A7.p7.3.m3.5.5.1.1.1.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1"><minus id="A7.p7.3.m3.5.5.1.1.1.1.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.1"></minus><apply id="A7.p7.3.m3.5.5.1.1.1.1.2.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.2"><times id="A7.p7.3.m3.5.5.1.1.1.1.2.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.2.1"></times><ci id="A7.p7.3.m3.5.5.1.1.1.1.2.2a.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.2.2"><mtext id="A7.p7.3.m3.5.5.1.1.1.1.2.2.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.2.2">diag</mtext></ci><ci id="A7.p7.3.m3.4.4.cmml" xref="A7.p7.3.m3.4.4">𝑃</ci></apply><apply id="A7.p7.3.m3.5.5.1.1.1.1.3.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3"><times id="A7.p7.3.m3.5.5.1.1.1.1.3.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.1"></times><ci id="A7.p7.3.m3.5.5.1.1.1.1.3.2.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.2">𝑃</ci><apply id="A7.p7.3.m3.5.5.1.1.1.1.3.3.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.p7.3.m3.5.5.1.1.1.1.3.3.1.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3">superscript</csymbol><ci id="A7.p7.3.m3.5.5.1.1.1.1.3.3.2.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3.2">𝑃</ci><csymbol cd="latexml" id="A7.p7.3.m3.5.5.1.1.1.1.3.3.3.cmml" xref="A7.p7.3.m3.5.5.1.1.1.1.3.3.3">top</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p7.3.m3.5c">C_{attn}=\frac{\|X\|^{3}\|W_{k}\|\|W_{v}\|}{\sqrt{d_{k}}}\|\text{diag}(P)-PP^{%
\top}\|</annotation><annotation encoding="application/x-llamapun" id="A7.p7.3.m3.5d">italic_C start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT = divide start_ARG ∥ italic_X ∥ start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ∥ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ ∥ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥ end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ∥ diag ( italic_P ) - italic_P italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∥</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A7.p8">
<p class="ltx_p" id="A7.p8.4">In terms of FFN modules, we use ReLU as the activation function instead of SwiGLU in FFN, which is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FFN}(X)=\text{ReLU}(W_{1}(\text{ReLU}(W_{2}x+b_{2}))+b_{1})" class="ltx_Math" display="block" id="A7.E17.m1.2"><semantics id="A7.E17.m1.2a"><mrow id="A7.E17.m1.2.2" xref="A7.E17.m1.2.2.cmml"><mrow id="A7.E17.m1.2.2.3" xref="A7.E17.m1.2.2.3.cmml"><mtext id="A7.E17.m1.2.2.3.2" xref="A7.E17.m1.2.2.3.2a.cmml">FFN</mtext><mo id="A7.E17.m1.2.2.3.1" xref="A7.E17.m1.2.2.3.1.cmml">⁢</mo><mrow id="A7.E17.m1.2.2.3.3.2" xref="A7.E17.m1.2.2.3.cmml"><mo id="A7.E17.m1.2.2.3.3.2.1" stretchy="false" xref="A7.E17.m1.2.2.3.cmml">(</mo><mi id="A7.E17.m1.1.1" xref="A7.E17.m1.1.1.cmml">X</mi><mo id="A7.E17.m1.2.2.3.3.2.2" stretchy="false" xref="A7.E17.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A7.E17.m1.2.2.2" xref="A7.E17.m1.2.2.2.cmml">=</mo><mrow id="A7.E17.m1.2.2.1" xref="A7.E17.m1.2.2.1.cmml"><mtext id="A7.E17.m1.2.2.1.3" xref="A7.E17.m1.2.2.1.3a.cmml">ReLU</mtext><mo id="A7.E17.m1.2.2.1.2" xref="A7.E17.m1.2.2.1.2.cmml">⁢</mo><mrow id="A7.E17.m1.2.2.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.cmml"><mo id="A7.E17.m1.2.2.1.1.1.2" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.E17.m1.2.2.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.cmml"><mrow id="A7.E17.m1.2.2.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.cmml"><msub id="A7.E17.m1.2.2.1.1.1.1.1.3" xref="A7.E17.m1.2.2.1.1.1.1.1.3.cmml"><mi id="A7.E17.m1.2.2.1.1.1.1.1.3.2" xref="A7.E17.m1.2.2.1.1.1.1.1.3.2.cmml">W</mi><mn id="A7.E17.m1.2.2.1.1.1.1.1.3.3" xref="A7.E17.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A7.E17.m1.2.2.1.1.1.1.1.2" xref="A7.E17.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.E17.m1.2.2.1.1.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mtext id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3a.cmml">ReLU</mtext><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msub><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E17.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E17.m1.2.2.1.1.1.1.2" xref="A7.E17.m1.2.2.1.1.1.1.2.cmml">+</mo><msub id="A7.E17.m1.2.2.1.1.1.1.3" xref="A7.E17.m1.2.2.1.1.1.1.3.cmml"><mi id="A7.E17.m1.2.2.1.1.1.1.3.2" xref="A7.E17.m1.2.2.1.1.1.1.3.2.cmml">b</mi><mn id="A7.E17.m1.2.2.1.1.1.1.3.3" xref="A7.E17.m1.2.2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.E17.m1.2.2.1.1.1.3" stretchy="false" xref="A7.E17.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E17.m1.2b"><apply id="A7.E17.m1.2.2.cmml" xref="A7.E17.m1.2.2"><eq id="A7.E17.m1.2.2.2.cmml" xref="A7.E17.m1.2.2.2"></eq><apply id="A7.E17.m1.2.2.3.cmml" xref="A7.E17.m1.2.2.3"><times id="A7.E17.m1.2.2.3.1.cmml" xref="A7.E17.m1.2.2.3.1"></times><ci id="A7.E17.m1.2.2.3.2a.cmml" xref="A7.E17.m1.2.2.3.2"><mtext id="A7.E17.m1.2.2.3.2.cmml" xref="A7.E17.m1.2.2.3.2">FFN</mtext></ci><ci id="A7.E17.m1.1.1.cmml" xref="A7.E17.m1.1.1">𝑋</ci></apply><apply id="A7.E17.m1.2.2.1.cmml" xref="A7.E17.m1.2.2.1"><times id="A7.E17.m1.2.2.1.2.cmml" xref="A7.E17.m1.2.2.1.2"></times><ci id="A7.E17.m1.2.2.1.3a.cmml" xref="A7.E17.m1.2.2.1.3"><mtext id="A7.E17.m1.2.2.1.3.cmml" xref="A7.E17.m1.2.2.1.3">ReLU</mtext></ci><apply id="A7.E17.m1.2.2.1.1.1.1.cmml" xref="A7.E17.m1.2.2.1.1.1"><plus id="A7.E17.m1.2.2.1.1.1.1.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.2"></plus><apply id="A7.E17.m1.2.2.1.1.1.1.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1"><times id="A7.E17.m1.2.2.1.1.1.1.1.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.2"></times><apply id="A7.E17.m1.2.2.1.1.1.1.1.3.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E17.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E17.m1.2.2.1.1.1.1.1.3.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.3.2">𝑊</ci><cn id="A7.E17.m1.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.E17.m1.2.2.1.1.1.1.1.3.3">1</cn></apply><apply id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1"><times id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3a.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3"><mtext id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.3">ReLU</mtext></ci><apply id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1"><plus id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><times id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><cn id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3">2</cn></apply><ci id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply><apply id="A7.E17.m1.2.2.1.1.1.1.3.cmml" xref="A7.E17.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E17.m1.2.2.1.1.1.1.3.1.cmml" xref="A7.E17.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A7.E17.m1.2.2.1.1.1.1.3.2.cmml" xref="A7.E17.m1.2.2.1.1.1.1.3.2">𝑏</ci><cn id="A7.E17.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="A7.E17.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E17.m1.2c">\text{FFN}(X)=\text{ReLU}(W_{1}(\text{ReLU}(W_{2}x+b_{2}))+b_{1})</annotation><annotation encoding="application/x-llamapun" id="A7.E17.m1.2d">FFN ( italic_X ) = ReLU ( italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( ReLU ( italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_x + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) + italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p8.3">where <math alttext="W_{1}\in\mathbb{R}^{d\times 4d}" class="ltx_Math" display="inline" id="A7.p8.1.m1.1"><semantics id="A7.p8.1.m1.1a"><mrow id="A7.p8.1.m1.1.1" xref="A7.p8.1.m1.1.1.cmml"><msub id="A7.p8.1.m1.1.1.2" xref="A7.p8.1.m1.1.1.2.cmml"><mi id="A7.p8.1.m1.1.1.2.2" xref="A7.p8.1.m1.1.1.2.2.cmml">W</mi><mn id="A7.p8.1.m1.1.1.2.3" xref="A7.p8.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="A7.p8.1.m1.1.1.1" xref="A7.p8.1.m1.1.1.1.cmml">∈</mo><msup id="A7.p8.1.m1.1.1.3" xref="A7.p8.1.m1.1.1.3.cmml"><mi id="A7.p8.1.m1.1.1.3.2" xref="A7.p8.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A7.p8.1.m1.1.1.3.3" xref="A7.p8.1.m1.1.1.3.3.cmml"><mrow id="A7.p8.1.m1.1.1.3.3.2" xref="A7.p8.1.m1.1.1.3.3.2.cmml"><mi id="A7.p8.1.m1.1.1.3.3.2.2" xref="A7.p8.1.m1.1.1.3.3.2.2.cmml">d</mi><mo id="A7.p8.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A7.p8.1.m1.1.1.3.3.2.1.cmml">×</mo><mn id="A7.p8.1.m1.1.1.3.3.2.3" xref="A7.p8.1.m1.1.1.3.3.2.3.cmml">4</mn></mrow><mo id="A7.p8.1.m1.1.1.3.3.1" xref="A7.p8.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A7.p8.1.m1.1.1.3.3.3" xref="A7.p8.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A7.p8.1.m1.1b"><apply id="A7.p8.1.m1.1.1.cmml" xref="A7.p8.1.m1.1.1"><in id="A7.p8.1.m1.1.1.1.cmml" xref="A7.p8.1.m1.1.1.1"></in><apply id="A7.p8.1.m1.1.1.2.cmml" xref="A7.p8.1.m1.1.1.2"><csymbol cd="ambiguous" id="A7.p8.1.m1.1.1.2.1.cmml" xref="A7.p8.1.m1.1.1.2">subscript</csymbol><ci id="A7.p8.1.m1.1.1.2.2.cmml" xref="A7.p8.1.m1.1.1.2.2">𝑊</ci><cn id="A7.p8.1.m1.1.1.2.3.cmml" type="integer" xref="A7.p8.1.m1.1.1.2.3">1</cn></apply><apply id="A7.p8.1.m1.1.1.3.cmml" xref="A7.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="A7.p8.1.m1.1.1.3.1.cmml" xref="A7.p8.1.m1.1.1.3">superscript</csymbol><ci id="A7.p8.1.m1.1.1.3.2.cmml" xref="A7.p8.1.m1.1.1.3.2">ℝ</ci><apply id="A7.p8.1.m1.1.1.3.3.cmml" xref="A7.p8.1.m1.1.1.3.3"><times id="A7.p8.1.m1.1.1.3.3.1.cmml" xref="A7.p8.1.m1.1.1.3.3.1"></times><apply id="A7.p8.1.m1.1.1.3.3.2.cmml" xref="A7.p8.1.m1.1.1.3.3.2"><times id="A7.p8.1.m1.1.1.3.3.2.1.cmml" xref="A7.p8.1.m1.1.1.3.3.2.1"></times><ci id="A7.p8.1.m1.1.1.3.3.2.2.cmml" xref="A7.p8.1.m1.1.1.3.3.2.2">𝑑</ci><cn id="A7.p8.1.m1.1.1.3.3.2.3.cmml" type="integer" xref="A7.p8.1.m1.1.1.3.3.2.3">4</cn></apply><ci id="A7.p8.1.m1.1.1.3.3.3.cmml" xref="A7.p8.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p8.1.m1.1c">W_{1}\in\mathbb{R}^{d\times 4d}</annotation><annotation encoding="application/x-llamapun" id="A7.p8.1.m1.1d">italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 4 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{2}\in\mathbb{R}^{4d\times d}" class="ltx_Math" display="inline" id="A7.p8.2.m2.1"><semantics id="A7.p8.2.m2.1a"><mrow id="A7.p8.2.m2.1.1" xref="A7.p8.2.m2.1.1.cmml"><msub id="A7.p8.2.m2.1.1.2" xref="A7.p8.2.m2.1.1.2.cmml"><mi id="A7.p8.2.m2.1.1.2.2" xref="A7.p8.2.m2.1.1.2.2.cmml">W</mi><mn id="A7.p8.2.m2.1.1.2.3" xref="A7.p8.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="A7.p8.2.m2.1.1.1" xref="A7.p8.2.m2.1.1.1.cmml">∈</mo><msup id="A7.p8.2.m2.1.1.3" xref="A7.p8.2.m2.1.1.3.cmml"><mi id="A7.p8.2.m2.1.1.3.2" xref="A7.p8.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A7.p8.2.m2.1.1.3.3" xref="A7.p8.2.m2.1.1.3.3.cmml"><mrow id="A7.p8.2.m2.1.1.3.3.2" xref="A7.p8.2.m2.1.1.3.3.2.cmml"><mn id="A7.p8.2.m2.1.1.3.3.2.2" xref="A7.p8.2.m2.1.1.3.3.2.2.cmml">4</mn><mo id="A7.p8.2.m2.1.1.3.3.2.1" xref="A7.p8.2.m2.1.1.3.3.2.1.cmml">⁢</mo><mi id="A7.p8.2.m2.1.1.3.3.2.3" xref="A7.p8.2.m2.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="A7.p8.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A7.p8.2.m2.1.1.3.3.1.cmml">×</mo><mi id="A7.p8.2.m2.1.1.3.3.3" xref="A7.p8.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A7.p8.2.m2.1b"><apply id="A7.p8.2.m2.1.1.cmml" xref="A7.p8.2.m2.1.1"><in id="A7.p8.2.m2.1.1.1.cmml" xref="A7.p8.2.m2.1.1.1"></in><apply id="A7.p8.2.m2.1.1.2.cmml" xref="A7.p8.2.m2.1.1.2"><csymbol cd="ambiguous" id="A7.p8.2.m2.1.1.2.1.cmml" xref="A7.p8.2.m2.1.1.2">subscript</csymbol><ci id="A7.p8.2.m2.1.1.2.2.cmml" xref="A7.p8.2.m2.1.1.2.2">𝑊</ci><cn id="A7.p8.2.m2.1.1.2.3.cmml" type="integer" xref="A7.p8.2.m2.1.1.2.3">2</cn></apply><apply id="A7.p8.2.m2.1.1.3.cmml" xref="A7.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="A7.p8.2.m2.1.1.3.1.cmml" xref="A7.p8.2.m2.1.1.3">superscript</csymbol><ci id="A7.p8.2.m2.1.1.3.2.cmml" xref="A7.p8.2.m2.1.1.3.2">ℝ</ci><apply id="A7.p8.2.m2.1.1.3.3.cmml" xref="A7.p8.2.m2.1.1.3.3"><times id="A7.p8.2.m2.1.1.3.3.1.cmml" xref="A7.p8.2.m2.1.1.3.3.1"></times><apply id="A7.p8.2.m2.1.1.3.3.2.cmml" xref="A7.p8.2.m2.1.1.3.3.2"><times id="A7.p8.2.m2.1.1.3.3.2.1.cmml" xref="A7.p8.2.m2.1.1.3.3.2.1"></times><cn id="A7.p8.2.m2.1.1.3.3.2.2.cmml" type="integer" xref="A7.p8.2.m2.1.1.3.3.2.2">4</cn><ci id="A7.p8.2.m2.1.1.3.3.2.3.cmml" xref="A7.p8.2.m2.1.1.3.3.2.3">𝑑</ci></apply><ci id="A7.p8.2.m2.1.1.3.3.3.cmml" xref="A7.p8.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p8.2.m2.1c">W_{2}\in\mathbb{R}^{4d\times d}</annotation><annotation encoding="application/x-llamapun" id="A7.p8.2.m2.1d">italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
For small perturbations <math alttext="\Delta W_{1},\Delta W_{2},\Delta b_{1},\Delta b_{2}" class="ltx_Math" display="inline" id="A7.p8.3.m3.4"><semantics id="A7.p8.3.m3.4a"><mrow id="A7.p8.3.m3.4.4.4" xref="A7.p8.3.m3.4.4.5.cmml"><mrow id="A7.p8.3.m3.1.1.1.1" xref="A7.p8.3.m3.1.1.1.1.cmml"><mi id="A7.p8.3.m3.1.1.1.1.2" mathvariant="normal" xref="A7.p8.3.m3.1.1.1.1.2.cmml">Δ</mi><mo id="A7.p8.3.m3.1.1.1.1.1" xref="A7.p8.3.m3.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p8.3.m3.1.1.1.1.3" xref="A7.p8.3.m3.1.1.1.1.3.cmml"><mi id="A7.p8.3.m3.1.1.1.1.3.2" xref="A7.p8.3.m3.1.1.1.1.3.2.cmml">W</mi><mn id="A7.p8.3.m3.1.1.1.1.3.3" xref="A7.p8.3.m3.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.p8.3.m3.4.4.4.5" xref="A7.p8.3.m3.4.4.5.cmml">,</mo><mrow id="A7.p8.3.m3.2.2.2.2" xref="A7.p8.3.m3.2.2.2.2.cmml"><mi id="A7.p8.3.m3.2.2.2.2.2" mathvariant="normal" xref="A7.p8.3.m3.2.2.2.2.2.cmml">Δ</mi><mo id="A7.p8.3.m3.2.2.2.2.1" xref="A7.p8.3.m3.2.2.2.2.1.cmml">⁢</mo><msub id="A7.p8.3.m3.2.2.2.2.3" xref="A7.p8.3.m3.2.2.2.2.3.cmml"><mi id="A7.p8.3.m3.2.2.2.2.3.2" xref="A7.p8.3.m3.2.2.2.2.3.2.cmml">W</mi><mn id="A7.p8.3.m3.2.2.2.2.3.3" xref="A7.p8.3.m3.2.2.2.2.3.3.cmml">2</mn></msub></mrow><mo id="A7.p8.3.m3.4.4.4.6" xref="A7.p8.3.m3.4.4.5.cmml">,</mo><mrow id="A7.p8.3.m3.3.3.3.3" xref="A7.p8.3.m3.3.3.3.3.cmml"><mi id="A7.p8.3.m3.3.3.3.3.2" mathvariant="normal" xref="A7.p8.3.m3.3.3.3.3.2.cmml">Δ</mi><mo id="A7.p8.3.m3.3.3.3.3.1" xref="A7.p8.3.m3.3.3.3.3.1.cmml">⁢</mo><msub id="A7.p8.3.m3.3.3.3.3.3" xref="A7.p8.3.m3.3.3.3.3.3.cmml"><mi id="A7.p8.3.m3.3.3.3.3.3.2" xref="A7.p8.3.m3.3.3.3.3.3.2.cmml">b</mi><mn id="A7.p8.3.m3.3.3.3.3.3.3" xref="A7.p8.3.m3.3.3.3.3.3.3.cmml">1</mn></msub></mrow><mo id="A7.p8.3.m3.4.4.4.7" xref="A7.p8.3.m3.4.4.5.cmml">,</mo><mrow id="A7.p8.3.m3.4.4.4.4" xref="A7.p8.3.m3.4.4.4.4.cmml"><mi id="A7.p8.3.m3.4.4.4.4.2" mathvariant="normal" xref="A7.p8.3.m3.4.4.4.4.2.cmml">Δ</mi><mo id="A7.p8.3.m3.4.4.4.4.1" xref="A7.p8.3.m3.4.4.4.4.1.cmml">⁢</mo><msub id="A7.p8.3.m3.4.4.4.4.3" xref="A7.p8.3.m3.4.4.4.4.3.cmml"><mi id="A7.p8.3.m3.4.4.4.4.3.2" xref="A7.p8.3.m3.4.4.4.4.3.2.cmml">b</mi><mn id="A7.p8.3.m3.4.4.4.4.3.3" xref="A7.p8.3.m3.4.4.4.4.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p8.3.m3.4b"><list id="A7.p8.3.m3.4.4.5.cmml" xref="A7.p8.3.m3.4.4.4"><apply id="A7.p8.3.m3.1.1.1.1.cmml" xref="A7.p8.3.m3.1.1.1.1"><times id="A7.p8.3.m3.1.1.1.1.1.cmml" xref="A7.p8.3.m3.1.1.1.1.1"></times><ci id="A7.p8.3.m3.1.1.1.1.2.cmml" xref="A7.p8.3.m3.1.1.1.1.2">Δ</ci><apply id="A7.p8.3.m3.1.1.1.1.3.cmml" xref="A7.p8.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p8.3.m3.1.1.1.1.3.1.cmml" xref="A7.p8.3.m3.1.1.1.1.3">subscript</csymbol><ci id="A7.p8.3.m3.1.1.1.1.3.2.cmml" xref="A7.p8.3.m3.1.1.1.1.3.2">𝑊</ci><cn id="A7.p8.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="A7.p8.3.m3.1.1.1.1.3.3">1</cn></apply></apply><apply id="A7.p8.3.m3.2.2.2.2.cmml" xref="A7.p8.3.m3.2.2.2.2"><times id="A7.p8.3.m3.2.2.2.2.1.cmml" xref="A7.p8.3.m3.2.2.2.2.1"></times><ci id="A7.p8.3.m3.2.2.2.2.2.cmml" xref="A7.p8.3.m3.2.2.2.2.2">Δ</ci><apply id="A7.p8.3.m3.2.2.2.2.3.cmml" xref="A7.p8.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="A7.p8.3.m3.2.2.2.2.3.1.cmml" xref="A7.p8.3.m3.2.2.2.2.3">subscript</csymbol><ci id="A7.p8.3.m3.2.2.2.2.3.2.cmml" xref="A7.p8.3.m3.2.2.2.2.3.2">𝑊</ci><cn id="A7.p8.3.m3.2.2.2.2.3.3.cmml" type="integer" xref="A7.p8.3.m3.2.2.2.2.3.3">2</cn></apply></apply><apply id="A7.p8.3.m3.3.3.3.3.cmml" xref="A7.p8.3.m3.3.3.3.3"><times id="A7.p8.3.m3.3.3.3.3.1.cmml" xref="A7.p8.3.m3.3.3.3.3.1"></times><ci id="A7.p8.3.m3.3.3.3.3.2.cmml" xref="A7.p8.3.m3.3.3.3.3.2">Δ</ci><apply id="A7.p8.3.m3.3.3.3.3.3.cmml" xref="A7.p8.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="A7.p8.3.m3.3.3.3.3.3.1.cmml" xref="A7.p8.3.m3.3.3.3.3.3">subscript</csymbol><ci id="A7.p8.3.m3.3.3.3.3.3.2.cmml" xref="A7.p8.3.m3.3.3.3.3.3.2">𝑏</ci><cn id="A7.p8.3.m3.3.3.3.3.3.3.cmml" type="integer" xref="A7.p8.3.m3.3.3.3.3.3.3">1</cn></apply></apply><apply id="A7.p8.3.m3.4.4.4.4.cmml" xref="A7.p8.3.m3.4.4.4.4"><times id="A7.p8.3.m3.4.4.4.4.1.cmml" xref="A7.p8.3.m3.4.4.4.4.1"></times><ci id="A7.p8.3.m3.4.4.4.4.2.cmml" xref="A7.p8.3.m3.4.4.4.4.2">Δ</ci><apply id="A7.p8.3.m3.4.4.4.4.3.cmml" xref="A7.p8.3.m3.4.4.4.4.3"><csymbol cd="ambiguous" id="A7.p8.3.m3.4.4.4.4.3.1.cmml" xref="A7.p8.3.m3.4.4.4.4.3">subscript</csymbol><ci id="A7.p8.3.m3.4.4.4.4.3.2.cmml" xref="A7.p8.3.m3.4.4.4.4.3.2">𝑏</ci><cn id="A7.p8.3.m3.4.4.4.4.3.3.cmml" type="integer" xref="A7.p8.3.m3.4.4.4.4.3.3">2</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A7.p8.3.m3.4c">\Delta W_{1},\Delta W_{2},\Delta b_{1},\Delta b_{2}</annotation><annotation encoding="application/x-llamapun" id="A7.p8.3.m3.4d">roman_Δ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , roman_Δ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , roman_Δ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , roman_Δ italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, the perturbed FFN output is:</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FFN}_{\Delta}(X)=\text{ReLU}((W_{1}+\Delta W_{1})(\text{ReLU}((W_{2}+%
\Delta W_{2})X+b_{2}+\Delta b_{2}))+b_{1}+\Delta b_{1})" class="ltx_Math" display="block" id="A7.E18.m1.2"><semantics id="A7.E18.m1.2a"><mrow id="A7.E18.m1.2.2" xref="A7.E18.m1.2.2.cmml"><mrow id="A7.E18.m1.2.2.3" xref="A7.E18.m1.2.2.3.cmml"><msub id="A7.E18.m1.2.2.3.2" xref="A7.E18.m1.2.2.3.2.cmml"><mtext id="A7.E18.m1.2.2.3.2.2" xref="A7.E18.m1.2.2.3.2.2a.cmml">FFN</mtext><mi id="A7.E18.m1.2.2.3.2.3" mathvariant="normal" xref="A7.E18.m1.2.2.3.2.3.cmml">Δ</mi></msub><mo id="A7.E18.m1.2.2.3.1" xref="A7.E18.m1.2.2.3.1.cmml">⁢</mo><mrow id="A7.E18.m1.2.2.3.3.2" xref="A7.E18.m1.2.2.3.cmml"><mo id="A7.E18.m1.2.2.3.3.2.1" stretchy="false" xref="A7.E18.m1.2.2.3.cmml">(</mo><mi id="A7.E18.m1.1.1" xref="A7.E18.m1.1.1.cmml">X</mi><mo id="A7.E18.m1.2.2.3.3.2.2" stretchy="false" xref="A7.E18.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A7.E18.m1.2.2.2" xref="A7.E18.m1.2.2.2.cmml">=</mo><mrow id="A7.E18.m1.2.2.1" xref="A7.E18.m1.2.2.1.cmml"><mtext id="A7.E18.m1.2.2.1.3" xref="A7.E18.m1.2.2.1.3a.cmml">ReLU</mtext><mo id="A7.E18.m1.2.2.1.2" xref="A7.E18.m1.2.2.1.2.cmml">⁢</mo><mrow id="A7.E18.m1.2.2.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.cmml"><mo id="A7.E18.m1.2.2.1.1.1.2" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.E18.m1.2.2.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.cmml"><mrow id="A7.E18.m1.2.2.1.1.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.2.cmml"><mrow id="A7.E18.m1.2.2.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="A7.E18.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mn id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.3" xref="A7.E18.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.cmml"><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.2" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.cmml"><mtext id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3a.cmml">ReLU</mtext><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.cmml"><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.2" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.cmml"><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2.cmml">+</mo><msub id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml">b</mi><mn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2a" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2.cmml">+</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.2" mathvariant="normal" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.2.cmml">Δ</mi><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.1" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.2" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.2.cmml">b</mi><mn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.3" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.3" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.2.2.1.3" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.1.3" xref="A7.E18.m1.2.2.1.1.1.1.3.cmml">+</mo><msub id="A7.E18.m1.2.2.1.1.1.1.4" xref="A7.E18.m1.2.2.1.1.1.1.4.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.4.2" xref="A7.E18.m1.2.2.1.1.1.1.4.2.cmml">b</mi><mn id="A7.E18.m1.2.2.1.1.1.1.4.3" xref="A7.E18.m1.2.2.1.1.1.1.4.3.cmml">1</mn></msub><mo id="A7.E18.m1.2.2.1.1.1.1.3a" xref="A7.E18.m1.2.2.1.1.1.1.3.cmml">+</mo><mrow id="A7.E18.m1.2.2.1.1.1.1.5" xref="A7.E18.m1.2.2.1.1.1.1.5.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.5.2" mathvariant="normal" xref="A7.E18.m1.2.2.1.1.1.1.5.2.cmml">Δ</mi><mo id="A7.E18.m1.2.2.1.1.1.1.5.1" xref="A7.E18.m1.2.2.1.1.1.1.5.1.cmml">⁢</mo><msub id="A7.E18.m1.2.2.1.1.1.1.5.3" xref="A7.E18.m1.2.2.1.1.1.1.5.3.cmml"><mi id="A7.E18.m1.2.2.1.1.1.1.5.3.2" xref="A7.E18.m1.2.2.1.1.1.1.5.3.2.cmml">b</mi><mn id="A7.E18.m1.2.2.1.1.1.1.5.3.3" xref="A7.E18.m1.2.2.1.1.1.1.5.3.3.cmml">1</mn></msub></mrow></mrow><mo id="A7.E18.m1.2.2.1.1.1.3" stretchy="false" xref="A7.E18.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E18.m1.2b"><apply id="A7.E18.m1.2.2.cmml" xref="A7.E18.m1.2.2"><eq id="A7.E18.m1.2.2.2.cmml" xref="A7.E18.m1.2.2.2"></eq><apply id="A7.E18.m1.2.2.3.cmml" xref="A7.E18.m1.2.2.3"><times id="A7.E18.m1.2.2.3.1.cmml" xref="A7.E18.m1.2.2.3.1"></times><apply id="A7.E18.m1.2.2.3.2.cmml" xref="A7.E18.m1.2.2.3.2"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.3.2.1.cmml" xref="A7.E18.m1.2.2.3.2">subscript</csymbol><ci id="A7.E18.m1.2.2.3.2.2a.cmml" xref="A7.E18.m1.2.2.3.2.2"><mtext id="A7.E18.m1.2.2.3.2.2.cmml" xref="A7.E18.m1.2.2.3.2.2">FFN</mtext></ci><ci id="A7.E18.m1.2.2.3.2.3.cmml" xref="A7.E18.m1.2.2.3.2.3">Δ</ci></apply><ci id="A7.E18.m1.1.1.cmml" xref="A7.E18.m1.1.1">𝑋</ci></apply><apply id="A7.E18.m1.2.2.1.cmml" xref="A7.E18.m1.2.2.1"><times id="A7.E18.m1.2.2.1.2.cmml" xref="A7.E18.m1.2.2.1.2"></times><ci id="A7.E18.m1.2.2.1.3a.cmml" xref="A7.E18.m1.2.2.1.3"><mtext id="A7.E18.m1.2.2.1.3.cmml" xref="A7.E18.m1.2.2.1.3">ReLU</mtext></ci><apply id="A7.E18.m1.2.2.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1"><plus id="A7.E18.m1.2.2.1.1.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.3"></plus><apply id="A7.E18.m1.2.2.1.1.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2"><times id="A7.E18.m1.2.2.1.1.1.1.2.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.3"></times><apply id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1"><plus id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑊</ci><cn id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3"><times id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.2">Δ</ci><apply id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑊</ci><cn id="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1"><times id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.2"></times><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3a.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3"><mtext id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.3">ReLU</mtext></ci><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1"><plus id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.2"></plus><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1"><times id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.2"></times><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1"><plus id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><cn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3"><times id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">𝑊</ci><cn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.1.3">𝑋</ci></apply><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.2">𝑏</ci><cn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.3.3">2</cn></apply><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4"><times id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.1"></times><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.2">Δ</ci><apply id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.2">𝑏</ci><cn id="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.2.2.1.1.1.1.1.4.3.3">2</cn></apply></apply></apply></apply></apply><apply id="A7.E18.m1.2.2.1.1.1.1.4.cmml" xref="A7.E18.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.4.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.4.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.4.2">𝑏</ci><cn id="A7.E18.m1.2.2.1.1.1.1.4.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.4.3">1</cn></apply><apply id="A7.E18.m1.2.2.1.1.1.1.5.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5"><times id="A7.E18.m1.2.2.1.1.1.1.5.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5.1"></times><ci id="A7.E18.m1.2.2.1.1.1.1.5.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5.2">Δ</ci><apply id="A7.E18.m1.2.2.1.1.1.1.5.3.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5.3"><csymbol cd="ambiguous" id="A7.E18.m1.2.2.1.1.1.1.5.3.1.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5.3">subscript</csymbol><ci id="A7.E18.m1.2.2.1.1.1.1.5.3.2.cmml" xref="A7.E18.m1.2.2.1.1.1.1.5.3.2">𝑏</ci><cn id="A7.E18.m1.2.2.1.1.1.1.5.3.3.cmml" type="integer" xref="A7.E18.m1.2.2.1.1.1.1.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E18.m1.2c">\text{FFN}_{\Delta}(X)=\text{ReLU}((W_{1}+\Delta W_{1})(\text{ReLU}((W_{2}+%
\Delta W_{2})X+b_{2}+\Delta b_{2}))+b_{1}+\Delta b_{1})</annotation><annotation encoding="application/x-llamapun" id="A7.E18.m1.2d">FFN start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ( italic_X ) = ReLU ( ( italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + roman_Δ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ( ReLU ( ( italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + roman_Δ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) italic_X + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + roman_Δ italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) + italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + roman_Δ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p8.5">Similar to the above analysis, we obtain the perturbation bound of FFN modules:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A8.EGx6">
<tbody id="A7.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\|\Delta\text{FFN}(X)\|\leq\|f^{\prime}(Y)XW_{1}f^{\prime}(XW_{2}%
+b_{2})\|\|\Delta W_{2}\|+\|f^{\prime}(Y)W_{1}f^{\prime}(X_{2}+b_{2})\|\|%
\Delta b_{2}\|" class="ltx_Math" display="inline" id="A7.Ex5.m1.8"><semantics id="A7.Ex5.m1.8a"><mrow id="A7.Ex5.m1.8.8" xref="A7.Ex5.m1.8.8.cmml"><mrow id="A7.Ex5.m1.4.4.1.1" xref="A7.Ex5.m1.4.4.1.2.cmml"><mo id="A7.Ex5.m1.4.4.1.1.2" stretchy="false" xref="A7.Ex5.m1.4.4.1.2.1.cmml">‖</mo><mrow id="A7.Ex5.m1.4.4.1.1.1" xref="A7.Ex5.m1.4.4.1.1.1.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.2" mathvariant="normal" xref="A7.Ex5.m1.4.4.1.1.1.2.cmml">Δ</mi><mo id="A7.Ex5.m1.4.4.1.1.1.1" xref="A7.Ex5.m1.4.4.1.1.1.1.cmml">⁢</mo><mtext id="A7.Ex5.m1.4.4.1.1.1.3" xref="A7.Ex5.m1.4.4.1.1.1.3a.cmml">FFN</mtext><mo id="A7.Ex5.m1.4.4.1.1.1.1a" xref="A7.Ex5.m1.4.4.1.1.1.1.cmml">⁢</mo><mrow id="A7.Ex5.m1.4.4.1.1.1.4.2" xref="A7.Ex5.m1.4.4.1.1.1.cmml"><mo id="A7.Ex5.m1.4.4.1.1.1.4.2.1" stretchy="false" xref="A7.Ex5.m1.4.4.1.1.1.cmml">(</mo><mi id="A7.Ex5.m1.1.1" xref="A7.Ex5.m1.1.1.cmml">X</mi><mo id="A7.Ex5.m1.4.4.1.1.1.4.2.2" stretchy="false" xref="A7.Ex5.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex5.m1.4.4.1.1.3" stretchy="false" xref="A7.Ex5.m1.4.4.1.2.1.cmml">‖</mo></mrow><mo id="A7.Ex5.m1.8.8.6" xref="A7.Ex5.m1.8.8.6.cmml">≤</mo><mrow id="A7.Ex5.m1.8.8.5" xref="A7.Ex5.m1.8.8.5.cmml"><mrow id="A7.Ex5.m1.6.6.3.2" xref="A7.Ex5.m1.6.6.3.2.cmml"><mrow id="A7.Ex5.m1.5.5.2.1.1.1" xref="A7.Ex5.m1.5.5.2.1.1.2.cmml"><mo id="A7.Ex5.m1.5.5.2.1.1.1.2" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.2.1.cmml">‖</mo><mrow id="A7.Ex5.m1.5.5.2.1.1.1.1" xref="A7.Ex5.m1.5.5.2.1.1.1.1.cmml"><msup id="A7.Ex5.m1.5.5.2.1.1.1.1.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.3.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3.2.cmml">f</mi><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.3.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3.3.cmml">′</mo></msup><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.Ex5.m1.5.5.2.1.1.1.1.4.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.cmml"><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.4.2.1" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.1.1.cmml">(</mo><mi id="A7.Ex5.m1.2.2" xref="A7.Ex5.m1.2.2.cmml">Y</mi><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.4.2.2" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.1.1.cmml">)</mo></mrow><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.2a" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml">⁢</mo><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.5" xref="A7.Ex5.m1.5.5.2.1.1.1.1.5.cmml">X</mi><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.2b" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml">⁢</mo><msub id="A7.Ex5.m1.5.5.2.1.1.1.1.6" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.6.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6.2.cmml">W</mi><mn id="A7.Ex5.m1.5.5.2.1.1.1.1.6.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6.3.cmml">1</mn></msub><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.2c" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml">⁢</mo><msup id="A7.Ex5.m1.5.5.2.1.1.1.1.7" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.7.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7.2.cmml">f</mi><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.7.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7.3.cmml">′</mo></msup><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.2d" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.2" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mrow id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml">X</mi><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.1" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mn id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.1" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.2" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.3" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.3" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex5.m1.5.5.2.1.1.1.3" stretchy="false" xref="A7.Ex5.m1.5.5.2.1.1.2.1.cmml">‖</mo></mrow><mo id="A7.Ex5.m1.6.6.3.2.3" xref="A7.Ex5.m1.6.6.3.2.3.cmml">⁢</mo><mrow id="A7.Ex5.m1.6.6.3.2.2.1" xref="A7.Ex5.m1.6.6.3.2.2.2.cmml"><mo id="A7.Ex5.m1.6.6.3.2.2.1.2" stretchy="false" xref="A7.Ex5.m1.6.6.3.2.2.2.1.cmml">‖</mo><mrow id="A7.Ex5.m1.6.6.3.2.2.1.1" xref="A7.Ex5.m1.6.6.3.2.2.1.1.cmml"><mi id="A7.Ex5.m1.6.6.3.2.2.1.1.2" mathvariant="normal" xref="A7.Ex5.m1.6.6.3.2.2.1.1.2.cmml">Δ</mi><mo id="A7.Ex5.m1.6.6.3.2.2.1.1.1" xref="A7.Ex5.m1.6.6.3.2.2.1.1.1.cmml">⁢</mo><msub id="A7.Ex5.m1.6.6.3.2.2.1.1.3" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3.cmml"><mi id="A7.Ex5.m1.6.6.3.2.2.1.1.3.2" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3.2.cmml">W</mi><mn id="A7.Ex5.m1.6.6.3.2.2.1.1.3.3" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.Ex5.m1.6.6.3.2.2.1.3" stretchy="false" xref="A7.Ex5.m1.6.6.3.2.2.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.Ex5.m1.8.8.5.5" xref="A7.Ex5.m1.8.8.5.5.cmml">+</mo><mrow id="A7.Ex5.m1.8.8.5.4" xref="A7.Ex5.m1.8.8.5.4.cmml"><mrow id="A7.Ex5.m1.7.7.4.3.1.1" xref="A7.Ex5.m1.7.7.4.3.1.2.cmml"><mo id="A7.Ex5.m1.7.7.4.3.1.1.2" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.2.1.cmml">‖</mo><mrow id="A7.Ex5.m1.7.7.4.3.1.1.1" xref="A7.Ex5.m1.7.7.4.3.1.1.1.cmml"><msup id="A7.Ex5.m1.7.7.4.3.1.1.1.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3.cmml"><mi id="A7.Ex5.m1.7.7.4.3.1.1.1.3.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3.2.cmml">f</mi><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.3.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3.3.cmml">′</mo></msup><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.2.cmml">⁢</mo><mrow id="A7.Ex5.m1.7.7.4.3.1.1.1.4.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.cmml"><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.4.2.1" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.1.1.cmml">(</mo><mi id="A7.Ex5.m1.3.3" xref="A7.Ex5.m1.3.3.cmml">Y</mi><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.4.2.2" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.1.1.cmml">)</mo></mrow><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.2a" xref="A7.Ex5.m1.7.7.4.3.1.1.1.2.cmml">⁢</mo><msub id="A7.Ex5.m1.7.7.4.3.1.1.1.5" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5.cmml"><mi id="A7.Ex5.m1.7.7.4.3.1.1.1.5.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5.2.cmml">W</mi><mn id="A7.Ex5.m1.7.7.4.3.1.1.1.5.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5.3.cmml">1</mn></msub><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.2b" xref="A7.Ex5.m1.7.7.4.3.1.1.1.2.cmml">⁢</mo><msup id="A7.Ex5.m1.7.7.4.3.1.1.1.6" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6.cmml"><mi id="A7.Ex5.m1.7.7.4.3.1.1.1.6.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6.2.cmml">f</mi><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.6.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6.3.cmml">′</mo></msup><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.2c" xref="A7.Ex5.m1.7.7.4.3.1.1.1.2.cmml">⁢</mo><mrow id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.cmml"><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.2" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.cmml"><msub id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.cmml"><mi id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.2.cmml">X</mi><mn id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.1" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.1.cmml">+</mo><msub id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.2" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.3" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.3" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex5.m1.7.7.4.3.1.1.3" stretchy="false" xref="A7.Ex5.m1.7.7.4.3.1.2.1.cmml">‖</mo></mrow><mo id="A7.Ex5.m1.8.8.5.4.3" xref="A7.Ex5.m1.8.8.5.4.3.cmml">⁢</mo><mrow id="A7.Ex5.m1.8.8.5.4.2.1" xref="A7.Ex5.m1.8.8.5.4.2.2.cmml"><mo id="A7.Ex5.m1.8.8.5.4.2.1.2" stretchy="false" xref="A7.Ex5.m1.8.8.5.4.2.2.1.cmml">‖</mo><mrow id="A7.Ex5.m1.8.8.5.4.2.1.1" xref="A7.Ex5.m1.8.8.5.4.2.1.1.cmml"><mi id="A7.Ex5.m1.8.8.5.4.2.1.1.2" mathvariant="normal" xref="A7.Ex5.m1.8.8.5.4.2.1.1.2.cmml">Δ</mi><mo id="A7.Ex5.m1.8.8.5.4.2.1.1.1" xref="A7.Ex5.m1.8.8.5.4.2.1.1.1.cmml">⁢</mo><msub id="A7.Ex5.m1.8.8.5.4.2.1.1.3" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3.cmml"><mi id="A7.Ex5.m1.8.8.5.4.2.1.1.3.2" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3.2.cmml">b</mi><mn id="A7.Ex5.m1.8.8.5.4.2.1.1.3.3" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.Ex5.m1.8.8.5.4.2.1.3" stretchy="false" xref="A7.Ex5.m1.8.8.5.4.2.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex5.m1.8b"><apply id="A7.Ex5.m1.8.8.cmml" xref="A7.Ex5.m1.8.8"><leq id="A7.Ex5.m1.8.8.6.cmml" xref="A7.Ex5.m1.8.8.6"></leq><apply id="A7.Ex5.m1.4.4.1.2.cmml" xref="A7.Ex5.m1.4.4.1.1"><csymbol cd="latexml" id="A7.Ex5.m1.4.4.1.2.1.cmml" xref="A7.Ex5.m1.4.4.1.1.2">norm</csymbol><apply id="A7.Ex5.m1.4.4.1.1.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1"><times id="A7.Ex5.m1.4.4.1.1.1.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1"></times><ci id="A7.Ex5.m1.4.4.1.1.1.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2">Δ</ci><ci id="A7.Ex5.m1.4.4.1.1.1.3a.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3"><mtext id="A7.Ex5.m1.4.4.1.1.1.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3">FFN</mtext></ci><ci id="A7.Ex5.m1.1.1.cmml" xref="A7.Ex5.m1.1.1">𝑋</ci></apply></apply><apply id="A7.Ex5.m1.8.8.5.cmml" xref="A7.Ex5.m1.8.8.5"><plus id="A7.Ex5.m1.8.8.5.5.cmml" xref="A7.Ex5.m1.8.8.5.5"></plus><apply id="A7.Ex5.m1.6.6.3.2.cmml" xref="A7.Ex5.m1.6.6.3.2"><times id="A7.Ex5.m1.6.6.3.2.3.cmml" xref="A7.Ex5.m1.6.6.3.2.3"></times><apply id="A7.Ex5.m1.5.5.2.1.1.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1"><csymbol cd="latexml" id="A7.Ex5.m1.5.5.2.1.1.2.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.2">norm</csymbol><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1"><times id="A7.Ex5.m1.5.5.2.1.1.1.1.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.2"></times><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.3.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.5.5.2.1.1.1.1.3.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3">superscript</csymbol><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.3.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3.2">𝑓</ci><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.3.3.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.3.3">′</ci></apply><ci id="A7.Ex5.m1.2.2.cmml" xref="A7.Ex5.m1.2.2">𝑌</ci><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.5.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.5">𝑋</ci><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.6.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6"><csymbol cd="ambiguous" id="A7.Ex5.m1.5.5.2.1.1.1.1.6.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6">subscript</csymbol><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.6.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6.2">𝑊</ci><cn id="A7.Ex5.m1.5.5.2.1.1.1.1.6.3.cmml" type="integer" xref="A7.Ex5.m1.5.5.2.1.1.1.1.6.3">1</cn></apply><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.7.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7"><csymbol cd="ambiguous" id="A7.Ex5.m1.5.5.2.1.1.1.1.7.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7">superscript</csymbol><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.7.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7.2">𝑓</ci><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.7.3.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.7.3">′</ci></apply><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1"><plus id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.1"></plus><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2"><times id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.1"></times><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.2">𝑋</ci><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.2">𝑊</ci><cn id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.Ex5.m1.5.5.2.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply><apply id="A7.Ex5.m1.6.6.3.2.2.2.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1"><csymbol cd="latexml" id="A7.Ex5.m1.6.6.3.2.2.2.1.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.2">norm</csymbol><apply id="A7.Ex5.m1.6.6.3.2.2.1.1.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1"><times id="A7.Ex5.m1.6.6.3.2.2.1.1.1.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1.1"></times><ci id="A7.Ex5.m1.6.6.3.2.2.1.1.2.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1.2">Δ</ci><apply id="A7.Ex5.m1.6.6.3.2.2.1.1.3.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.6.6.3.2.2.1.1.3.1.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3">subscript</csymbol><ci id="A7.Ex5.m1.6.6.3.2.2.1.1.3.2.cmml" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3.2">𝑊</ci><cn id="A7.Ex5.m1.6.6.3.2.2.1.1.3.3.cmml" type="integer" xref="A7.Ex5.m1.6.6.3.2.2.1.1.3.3">2</cn></apply></apply></apply></apply><apply id="A7.Ex5.m1.8.8.5.4.cmml" xref="A7.Ex5.m1.8.8.5.4"><times id="A7.Ex5.m1.8.8.5.4.3.cmml" xref="A7.Ex5.m1.8.8.5.4.3"></times><apply id="A7.Ex5.m1.7.7.4.3.1.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1"><csymbol cd="latexml" id="A7.Ex5.m1.7.7.4.3.1.2.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.2">norm</csymbol><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1"><times id="A7.Ex5.m1.7.7.4.3.1.1.1.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.2"></times><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.3.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.7.7.4.3.1.1.1.3.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3">superscript</csymbol><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.3.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3.2">𝑓</ci><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.3.3.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.3.3">′</ci></apply><ci id="A7.Ex5.m1.3.3.cmml" xref="A7.Ex5.m1.3.3">𝑌</ci><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.5.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5"><csymbol cd="ambiguous" id="A7.Ex5.m1.7.7.4.3.1.1.1.5.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5">subscript</csymbol><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.5.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5.2">𝑊</ci><cn id="A7.Ex5.m1.7.7.4.3.1.1.1.5.3.cmml" type="integer" xref="A7.Ex5.m1.7.7.4.3.1.1.1.5.3">1</cn></apply><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.6.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6"><csymbol cd="ambiguous" id="A7.Ex5.m1.7.7.4.3.1.1.1.6.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6">superscript</csymbol><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.6.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6.2">𝑓</ci><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.6.3.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.6.3">′</ci></apply><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1"><plus id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.1"></plus><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.2">𝑋</ci><cn id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.2.3">2</cn></apply><apply id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.Ex5.m1.7.7.4.3.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply><apply id="A7.Ex5.m1.8.8.5.4.2.2.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1"><csymbol cd="latexml" id="A7.Ex5.m1.8.8.5.4.2.2.1.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.2">norm</csymbol><apply id="A7.Ex5.m1.8.8.5.4.2.1.1.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1"><times id="A7.Ex5.m1.8.8.5.4.2.1.1.1.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1.1"></times><ci id="A7.Ex5.m1.8.8.5.4.2.1.1.2.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1.2">Δ</ci><apply id="A7.Ex5.m1.8.8.5.4.2.1.1.3.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.8.8.5.4.2.1.1.3.1.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3">subscript</csymbol><ci id="A7.Ex5.m1.8.8.5.4.2.1.1.3.2.cmml" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3.2">𝑏</ci><cn id="A7.Ex5.m1.8.8.5.4.2.1.1.3.3.cmml" type="integer" xref="A7.Ex5.m1.8.8.5.4.2.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex5.m1.8c">\displaystyle\|\Delta\text{FFN}(X)\|\leq\|f^{\prime}(Y)XW_{1}f^{\prime}(XW_{2}%
+b_{2})\|\|\Delta W_{2}\|+\|f^{\prime}(Y)W_{1}f^{\prime}(X_{2}+b_{2})\|\|%
\Delta b_{2}\|</annotation><annotation encoding="application/x-llamapun" id="A7.Ex5.m1.8d">∥ roman_Δ FFN ( italic_X ) ∥ ≤ ∥ italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_Y ) italic_X italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_X italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ ∥ roman_Δ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ + ∥ italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_Y ) italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_X start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ ∥ roman_Δ italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle+\|f^{\prime}(Y)Y\|\|\Delta W_{1}\|+\|f^{\prime}(Y)\|\|\Delta b_{%
1}\|" class="ltx_Math" display="inline" id="A7.Ex6.m1.6"><semantics id="A7.Ex6.m1.6a"><mrow id="A7.Ex6.m1.6.6" xref="A7.Ex6.m1.6.6.cmml"><mrow id="A7.Ex6.m1.4.4.2" xref="A7.Ex6.m1.4.4.2.cmml"><mo id="A7.Ex6.m1.4.4.2a" xref="A7.Ex6.m1.4.4.2.cmml">+</mo><mrow id="A7.Ex6.m1.4.4.2.2" xref="A7.Ex6.m1.4.4.2.2.cmml"><mrow id="A7.Ex6.m1.3.3.1.1.1.1" xref="A7.Ex6.m1.3.3.1.1.1.2.cmml"><mo id="A7.Ex6.m1.3.3.1.1.1.1.2" stretchy="false" xref="A7.Ex6.m1.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A7.Ex6.m1.3.3.1.1.1.1.1" xref="A7.Ex6.m1.3.3.1.1.1.1.1.cmml"><msup id="A7.Ex6.m1.3.3.1.1.1.1.1.2" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2.cmml"><mi id="A7.Ex6.m1.3.3.1.1.1.1.1.2.2" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mo id="A7.Ex6.m1.3.3.1.1.1.1.1.2.3" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="A7.Ex6.m1.3.3.1.1.1.1.1.1" xref="A7.Ex6.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="A7.Ex6.m1.3.3.1.1.1.1.1.3.2" xref="A7.Ex6.m1.3.3.1.1.1.1.1.cmml"><mo id="A7.Ex6.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="A7.Ex6.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="A7.Ex6.m1.1.1" xref="A7.Ex6.m1.1.1.cmml">Y</mi><mo id="A7.Ex6.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="A7.Ex6.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A7.Ex6.m1.3.3.1.1.1.1.1.1a" xref="A7.Ex6.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mi id="A7.Ex6.m1.3.3.1.1.1.1.1.4" xref="A7.Ex6.m1.3.3.1.1.1.1.1.4.cmml">Y</mi></mrow><mo id="A7.Ex6.m1.3.3.1.1.1.1.3" stretchy="false" xref="A7.Ex6.m1.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A7.Ex6.m1.4.4.2.2.3" xref="A7.Ex6.m1.4.4.2.2.3.cmml">⁢</mo><mrow id="A7.Ex6.m1.4.4.2.2.2.1" xref="A7.Ex6.m1.4.4.2.2.2.2.cmml"><mo id="A7.Ex6.m1.4.4.2.2.2.1.2" stretchy="false" xref="A7.Ex6.m1.4.4.2.2.2.2.1.cmml">‖</mo><mrow id="A7.Ex6.m1.4.4.2.2.2.1.1" xref="A7.Ex6.m1.4.4.2.2.2.1.1.cmml"><mi id="A7.Ex6.m1.4.4.2.2.2.1.1.2" mathvariant="normal" xref="A7.Ex6.m1.4.4.2.2.2.1.1.2.cmml">Δ</mi><mo id="A7.Ex6.m1.4.4.2.2.2.1.1.1" xref="A7.Ex6.m1.4.4.2.2.2.1.1.1.cmml">⁢</mo><msub id="A7.Ex6.m1.4.4.2.2.2.1.1.3" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3.cmml"><mi id="A7.Ex6.m1.4.4.2.2.2.1.1.3.2" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3.2.cmml">W</mi><mn id="A7.Ex6.m1.4.4.2.2.2.1.1.3.3" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.Ex6.m1.4.4.2.2.2.1.3" stretchy="false" xref="A7.Ex6.m1.4.4.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="A7.Ex6.m1.6.6.5" xref="A7.Ex6.m1.6.6.5.cmml">+</mo><mrow id="A7.Ex6.m1.6.6.4" xref="A7.Ex6.m1.6.6.4.cmml"><mrow id="A7.Ex6.m1.5.5.3.1.1" xref="A7.Ex6.m1.5.5.3.1.2.cmml"><mo id="A7.Ex6.m1.5.5.3.1.1.2" stretchy="false" xref="A7.Ex6.m1.5.5.3.1.2.1.cmml">‖</mo><mrow id="A7.Ex6.m1.5.5.3.1.1.1" xref="A7.Ex6.m1.5.5.3.1.1.1.cmml"><msup id="A7.Ex6.m1.5.5.3.1.1.1.2" xref="A7.Ex6.m1.5.5.3.1.1.1.2.cmml"><mi id="A7.Ex6.m1.5.5.3.1.1.1.2.2" xref="A7.Ex6.m1.5.5.3.1.1.1.2.2.cmml">f</mi><mo id="A7.Ex6.m1.5.5.3.1.1.1.2.3" xref="A7.Ex6.m1.5.5.3.1.1.1.2.3.cmml">′</mo></msup><mo id="A7.Ex6.m1.5.5.3.1.1.1.1" xref="A7.Ex6.m1.5.5.3.1.1.1.1.cmml">⁢</mo><mrow id="A7.Ex6.m1.5.5.3.1.1.1.3.2" xref="A7.Ex6.m1.5.5.3.1.1.1.cmml"><mo id="A7.Ex6.m1.5.5.3.1.1.1.3.2.1" stretchy="false" xref="A7.Ex6.m1.5.5.3.1.1.1.cmml">(</mo><mi id="A7.Ex6.m1.2.2" xref="A7.Ex6.m1.2.2.cmml">Y</mi><mo id="A7.Ex6.m1.5.5.3.1.1.1.3.2.2" stretchy="false" xref="A7.Ex6.m1.5.5.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex6.m1.5.5.3.1.1.3" stretchy="false" xref="A7.Ex6.m1.5.5.3.1.2.1.cmml">‖</mo></mrow><mo id="A7.Ex6.m1.6.6.4.3" xref="A7.Ex6.m1.6.6.4.3.cmml">⁢</mo><mrow id="A7.Ex6.m1.6.6.4.2.1" xref="A7.Ex6.m1.6.6.4.2.2.cmml"><mo id="A7.Ex6.m1.6.6.4.2.1.2" stretchy="false" xref="A7.Ex6.m1.6.6.4.2.2.1.cmml">‖</mo><mrow id="A7.Ex6.m1.6.6.4.2.1.1" xref="A7.Ex6.m1.6.6.4.2.1.1.cmml"><mi id="A7.Ex6.m1.6.6.4.2.1.1.2" mathvariant="normal" xref="A7.Ex6.m1.6.6.4.2.1.1.2.cmml">Δ</mi><mo id="A7.Ex6.m1.6.6.4.2.1.1.1" xref="A7.Ex6.m1.6.6.4.2.1.1.1.cmml">⁢</mo><msub id="A7.Ex6.m1.6.6.4.2.1.1.3" xref="A7.Ex6.m1.6.6.4.2.1.1.3.cmml"><mi id="A7.Ex6.m1.6.6.4.2.1.1.3.2" xref="A7.Ex6.m1.6.6.4.2.1.1.3.2.cmml">b</mi><mn id="A7.Ex6.m1.6.6.4.2.1.1.3.3" xref="A7.Ex6.m1.6.6.4.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.Ex6.m1.6.6.4.2.1.3" stretchy="false" xref="A7.Ex6.m1.6.6.4.2.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex6.m1.6b"><apply id="A7.Ex6.m1.6.6.cmml" xref="A7.Ex6.m1.6.6"><plus id="A7.Ex6.m1.6.6.5.cmml" xref="A7.Ex6.m1.6.6.5"></plus><apply id="A7.Ex6.m1.4.4.2.cmml" xref="A7.Ex6.m1.4.4.2"><plus id="A7.Ex6.m1.4.4.2.3.cmml" xref="A7.Ex6.m1.4.4.2"></plus><apply id="A7.Ex6.m1.4.4.2.2.cmml" xref="A7.Ex6.m1.4.4.2.2"><times id="A7.Ex6.m1.4.4.2.2.3.cmml" xref="A7.Ex6.m1.4.4.2.2.3"></times><apply id="A7.Ex6.m1.3.3.1.1.1.2.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A7.Ex6.m1.3.3.1.1.1.2.1.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.2">norm</csymbol><apply id="A7.Ex6.m1.3.3.1.1.1.1.1.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1"><times id="A7.Ex6.m1.3.3.1.1.1.1.1.1.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.1"></times><apply id="A7.Ex6.m1.3.3.1.1.1.1.1.2.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex6.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="A7.Ex6.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="A7.Ex6.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.2.3">′</ci></apply><ci id="A7.Ex6.m1.1.1.cmml" xref="A7.Ex6.m1.1.1">𝑌</ci><ci id="A7.Ex6.m1.3.3.1.1.1.1.1.4.cmml" xref="A7.Ex6.m1.3.3.1.1.1.1.1.4">𝑌</ci></apply></apply><apply id="A7.Ex6.m1.4.4.2.2.2.2.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1"><csymbol cd="latexml" id="A7.Ex6.m1.4.4.2.2.2.2.1.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.2">norm</csymbol><apply id="A7.Ex6.m1.4.4.2.2.2.1.1.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1"><times id="A7.Ex6.m1.4.4.2.2.2.1.1.1.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1.1"></times><ci id="A7.Ex6.m1.4.4.2.2.2.1.1.2.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1.2">Δ</ci><apply id="A7.Ex6.m1.4.4.2.2.2.1.1.3.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A7.Ex6.m1.4.4.2.2.2.1.1.3.1.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="A7.Ex6.m1.4.4.2.2.2.1.1.3.2.cmml" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3.2">𝑊</ci><cn id="A7.Ex6.m1.4.4.2.2.2.1.1.3.3.cmml" type="integer" xref="A7.Ex6.m1.4.4.2.2.2.1.1.3.3">1</cn></apply></apply></apply></apply></apply><apply id="A7.Ex6.m1.6.6.4.cmml" xref="A7.Ex6.m1.6.6.4"><times id="A7.Ex6.m1.6.6.4.3.cmml" xref="A7.Ex6.m1.6.6.4.3"></times><apply id="A7.Ex6.m1.5.5.3.1.2.cmml" xref="A7.Ex6.m1.5.5.3.1.1"><csymbol cd="latexml" id="A7.Ex6.m1.5.5.3.1.2.1.cmml" xref="A7.Ex6.m1.5.5.3.1.1.2">norm</csymbol><apply id="A7.Ex6.m1.5.5.3.1.1.1.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1"><times id="A7.Ex6.m1.5.5.3.1.1.1.1.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1.1"></times><apply id="A7.Ex6.m1.5.5.3.1.1.1.2.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex6.m1.5.5.3.1.1.1.2.1.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1.2">superscript</csymbol><ci id="A7.Ex6.m1.5.5.3.1.1.1.2.2.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1.2.2">𝑓</ci><ci id="A7.Ex6.m1.5.5.3.1.1.1.2.3.cmml" xref="A7.Ex6.m1.5.5.3.1.1.1.2.3">′</ci></apply><ci id="A7.Ex6.m1.2.2.cmml" xref="A7.Ex6.m1.2.2">𝑌</ci></apply></apply><apply id="A7.Ex6.m1.6.6.4.2.2.cmml" xref="A7.Ex6.m1.6.6.4.2.1"><csymbol cd="latexml" id="A7.Ex6.m1.6.6.4.2.2.1.cmml" xref="A7.Ex6.m1.6.6.4.2.1.2">norm</csymbol><apply id="A7.Ex6.m1.6.6.4.2.1.1.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1"><times id="A7.Ex6.m1.6.6.4.2.1.1.1.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1.1"></times><ci id="A7.Ex6.m1.6.6.4.2.1.1.2.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1.2">Δ</ci><apply id="A7.Ex6.m1.6.6.4.2.1.1.3.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1.3"><csymbol cd="ambiguous" id="A7.Ex6.m1.6.6.4.2.1.1.3.1.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1.3">subscript</csymbol><ci id="A7.Ex6.m1.6.6.4.2.1.1.3.2.cmml" xref="A7.Ex6.m1.6.6.4.2.1.1.3.2">𝑏</ci><cn id="A7.Ex6.m1.6.6.4.2.1.1.3.3.cmml" type="integer" xref="A7.Ex6.m1.6.6.4.2.1.1.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex6.m1.6c">\displaystyle+\|f^{\prime}(Y)Y\|\|\Delta W_{1}\|+\|f^{\prime}(Y)\|\|\Delta b_{%
1}\|</annotation><annotation encoding="application/x-llamapun" id="A7.Ex6.m1.6d">+ ∥ italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_Y ) italic_Y ∥ ∥ roman_Δ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ + ∥ italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_Y ) ∥ ∥ roman_Δ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A7.p9">
<p class="ltx_p" id="A7.p9.5">where <math alttext="f^{\prime}" class="ltx_Math" display="inline" id="A7.p9.1.m1.1"><semantics id="A7.p9.1.m1.1a"><msup id="A7.p9.1.m1.1.1" xref="A7.p9.1.m1.1.1.cmml"><mi id="A7.p9.1.m1.1.1.2" xref="A7.p9.1.m1.1.1.2.cmml">f</mi><mo id="A7.p9.1.m1.1.1.3" xref="A7.p9.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A7.p9.1.m1.1b"><apply id="A7.p9.1.m1.1.1.cmml" xref="A7.p9.1.m1.1.1"><csymbol cd="ambiguous" id="A7.p9.1.m1.1.1.1.cmml" xref="A7.p9.1.m1.1.1">superscript</csymbol><ci id="A7.p9.1.m1.1.1.2.cmml" xref="A7.p9.1.m1.1.1.2">𝑓</ci><ci id="A7.p9.1.m1.1.1.3.cmml" xref="A7.p9.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p9.1.m1.1c">f^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A7.p9.1.m1.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the derivative of <span class="ltx_text ltx_markedasmath" id="A7.p9.5.1">ReLU</span> and <math alttext="Y=\text{ReLU}(XW_{2}+b_{2})" class="ltx_Math" display="inline" id="A7.p9.3.m3.1"><semantics id="A7.p9.3.m3.1a"><mrow id="A7.p9.3.m3.1.1" xref="A7.p9.3.m3.1.1.cmml"><mi id="A7.p9.3.m3.1.1.3" xref="A7.p9.3.m3.1.1.3.cmml">Y</mi><mo id="A7.p9.3.m3.1.1.2" xref="A7.p9.3.m3.1.1.2.cmml">=</mo><mrow id="A7.p9.3.m3.1.1.1" xref="A7.p9.3.m3.1.1.1.cmml"><mtext id="A7.p9.3.m3.1.1.1.3" xref="A7.p9.3.m3.1.1.1.3a.cmml">ReLU</mtext><mo id="A7.p9.3.m3.1.1.1.2" xref="A7.p9.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="A7.p9.3.m3.1.1.1.1.1" xref="A7.p9.3.m3.1.1.1.1.1.1.cmml"><mo id="A7.p9.3.m3.1.1.1.1.1.2" stretchy="false" xref="A7.p9.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.p9.3.m3.1.1.1.1.1.1" xref="A7.p9.3.m3.1.1.1.1.1.1.cmml"><mrow id="A7.p9.3.m3.1.1.1.1.1.1.2" xref="A7.p9.3.m3.1.1.1.1.1.1.2.cmml"><mi id="A7.p9.3.m3.1.1.1.1.1.1.2.2" xref="A7.p9.3.m3.1.1.1.1.1.1.2.2.cmml">X</mi><mo id="A7.p9.3.m3.1.1.1.1.1.1.2.1" xref="A7.p9.3.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A7.p9.3.m3.1.1.1.1.1.1.2.3" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3.cmml"><mi id="A7.p9.3.m3.1.1.1.1.1.1.2.3.2" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3.2.cmml">W</mi><mn id="A7.p9.3.m3.1.1.1.1.1.1.2.3.3" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="A7.p9.3.m3.1.1.1.1.1.1.1" xref="A7.p9.3.m3.1.1.1.1.1.1.1.cmml">+</mo><msub id="A7.p9.3.m3.1.1.1.1.1.1.3" xref="A7.p9.3.m3.1.1.1.1.1.1.3.cmml"><mi id="A7.p9.3.m3.1.1.1.1.1.1.3.2" xref="A7.p9.3.m3.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A7.p9.3.m3.1.1.1.1.1.1.3.3" xref="A7.p9.3.m3.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.p9.3.m3.1.1.1.1.1.3" stretchy="false" xref="A7.p9.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p9.3.m3.1b"><apply id="A7.p9.3.m3.1.1.cmml" xref="A7.p9.3.m3.1.1"><eq id="A7.p9.3.m3.1.1.2.cmml" xref="A7.p9.3.m3.1.1.2"></eq><ci id="A7.p9.3.m3.1.1.3.cmml" xref="A7.p9.3.m3.1.1.3">𝑌</ci><apply id="A7.p9.3.m3.1.1.1.cmml" xref="A7.p9.3.m3.1.1.1"><times id="A7.p9.3.m3.1.1.1.2.cmml" xref="A7.p9.3.m3.1.1.1.2"></times><ci id="A7.p9.3.m3.1.1.1.3a.cmml" xref="A7.p9.3.m3.1.1.1.3"><mtext id="A7.p9.3.m3.1.1.1.3.cmml" xref="A7.p9.3.m3.1.1.1.3">ReLU</mtext></ci><apply id="A7.p9.3.m3.1.1.1.1.1.1.cmml" xref="A7.p9.3.m3.1.1.1.1.1"><plus id="A7.p9.3.m3.1.1.1.1.1.1.1.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.1"></plus><apply id="A7.p9.3.m3.1.1.1.1.1.1.2.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2"><times id="A7.p9.3.m3.1.1.1.1.1.1.2.1.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2.1"></times><ci id="A7.p9.3.m3.1.1.1.1.1.1.2.2.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2.2">𝑋</ci><apply id="A7.p9.3.m3.1.1.1.1.1.1.2.3.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A7.p9.3.m3.1.1.1.1.1.1.2.3.1.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A7.p9.3.m3.1.1.1.1.1.1.2.3.2.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3.2">𝑊</ci><cn id="A7.p9.3.m3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A7.p9.3.m3.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A7.p9.3.m3.1.1.1.1.1.1.3.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p9.3.m3.1.1.1.1.1.1.3.1.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p9.3.m3.1.1.1.1.1.1.3.2.cmml" xref="A7.p9.3.m3.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A7.p9.3.m3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.p9.3.m3.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p9.3.m3.1c">Y=\text{ReLU}(XW_{2}+b_{2})</annotation><annotation encoding="application/x-llamapun" id="A7.p9.3.m3.1d">italic_Y = ReLU ( italic_X italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> and we simplify the bound as such: <math alttext="\|\Delta\text{FFN}(X)\|\leq C_{ffn}(\|\Delta W_{2}\|+\|\Delta W_{1}\|+\|\Delta
b%
_{1}\|+\|\Delta b_{2}\|)" class="ltx_Math" display="inline" id="A7.p9.4.m4.3"><semantics id="A7.p9.4.m4.3a"><mrow id="A7.p9.4.m4.3.3" xref="A7.p9.4.m4.3.3.cmml"><mrow id="A7.p9.4.m4.2.2.1.1" xref="A7.p9.4.m4.2.2.1.2.cmml"><mo id="A7.p9.4.m4.2.2.1.1.2" stretchy="false" xref="A7.p9.4.m4.2.2.1.2.1.cmml">‖</mo><mrow id="A7.p9.4.m4.2.2.1.1.1" xref="A7.p9.4.m4.2.2.1.1.1.cmml"><mi id="A7.p9.4.m4.2.2.1.1.1.2" mathvariant="normal" xref="A7.p9.4.m4.2.2.1.1.1.2.cmml">Δ</mi><mo id="A7.p9.4.m4.2.2.1.1.1.1" xref="A7.p9.4.m4.2.2.1.1.1.1.cmml">⁢</mo><mtext id="A7.p9.4.m4.2.2.1.1.1.3" xref="A7.p9.4.m4.2.2.1.1.1.3a.cmml">FFN</mtext><mo id="A7.p9.4.m4.2.2.1.1.1.1a" xref="A7.p9.4.m4.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A7.p9.4.m4.2.2.1.1.1.4.2" xref="A7.p9.4.m4.2.2.1.1.1.cmml"><mo id="A7.p9.4.m4.2.2.1.1.1.4.2.1" stretchy="false" xref="A7.p9.4.m4.2.2.1.1.1.cmml">(</mo><mi id="A7.p9.4.m4.1.1" xref="A7.p9.4.m4.1.1.cmml">X</mi><mo id="A7.p9.4.m4.2.2.1.1.1.4.2.2" stretchy="false" xref="A7.p9.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p9.4.m4.2.2.1.1.3" stretchy="false" xref="A7.p9.4.m4.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A7.p9.4.m4.3.3.3" xref="A7.p9.4.m4.3.3.3.cmml">≤</mo><mrow id="A7.p9.4.m4.3.3.2" xref="A7.p9.4.m4.3.3.2.cmml"><msub id="A7.p9.4.m4.3.3.2.3" xref="A7.p9.4.m4.3.3.2.3.cmml"><mi id="A7.p9.4.m4.3.3.2.3.2" xref="A7.p9.4.m4.3.3.2.3.2.cmml">C</mi><mrow id="A7.p9.4.m4.3.3.2.3.3" xref="A7.p9.4.m4.3.3.2.3.3.cmml"><mi id="A7.p9.4.m4.3.3.2.3.3.2" xref="A7.p9.4.m4.3.3.2.3.3.2.cmml">f</mi><mo id="A7.p9.4.m4.3.3.2.3.3.1" xref="A7.p9.4.m4.3.3.2.3.3.1.cmml">⁢</mo><mi id="A7.p9.4.m4.3.3.2.3.3.3" xref="A7.p9.4.m4.3.3.2.3.3.3.cmml">f</mi><mo id="A7.p9.4.m4.3.3.2.3.3.1a" xref="A7.p9.4.m4.3.3.2.3.3.1.cmml">⁢</mo><mi id="A7.p9.4.m4.3.3.2.3.3.4" xref="A7.p9.4.m4.3.3.2.3.3.4.cmml">n</mi></mrow></msub><mo id="A7.p9.4.m4.3.3.2.2" xref="A7.p9.4.m4.3.3.2.2.cmml">⁢</mo><mrow id="A7.p9.4.m4.3.3.2.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.cmml"><mo id="A7.p9.4.m4.3.3.2.1.1.2" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.cmml">(</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.cmml"><mrow id="A7.p9.4.m4.3.3.2.1.1.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.1.2.cmml"><mo id="A7.p9.4.m4.3.3.2.1.1.1.1.1.2" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.2" mathvariant="normal" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.2" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.2.cmml">W</mi><mn id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.3" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.1.1.3" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.5" xref="A7.p9.4.m4.3.3.2.1.1.1.5.cmml">+</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.2.1" xref="A7.p9.4.m4.3.3.2.1.1.1.2.2.cmml"><mo id="A7.p9.4.m4.3.3.2.1.1.1.2.1.2" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.2.2.1.cmml">‖</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.2" mathvariant="normal" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.2.cmml">Δ</mi><mo id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.2" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.2.cmml">W</mi><mn id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.3" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.2.1.3" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.2.2.1.cmml">‖</mo></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.5a" xref="A7.p9.4.m4.3.3.2.1.1.1.5.cmml">+</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.3.1" xref="A7.p9.4.m4.3.3.2.1.1.1.3.2.cmml"><mo id="A7.p9.4.m4.3.3.2.1.1.1.3.1.2" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.3.2.1.cmml">‖</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.2" mathvariant="normal" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.2.cmml">Δ</mi><mo id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.1.cmml">⁢</mo><msub id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.2" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.2.cmml">b</mi><mn id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.3" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.3.1.3" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.3.2.1.cmml">‖</mo></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.5b" xref="A7.p9.4.m4.3.3.2.1.1.1.5.cmml">+</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.4.1" xref="A7.p9.4.m4.3.3.2.1.1.1.4.2.cmml"><mo id="A7.p9.4.m4.3.3.2.1.1.1.4.1.2" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.4.2.1.cmml">‖</mo><mrow id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.2" mathvariant="normal" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.2.cmml">Δ</mi><mo id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.1" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.1.cmml">⁢</mo><msub id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.cmml"><mi id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.2" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.2.cmml">b</mi><mn id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.3" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.1.4.1.3" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.4.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.p9.4.m4.3.3.2.1.1.3" stretchy="false" xref="A7.p9.4.m4.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p9.4.m4.3b"><apply id="A7.p9.4.m4.3.3.cmml" xref="A7.p9.4.m4.3.3"><leq id="A7.p9.4.m4.3.3.3.cmml" xref="A7.p9.4.m4.3.3.3"></leq><apply id="A7.p9.4.m4.2.2.1.2.cmml" xref="A7.p9.4.m4.2.2.1.1"><csymbol cd="latexml" id="A7.p9.4.m4.2.2.1.2.1.cmml" xref="A7.p9.4.m4.2.2.1.1.2">norm</csymbol><apply id="A7.p9.4.m4.2.2.1.1.1.cmml" xref="A7.p9.4.m4.2.2.1.1.1"><times id="A7.p9.4.m4.2.2.1.1.1.1.cmml" xref="A7.p9.4.m4.2.2.1.1.1.1"></times><ci id="A7.p9.4.m4.2.2.1.1.1.2.cmml" xref="A7.p9.4.m4.2.2.1.1.1.2">Δ</ci><ci id="A7.p9.4.m4.2.2.1.1.1.3a.cmml" xref="A7.p9.4.m4.2.2.1.1.1.3"><mtext id="A7.p9.4.m4.2.2.1.1.1.3.cmml" xref="A7.p9.4.m4.2.2.1.1.1.3">FFN</mtext></ci><ci id="A7.p9.4.m4.1.1.cmml" xref="A7.p9.4.m4.1.1">𝑋</ci></apply></apply><apply id="A7.p9.4.m4.3.3.2.cmml" xref="A7.p9.4.m4.3.3.2"><times id="A7.p9.4.m4.3.3.2.2.cmml" xref="A7.p9.4.m4.3.3.2.2"></times><apply id="A7.p9.4.m4.3.3.2.3.cmml" xref="A7.p9.4.m4.3.3.2.3"><csymbol cd="ambiguous" id="A7.p9.4.m4.3.3.2.3.1.cmml" xref="A7.p9.4.m4.3.3.2.3">subscript</csymbol><ci id="A7.p9.4.m4.3.3.2.3.2.cmml" xref="A7.p9.4.m4.3.3.2.3.2">𝐶</ci><apply id="A7.p9.4.m4.3.3.2.3.3.cmml" xref="A7.p9.4.m4.3.3.2.3.3"><times id="A7.p9.4.m4.3.3.2.3.3.1.cmml" xref="A7.p9.4.m4.3.3.2.3.3.1"></times><ci id="A7.p9.4.m4.3.3.2.3.3.2.cmml" xref="A7.p9.4.m4.3.3.2.3.3.2">𝑓</ci><ci id="A7.p9.4.m4.3.3.2.3.3.3.cmml" xref="A7.p9.4.m4.3.3.2.3.3.3">𝑓</ci><ci id="A7.p9.4.m4.3.3.2.3.3.4.cmml" xref="A7.p9.4.m4.3.3.2.3.3.4">𝑛</ci></apply></apply><apply id="A7.p9.4.m4.3.3.2.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1"><plus id="A7.p9.4.m4.3.3.2.1.1.1.5.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.5"></plus><apply id="A7.p9.4.m4.3.3.2.1.1.1.1.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1"><csymbol cd="latexml" id="A7.p9.4.m4.3.3.2.1.1.1.1.2.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.2">norm</csymbol><apply id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1"><times id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.1"></times><ci id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.2">Δ</ci><apply id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.2">𝑊</ci><cn id="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.p9.4.m4.3.3.2.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply><apply id="A7.p9.4.m4.3.3.2.1.1.1.2.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1"><csymbol cd="latexml" id="A7.p9.4.m4.3.3.2.1.1.1.2.2.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.2">norm</csymbol><apply id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1"><times id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.1"></times><ci id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.2">Δ</ci><apply id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3">subscript</csymbol><ci id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.2">𝑊</ci><cn id="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.3.cmml" type="integer" xref="A7.p9.4.m4.3.3.2.1.1.1.2.1.1.3.3">1</cn></apply></apply></apply><apply id="A7.p9.4.m4.3.3.2.1.1.1.3.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1"><csymbol cd="latexml" id="A7.p9.4.m4.3.3.2.1.1.1.3.2.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.2">norm</csymbol><apply id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1"><times id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.1"></times><ci id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.2">Δ</ci><apply id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3">subscript</csymbol><ci id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.2">𝑏</ci><cn id="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.3.cmml" type="integer" xref="A7.p9.4.m4.3.3.2.1.1.1.3.1.1.3.3">1</cn></apply></apply></apply><apply id="A7.p9.4.m4.3.3.2.1.1.1.4.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1"><csymbol cd="latexml" id="A7.p9.4.m4.3.3.2.1.1.1.4.2.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.2">norm</csymbol><apply id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1"><times id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.1"></times><ci id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.2">Δ</ci><apply id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3"><csymbol cd="ambiguous" id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.1.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3">subscript</csymbol><ci id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.2.cmml" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.2">𝑏</ci><cn id="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.3.cmml" type="integer" xref="A7.p9.4.m4.3.3.2.1.1.1.4.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p9.4.m4.3c">\|\Delta\text{FFN}(X)\|\leq C_{ffn}(\|\Delta W_{2}\|+\|\Delta W_{1}\|+\|\Delta
b%
_{1}\|+\|\Delta b_{2}\|)</annotation><annotation encoding="application/x-llamapun" id="A7.p9.4.m4.3d">∥ roman_Δ FFN ( italic_X ) ∥ ≤ italic_C start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT ( ∥ roman_Δ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ + ∥ roman_Δ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ + ∥ roman_Δ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ + ∥ roman_Δ italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ )</annotation></semantics></math> where <math alttext="C_{ffn}=nd\|X\|\cdot\|W_{1}|b_{1}\|\cdot\|W_{2}|b_{2}\|" class="ltx_Math" display="inline" id="A7.p9.5.m5.2"><semantics id="A7.p9.5.m5.2a"><mrow id="A7.p9.5.m5.2.2" xref="A7.p9.5.m5.2.2.cmml"><msub id="A7.p9.5.m5.2.2.3" xref="A7.p9.5.m5.2.2.3.cmml"><mi id="A7.p9.5.m5.2.2.3.2" xref="A7.p9.5.m5.2.2.3.2.cmml">C</mi><mrow id="A7.p9.5.m5.2.2.3.3" xref="A7.p9.5.m5.2.2.3.3.cmml"><mi id="A7.p9.5.m5.2.2.3.3.2" xref="A7.p9.5.m5.2.2.3.3.2.cmml">f</mi><mo id="A7.p9.5.m5.2.2.3.3.1" xref="A7.p9.5.m5.2.2.3.3.1.cmml">⁢</mo><mi id="A7.p9.5.m5.2.2.3.3.3" xref="A7.p9.5.m5.2.2.3.3.3.cmml">f</mi><mo id="A7.p9.5.m5.2.2.3.3.1a" xref="A7.p9.5.m5.2.2.3.3.1.cmml">⁢</mo><mi id="A7.p9.5.m5.2.2.3.3.4" xref="A7.p9.5.m5.2.2.3.3.4.cmml">n</mi></mrow></msub><mo id="A7.p9.5.m5.2.2.2" xref="A7.p9.5.m5.2.2.2.cmml">=</mo><mrow id="A7.p9.5.m5.2.2.1" xref="A7.p9.5.m5.2.2.1.cmml"><mrow id="A7.p9.5.m5.2.2.1.3" xref="A7.p9.5.m5.2.2.1.3.cmml"><mi id="A7.p9.5.m5.2.2.1.3.2" xref="A7.p9.5.m5.2.2.1.3.2.cmml">n</mi><mo id="A7.p9.5.m5.2.2.1.3.1" xref="A7.p9.5.m5.2.2.1.3.1.cmml">⁢</mo><mi id="A7.p9.5.m5.2.2.1.3.3" xref="A7.p9.5.m5.2.2.1.3.3.cmml">d</mi><mo id="A7.p9.5.m5.2.2.1.3.1a" xref="A7.p9.5.m5.2.2.1.3.1.cmml">⁢</mo><mrow id="A7.p9.5.m5.2.2.1.3.4.2" xref="A7.p9.5.m5.2.2.1.3.4.1.cmml"><mo id="A7.p9.5.m5.2.2.1.3.4.2.1" stretchy="false" xref="A7.p9.5.m5.2.2.1.3.4.1.1.cmml">‖</mo><mi id="A7.p9.5.m5.1.1" xref="A7.p9.5.m5.1.1.cmml">X</mi><mo id="A7.p9.5.m5.2.2.1.3.4.2.2" rspace="0.055em" stretchy="false" xref="A7.p9.5.m5.2.2.1.3.4.1.1.cmml">‖</mo></mrow></mrow><mo id="A7.p9.5.m5.2.2.1.2" rspace="0.222em" xref="A7.p9.5.m5.2.2.1.2.cmml">⋅</mo><mrow id="A7.p9.5.m5.2.2.1.1.1" xref="A7.p9.5.m5.2.2.1.1.2.cmml"><mo id="A7.p9.5.m5.2.2.1.1.1.2" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.2.1.cmml">‖</mo><mrow id="A7.p9.5.m5.2.2.1.1.1.1" xref="A7.p9.5.m5.2.2.1.1.1.1.cmml"><mrow id="A7.p9.5.m5.2.2.1.1.1.1.2" xref="A7.p9.5.m5.2.2.1.1.1.1.2.cmml"><mrow id="A7.p9.5.m5.2.2.1.1.1.1.1.1" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.cmml"><msub id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.cmml"><mi id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.2" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.2.cmml">W</mi><mn id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.3" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A7.p9.5.m5.2.2.1.1.1.1.1.1.2" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.2" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.2.cmml">b</mi><mn id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.3" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.p9.5.m5.2.2.1.1.1.1.2.3" rspace="0.222em" xref="A7.p9.5.m5.2.2.1.1.1.1.2.3.cmml">⋅</mo><mrow id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.2.cmml"><mo id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.2" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.2.1.cmml">‖</mo><msub id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.cmml"><mi id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.2" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.2.cmml">W</mi><mn id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.3" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.3.cmml">2</mn></msub><mo id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.3" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.2.1.cmml">|</mo></mrow></mrow><mo id="A7.p9.5.m5.2.2.1.1.1.1.3" xref="A7.p9.5.m5.2.2.1.1.1.1.3.cmml">⁢</mo><msub id="A7.p9.5.m5.2.2.1.1.1.1.4" xref="A7.p9.5.m5.2.2.1.1.1.1.4.cmml"><mi id="A7.p9.5.m5.2.2.1.1.1.1.4.2" xref="A7.p9.5.m5.2.2.1.1.1.1.4.2.cmml">b</mi><mn id="A7.p9.5.m5.2.2.1.1.1.1.4.3" xref="A7.p9.5.m5.2.2.1.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="A7.p9.5.m5.2.2.1.1.1.3" stretchy="false" xref="A7.p9.5.m5.2.2.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p9.5.m5.2b"><apply id="A7.p9.5.m5.2.2.cmml" xref="A7.p9.5.m5.2.2"><eq id="A7.p9.5.m5.2.2.2.cmml" xref="A7.p9.5.m5.2.2.2"></eq><apply id="A7.p9.5.m5.2.2.3.cmml" xref="A7.p9.5.m5.2.2.3"><csymbol cd="ambiguous" id="A7.p9.5.m5.2.2.3.1.cmml" xref="A7.p9.5.m5.2.2.3">subscript</csymbol><ci id="A7.p9.5.m5.2.2.3.2.cmml" xref="A7.p9.5.m5.2.2.3.2">𝐶</ci><apply id="A7.p9.5.m5.2.2.3.3.cmml" xref="A7.p9.5.m5.2.2.3.3"><times id="A7.p9.5.m5.2.2.3.3.1.cmml" xref="A7.p9.5.m5.2.2.3.3.1"></times><ci id="A7.p9.5.m5.2.2.3.3.2.cmml" xref="A7.p9.5.m5.2.2.3.3.2">𝑓</ci><ci id="A7.p9.5.m5.2.2.3.3.3.cmml" xref="A7.p9.5.m5.2.2.3.3.3">𝑓</ci><ci id="A7.p9.5.m5.2.2.3.3.4.cmml" xref="A7.p9.5.m5.2.2.3.3.4">𝑛</ci></apply></apply><apply id="A7.p9.5.m5.2.2.1.cmml" xref="A7.p9.5.m5.2.2.1"><ci id="A7.p9.5.m5.2.2.1.2.cmml" xref="A7.p9.5.m5.2.2.1.2">⋅</ci><apply id="A7.p9.5.m5.2.2.1.3.cmml" xref="A7.p9.5.m5.2.2.1.3"><times id="A7.p9.5.m5.2.2.1.3.1.cmml" xref="A7.p9.5.m5.2.2.1.3.1"></times><ci id="A7.p9.5.m5.2.2.1.3.2.cmml" xref="A7.p9.5.m5.2.2.1.3.2">𝑛</ci><ci id="A7.p9.5.m5.2.2.1.3.3.cmml" xref="A7.p9.5.m5.2.2.1.3.3">𝑑</ci><apply id="A7.p9.5.m5.2.2.1.3.4.1.cmml" xref="A7.p9.5.m5.2.2.1.3.4.2"><csymbol cd="latexml" id="A7.p9.5.m5.2.2.1.3.4.1.1.cmml" xref="A7.p9.5.m5.2.2.1.3.4.2.1">norm</csymbol><ci id="A7.p9.5.m5.1.1.cmml" xref="A7.p9.5.m5.1.1">𝑋</ci></apply></apply><apply id="A7.p9.5.m5.2.2.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1"><csymbol cd="latexml" id="A7.p9.5.m5.2.2.1.1.2.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.2">norm</csymbol><apply id="A7.p9.5.m5.2.2.1.1.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1"><times id="A7.p9.5.m5.2.2.1.1.1.1.3.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.3"></times><apply id="A7.p9.5.m5.2.2.1.1.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2"><ci id="A7.p9.5.m5.2.2.1.1.1.1.2.3.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.3">⋅</ci><apply id="A7.p9.5.m5.2.2.1.1.1.1.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1"><times id="A7.p9.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.2"></times><apply id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.2">𝑊</ci><cn id="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.3.3">1</cn></apply><apply id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.2">delimited-|‖</csymbol><apply id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.2">𝑏</ci><cn id="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A7.p9.5.m5.2.2.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="A7.p9.5.m5.2.2.1.1.1.1.2.2.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1"><csymbol cd="latexml" id="A7.p9.5.m5.2.2.1.1.1.1.2.2.2.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.2">delimited-‖|</csymbol><apply id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.2">𝑊</ci><cn id="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.3.cmml" type="integer" xref="A7.p9.5.m5.2.2.1.1.1.1.2.2.1.1.3">2</cn></apply></apply></apply><apply id="A7.p9.5.m5.2.2.1.1.1.1.4.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A7.p9.5.m5.2.2.1.1.1.1.4.1.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.4">subscript</csymbol><ci id="A7.p9.5.m5.2.2.1.1.1.1.4.2.cmml" xref="A7.p9.5.m5.2.2.1.1.1.1.4.2">𝑏</ci><cn id="A7.p9.5.m5.2.2.1.1.1.1.4.3.cmml" type="integer" xref="A7.p9.5.m5.2.2.1.1.1.1.4.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p9.5.m5.2c">C_{ffn}=nd\|X\|\cdot\|W_{1}|b_{1}\|\cdot\|W_{2}|b_{2}\|</annotation><annotation encoding="application/x-llamapun" id="A7.p9.5.m5.2d">italic_C start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT = italic_n italic_d ∥ italic_X ∥ ⋅ ∥ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ ⋅ ∥ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A7.p10">
<p class="ltx_p" id="A7.p10.2">The SoftMax function’s normalization limits the perturbation’s amplification and hence limits the <math alttext="\|\text{diag}(P)-PP^{\top}\|\leq 1" class="ltx_Math" display="inline" id="A7.p10.1.m1.2"><semantics id="A7.p10.1.m1.2a"><mrow id="A7.p10.1.m1.2.2" xref="A7.p10.1.m1.2.2.cmml"><mrow id="A7.p10.1.m1.2.2.1.1" xref="A7.p10.1.m1.2.2.1.2.cmml"><mo id="A7.p10.1.m1.2.2.1.1.2" stretchy="false" xref="A7.p10.1.m1.2.2.1.2.1.cmml">‖</mo><mrow id="A7.p10.1.m1.2.2.1.1.1" xref="A7.p10.1.m1.2.2.1.1.1.cmml"><mrow id="A7.p10.1.m1.2.2.1.1.1.2" xref="A7.p10.1.m1.2.2.1.1.1.2.cmml"><mtext id="A7.p10.1.m1.2.2.1.1.1.2.2" xref="A7.p10.1.m1.2.2.1.1.1.2.2a.cmml">diag</mtext><mo id="A7.p10.1.m1.2.2.1.1.1.2.1" xref="A7.p10.1.m1.2.2.1.1.1.2.1.cmml">⁢</mo><mrow id="A7.p10.1.m1.2.2.1.1.1.2.3.2" xref="A7.p10.1.m1.2.2.1.1.1.2.cmml"><mo id="A7.p10.1.m1.2.2.1.1.1.2.3.2.1" stretchy="false" xref="A7.p10.1.m1.2.2.1.1.1.2.cmml">(</mo><mi id="A7.p10.1.m1.1.1" xref="A7.p10.1.m1.1.1.cmml">P</mi><mo id="A7.p10.1.m1.2.2.1.1.1.2.3.2.2" stretchy="false" xref="A7.p10.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A7.p10.1.m1.2.2.1.1.1.1" xref="A7.p10.1.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="A7.p10.1.m1.2.2.1.1.1.3" xref="A7.p10.1.m1.2.2.1.1.1.3.cmml"><mi id="A7.p10.1.m1.2.2.1.1.1.3.2" xref="A7.p10.1.m1.2.2.1.1.1.3.2.cmml">P</mi><mo id="A7.p10.1.m1.2.2.1.1.1.3.1" xref="A7.p10.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><msup id="A7.p10.1.m1.2.2.1.1.1.3.3" xref="A7.p10.1.m1.2.2.1.1.1.3.3.cmml"><mi id="A7.p10.1.m1.2.2.1.1.1.3.3.2" xref="A7.p10.1.m1.2.2.1.1.1.3.3.2.cmml">P</mi><mo id="A7.p10.1.m1.2.2.1.1.1.3.3.3" xref="A7.p10.1.m1.2.2.1.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><mo id="A7.p10.1.m1.2.2.1.1.3" stretchy="false" xref="A7.p10.1.m1.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A7.p10.1.m1.2.2.2" xref="A7.p10.1.m1.2.2.2.cmml">≤</mo><mn id="A7.p10.1.m1.2.2.3" xref="A7.p10.1.m1.2.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p10.1.m1.2b"><apply id="A7.p10.1.m1.2.2.cmml" xref="A7.p10.1.m1.2.2"><leq id="A7.p10.1.m1.2.2.2.cmml" xref="A7.p10.1.m1.2.2.2"></leq><apply id="A7.p10.1.m1.2.2.1.2.cmml" xref="A7.p10.1.m1.2.2.1.1"><csymbol cd="latexml" id="A7.p10.1.m1.2.2.1.2.1.cmml" xref="A7.p10.1.m1.2.2.1.1.2">norm</csymbol><apply id="A7.p10.1.m1.2.2.1.1.1.cmml" xref="A7.p10.1.m1.2.2.1.1.1"><minus id="A7.p10.1.m1.2.2.1.1.1.1.cmml" xref="A7.p10.1.m1.2.2.1.1.1.1"></minus><apply id="A7.p10.1.m1.2.2.1.1.1.2.cmml" xref="A7.p10.1.m1.2.2.1.1.1.2"><times id="A7.p10.1.m1.2.2.1.1.1.2.1.cmml" xref="A7.p10.1.m1.2.2.1.1.1.2.1"></times><ci id="A7.p10.1.m1.2.2.1.1.1.2.2a.cmml" xref="A7.p10.1.m1.2.2.1.1.1.2.2"><mtext id="A7.p10.1.m1.2.2.1.1.1.2.2.cmml" xref="A7.p10.1.m1.2.2.1.1.1.2.2">diag</mtext></ci><ci id="A7.p10.1.m1.1.1.cmml" xref="A7.p10.1.m1.1.1">𝑃</ci></apply><apply id="A7.p10.1.m1.2.2.1.1.1.3.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3"><times id="A7.p10.1.m1.2.2.1.1.1.3.1.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.1"></times><ci id="A7.p10.1.m1.2.2.1.1.1.3.2.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.2">𝑃</ci><apply id="A7.p10.1.m1.2.2.1.1.1.3.3.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.p10.1.m1.2.2.1.1.1.3.3.1.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.3">superscript</csymbol><ci id="A7.p10.1.m1.2.2.1.1.1.3.3.2.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.3.2">𝑃</ci><csymbol cd="latexml" id="A7.p10.1.m1.2.2.1.1.1.3.3.3.cmml" xref="A7.p10.1.m1.2.2.1.1.1.3.3.3">top</csymbol></apply></apply></apply></apply><cn id="A7.p10.1.m1.2.2.3.cmml" type="integer" xref="A7.p10.1.m1.2.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p10.1.m1.2c">\|\text{diag}(P)-PP^{\top}\|\leq 1</annotation><annotation encoding="application/x-llamapun" id="A7.p10.1.m1.2d">∥ diag ( italic_P ) - italic_P italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∥ ≤ 1</annotation></semantics></math> and the overall perturbation. Besides, <math alttext="\|X\|_{2}^{2}\sim\chi^{2},\|X\|\ \approx\sqrt{d}" class="ltx_Math" display="inline" id="A7.p10.2.m2.4"><semantics id="A7.p10.2.m2.4a"><mrow id="A7.p10.2.m2.4.4.2" xref="A7.p10.2.m2.4.4.3.cmml"><mrow id="A7.p10.2.m2.3.3.1.1" xref="A7.p10.2.m2.3.3.1.1.cmml"><msubsup id="A7.p10.2.m2.3.3.1.1.2" xref="A7.p10.2.m2.3.3.1.1.2.cmml"><mrow id="A7.p10.2.m2.3.3.1.1.2.2.2.2" xref="A7.p10.2.m2.3.3.1.1.2.2.2.1.cmml"><mo id="A7.p10.2.m2.3.3.1.1.2.2.2.2.1" stretchy="false" xref="A7.p10.2.m2.3.3.1.1.2.2.2.1.1.cmml">‖</mo><mi id="A7.p10.2.m2.1.1" xref="A7.p10.2.m2.1.1.cmml">X</mi><mo id="A7.p10.2.m2.3.3.1.1.2.2.2.2.2" stretchy="false" xref="A7.p10.2.m2.3.3.1.1.2.2.2.1.1.cmml">‖</mo></mrow><mn id="A7.p10.2.m2.3.3.1.1.2.2.3" xref="A7.p10.2.m2.3.3.1.1.2.2.3.cmml">2</mn><mn id="A7.p10.2.m2.3.3.1.1.2.3" xref="A7.p10.2.m2.3.3.1.1.2.3.cmml">2</mn></msubsup><mo id="A7.p10.2.m2.3.3.1.1.1" xref="A7.p10.2.m2.3.3.1.1.1.cmml">∼</mo><msup id="A7.p10.2.m2.3.3.1.1.3" xref="A7.p10.2.m2.3.3.1.1.3.cmml"><mi id="A7.p10.2.m2.3.3.1.1.3.2" xref="A7.p10.2.m2.3.3.1.1.3.2.cmml">χ</mi><mn id="A7.p10.2.m2.3.3.1.1.3.3" xref="A7.p10.2.m2.3.3.1.1.3.3.cmml">2</mn></msup></mrow><mo id="A7.p10.2.m2.4.4.2.3" xref="A7.p10.2.m2.4.4.3a.cmml">,</mo><mrow id="A7.p10.2.m2.4.4.2.2" xref="A7.p10.2.m2.4.4.2.2.cmml"><mrow id="A7.p10.2.m2.4.4.2.2.2.2" xref="A7.p10.2.m2.4.4.2.2.2.1.cmml"><mo id="A7.p10.2.m2.4.4.2.2.2.2.1" stretchy="false" xref="A7.p10.2.m2.4.4.2.2.2.1.1.cmml">‖</mo><mi id="A7.p10.2.m2.2.2" xref="A7.p10.2.m2.2.2.cmml">X</mi><mo id="A7.p10.2.m2.4.4.2.2.2.2.2" rspace="0.500em" stretchy="false" xref="A7.p10.2.m2.4.4.2.2.2.1.1.cmml">‖</mo></mrow><mo id="A7.p10.2.m2.4.4.2.2.1" xref="A7.p10.2.m2.4.4.2.2.1.cmml">≈</mo><msqrt id="A7.p10.2.m2.4.4.2.2.3" xref="A7.p10.2.m2.4.4.2.2.3.cmml"><mi id="A7.p10.2.m2.4.4.2.2.3.2" xref="A7.p10.2.m2.4.4.2.2.3.2.cmml">d</mi></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p10.2.m2.4b"><apply id="A7.p10.2.m2.4.4.3.cmml" xref="A7.p10.2.m2.4.4.2"><csymbol cd="ambiguous" id="A7.p10.2.m2.4.4.3a.cmml" xref="A7.p10.2.m2.4.4.2.3">formulae-sequence</csymbol><apply id="A7.p10.2.m2.3.3.1.1.cmml" xref="A7.p10.2.m2.3.3.1.1"><csymbol cd="latexml" id="A7.p10.2.m2.3.3.1.1.1.cmml" xref="A7.p10.2.m2.3.3.1.1.1">similar-to</csymbol><apply id="A7.p10.2.m2.3.3.1.1.2.cmml" xref="A7.p10.2.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="A7.p10.2.m2.3.3.1.1.2.1.cmml" xref="A7.p10.2.m2.3.3.1.1.2">superscript</csymbol><apply id="A7.p10.2.m2.3.3.1.1.2.2.cmml" xref="A7.p10.2.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="A7.p10.2.m2.3.3.1.1.2.2.1.cmml" xref="A7.p10.2.m2.3.3.1.1.2">subscript</csymbol><apply id="A7.p10.2.m2.3.3.1.1.2.2.2.1.cmml" xref="A7.p10.2.m2.3.3.1.1.2.2.2.2"><csymbol cd="latexml" id="A7.p10.2.m2.3.3.1.1.2.2.2.1.1.cmml" xref="A7.p10.2.m2.3.3.1.1.2.2.2.2.1">norm</csymbol><ci id="A7.p10.2.m2.1.1.cmml" xref="A7.p10.2.m2.1.1">𝑋</ci></apply><cn id="A7.p10.2.m2.3.3.1.1.2.2.3.cmml" type="integer" xref="A7.p10.2.m2.3.3.1.1.2.2.3">2</cn></apply><cn id="A7.p10.2.m2.3.3.1.1.2.3.cmml" type="integer" xref="A7.p10.2.m2.3.3.1.1.2.3">2</cn></apply><apply id="A7.p10.2.m2.3.3.1.1.3.cmml" xref="A7.p10.2.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="A7.p10.2.m2.3.3.1.1.3.1.cmml" xref="A7.p10.2.m2.3.3.1.1.3">superscript</csymbol><ci id="A7.p10.2.m2.3.3.1.1.3.2.cmml" xref="A7.p10.2.m2.3.3.1.1.3.2">𝜒</ci><cn id="A7.p10.2.m2.3.3.1.1.3.3.cmml" type="integer" xref="A7.p10.2.m2.3.3.1.1.3.3">2</cn></apply></apply><apply id="A7.p10.2.m2.4.4.2.2.cmml" xref="A7.p10.2.m2.4.4.2.2"><approx id="A7.p10.2.m2.4.4.2.2.1.cmml" xref="A7.p10.2.m2.4.4.2.2.1"></approx><apply id="A7.p10.2.m2.4.4.2.2.2.1.cmml" xref="A7.p10.2.m2.4.4.2.2.2.2"><csymbol cd="latexml" id="A7.p10.2.m2.4.4.2.2.2.1.1.cmml" xref="A7.p10.2.m2.4.4.2.2.2.2.1">norm</csymbol><ci id="A7.p10.2.m2.2.2.cmml" xref="A7.p10.2.m2.2.2">𝑋</ci></apply><apply id="A7.p10.2.m2.4.4.2.2.3.cmml" xref="A7.p10.2.m2.4.4.2.2.3"><root id="A7.p10.2.m2.4.4.2.2.3a.cmml" xref="A7.p10.2.m2.4.4.2.2.3"></root><ci id="A7.p10.2.m2.4.4.2.2.3.2.cmml" xref="A7.p10.2.m2.4.4.2.2.3.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p10.2.m2.4c">\|X\|_{2}^{2}\sim\chi^{2},\|X\|\ \approx\sqrt{d}</annotation><annotation encoding="application/x-llamapun" id="A7.p10.2.m2.4d">∥ italic_X ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∼ italic_χ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , ∥ italic_X ∥ ≈ square-root start_ARG italic_d end_ARG</annotation></semantics></math>. Due to ReLU’s non-linear activation, perturbations are significantly amplified around the non-linear activations, especially in the high-dimensional space. Based on the above comparison</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C_{attn}\approx d\|W_{k}\|\|W_{v}\|\|\text{diag}(P)-PP^{\top}\|\ll C_{ffn}=nd%
\sqrt{d}\cdot\|W_{1}|b_{1}\|\cdot\|W_{2}|b_{2}\|" class="ltx_Math" display="block" id="A7.E19.m1.5"><semantics id="A7.E19.m1.5a"><mrow id="A7.E19.m1.5.5" xref="A7.E19.m1.5.5.cmml"><msub id="A7.E19.m1.5.5.6" xref="A7.E19.m1.5.5.6.cmml"><mi id="A7.E19.m1.5.5.6.2" xref="A7.E19.m1.5.5.6.2.cmml">C</mi><mrow id="A7.E19.m1.5.5.6.3" xref="A7.E19.m1.5.5.6.3.cmml"><mi id="A7.E19.m1.5.5.6.3.2" xref="A7.E19.m1.5.5.6.3.2.cmml">a</mi><mo id="A7.E19.m1.5.5.6.3.1" xref="A7.E19.m1.5.5.6.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.6.3.3" xref="A7.E19.m1.5.5.6.3.3.cmml">t</mi><mo id="A7.E19.m1.5.5.6.3.1a" xref="A7.E19.m1.5.5.6.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.6.3.4" xref="A7.E19.m1.5.5.6.3.4.cmml">t</mi><mo id="A7.E19.m1.5.5.6.3.1b" xref="A7.E19.m1.5.5.6.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.6.3.5" xref="A7.E19.m1.5.5.6.3.5.cmml">n</mi></mrow></msub><mo id="A7.E19.m1.5.5.7" xref="A7.E19.m1.5.5.7.cmml">≈</mo><mrow id="A7.E19.m1.4.4.3" xref="A7.E19.m1.4.4.3.cmml"><mi id="A7.E19.m1.4.4.3.5" xref="A7.E19.m1.4.4.3.5.cmml">d</mi><mo id="A7.E19.m1.4.4.3.4" xref="A7.E19.m1.4.4.3.4.cmml">⁢</mo><mrow id="A7.E19.m1.2.2.1.1.1" xref="A7.E19.m1.2.2.1.1.2.cmml"><mo id="A7.E19.m1.2.2.1.1.1.2" stretchy="false" xref="A7.E19.m1.2.2.1.1.2.1.cmml">‖</mo><msub id="A7.E19.m1.2.2.1.1.1.1" xref="A7.E19.m1.2.2.1.1.1.1.cmml"><mi id="A7.E19.m1.2.2.1.1.1.1.2" xref="A7.E19.m1.2.2.1.1.1.1.2.cmml">W</mi><mi id="A7.E19.m1.2.2.1.1.1.1.3" xref="A7.E19.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="A7.E19.m1.2.2.1.1.1.3" stretchy="false" xref="A7.E19.m1.2.2.1.1.2.1.cmml">‖</mo></mrow><mo id="A7.E19.m1.4.4.3.4a" xref="A7.E19.m1.4.4.3.4.cmml">⁢</mo><mrow id="A7.E19.m1.3.3.2.2.1" xref="A7.E19.m1.3.3.2.2.2.cmml"><mo id="A7.E19.m1.3.3.2.2.1.2" stretchy="false" xref="A7.E19.m1.3.3.2.2.2.1.cmml">‖</mo><msub id="A7.E19.m1.3.3.2.2.1.1" xref="A7.E19.m1.3.3.2.2.1.1.cmml"><mi id="A7.E19.m1.3.3.2.2.1.1.2" xref="A7.E19.m1.3.3.2.2.1.1.2.cmml">W</mi><mi id="A7.E19.m1.3.3.2.2.1.1.3" xref="A7.E19.m1.3.3.2.2.1.1.3.cmml">v</mi></msub><mo id="A7.E19.m1.3.3.2.2.1.3" stretchy="false" xref="A7.E19.m1.3.3.2.2.2.1.cmml">‖</mo></mrow><mo id="A7.E19.m1.4.4.3.4b" xref="A7.E19.m1.4.4.3.4.cmml">⁢</mo><mrow id="A7.E19.m1.4.4.3.3.1" xref="A7.E19.m1.4.4.3.3.2.cmml"><mo id="A7.E19.m1.4.4.3.3.1.2" stretchy="false" xref="A7.E19.m1.4.4.3.3.2.1.cmml">‖</mo><mrow id="A7.E19.m1.4.4.3.3.1.1" xref="A7.E19.m1.4.4.3.3.1.1.cmml"><mrow id="A7.E19.m1.4.4.3.3.1.1.2" xref="A7.E19.m1.4.4.3.3.1.1.2.cmml"><mtext id="A7.E19.m1.4.4.3.3.1.1.2.2" xref="A7.E19.m1.4.4.3.3.1.1.2.2a.cmml">diag</mtext><mo id="A7.E19.m1.4.4.3.3.1.1.2.1" xref="A7.E19.m1.4.4.3.3.1.1.2.1.cmml">⁢</mo><mrow id="A7.E19.m1.4.4.3.3.1.1.2.3.2" xref="A7.E19.m1.4.4.3.3.1.1.2.cmml"><mo id="A7.E19.m1.4.4.3.3.1.1.2.3.2.1" stretchy="false" xref="A7.E19.m1.4.4.3.3.1.1.2.cmml">(</mo><mi id="A7.E19.m1.1.1" xref="A7.E19.m1.1.1.cmml">P</mi><mo id="A7.E19.m1.4.4.3.3.1.1.2.3.2.2" stretchy="false" xref="A7.E19.m1.4.4.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="A7.E19.m1.4.4.3.3.1.1.1" xref="A7.E19.m1.4.4.3.3.1.1.1.cmml">−</mo><mrow id="A7.E19.m1.4.4.3.3.1.1.3" xref="A7.E19.m1.4.4.3.3.1.1.3.cmml"><mi id="A7.E19.m1.4.4.3.3.1.1.3.2" xref="A7.E19.m1.4.4.3.3.1.1.3.2.cmml">P</mi><mo id="A7.E19.m1.4.4.3.3.1.1.3.1" xref="A7.E19.m1.4.4.3.3.1.1.3.1.cmml">⁢</mo><msup id="A7.E19.m1.4.4.3.3.1.1.3.3" xref="A7.E19.m1.4.4.3.3.1.1.3.3.cmml"><mi id="A7.E19.m1.4.4.3.3.1.1.3.3.2" xref="A7.E19.m1.4.4.3.3.1.1.3.3.2.cmml">P</mi><mo id="A7.E19.m1.4.4.3.3.1.1.3.3.3" xref="A7.E19.m1.4.4.3.3.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><mo id="A7.E19.m1.4.4.3.3.1.3" stretchy="false" xref="A7.E19.m1.4.4.3.3.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.E19.m1.5.5.8" xref="A7.E19.m1.5.5.8.cmml">≪</mo><msub id="A7.E19.m1.5.5.9" xref="A7.E19.m1.5.5.9.cmml"><mi id="A7.E19.m1.5.5.9.2" xref="A7.E19.m1.5.5.9.2.cmml">C</mi><mrow id="A7.E19.m1.5.5.9.3" xref="A7.E19.m1.5.5.9.3.cmml"><mi id="A7.E19.m1.5.5.9.3.2" xref="A7.E19.m1.5.5.9.3.2.cmml">f</mi><mo id="A7.E19.m1.5.5.9.3.1" xref="A7.E19.m1.5.5.9.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.9.3.3" xref="A7.E19.m1.5.5.9.3.3.cmml">f</mi><mo id="A7.E19.m1.5.5.9.3.1a" xref="A7.E19.m1.5.5.9.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.9.3.4" xref="A7.E19.m1.5.5.9.3.4.cmml">n</mi></mrow></msub><mo id="A7.E19.m1.5.5.10" xref="A7.E19.m1.5.5.10.cmml">=</mo><mrow id="A7.E19.m1.5.5.4" xref="A7.E19.m1.5.5.4.cmml"><mrow id="A7.E19.m1.5.5.4.3" xref="A7.E19.m1.5.5.4.3.cmml"><mi id="A7.E19.m1.5.5.4.3.2" xref="A7.E19.m1.5.5.4.3.2.cmml">n</mi><mo id="A7.E19.m1.5.5.4.3.1" xref="A7.E19.m1.5.5.4.3.1.cmml">⁢</mo><mi id="A7.E19.m1.5.5.4.3.3" xref="A7.E19.m1.5.5.4.3.3.cmml">d</mi><mo id="A7.E19.m1.5.5.4.3.1a" xref="A7.E19.m1.5.5.4.3.1.cmml">⁢</mo><msqrt id="A7.E19.m1.5.5.4.3.4" xref="A7.E19.m1.5.5.4.3.4.cmml"><mi id="A7.E19.m1.5.5.4.3.4.2" xref="A7.E19.m1.5.5.4.3.4.2.cmml">d</mi></msqrt></mrow><mo id="A7.E19.m1.5.5.4.2" lspace="0.222em" rspace="0.222em" xref="A7.E19.m1.5.5.4.2.cmml">⋅</mo><mrow id="A7.E19.m1.5.5.4.1.1" xref="A7.E19.m1.5.5.4.1.2.cmml"><mo id="A7.E19.m1.5.5.4.1.1.2" stretchy="false" xref="A7.E19.m1.5.5.4.1.2.1.cmml">‖</mo><mrow id="A7.E19.m1.5.5.4.1.1.1" xref="A7.E19.m1.5.5.4.1.1.1.cmml"><mrow id="A7.E19.m1.5.5.4.1.1.1.2" xref="A7.E19.m1.5.5.4.1.1.1.2.cmml"><mrow id="A7.E19.m1.5.5.4.1.1.1.1.1" xref="A7.E19.m1.5.5.4.1.1.1.1.1.cmml"><msub id="A7.E19.m1.5.5.4.1.1.1.1.1.3" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3.cmml"><mi id="A7.E19.m1.5.5.4.1.1.1.1.1.3.2" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3.2.cmml">W</mi><mn id="A7.E19.m1.5.5.4.1.1.1.1.1.3.3" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="A7.E19.m1.5.5.4.1.1.1.1.1.2" xref="A7.E19.m1.5.5.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.2.cmml"><mo id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.cmml"><mi id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.2" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.2.cmml">b</mi><mn id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.3" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="A7.E19.m1.5.5.4.1.1.1.2.3" rspace="0.222em" xref="A7.E19.m1.5.5.4.1.1.1.2.3.cmml">⋅</mo><mrow id="A7.E19.m1.5.5.4.1.1.1.2.2.1" xref="A7.E19.m1.5.5.4.1.1.1.2.2.2.cmml"><mo id="A7.E19.m1.5.5.4.1.1.1.2.2.1.2" stretchy="false" xref="A7.E19.m1.5.5.4.1.1.1.2.2.2.1.cmml">‖</mo><msub id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.cmml"><mi id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.2" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.2.cmml">W</mi><mn id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.3" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.3.cmml">2</mn></msub><mo id="A7.E19.m1.5.5.4.1.1.1.2.2.1.3" stretchy="false" xref="A7.E19.m1.5.5.4.1.1.1.2.2.2.1.cmml">|</mo></mrow></mrow><mo id="A7.E19.m1.5.5.4.1.1.1.3" xref="A7.E19.m1.5.5.4.1.1.1.3.cmml">⁢</mo><msub id="A7.E19.m1.5.5.4.1.1.1.4" xref="A7.E19.m1.5.5.4.1.1.1.4.cmml"><mi id="A7.E19.m1.5.5.4.1.1.1.4.2" xref="A7.E19.m1.5.5.4.1.1.1.4.2.cmml">b</mi><mn id="A7.E19.m1.5.5.4.1.1.1.4.3" xref="A7.E19.m1.5.5.4.1.1.1.4.3.cmml">2</mn></msub></mrow><mo id="A7.E19.m1.5.5.4.1.1.3" stretchy="false" xref="A7.E19.m1.5.5.4.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E19.m1.5b"><apply id="A7.E19.m1.5.5.cmml" xref="A7.E19.m1.5.5"><and id="A7.E19.m1.5.5a.cmml" xref="A7.E19.m1.5.5"></and><apply id="A7.E19.m1.5.5b.cmml" xref="A7.E19.m1.5.5"><approx id="A7.E19.m1.5.5.7.cmml" xref="A7.E19.m1.5.5.7"></approx><apply id="A7.E19.m1.5.5.6.cmml" xref="A7.E19.m1.5.5.6"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.6.1.cmml" xref="A7.E19.m1.5.5.6">subscript</csymbol><ci id="A7.E19.m1.5.5.6.2.cmml" xref="A7.E19.m1.5.5.6.2">𝐶</ci><apply id="A7.E19.m1.5.5.6.3.cmml" xref="A7.E19.m1.5.5.6.3"><times id="A7.E19.m1.5.5.6.3.1.cmml" xref="A7.E19.m1.5.5.6.3.1"></times><ci id="A7.E19.m1.5.5.6.3.2.cmml" xref="A7.E19.m1.5.5.6.3.2">𝑎</ci><ci id="A7.E19.m1.5.5.6.3.3.cmml" xref="A7.E19.m1.5.5.6.3.3">𝑡</ci><ci id="A7.E19.m1.5.5.6.3.4.cmml" xref="A7.E19.m1.5.5.6.3.4">𝑡</ci><ci id="A7.E19.m1.5.5.6.3.5.cmml" xref="A7.E19.m1.5.5.6.3.5">𝑛</ci></apply></apply><apply id="A7.E19.m1.4.4.3.cmml" xref="A7.E19.m1.4.4.3"><times id="A7.E19.m1.4.4.3.4.cmml" xref="A7.E19.m1.4.4.3.4"></times><ci id="A7.E19.m1.4.4.3.5.cmml" xref="A7.E19.m1.4.4.3.5">𝑑</ci><apply id="A7.E19.m1.2.2.1.1.2.cmml" xref="A7.E19.m1.2.2.1.1.1"><csymbol cd="latexml" id="A7.E19.m1.2.2.1.1.2.1.cmml" xref="A7.E19.m1.2.2.1.1.1.2">norm</csymbol><apply id="A7.E19.m1.2.2.1.1.1.1.cmml" xref="A7.E19.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A7.E19.m1.2.2.1.1.1.1.1.cmml" xref="A7.E19.m1.2.2.1.1.1.1">subscript</csymbol><ci id="A7.E19.m1.2.2.1.1.1.1.2.cmml" xref="A7.E19.m1.2.2.1.1.1.1.2">𝑊</ci><ci id="A7.E19.m1.2.2.1.1.1.1.3.cmml" xref="A7.E19.m1.2.2.1.1.1.1.3">𝑘</ci></apply></apply><apply id="A7.E19.m1.3.3.2.2.2.cmml" xref="A7.E19.m1.3.3.2.2.1"><csymbol cd="latexml" id="A7.E19.m1.3.3.2.2.2.1.cmml" xref="A7.E19.m1.3.3.2.2.1.2">norm</csymbol><apply id="A7.E19.m1.3.3.2.2.1.1.cmml" xref="A7.E19.m1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A7.E19.m1.3.3.2.2.1.1.1.cmml" xref="A7.E19.m1.3.3.2.2.1.1">subscript</csymbol><ci id="A7.E19.m1.3.3.2.2.1.1.2.cmml" xref="A7.E19.m1.3.3.2.2.1.1.2">𝑊</ci><ci id="A7.E19.m1.3.3.2.2.1.1.3.cmml" xref="A7.E19.m1.3.3.2.2.1.1.3">𝑣</ci></apply></apply><apply id="A7.E19.m1.4.4.3.3.2.cmml" xref="A7.E19.m1.4.4.3.3.1"><csymbol cd="latexml" id="A7.E19.m1.4.4.3.3.2.1.cmml" xref="A7.E19.m1.4.4.3.3.1.2">norm</csymbol><apply id="A7.E19.m1.4.4.3.3.1.1.cmml" xref="A7.E19.m1.4.4.3.3.1.1"><minus id="A7.E19.m1.4.4.3.3.1.1.1.cmml" xref="A7.E19.m1.4.4.3.3.1.1.1"></minus><apply id="A7.E19.m1.4.4.3.3.1.1.2.cmml" xref="A7.E19.m1.4.4.3.3.1.1.2"><times id="A7.E19.m1.4.4.3.3.1.1.2.1.cmml" xref="A7.E19.m1.4.4.3.3.1.1.2.1"></times><ci id="A7.E19.m1.4.4.3.3.1.1.2.2a.cmml" xref="A7.E19.m1.4.4.3.3.1.1.2.2"><mtext id="A7.E19.m1.4.4.3.3.1.1.2.2.cmml" xref="A7.E19.m1.4.4.3.3.1.1.2.2">diag</mtext></ci><ci id="A7.E19.m1.1.1.cmml" xref="A7.E19.m1.1.1">𝑃</ci></apply><apply id="A7.E19.m1.4.4.3.3.1.1.3.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3"><times id="A7.E19.m1.4.4.3.3.1.1.3.1.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.1"></times><ci id="A7.E19.m1.4.4.3.3.1.1.3.2.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.2">𝑃</ci><apply id="A7.E19.m1.4.4.3.3.1.1.3.3.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.3"><csymbol cd="ambiguous" id="A7.E19.m1.4.4.3.3.1.1.3.3.1.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.3">superscript</csymbol><ci id="A7.E19.m1.4.4.3.3.1.1.3.3.2.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.3.2">𝑃</ci><csymbol cd="latexml" id="A7.E19.m1.4.4.3.3.1.1.3.3.3.cmml" xref="A7.E19.m1.4.4.3.3.1.1.3.3.3">top</csymbol></apply></apply></apply></apply></apply></apply><apply id="A7.E19.m1.5.5c.cmml" xref="A7.E19.m1.5.5"><csymbol cd="latexml" id="A7.E19.m1.5.5.8.cmml" xref="A7.E19.m1.5.5.8">much-less-than</csymbol><share href="https://arxiv.org/html/2405.20192v2#A7.E19.m1.4.4.3.cmml" id="A7.E19.m1.5.5d.cmml" xref="A7.E19.m1.5.5"></share><apply id="A7.E19.m1.5.5.9.cmml" xref="A7.E19.m1.5.5.9"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.9.1.cmml" xref="A7.E19.m1.5.5.9">subscript</csymbol><ci id="A7.E19.m1.5.5.9.2.cmml" xref="A7.E19.m1.5.5.9.2">𝐶</ci><apply id="A7.E19.m1.5.5.9.3.cmml" xref="A7.E19.m1.5.5.9.3"><times id="A7.E19.m1.5.5.9.3.1.cmml" xref="A7.E19.m1.5.5.9.3.1"></times><ci id="A7.E19.m1.5.5.9.3.2.cmml" xref="A7.E19.m1.5.5.9.3.2">𝑓</ci><ci id="A7.E19.m1.5.5.9.3.3.cmml" xref="A7.E19.m1.5.5.9.3.3">𝑓</ci><ci id="A7.E19.m1.5.5.9.3.4.cmml" xref="A7.E19.m1.5.5.9.3.4">𝑛</ci></apply></apply></apply><apply id="A7.E19.m1.5.5e.cmml" xref="A7.E19.m1.5.5"><eq id="A7.E19.m1.5.5.10.cmml" xref="A7.E19.m1.5.5.10"></eq><share href="https://arxiv.org/html/2405.20192v2#A7.E19.m1.5.5.9.cmml" id="A7.E19.m1.5.5f.cmml" xref="A7.E19.m1.5.5"></share><apply id="A7.E19.m1.5.5.4.cmml" xref="A7.E19.m1.5.5.4"><ci id="A7.E19.m1.5.5.4.2.cmml" xref="A7.E19.m1.5.5.4.2">⋅</ci><apply id="A7.E19.m1.5.5.4.3.cmml" xref="A7.E19.m1.5.5.4.3"><times id="A7.E19.m1.5.5.4.3.1.cmml" xref="A7.E19.m1.5.5.4.3.1"></times><ci id="A7.E19.m1.5.5.4.3.2.cmml" xref="A7.E19.m1.5.5.4.3.2">𝑛</ci><ci id="A7.E19.m1.5.5.4.3.3.cmml" xref="A7.E19.m1.5.5.4.3.3">𝑑</ci><apply id="A7.E19.m1.5.5.4.3.4.cmml" xref="A7.E19.m1.5.5.4.3.4"><root id="A7.E19.m1.5.5.4.3.4a.cmml" xref="A7.E19.m1.5.5.4.3.4"></root><ci id="A7.E19.m1.5.5.4.3.4.2.cmml" xref="A7.E19.m1.5.5.4.3.4.2">𝑑</ci></apply></apply><apply id="A7.E19.m1.5.5.4.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1"><csymbol cd="latexml" id="A7.E19.m1.5.5.4.1.2.1.cmml" xref="A7.E19.m1.5.5.4.1.1.2">norm</csymbol><apply id="A7.E19.m1.5.5.4.1.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1"><times id="A7.E19.m1.5.5.4.1.1.1.3.cmml" xref="A7.E19.m1.5.5.4.1.1.1.3"></times><apply id="A7.E19.m1.5.5.4.1.1.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2"><ci id="A7.E19.m1.5.5.4.1.1.1.2.3.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.3">⋅</ci><apply id="A7.E19.m1.5.5.4.1.1.1.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1"><times id="A7.E19.m1.5.5.4.1.1.1.1.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.2"></times><apply id="A7.E19.m1.5.5.4.1.1.1.1.1.3.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.4.1.1.1.1.1.3.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E19.m1.5.5.4.1.1.1.1.1.3.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3.2">𝑊</ci><cn id="A7.E19.m1.5.5.4.1.1.1.1.1.3.3.cmml" type="integer" xref="A7.E19.m1.5.5.4.1.1.1.1.1.3.3">1</cn></apply><apply id="A7.E19.m1.5.5.4.1.1.1.1.1.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A7.E19.m1.5.5.4.1.1.1.1.1.1.2.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.2">delimited-|‖</csymbol><apply id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.2">𝑏</ci><cn id="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A7.E19.m1.5.5.4.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="A7.E19.m1.5.5.4.1.1.1.2.2.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1"><csymbol cd="latexml" id="A7.E19.m1.5.5.4.1.1.1.2.2.2.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.2">delimited-‖|</csymbol><apply id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1">subscript</csymbol><ci id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.2">𝑊</ci><cn id="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.3.cmml" type="integer" xref="A7.E19.m1.5.5.4.1.1.1.2.2.1.1.3">2</cn></apply></apply></apply><apply id="A7.E19.m1.5.5.4.1.1.1.4.cmml" xref="A7.E19.m1.5.5.4.1.1.1.4"><csymbol cd="ambiguous" id="A7.E19.m1.5.5.4.1.1.1.4.1.cmml" xref="A7.E19.m1.5.5.4.1.1.1.4">subscript</csymbol><ci id="A7.E19.m1.5.5.4.1.1.1.4.2.cmml" xref="A7.E19.m1.5.5.4.1.1.1.4.2">𝑏</ci><cn id="A7.E19.m1.5.5.4.1.1.1.4.3.cmml" type="integer" xref="A7.E19.m1.5.5.4.1.1.1.4.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E19.m1.5c">C_{attn}\approx d\|W_{k}\|\|W_{v}\|\|\text{diag}(P)-PP^{\top}\|\ll C_{ffn}=nd%
\sqrt{d}\cdot\|W_{1}|b_{1}\|\cdot\|W_{2}|b_{2}\|</annotation><annotation encoding="application/x-llamapun" id="A7.E19.m1.5d">italic_C start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT ≈ italic_d ∥ italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ ∥ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∥ ∥ diag ( italic_P ) - italic_P italic_P start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∥ ≪ italic_C start_POSTSUBSCRIPT italic_f italic_f italic_n end_POSTSUBSCRIPT = italic_n italic_d square-root start_ARG italic_d end_ARG ⋅ ∥ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ ⋅ ∥ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A7.p10.3">which implies</p>
<table class="ltx_equation ltx_eqn_table" id="A7.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\|\Delta\text{Attn}(X)\|&lt;\|\Delta\text{FFN}(X)\|" class="ltx_Math" display="block" id="A7.E20.m1.4"><semantics id="A7.E20.m1.4a"><mrow id="A7.E20.m1.4.4" xref="A7.E20.m1.4.4.cmml"><mrow id="A7.E20.m1.3.3.1.1" xref="A7.E20.m1.3.3.1.2.cmml"><mo id="A7.E20.m1.3.3.1.1.2" stretchy="false" xref="A7.E20.m1.3.3.1.2.1.cmml">‖</mo><mrow id="A7.E20.m1.3.3.1.1.1" xref="A7.E20.m1.3.3.1.1.1.cmml"><mi id="A7.E20.m1.3.3.1.1.1.2" mathvariant="normal" xref="A7.E20.m1.3.3.1.1.1.2.cmml">Δ</mi><mo id="A7.E20.m1.3.3.1.1.1.1" xref="A7.E20.m1.3.3.1.1.1.1.cmml">⁢</mo><mtext id="A7.E20.m1.3.3.1.1.1.3" xref="A7.E20.m1.3.3.1.1.1.3a.cmml">Attn</mtext><mo id="A7.E20.m1.3.3.1.1.1.1a" xref="A7.E20.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="A7.E20.m1.3.3.1.1.1.4.2" xref="A7.E20.m1.3.3.1.1.1.cmml"><mo id="A7.E20.m1.3.3.1.1.1.4.2.1" stretchy="false" xref="A7.E20.m1.3.3.1.1.1.cmml">(</mo><mi id="A7.E20.m1.1.1" xref="A7.E20.m1.1.1.cmml">X</mi><mo id="A7.E20.m1.3.3.1.1.1.4.2.2" stretchy="false" xref="A7.E20.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E20.m1.3.3.1.1.3" stretchy="false" xref="A7.E20.m1.3.3.1.2.1.cmml">‖</mo></mrow><mo id="A7.E20.m1.4.4.3" xref="A7.E20.m1.4.4.3.cmml">&lt;</mo><mrow id="A7.E20.m1.4.4.2.1" xref="A7.E20.m1.4.4.2.2.cmml"><mo id="A7.E20.m1.4.4.2.1.2" stretchy="false" xref="A7.E20.m1.4.4.2.2.1.cmml">‖</mo><mrow id="A7.E20.m1.4.4.2.1.1" xref="A7.E20.m1.4.4.2.1.1.cmml"><mi id="A7.E20.m1.4.4.2.1.1.2" mathvariant="normal" xref="A7.E20.m1.4.4.2.1.1.2.cmml">Δ</mi><mo id="A7.E20.m1.4.4.2.1.1.1" xref="A7.E20.m1.4.4.2.1.1.1.cmml">⁢</mo><mtext id="A7.E20.m1.4.4.2.1.1.3" xref="A7.E20.m1.4.4.2.1.1.3a.cmml">FFN</mtext><mo id="A7.E20.m1.4.4.2.1.1.1a" xref="A7.E20.m1.4.4.2.1.1.1.cmml">⁢</mo><mrow id="A7.E20.m1.4.4.2.1.1.4.2" xref="A7.E20.m1.4.4.2.1.1.cmml"><mo id="A7.E20.m1.4.4.2.1.1.4.2.1" stretchy="false" xref="A7.E20.m1.4.4.2.1.1.cmml">(</mo><mi id="A7.E20.m1.2.2" xref="A7.E20.m1.2.2.cmml">X</mi><mo id="A7.E20.m1.4.4.2.1.1.4.2.2" stretchy="false" xref="A7.E20.m1.4.4.2.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E20.m1.4.4.2.1.3" stretchy="false" xref="A7.E20.m1.4.4.2.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E20.m1.4b"><apply id="A7.E20.m1.4.4.cmml" xref="A7.E20.m1.4.4"><lt id="A7.E20.m1.4.4.3.cmml" xref="A7.E20.m1.4.4.3"></lt><apply id="A7.E20.m1.3.3.1.2.cmml" xref="A7.E20.m1.3.3.1.1"><csymbol cd="latexml" id="A7.E20.m1.3.3.1.2.1.cmml" xref="A7.E20.m1.3.3.1.1.2">norm</csymbol><apply id="A7.E20.m1.3.3.1.1.1.cmml" xref="A7.E20.m1.3.3.1.1.1"><times id="A7.E20.m1.3.3.1.1.1.1.cmml" xref="A7.E20.m1.3.3.1.1.1.1"></times><ci id="A7.E20.m1.3.3.1.1.1.2.cmml" xref="A7.E20.m1.3.3.1.1.1.2">Δ</ci><ci id="A7.E20.m1.3.3.1.1.1.3a.cmml" xref="A7.E20.m1.3.3.1.1.1.3"><mtext id="A7.E20.m1.3.3.1.1.1.3.cmml" xref="A7.E20.m1.3.3.1.1.1.3">Attn</mtext></ci><ci id="A7.E20.m1.1.1.cmml" xref="A7.E20.m1.1.1">𝑋</ci></apply></apply><apply id="A7.E20.m1.4.4.2.2.cmml" xref="A7.E20.m1.4.4.2.1"><csymbol cd="latexml" id="A7.E20.m1.4.4.2.2.1.cmml" xref="A7.E20.m1.4.4.2.1.2">norm</csymbol><apply id="A7.E20.m1.4.4.2.1.1.cmml" xref="A7.E20.m1.4.4.2.1.1"><times id="A7.E20.m1.4.4.2.1.1.1.cmml" xref="A7.E20.m1.4.4.2.1.1.1"></times><ci id="A7.E20.m1.4.4.2.1.1.2.cmml" xref="A7.E20.m1.4.4.2.1.1.2">Δ</ci><ci id="A7.E20.m1.4.4.2.1.1.3a.cmml" xref="A7.E20.m1.4.4.2.1.1.3"><mtext id="A7.E20.m1.4.4.2.1.1.3.cmml" xref="A7.E20.m1.4.4.2.1.1.3">FFN</mtext></ci><ci id="A7.E20.m1.2.2.cmml" xref="A7.E20.m1.2.2">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E20.m1.4c">\|\Delta\text{Attn}(X)\|&lt;\|\Delta\text{FFN}(X)\|</annotation><annotation encoding="application/x-llamapun" id="A7.E20.m1.4d">∥ roman_Δ Attn ( italic_X ) ∥ &lt; ∥ roman_Δ FFN ( italic_X ) ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A7.p11">
<p class="ltx_p" id="A7.p11.1">Thus, for equal-magnitude parameter perturbations, the output perturbation bound of the Attention module is less than that of the FFN module. This indicates that the FFN updates will introduce great perturbation to the distribution of transformers and narrow the similarity between tuned models and pre-trained models.</p>
</div>
</section>
<section class="ltx_appendix" id="A8">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Case Study</h2>
<div class="ltx_para" id="A8.p1">
<p class="ltx_p" id="A8.p1.1">Here we present three cases of <span class="ltx_text ltx_font_smallcaps" id="A8.p1.1.1">TAIA</span> and vanilla method evaluated on Advbench in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A8.F6" title="Figure 6 ‣ Appendix H Case Study ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A8.F7" title="Figure 7 ‣ Appendix H Case Study ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.20192v2#A8.F8" title="Figure 8 ‣ Appendix H Case Study ‣ TAIA: Large Language Models are Out-of-Distribution Data Learners"><span class="ltx_text ltx_ref_tag">8</span></a>, which are tuned on explicitly harmful contents, identity shifting contents and benign contents, respectively.
<span class="ltx_text ltx_font_smallcaps" id="A8.p1.1.2">TAIA</span> produces harmless contents against severe jailbreaking, albeit undertaking red teaming tuning.</p>
</div>
<figure class="ltx_figure" id="A8.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="892" id="A8.F6.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A8.F6.6.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A8.F6.7.2" style="font-size:90%;">Comparison between <span class="ltx_text ltx_font_smallcaps" id="A8.F6.7.2.1">TAIA</span> and vanilla fine-tuning method on Advbench with explicitly harmful tuning contents. We choose LLaMA2-7B-chat as the base LLM. We <span class="ltx_text" id="A8.F6.7.2.2" style="color:#0070C0;">highlight</span> the harmful contents generated by the vanilla method and <span class="ltx_text" id="A8.F6.7.2.3" style="color:#C00000;">denote</span> the rejective contents produced by <span class="ltx_text ltx_font_smallcaps" id="A8.F6.7.2.4">TAIA</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A8.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="911" id="A8.F7.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A8.F7.6.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="A8.F7.7.2" style="font-size:90%;">Comparison between <span class="ltx_text ltx_font_smallcaps" id="A8.F7.7.2.1">TAIA</span> and vanilla fine-tuning method on Advbench with identity shifting tuning contents. We choose LLaMA2-7B-chat as the base LLM. We <span class="ltx_text" id="A8.F7.7.2.2" style="color:#0070C0;">highlight</span> the harmful contents generated by the vanilla method and <span class="ltx_text" id="A8.F7.7.2.3" style="color:#C00000;">denote</span> the rejective contents produced by <span class="ltx_text ltx_font_smallcaps" id="A8.F7.7.2.4">TAIA</span>.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A8.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="799" id="A8.F8.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A8.F8.6.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="A8.F8.7.2" style="font-size:90%;">Comparison between <span class="ltx_text ltx_font_smallcaps" id="A8.F8.7.2.1">TAIA</span> and vanilla fine-tuning method on Advbench with benign tuning contents (Alpaca-GPT4). We choose LLaMA2-7B-chat as the base LLM. We <span class="ltx_text" id="A8.F8.7.2.2" style="color:#0070C0;">highlight</span> the harmful contents generated by the vanilla method and <span class="ltx_text" id="A8.F8.7.2.3" style="color:#C00000;">denote</span> the rejective contents produced by <span class="ltx_text ltx_font_smallcaps" id="A8.F8.7.2.4">TAIA</span>.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>